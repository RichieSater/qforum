<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Quantopian Miscalculation?
</title>
<meta content='I don&#39;t quite understand the way Quantopian simulate the trade. Hope someone can help me.Please look at the following algorithm and backtest result. The algorithm is very simple: buy XIV with all cash available. The backtest ran from 20140716 to 20140718. 20140717 was the day MH17 was shotdown in Ukraine, as a result price dropped significantly.From the log, I can see the prices on each day are:20140716 46.8020140717 42.3320140718 45.4716On 16th, the algorithm try to buy 1000000/46.8 -&gt; 23167...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="EE9M2n3lOGZog7vIxXU/2sI9T3+PtcRzoOUSZ8CukAxsKTqX3xPqhdGe4vmKmpeu+rNsFvV50Wgi6skNauvytw==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=false;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/quantopian-miscalculation' property='og:url'>
<meta content='Quantopian Miscalculation?' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/quantopian-miscalculation' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Quantopian Miscalculation?' property='og:title'>
<meta content='I don&#39;t quite understand the way Quantopian simulate the trade. Hope someone can help me.Please look at the following algorithm and backtest result. The algorithm is very simple: buy XIV with all cash available. The backtest ran from 20140716 to 20140718. 20140717 was the day MH17 was shotdown in Ukraine, as a result price dropped significantly.From the log, I can see the prices on each day are:20140716 46.8020140717 42.3320140718 45.4716On 16th, the algorithm try to buy 1000000/46.8 -&gt; 23167...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/quantopian-miscalculation">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='5489b9c9ddb347b72700044a'>
<div class='post-container' data-post-id='5489b9c9ddb347b72700044a' id='5489b9c9ddb347b72700044a'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Quantopian Miscalculation?</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546ccfabf8dadee0970003dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1cddd1e9bb4610cc0db65b55f5fdc199?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546ccfabf8dadee0970003dc'>Alan Wang</a>
</div>
<span class='posted-at'>posted </span>
<span UTCms='1418312137000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Quantopian Miscalculation?&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fquantopian-miscalculation%3Futm_source%3Dwebsite_share%26utm_campaign%3Dquantopian-miscalculation%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fquantopian-miscalculation%3Futm_source%3Dwebsite_share%26utm_campaign%3Dquantopian-miscalculation%26utm_medium%3Dlinkedin&amp;title=Quantopian+Miscalculation%3F+%28Alan+Wang%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/quantopian-miscalculation?utm_source=website_share&amp;utm_campaign=quantopian-miscalculation&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Alan Wang" />
<div class='body-text'>
<div class='body-text-container post-body'><p>I don&#39;t quite understand the way Quantopian simulate the trade. Hope someone can help me.</p>

<p>Please look at the following algorithm and backtest result. The algorithm is very simple: buy XIV with all cash available. The backtest ran from 20140716 to 20140718. 20140717 was the day MH17 was shotdown in Ukraine, as a result price dropped significantly.</p>

<p>From the log, I can see the prices on each day are:<br>
20140716 46.80<br>
20140717 42.33<br>
20140718 45.4716</p>

<p>On 16th, the algorithm try to buy 1000000/46.8 -> 23167 shares. If you click &#39;Transaction Details&#39; page. The transaction on 16th is BUY 21367 shares of XIV @ 42.36, which seems to be the price of 17th, after MH17 was shot down.</p>

<p>Why? The price algo used to calculate order and the price system used to fulfill the order has 1 days gap. Just like we calculate the orders today at market close and place the order tomorrow at market close.</p>

<p>Why?</p>

<p>Ideally, the backtester should use the same price of 46.8 to fulfill the order immediately. I understand the price will move after the moment of calculation. But that should be accounted by slippage.  </p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>20 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='5489d6dcd3a3d41b8f00003b' id='5489d6dcd3a3d41b8f00003b'>
<a href='#5489d6dcd3a3d41b8f00003b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1418319583000' class='quanto-date posted-at response-posted-at' href='#5489d6dcd3a3d41b8f00003b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Alan,</p>

<p>How orders work in daily and minutely mode is that, at the fastest, orders are executed at the next bar. So when you submit an order in daily mode on October 1st, the fastest it&#39;ll get executed is October 2nd at the closing. The same applies in minutely mode: 9:31 AM submit 9:32 execution (at the fastest). </p>

<p>However you can create your own custom slippage models to fit your needs. I believe Grant has created one on this thread (<a href="https://www.quantopian.com/posts/backtest-results-different-in-minute-and-daily-mode">https://www.quantopian.com/posts/backtest-results-different-in-minute-and-daily-mode</a>) to run on daily bars and execute on the same day.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5489ed16feaf14badd00009e' id='5489ed16feaf14badd00009e'>
<a href='#5489ed16feaf14badd00009e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5258725aa09fa7ebaa000024'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7734b86e32e834268bee6749eb322fb4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5258725aa09fa7ebaa000024'>David Edwards</a>
</div>
<a UTCms='1418325273000' class='quanto-date posted-at response-posted-at' href='#5489ed16feaf14badd00009e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Alan, does this version look more like what you were expecting? All I did was switch to minute mode and add a check for open orders.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5489edd8d3a3d4c7c50000ae' id='5489edd8d3a3d4c7c50000ae'>
<a href='#5489edd8d3a3d4c7c50000ae'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546ccfabf8dadee0970003dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1cddd1e9bb4610cc0db65b55f5fdc199?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546ccfabf8dadee0970003dc'>Alan Wang</a>
</div>
<a UTCms='1418325467000' class='quanto-date posted-at response-posted-at' href='#5489edd8d3a3d4c7c50000ae'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Seong,<br>
I understand your argument. That is also what I guess.</p>

<p>For minute level test, this problem is not severe. But for day level, the back test result is totally off. And it can hardly be addressed by slippage model only. </p>

<p>A more reasonable solution is to update the definition of bar, no matter minute bar or day bar. A bar should have open/close/volume at the minimum. The order calculated based on close price of bar1 should be fulfilled by open price of bar2. If you want to make it more realistic, then take volume into consideration as well.</p>

<p>I point this out and urge for a solution cause the back test results here is unreliable. If my back test is good, I turn on the live trade. I may get totally different result.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5489eedc178450cbe800009a' id='5489eedc178450cbe800009a'>
<a href='#5489eedc178450cbe800009a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546ccfabf8dadee0970003dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1cddd1e9bb4610cc0db65b55f5fdc199?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546ccfabf8dadee0970003dc'>Alan Wang</a>
</div>
<a UTCms='1418325728000' class='quanto-date posted-at response-posted-at' href='#5489eedc178450cbe800009a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi David,<br>
Minute level would be a solution. I can run the calculation at 15:58 each day. So I can based on a price very close to market close to calculate and fulfill the order. But it has a couple issues:<br>
1. Speed. This is quite obvious.<br>
2. I need a trading calendar see if I should calculate at 12:58 for those half-day trading dates like the day after Thanks giving.<br>
3. Most importantly, I cannot trust any day level back test result in this website.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5489fe60e8a40ed6200000f8' id='5489fe60e8a40ed6200000f8'>
<a href='#5489fe60e8a40ed6200000f8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546ccfabf8dadee0970003dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1cddd1e9bb4610cc0db65b55f5fdc199?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546ccfabf8dadee0970003dc'>Alan Wang</a>
</div>
<a UTCms='1418329699000' class='quanto-date posted-at response-posted-at' href='#5489fe60e8a40ed6200000f8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>To demonstrate this problem, I created two back tests:<br>
The first one is a clone of what Florent contributed a week ago @ <a href="https://www.quantopian.com/posts/system-based-on-easy-volatility-investing-by-tony-cooper-at-double-digit-numerics">https://www.quantopian.com/posts/system-based-on-easy-volatility-investing-by-tony-cooper-at-double-digit-numerics</a><br>
The second one, I changed her code slightly. I ran the test in minute mode. But only calculate once a day @ 15:58pm. This make sure I can use price close to last price to calculate and fulfill the orders within the same day rather than the end of next trade day.<br>
You can see how big the difference could be:  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5489fe82e8a40eafa50000d3' id='5489fe82e8a40eafa50000d3'>
<a href='#5489fe82e8a40eafa50000d3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546ccfabf8dadee0970003dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1cddd1e9bb4610cc0db65b55f5fdc199?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546ccfabf8dadee0970003dc'>Alan Wang</a>
</div>
<a UTCms='1418329733000' class='quanto-date posted-at response-posted-at' href='#5489fe82e8a40eafa50000d3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is the second test I mentioned:  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5489feff178450576c0000e4' id='5489feff178450576c0000e4'>
<a href='#5489feff178450576c0000e4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546ccfabf8dadee0970003dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1cddd1e9bb4610cc0db65b55f5fdc199?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546ccfabf8dadee0970003dc'>Alan Wang</a>
</div>
<a UTCms='1418329860000' class='quanto-date posted-at response-posted-at' href='#5489feff178450576c0000e4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>1250.53% vs -4.7%.<br>
How should I understand the difference?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='548a021be8a40eafa50000e5' id='548a021be8a40eafa50000e5'>
<a href='#548a021be8a40eafa50000e5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1418330653000' class='quanto-date posted-at response-posted-at' href='#548a021be8a40eafa50000e5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Alan,</p>

<p>I&#39;m looking for the 12:58 clause in your minutely backtest but can&#39;t seem to find it. Do you mind replicating it using schedule_function() and give that a shot? I believe right now it&#39;s executing every minute.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='548a076ad3a3d4c7c5000124' id='548a076ad3a3d4c7c5000124'>
<a href='#548a076ad3a3d4c7c5000124'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546ccfabf8dadee0970003dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1cddd1e9bb4610cc0db65b55f5fdc199?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546ccfabf8dadee0970003dc'>Alan Wang</a>
</div>
<a UTCms='1418332012000' class='quanto-date posted-at response-posted-at' href='#548a076ad3a3d4c7c5000124'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>There is no logic for 12:58. As I said, I have to maintain a trading calendar if I want to do that. Without this, every year, I lost 3 trading days. But that won&#39;t change the performance upside down. Cause from the result, we didn&#39;t find any spike on those 3 days each year.<br>
What I added on top of Florent&#39;s code is just:  </p>

<pre><code>    exchange_time = pandas.Timestamp(get_datetime()).tz_convert(&#39;US/Eastern&#39;)  
    if exchange_time.hour != 15 or exchange_time.minute != 58:  
        return

</code></pre>

<p>Even though handle_data will be called each minute, but given the code above, calculation will be fired only once a day shortly before market close. If anyone want to try Florent&#39;s idea, I think that is what he/she will do.<br>
I am not familiar with the schedule_function(). So I don&#39;t want to bother. Even if it can allow be to trade 2 minutes before market close for those 3 days, it won&#39;t change the comparison above upside down. I would like to focus on the major difference.If you like, I can rerun the test for a period without half-trading day to demonstrate the difference again.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='548a11f5178450cbe8000134' id='548a11f5178450cbe8000134'>
<a href='#548a11f5178450cbe8000134'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b9b56c02cabe5dae000143'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e9388ae5102f3b152fa6225f955a29d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b9b56c02cabe5dae000143'>Alisa Deychman</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1418334711000' class='quanto-date posted-at response-posted-at' href='#548a11f5178450cbe8000134'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>In backtesting, daily mode is used to get a sense of the strategy, to begin developing your idea. Once you have a concept, switch to minute mode to closely simulate the live trading environment. Using minute mode doesn&#39;t mean that you trade every minute - only that the algo receives minutely data. You can use <a href="https://www.quantopian.com/help#ide-schedulefunction">schedule_function</a> to schedule specific dates and times for trading. This eliminates the speed issues and need for maintaining the trading calendar - it&#39;s already built in. </p>

<p>When you&#39;re ready to deploy your algorithm to live trading, you are required to run a full backtest in minute mode to simulate the performance. This way you can directly see how the algorithm behaves. If you want to test your strategy before deploying with real money, you can paper trade it with Quantopian or connect your IB demo account. </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='548a1b00feaf143a09000164' id='548a1b00feaf143a09000164'>
<a href='#548a1b00feaf143a09000164'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/537400743fcd41da07000056'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/566071c42a032f096a4b6925585231da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/537400743fcd41da07000056'>Matt Clark</a>
</div>
<a UTCms='1418337027000' class='quanto-date posted-at response-posted-at' href='#548a1b00feaf143a09000164'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Alan,</p>

<p>In this particular case, part of the performance discrepancy between the two backtests you&#39;ve posted probably has to do with how fetch_csv handles time series data in daily vs minute mode.  Basically, running that algorithm in minute mode allows the algorithm to examine the current day&#39;s closing VXMT value at the start of the day (which is impossible in real life, unless you&#39;re Marty McFly).  The minute mode version of that algorithm would need to use post_func to shift the dates up by 1 day so the minute mode algorithm can&#39;t see into the future.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='548a5282178450cbe8000203' id='548a5282178450cbe8000203'>
<a href='#548a5282178450cbe8000203'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546ccfabf8dadee0970003dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1cddd1e9bb4610cc0db65b55f5fdc199?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546ccfabf8dadee0970003dc'>Alan Wang</a>
</div>
<a UTCms='1418351238000' class='quanto-date posted-at response-posted-at' href='#548a5282178450cbe8000203'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Matt,<br>
I totally understand the look ahead issue. That is exactly why I let the calculation happens at 15:58. Even though there is still two minutes look ahead. It shouldn&#39;t be that big.<br>
Correct, shift the data by one day avoid the look ahead bias. But that creates a bigger issue. Instead of 2 minutes look ahead bias, that uses one day old data. If you ask me to  guess where the price is at 15:58pm today. I would say it is closer to close price today rather than the close price of yesterday.<br>
Do you agree?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='548a5932e8a40ed620000262' id='548a5932e8a40ed620000262'>
<a href='#548a5932e8a40ed620000262'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546ccfabf8dadee0970003dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1cddd1e9bb4610cc0db65b55f5fdc199?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546ccfabf8dadee0970003dc'>Alan Wang</a>
</div>
<a UTCms='1418352948000' class='quanto-date posted-at response-posted-at' href='#548a5932e8a40ed620000262'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Alisa,<br>
I agree with your opinion that minute level back test is way more accurate than the day level. What I want to say is, day level back test could have been much closer to reality if back tester execute the order in more widely accepted ways, either use the close price of current cycle or use open price of next cycle. When you see the last price of a stock, what price do you think your market order would be fulfilled? Without knowledge of BBO and book depth, your best guess is the last price you saw rather than the close price of next cycle, particularly when cycle is long like a day.<br>
If we look at the discussions on this site, most back tests were ran at day level. Algorithms were discussed based on these day level back tests. Like the result I copied from Florent above, everyone is so excited. But it is so far away from the minute level test. That make the day level test result hard to compare.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='548b22dea2645ce1f0000014' id='548b22dea2645ce1f0000014'>
<a href='#548b22dea2645ce1f0000014'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b9b56c02cabe5dae000143'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e9388ae5102f3b152fa6225f955a29d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b9b56c02cabe5dae000143'>Alisa Deychman</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1418404578000' class='quanto-date posted-at response-posted-at' href='#548b22dea2645ce1f0000014'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Alan, we&#39;re in complete agreement. In the early iterations of the backtester, daily mode trades and fills orders at the end of day close price. An order submitted on Monday EOD is filled on Tuesday EOD. In hindsight, perhaps an improved simulation would be to submit orders at the end of the day and fill them at the next day&#39;s open. As we go forward, I would like to see the daily mode deprecated and use minute mode simulation. This would give more accurate pricing and fills, remove confusion, and align the behavior directly with live trading.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='548b2ac1a2645ce1f0000030' id='548b2ac1a2645ce1f0000030'>
<a href='#548b2ac1a2645ce1f0000030'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1418406596000' class='quanto-date posted-at response-posted-at' href='#548b2ac1a2645ce1f0000030'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Why not make Daily just simply a subset of Minute that feeds data only at 15:59 (with fill at 16:00)?  Thus maybe side-step the industry &quot;Daily&quot; OHLCV concept (rename it to something other than &quot;Daily&quot; if that seems appropriate), and just feed only one minute per day, the idea is to obtain a quick rough idea. Tons of issues evaporate (datetime, extreme slippage et al). Any down-side?</p>

<p>With schedule_function, Minute tests are still slow so that&#39;s not a solution, some might not realize this, to be clear, stay with me here, it&#39;s due to the fact that all 390 data frames are still being rounded up from the database, packaged, transmitted and the information for all securities fed in calls to handle_data(), 24 Gigabytes--with a G--per backtesting-year of frame content (with set_universe on max at 300 sids), even if only 1 minute of the day is specified in schedule_function. That 1 minute applies only to the new user-specified function that schedule_function was told to run, not handle_data() which still receives everything on all 390 minutes. Maybe the schedule_function func could be changed to be allowed to be handle_data().</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='548b4e96a2645ce1f00000a8' id='548b4e96a2645ce1f00000a8'>
<a href='#548b4e96a2645ce1f00000a8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546ccfabf8dadee0970003dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1cddd1e9bb4610cc0db65b55f5fdc199?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546ccfabf8dadee0970003dc'>Alan Wang</a>
</div>
<a UTCms='1418415768000' class='quanto-date posted-at response-posted-at' href='#548b4e96a2645ce1f00000a8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Cool. Both Anony and Gary feed in very good point.<br>
I think it really depends on how you want to trade finally.<br>
If you want your calculation based on precisely the close price of day, then it is better to test it with Anony&#39;s suggestion, let your order get executed with the open price of next day.<br>
If you want your order fulfilled within the same day to avoid the big price move over night due to earning announcement etc, then go Gary&#39;s suggestions, use 15:59 price to calculate and place the order. This way suffered from the look ahead bias mentioned by Matt if your calculation use EOD price of some user provided daily data. But hopefully the real 15:59 price is not far from the close price. Then such test is still a good approximation.<br>
I would suggest Quantopian to make a small enhancement to support Gary&#39;s way. Currently using either schedule_function or my simply code snippet can achieve this. But under the hood, a lot of data were processed unnecessarily. That makes the test slow for user and expensive for Quantopian.<br>
If the user choose to run the calculation at 15:55 for his daily test, should we fulfill the order use price at 15:55 or close price of day or price of 15:56? That is open for debate. Each can serve different purpose. It would be nice to provide it as an option. If no option provided, I think using open price of 15:56 minute bar would be the best approximation.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='548b5474bfca257a2600009d' id='548b5474bfca257a2600009d'>
<a href='#548b5474bfca257a2600009d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546ccfabf8dadee0970003dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1cddd1e9bb4610cc0db65b55f5fdc199?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546ccfabf8dadee0970003dc'>Alan Wang</a>
</div>
<a UTCms='1418417272000' class='quanto-date posted-at response-posted-at' href='#548b5474bfca257a2600009d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Just read through <a href="https://www.quantopian.com/posts/trade-at-the-open-slippage-model">https://www.quantopian.com/posts/trade-at-the-open-slippage-model</a> started by Anony.<br>
It discussed about using customized SlippageModel to choose different prices to fulfilled the order. Today close, next open and next close etc. That should be able to address the issue I raised. I would strongly suggest Quantopian integrate this as a standard option for the daily test. That would save people a lot of time to duplicate the code. More importantly, avoid people running daily test and fulfill the order with next day close price. As @Andrew Blount mentioned, waiting until the next period&#39;s close is not how &quot;real trading&quot; works.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5491f509b716a32d2300048f' id='5491f509b716a32d2300048f'>
<a href='#5491f509b716a32d2300048f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4eeb56c2e33b1b000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/143cb38866446b05d296e77f5db46502?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4eeb56c2e33b1b000b000001'>Dale Jung</a>
</div>
<a UTCms='1418851595000' class='quanto-date posted-at response-posted-at' href='#5491f509b716a32d2300048f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thing with OHLC bars is that they aren&#39;t technically point-in-time. It&#39;s a range. You can conceptually break EOD data into multiple points like  </p>

<pre><code>* denotes a price event

*Day1.Close  
Post-close->Pre-open  
  Compute stats based on close. Orders can only execute on next day prices.  
*Day2.Open  
Post-open  
  Can do calcs on open prices. Can set limit orders, MOC.  
*Day2.High Day2.Low  
Pre-close  
  Since we don&#39;t know time ordering of high/low, you can only send MarkClose orders.  
  If an existing limit order had an attached stop and/or target, you&#39;d always assume the most pessimistic outcome.  
  Example: Limit order was hit, then stop was hit.  
  In reality, this might not be true since Target might have been hit first.  
*Day.Close  
Post-close->Pre-open  
  Once again, we have close. Can compute orders for next open.  
</code></pre>

<p>Breaking up the Daily into discrete portions allows a bit more granularity while still only using daily data. With the above breakdown, it&#39;s possible to trade the close based on open price of the same day without lookahead bias. If you have minutely data, you can always add another column like price_at_noon and pre_close, which would create additional discrete portions/events.</p>

<p>The backtester could also breakup the day into two timeframes, market-open -> 5-minutes-before-close and 5-minutes-before-close -> close. You&#39;d do this because it&#39;s possible you care about the daily range so far, which skipping to just the 15:55 minute bar wouldn&#39;t tell you. Precomputing new OHLC data is a lot faster than sending in every minute bar. </p>

<p>I&#39;m not actually sure if the point of daily mode was to quasi-replicate minutely backtests with faster EOD or to test a different time frame.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54921b82c834cda1d7000516' id='54921b82c834cda1d7000516'>
<a href='#54921b82c834cda1d7000516'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1418861445000' class='quanto-date posted-at response-posted-at' href='#54921b82c834cda1d7000516'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>You sound experienced. I&#39;m a neophyte, do not understand why there could be a look-ahead problem in this case and do not know how Q works at the database level so I have a question.<br>
I gather that along with daily Close prices, there are stored Open, High, Low and Volume numbers for the day and those are all used for daily mode.<br>
So I&#39;m wondering whether the following could make sense:</p>

<pre><code>Use the daily OHL and V pre-stored information for daily tests, not Close though.  
For C, the close price, it is replaced with the minute-close 15:59 price.  
Only that assembled set is fed as &#39;data&#39; in daily mode (only one frame per day).  
Fills can happen sort of at 16:00.  
The same daily mode fast execution.  
In Quantopian code, it is like minute mode (a lot of the same minute code is active) except it skips 389 out of 390 minutes -ish.

To put it another way, minute OHL and V for 15:59 are replaced by daily mode values.  
</code></pre>

<p>The 15:59 price is likely to be closer to the 16:00 price a minute later than a price 24 hours later, resulting in daily tests nudging closer to minute tests.</p>

<p>Any downside?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54946df367965d599d00039a' id='54946df367965d599d00039a'>
<a href='#54946df367965d599d00039a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4eeb56c2e33b1b000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/143cb38866446b05d296e77f5db46502?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4eeb56c2e33b1b000b000001'>Dale Jung</a>
</div>
<a UTCms='1419013621000' class='quanto-date posted-at response-posted-at' href='#54946df367965d599d00039a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>There&#39;s no look ahead there. My concern with the minute-at-15:59 was that it couldn&#39;t just be the minute bar. It&#39;d have to be the session up until then, but you might have had that in mind and I misunderstood. I still think you&#39;d need the actual close transmitted to you at some point, depending on how volatile the close is it might result in a new daily high. Some algos might need that info after the fact, even if it&#39;s not something you could trade on the day of.  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/quantopian-miscalculation'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/quantopian-miscalculation'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#accac9c9c8cecdcfc7ecddd9cdc2d8c3dcc5cdc282cfc3c1">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
