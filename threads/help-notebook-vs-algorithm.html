<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Help: Notebook vs Algorithm
</title>
<meta content='Hi, I&#39;m new to Quantopian, gotten pretty good with working with algos, but struggling a little bit in the notebook, I&#39;m hoping to get some help! What I&#39;d like to do is get the RSI data for a particular stock over the past X years, then iterate through the RSI data. Below is the code that shows what i&#39;m doing it in the algos, and I believe this is correct (it prints values to log). Algo code:   import talibdef initialize(context):      context.stock = symbol(&#39;LMT&#39;)      context.x = 0     ...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="vso2BaSPzucBKYdXm1Tr/n59IukIBLx1zfeJW6FX4VbCrEBIBnkcBLg03mbUu0OKRvMBgHLIqW5P+FIxCxKD7Q==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=true;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/help-notebook-vs-algorithm' property='og:url'>
<meta content='Help: Notebook vs Algorithm' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/help-notebook-vs-algorithm' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Help: Notebook vs Algorithm' property='og:title'>
<meta content='Hi, I&#39;m new to Quantopian, gotten pretty good with working with algos, but struggling a little bit in the notebook, I&#39;m hoping to get some help! What I&#39;d like to do is get the RSI data for a particular stock over the past X years, then iterate through the RSI data. Below is the code that shows what i&#39;m doing it in the algos, and I believe this is correct (it prints values to log). Algo code:   import talibdef initialize(context):      context.stock = symbol(&#39;LMT&#39;)      context.x = 0     ...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/help-notebook-vs-algorithm">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='5930e2657b0aeb0010afd651'>
<div class='post-container' data-post-id='5930e2657b0aeb0010afd651' id='5930e2657b0aeb0010afd651'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Help: Notebook vs Algorithm</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/591494829496bb000d87ff75'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fda107f804051c235a93ce5195749d80?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/591494829496bb000d87ff75'>MA K</a>
</div>
<span class='posted-at'>posted </span>
<span UTCms='1496375909000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Help: Notebook vs Algorithm&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fhelp-notebook-vs-algorithm%3Futm_source%3Dwebsite_share%26utm_campaign%3Dhelp-notebook-vs-algorithm%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fhelp-notebook-vs-algorithm%3Futm_source%3Dwebsite_share%26utm_campaign%3Dhelp-notebook-vs-algorithm%26utm_medium%3Dlinkedin&amp;title=Help%3A+Notebook+vs+Algorithm+%28MA+K%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/help-notebook-vs-algorithm?utm_source=website_share&amp;utm_campaign=help-notebook-vs-algorithm&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="MA K" />
<div class='body-text'>
<div class='body-text-container post-body'><p>Hi,</p>

<p>I&#39;m new to Quantopian, gotten pretty good with working with algos, but struggling a little bit in the notebook, I&#39;m hoping to get some help! What I&#39;d like to do is get the RSI data for a particular stock over the past X years, then iterate through the RSI data. Below is the code that shows what i&#39;m doing it in the algos, and I believe this is correct (it prints values to log).</p>

<p>Algo code:  </p>

<pre><code>import talib

def initialize(context):  
    context.stock = symbol(&#39;LMT&#39;)  
    context.x = 0  
    schedule_function(my_rebalance, date_rules.every_day(), time_rules.market_open(minutes=5))  
def my_rebalance(context,data):  
    prices = data.history(context.stock, &quot;close&quot;, 30, &quot;1d&quot;)  
    RSI2 = talib.RSI(prices, 2)  
    context.x+=1  
    print(context.x, RSI2[-1])  
</code></pre>

<p>My issue is that in the notebook (code below), the numbers don&#39;t match up. I understand that there is a warm up period at the start of the rsi period, but in my case, the numbers aren&#39;t even close! I think there is something wrong with the way I am doing it in the notebook, what is the correct way for me to do this?</p>

<p>Notebook code:</p>

<pre><code>import talib  
sec = &#39;LMT&#39;  
sec_prices = get_pricing(sec, start_date=&#39;2011-01-03&#39;, end_date=&#39;2017-01-03&#39;, symbol_reference_date=None, frequency=&#39;daily&#39;, fields=&#39;close_price&#39;)  
RSI2 = talib.RSI(sec_prices, 2)  
for i in range(len(RSI2)-1):  
    print(i, RSI2[i])  
</code></pre>

<p>Thank you.  </p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>14 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='593170c511c5760010547b98' id='593170c511c5760010547b98'>
<a href='#593170c511c5760010547b98'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571d1bab2616ef09ce0002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a69e9457dd2832a76875bcae334d5baf?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571d1bab2616ef09ce0002b6'>Dan Whitnable</a>
</div>
<a UTCms='1496412357000' class='quanto-date posted-at response-posted-at' href='#593170c511c5760010547b98'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Not sure if this is the entire problem, but the &#39;data.history&#39; method in the algo returns the last minute close of today and then the close for the previous 29 days. However, the notebook &#39;get_pricing&#39; method simply gets the daily close prices. Another issue with the &#39;data.history&#39; method is that it will return NaN for the todays data if no trades were made during the previous bar. This wouldn&#39;t usually have a huge impact but since you are only using an RSI window of 2, that last data point is half your data.</p>

<p>To make the two &#39;interchangeable&#39; I&#39;d suggest implementing this with pipeline instead of the &#39;data.history method&#39;. See the attached notebook. You may need to change the &#39;symbols&#39; method when porting it to an algorithm. Otherwise, the exact code will run in both environments.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5931aebdeb55ea00107a9e32' id='5931aebdeb55ea00107a9e32'>
<a href='#5931aebdeb55ea00107a9e32'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/591494829496bb000d87ff75'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fda107f804051c235a93ce5195749d80?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/591494829496bb000d87ff75'>MA K</a>
</div>
<a UTCms='1496428221000' class='quanto-date posted-at response-posted-at' href='#5931aebdeb55ea00107a9e32'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Dan,</p>

<p>Thanks very much for your reply. I will take a look at your notebook.</p>

<p>In the algo (using data.history), I was doing the backtest from 01-03-2011 to 01-03-2017. Since this is in the past, I assume the &#39;last minute close of today&#39; would be the close of the day (since all days are past/complete), so I don&#39;t think that <em>should</em> be a problem. </p>

<p>Also, this: &quot;Another issue with the &#39;data.history&#39; method is that it will return NaN for the todays data if no trades were made during the previous bar.&quot; is a little scary. Can you explain this further? Why is it skipping data? One would imagine that it would give you data for all days, as you are requesting. Not only providing data &#39;if you traded on the previous bar.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5931b0a255a8b933aa143546' id='5931b0a255a8b933aa143546'>
<a href='#5931b0a255a8b933aa143546'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/591494829496bb000d87ff75'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fda107f804051c235a93ce5195749d80?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/591494829496bb000d87ff75'>MA K</a>
</div>
<a UTCms='1496428706000' class='quanto-date posted-at response-posted-at' href='#5931b0a255a8b933aa143546'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I understand what you mean about data.history getting the last minute close of today, since I am getting this data at 5 minutes past the open. I will drop the most recent data point, so I am getting the closes from the previous full days. I guess before I try compare the RSI, I will make sure the price data is consistent!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5931b56b631e5d0010069e87' id='5931b56b631e5d0010069e87'>
<a href='#5931b56b631e5d0010069e87'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/591494829496bb000d87ff75'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fda107f804051c235a93ce5195749d80?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/591494829496bb000d87ff75'>MA K</a>
</div>
<a UTCms='1496429931000' class='quanto-date posted-at response-posted-at' href='#5931b56b631e5d0010069e87'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Doing some more looking into this and what I&#39;m finding is not very encouraging. </p>

<p>In the notebook, using get_pricing, I am getting <strong>differing price data for the same days simply by changing the &#39;end date&#39; parameter</strong>??? That is scary. How can we trust any of our analysis if we can&#39;t trust the data?</p>

<p>Attaching the notebook, but here is an example of what I mean:</p>

<pre><code>sec = &#39;LMT&#39;  
sec_prices = get_pricing(sec, start_date=&#39;2011-01-03&#39;, end_date=&#39;2011-02-10&#39;, symbol_reference_date=None, frequency=&#39;daily&#39;, fields=&#39;close_price&#39;)  
print(sec_prices)  
</code></pre>

<p>Output (first few lines/days):</p>

<p>2011-01-03 00:00:00+00:00    69.83<br>
2011-01-04 00:00:00+00:00    70.31<br>
2011-01-05 00:00:00+00:00    71.92<br>
2011-01-06 00:00:00+00:00    73.18<br>
2011-01-07 00:00:00+00:00    73.63<br>
2011-01-10 00:00:00+00:00    73.59</p>

<p>Now, simply change the &#39;end_date&#39; to one year later:</p>

<pre><code>sec = &#39;LMT&#39;  
sec_prices = get_pricing(sec, start_date=&#39;2011-01-03&#39;, end_date=&#39;2012-02-10&#39;, symbol_reference_date=None, frequency=&#39;daily&#39;, fields=&#39;close_price&#39;)  
print(sec_prices)  
</code></pre>

<p>Output for the same days (first few lines/days), different prices!!</p>

<p>2011-01-03 00:00:00+00:00    66.941<br>
2011-01-04 00:00:00+00:00    67.401<br>
2011-01-05 00:00:00+00:00    68.944<br>
2011-01-06 00:00:00+00:00    70.152<br>
2011-01-07 00:00:00+00:00    70.584<br>
2011-01-10 00:00:00+00:00    70.545</p>

<p>scary?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5931b607631e5d000d069e8f' id='5931b607631e5d000d069e8f'>
<a href='#5931b607631e5d000d069e8f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/591494829496bb000d87ff75'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fda107f804051c235a93ce5195749d80?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/591494829496bb000d87ff75'>MA K</a>
</div>
<a UTCms='1496430087000' class='quanto-date posted-at response-posted-at' href='#5931b607631e5d000d069e8f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>BTW, the first example seems to match the data I get using data.history in the algo.</p>

<p>Baffled as to why changing end date changes the price data  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5931c001eb55ea45d57a9c58' id='5931c001eb55ea45d57a9c58'>
<a href='#5931c001eb55ea45d57a9c58'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571d1bab2616ef09ce0002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a69e9457dd2832a76875bcae334d5baf?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571d1bab2616ef09ce0002b6'>Dan Whitnable</a>
</div>
<a UTCms='1496432641000' class='quanto-date posted-at response-posted-at' href='#5931c001eb55ea45d57a9c58'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@MA K</p>

<p>A few things. You stated <em>&quot;In the algo (using data.history).... Since this is in the past, I assume the &#39;last minute close of today&#39; would be the close of the day (since all days are past/complete), so I don&#39;t think that should be a problem.&quot;</em></p>

<p>Yes, that is the problem. As I stated previously, the &#39;data.history&#39; method, will always return the last bar data as the last value in the returned series.</p>

<pre><code>hist = data.history(context.securities, &#39;close&#39;, 10, &#39;1d&#39;)  
close_as_of_last_bar_in_backtest = hist.iloc[-1, 0]  
yesterdays_close = hist.iloc[-2, 0]
</code></pre>

<p>The last entry in the series is NOT yesterdays close. The second from the last bar is yesterdays close. See the attached algorithm and look at the logs to see this in action.</p>

<p>You also stated <em>&quot; I am getting differing price data for the same days simply by changing the &#39;end date&#39; parameter&quot;</em></p>

<p>Yes, that is true because the prices are all split adjusted as of the &#39;end date&#39; parameter.  The &#39;get_pricing&#39; method is point-in-time split- and dividend-adjusted. For these adjustments, the reference date, or the ‘date which you are looking back from’, is always the end_date of the &#39;get_pricing&#39; call. See <a href="https://www.quantopian.com/posts/research-updates-get-pricing-and-jupyter-notebook-upgrade">https://www.quantopian.com/posts/research-updates-get-pricing-and-jupyter-notebook-upgrade</a></p>

<p>Regarding &#39;data.history&#39; method will return NaN if no data for that minute. Take a look at the documentation (<a href="https://www.quantopian.com/help#api-data-history">https://www.quantopian.com/help#api-data-history</a>) for a description how only certain fields (eg &#39;price&#39;) are forward filled. Other fields are not. However, it seems that this may only be true when requesting minute data? Looking at the logs of the attached algorithm there aren&#39;t any NaN values for what should be a thinly traded stock.</p>

<p>Understanding those concepts should go along way to clearing up the confusion. Does that help?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5931cc1f3ae66f5d91005dca' id='5931cc1f3ae66f5d91005dca'>
<a href='#5931cc1f3ae66f5d91005dca'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/591494829496bb000d87ff75'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fda107f804051c235a93ce5195749d80?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/591494829496bb000d87ff75'>MA K</a>
</div>
<a UTCms='1496435743000' class='quanto-date posted-at response-posted-at' href='#5931cc1f3ae66f5d91005dca'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Dan,</p>

<p>Thank you so much for your explanation.</p>

<p>So, I solved the first problem by doing this:  </p>

<pre><code>hist = data.history(context.securities, &#39;close&#39;, 10, &#39;1d&#39;)[:-1]  
</code></pre>

<p>Thereby dropping the last, incomplete data point. Now, the last entry will be yesterdays close. </p>

<p>And I now understand why the prices are different when you use different end_date for get_pricing, thank you for the link. But I now have 2 follow up questions.</p>

<p>1) How can I get the RSI data as it would have been in reality, historically? Not based on adjusted price, but the actual RSI value that would have been. I think this might be done using the approach you present in your first reply. If this is the case, how would I get rsi with my custom period? I don&#39;t see any period given in your pipeline code. </p>

<p>2) There are a lot of algorithms floating around on Q, many of them great, that use this approach to calculate RSI and make decisions on whether to buy or sell</p>

<pre><code>prices = data.history(context.stock, &quot;close&quot;, 30, &quot;1d&quot;)  
RSI2 = talib.RSI(prices, 2)  
</code></pre>

<p>Is this incorrect/invalid?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5931cc92c7acd8000de02b8c' id='5931cc92c7acd8000de02b8c'>
<a href='#5931cc92c7acd8000de02b8c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/591494829496bb000d87ff75'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fda107f804051c235a93ce5195749d80?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/591494829496bb000d87ff75'>MA K</a>
</div>
<a UTCms='1496435858000' class='quanto-date posted-at response-posted-at' href='#5931cc92c7acd8000de02b8c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Follow up to #2 above, for example, if there is a 7:1 price split, and data.history is just providing actual (non-adjusted) price, then surely the RSI calculated using this data would be incorrect, so the signal would be invalid?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5931db74cee248000dd5993e' id='5931db74cee248000dd5993e'>
<a href='#5931db74cee248000dd5993e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571d1bab2616ef09ce0002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a69e9457dd2832a76875bcae334d5baf?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571d1bab2616ef09ce0002b6'>Dan Whitnable</a>
</div>
<a UTCms='1496439668000' class='quanto-date posted-at response-posted-at' href='#5931db74cee248000dd5993e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ MA K<br>
Regarding #1 above. RSI is a ratio with values between 0 and 100. Since its a ratio of prices it will not be affected by multiplying the prices by a constant. Therefore it won&#39;t be affected by stock splits. See the calculation here <a href="https://en.wikipedia.org/wiki/Relative_strength_index">https://en.wikipedia.org/wiki/Relative_strength_index</a>. However, in a backtest, the data that an algorithm sees on a specific date is EXACTLY the data one would have seen in real life. If AAPL was selling for $99 on a specific date then one would see $99 in the backtest on that date.</p>

<p>You can get a custom window length for the RSI factor like this:</p>

<pre><code># set the custom period to 2  
rsi = RSI(window_length = 2)

</code></pre>

<p>Regarding #2. Using a window length of two is silly (in my humble opinion) or at least overkill. There can be only 2 values for the RSI in that case, either 0 or 100. All it&#39;s really telling you, if its 100, is the current price is greater than the previous close. If its 0, then the current price is less than or equal to yesterdays close. As far as using &#39;data.history&#39; and then using the &#39;talib&#39; function to calculate signals, you are correct, there are a lot of algos on the forums that do that. Many of those algos pre-date the introduction of pipeline. Pipeline is generally the preferred method to get historical data now. If needed you can append current minute data to the pipeline dataframe to keep all your data in one place. There are still times when the&#39; talib&#39; functions and &#39;get.history&#39; may be appropriate but generally start with pipeline.</p>

<p>Regarding #2 (previous post). The prices and volumes returned by &#39;data.history&#39; ARE split adjusted (see <a href="https://www.quantopian.com/help#api-data-history">https://www.quantopian.com/help#api-data-history</a>). One needs to be a little careful when using absolute values in any historical lookups. I won&#39;t go into that. However, as stated in #1 above RSI is a ratio and therefore won&#39;t be effected by adjusting for splits. In fact, if prices weren&#39;t adjusted, the RSI values would be wrong because it would interpret a stock split as being a huge change in price when in reality it isn&#39;t. Make sense?</p>

<p>I&#39;ve attached the same notebook but with a custom window length for RSI. Note the dataframe output.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5931fb4573c2cf0748f60bb1' id='5931fb4573c2cf0748f60bb1'>
<a href='#5931fb4573c2cf0748f60bb1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/591494829496bb000d87ff75'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fda107f804051c235a93ce5195749d80?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/591494829496bb000d87ff75'>MA K</a>
</div>
<a UTCms='1496447813000' class='quanto-date posted-at response-posted-at' href='#5931fb4573c2cf0748f60bb1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Dan,</p>

<p>Thank you so much for taking the time to answer my questions, I really appreciate it. </p>

<p>I want to clarify three points:</p>

<p>1) You said two things which I find conflicting, so I just want to clarify. First you said that in a backtest, the data than an algorithm sees on a specific date is exactly the data one would have seen in real life. But then you say that The prices and volumes returned by &#39;data.history&#39; ARE split adjusted. So when I get price data using data.history in the algorithm, is that split adjusted (because of the later point above)? or is it the exact price one would have seen in real life (because of the former point above)? </p>

<p>2) If I am using data.history to get price in the algo, and this price is the actual price it was trading on that day (not split adjusted), and then I used this data to calculate the RSI using talib (as is being done in many algos), this means that all the algos using this method are in fact invalid? It may not be a huge difference, but around the times of the stock split, the algo would have been trading on invalid signals? (the answer for this question also depends on the answer to number 1 above)</p>

<p>3) About the values of RSI2 being either 0 or 100, please see this notebook example of calculating RSI 2 using talib. They are not only 0 or 100, they are everything between. I also just opened a charting software and pulled up some data, and threw on the RSI indicator with period 2 and I see all values between 0 and 100, not just 0 or 100. I guess I am unclear on something here.</p>

<p>Thanks again very much.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5931fe0c3ae66f5d910060bf' id='5931fe0c3ae66f5d910060bf'>
<a href='#5931fe0c3ae66f5d910060bf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1496448524000' class='quanto-date posted-at response-posted-at' href='#5931fe0c3ae66f5d910060bf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@MA K</p>

<p>I can help with 1) and 2).</p>

<p>All pricing data on Quantopian is split and dividend adjusted <em>as of the current trading day</em>. This means that the &#39;current&#39; price of an equity on any given day in the backtester will be the price that it traded that day. However, if you ask for a historical window on day N in the backtester, the returned price series will be adjusted for all the dividends and splits that occurred prior to day N. We do this to avoid forward lookahead bias. We don&#39;t want to adjust prices for splits and dividends that had not yet happened at that point in time in the backtest to keep it as realistic as possible.</p>

<p>Hopefully this clarifies 1) and alleviates your concern in 2).  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='593399ac429f66001049c095' id='593399ac429f66001049c095'>
<a href='#593399ac429f66001049c095'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/591494829496bb000d87ff75'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fda107f804051c235a93ce5195749d80?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/591494829496bb000d87ff75'>MA K</a>
</div>
<a UTCms='1496553900000' class='quanto-date posted-at response-posted-at' href='#593399ac429f66001049c095'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Jamie,</p>

<p>Thank you very much for your reply. I think I understand now: The prices in the backtester will always be the price you would have seen that day, and you can get this same data in the notebook using the pipeline. I have confirmed this (the price data I get from pipeline in the notebook matches the price in the backtester). This works perfectly if I request one stock from pipeline, like the examples above. But what I want to do is get the Q500US set (and the historical price data) using pipeline, and I am having some trouble. Please see the attached notebook. In it, I am simply choosing one stock an an example, and as you can see, it is not the complete data set. There is a gap between 2011-01-31 and 2013-07-01. Why is this happening? Is it because it was a part of the Q500US until 2011-01-31 and then was not anymore until 2013-07-01? </p>

<p>How would I get <strong>all</strong> price data going back X years for all stocks in the Q500US <strong>today</strong>, using pipeline? (so as a result, I have full price data going back X years for exactly 500 stocks)</p>

<p>What I was doing was getting the list of Q500US for one particular date (by setting the start and end date to be the same in run_pipeline()), then getting the price history for each stock in the list using get_pricing, but that didn&#39;t work for me because I want the price as I would get it in the backtester, not the end date split adjusted price. So now, I&#39;m using pipeline to get the price history, but having the problem described above. </p>

<p>Thank you.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59358a84b122df5281b0bec9' id='59358a84b122df5281b0bec9'>
<a href='#59358a84b122df5281b0bec9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1496681092000' class='quanto-date posted-at response-posted-at' href='#59358a84b122df5281b0bec9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Pipeline was designed to get you data according to a fixed reference point (the current date in backtesting, and the current date in <code>run_pipeline</code>**). It is also designed to output a single output per column per asset per day, which means you can&#39;t easily return a time series of data.</p>

<p>The best way to get the times series for each asset in the Q500US <strong>today</strong> would be to do as you suggested and get the constituents of the Q500 on a particular day, and pass these to <code>get_pricing</code>. <code>get_pricing</code> will return prices that are adjusted as of the <code>end_date</code> of the query.</p>

<p>I&#39;ve attached a notebook that should get you what you&#39;re asking for (the notebook gets the Q500 for 2017-01-03). Let me know if this helps.</p>

<p><strong>Note:</strong> The first sentence used to say that pipeline was adjusted as of the <code>end_date</code>. This was incorrect. Pipeline data is adjusted as of the &#39;current&#39; date in the simulation or the &#39;current&#39; date in <code>run_pipeline</code>.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='597849c24ef55c000d1cebf5' id='597849c24ef55c000d1cebf5'>
<a href='#597849c24ef55c000d1cebf5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1501055426000' class='quanto-date posted-at response-posted-at' href='#597849c24ef55c000d1cebf5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi all,</p>

<p>I have the similar problem what MAK has. If one uses an indicator which deal with ration such as RSI, maybe this has a little problem. But how about the oder indicator such as MACD?  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/help-notebook-vs-algorithm'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/help-notebook-vs-algorithm'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#01676464656360626a417074606f756e7168606f2f626e6c">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
