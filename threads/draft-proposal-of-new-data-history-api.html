<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Draft Proposal of New Data History API
</title>
<meta content='We&#39;ve been listening to the discussions about the difficulties around the ability to retrieve and perform calculations on windows of data.I’d like to give a special thank you to Grant, Peter, Aidan, and everyone else for their diligence in making the current APIs work for them and their thoughts on how to make it more useful.We’ve been working on replacements to batch transform and the simple transforms (mavg, vwap, etc.) that are both easier to use and more efficient on the back end. We want...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="spdB6vG6CMuo8L051JSmZNqQl9U6B+jW/bt+lLf6KOvO8TenU0zaKBHt5Aibew4Q4h60vEDL/c1/tKX+Hb9KUA==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=false;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/draft-proposal-of-new-data-history-api' property='og:url'>
<meta content='Draft Proposal of New Data History API' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/draft-proposal-of-new-data-history-api' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Draft Proposal of New Data History API' property='og:title'>
<meta content='We&#39;ve been listening to the discussions about the difficulties around the ability to retrieve and perform calculations on windows of data.I’d like to give a special thank you to Grant, Peter, Aidan, and everyone else for their diligence in making the current APIs work for them and their thoughts on how to make it more useful.We’ve been working on replacements to batch transform and the simple transforms (mavg, vwap, etc.) that are both easier to use and more efficient on the back end. We want...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/draft-proposal-of-new-data-history-api">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='5245a4d8a4ef342db900011a'>
<div class='post-container' data-post-id='5245a4d8a4ef342db900011a' id='5245a4d8a4ef342db900011a'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Draft Proposal of New Data History API</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5019a7055f23060002000002'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8c909680c18a7ce44f242e6923776110?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5019a7055f23060002000002'>Eddie Hebert</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<span class='posted-at'>edited </span>
<span UTCms='1380299170000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Draft Proposal of New Data History API&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fdraft-proposal-of-new-data-history-api%3Futm_source%3Dwebsite_share%26utm_campaign%3Ddraft-proposal-of-new-data-history-api%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fdraft-proposal-of-new-data-history-api%3Futm_source%3Dwebsite_share%26utm_campaign%3Ddraft-proposal-of-new-data-history-api%26utm_medium%3Dlinkedin&amp;title=Draft+Proposal+of+New+Data+History+API+%28Eddie+Hebert%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/draft-proposal-of-new-data-history-api?utm_source=website_share&amp;utm_campaign=draft-proposal-of-new-data-history-api&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Eddie Hebert" />
<div class='body-text'>
<div class='body-text-container post-body'><p>We&#39;ve been listening to the discussions about the difficulties around the ability to retrieve and perform calculations on windows of data.<br>
I’d like to give a special thank you to Grant, Peter, Aidan, and everyone else for their diligence in making the current APIs work for them and their thoughts on how to make it more useful.</p>

<p>We’ve been working on replacements to batch transform and the simple transforms (mavg, vwap, etc.) that are both easier to use and more efficient on the back end. We want to make it easier to access the data that occurred before the current bar. We want the new versions to be easy in daily and minutely backtesting, and we particularly want to them to make minute mode easier to manipulate.</p>

<p>Here is a link, <a href="https://github.com/quantopian/quantopian-drafts/blob/master/data-history-draft.md">https://github.com/quantopian/quantopian-drafts/blob/master/data-history-draft.md</a>, to the draft of the new idea that is part specification, part documentation, and part cookbook for a new API for accessing history. In this thread, we would love to hear your thoughts and discuss with<br>
you about the proposal.  What does it get right?  Where can it get better?</p>

<p>Thanks in advance for your help in making the algo writing, backtesting, and trading better.  </p>
</div>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>53 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='5245c2c3a4ef34955e000170' id='5245c2c3a4ef34955e000170'>
<a href='#5245c2c3a4ef34955e000170'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380303558000' class='quanto-date posted-at response-posted-at' href='#5245c2c3a4ef34955e000170'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Eddie,</p>

<p>I&#39;ll take a look as time allows.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5246bacd3a0d8de3330000b2' id='5246bacd3a0d8de3330000b2'>
<a href='#5246bacd3a0d8de3330000b2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380367054000' class='quanto-date posted-at response-posted-at' href='#5246bacd3a0d8de3330000b2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Eddie,</p>

<p>It appears that you&#39;ll be addressing the &quot;warm-up&quot; issue with backtesting:</p>

<blockquote>
<p>Daily History and Back Test Start</p>

<p>Unlike batch transforms, daily history is available on the first day of the backtest, data availability permitting.</p>

<p>Unlike batch transforms, the data history does not require the algorithm to run for the number of days the window before returning a value.</p>

<p>The data is backfilled so that calculations can be done more immediately.</p>
</blockquote>

<p>Will this also apply to minute-level backtesting (since you only refer to &quot;daily history&quot;)?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5246e314c79c4a71d8000097' id='5246e314c79c4a71d8000097'>
<a href='#5246e314c79c4a71d8000097'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5019a7055f23060002000002'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8c909680c18a7ce44f242e6923776110?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5019a7055f23060002000002'>Eddie Hebert</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1380377365000' class='quanto-date posted-at response-posted-at' href='#5246e314c79c4a71d8000097'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, yes the proposal for back filling of data will apply to both minute-bar and day-bar history.</p>

<p>(Just edited to the document to remove the prefix of &#39;daily&#39;, which had been an artifact of a previous organization of the document.)</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5246f2972b21bfadb00000a2' id='5246f2972b21bfadb00000a2'>
<a href='#5246f2972b21bfadb00000a2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380381336000' class='quanto-date posted-at response-posted-at' href='#5246f2972b21bfadb00000a2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Eddie,</p>

<p>Regarding your forward filling, it seems that the way you are structure the data could be different, which would avoid the problem of empty bars for Security A relative to Security B.  As an option (or an example using pandas functionality) wouldn&#39;t it be possible to provide the data as independent pandas time series?  This would be more consistent with the idea that the backtester is &quot;event-driven&quot; with each security having its own stream of events.  By forward filling, you are creating events where there were none historically.</p>

<p>I&#39;m not sure if you made it clear in your document, but as I understand, the filling is only done for the multiple security case.  If the dataframe only contains one security, there is no way to know if bars are missing, correct?  Or are you keeping track of wall clock time, to determine if minutes are skipped (or days, in the case of daily trading)?</p>

<p>Also, what is the remedy if the first bar is empty?  The filling will fail, right?  Should there be a warning?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524714fe793d50e1370000e5' id='524714fe793d50e1370000e5'>
<a href='#524714fe793d50e1370000e5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1380390143000' class='quanto-date posted-at response-posted-at' href='#524714fe793d50e1370000e5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It makes sense to settle on pandas dataframes for time series data. &quot;5m&quot; for five minutes of data seems a bit strange, anyone who&#39;s used any other data platform may wonder, &quot;but how much five-minute bar data is there?&quot; Ie - that notation is usually used for periodicity, not for backfill.</p>

<p>Also re forward filling, are you forward filling a nil tick to produce a degenerate bar with 0 volume? Or are you actually forward filling whatever the last bar was, causing any code that has exponential decay, volume accumulation or really any calculation at all to change...?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52473605c79c4a71d80000f8' id='52473605c79c4a71d80000f8'>
<a href='#52473605c79c4a71d80000f8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1380398601000' class='quanto-date posted-at response-posted-at' href='#52473605c79c4a71d80000f8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>My first thought was the same as Simon&#39;s. It might be better for</p>

<pre><code>data.history.minutes(&#39;15m&#39;, &#39;price&#39;)  
</code></pre>

<p>to be</p>

<pre><code>data.history.minutes(15, &#39;1m&#39;, &#39;price&#39;)  
</code></pre>

<p>which also makes</p>

<pre><code>data.history.minutes(26, &#39;15m&#39;, &#39;price&#39;)  
</code></pre>

<p>possible in the future.</p>

<p>I don&#39;t agree with Grant on the &#39;independent&#39; time series. I think a DataFrame of one SID or of many SIDs should have all missing timestamps inserted.</p>

<p>I see Simon&#39;s point on forward filling and I would suggest the default is to fill with NaNs, To answer Grant a missing first bar can be filled from the day before so maybe the earliest backtest start date becomes 01/04/2002 instead of 01/03/2002.</p>

<p>It all looks very promising.</p>

<p>P.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5247560b80a606afdc0000fe' id='5247560b80a606afdc0000fe'>
<a href='#5247560b80a606afdc0000fe'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380406795000' class='quanto-date posted-at response-posted-at' href='#5247560b80a606afdc0000fe'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Peter,</p>

<p>We&#39;ll see what the response is, but my guess is that the proposed code will not fill forward missing bars if only one sid is specified.</p>

<p>Regarding the independent time series, by sid, I think that so long as the filling can be turned off, then one can always generate the time series that I&#39;m talking about, with no filling (but with irregularly spaced datetime stamps).</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524852d17f1522ef98000321' id='524852d17f1522ef98000321'>
<a href='#524852d17f1522ef98000321'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/518dfcd21ee7cde87a000022'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/802dba78839794011a22dda146b50897?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/518dfcd21ee7cde87a000022'>Working ForCoins</a>
</div>
<a UTCms='1380471506000' class='quanto-date posted-at response-posted-at' href='#524852d17f1522ef98000321'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>That&#39;s interesting. I also thought to implement myself a kind of history object for a Python backtester</p>

<p>My idea was to use a kind of rolling DataFrame (like a circular buffer) to store OHLCV price and volume for differents timeframe.</p>

<p>I have some difficulties to understand how to access to price history of a given sid</p>

<p>I also don&#39;t understand what happens (in term of memory usage) for a given strategy which use several sid<br>
    prices_a = data.history.minutes(&#39;15m&#39;, &#39;price&#39;)</p>

<p>Does it means that you are building a 15 minutes OHLCV internal dataframe for each sid ?<br>
What is the length of this DataFrame (does size inflates ? if no... how DataFrame size can be set ?)</p>

<p>I also wonder how to access to &quot;latest_price&quot; and &quot;latest_volume&quot; for a given sid into handle_data</p>

<p>Is there a way to feed this object to have both access to bid price and ask price ?<br>
(and also spread ?)</p>

<p>How to access to &quot;last_datetime&quot; ? (it could be useful if, for example, your strategy only works on friday.)<br>
If you want to turn live your strategy you will need to know current datetime into handle_data</p>

<p>A good way to test this history object could be to make a python / pandas / zipline script which build into memory history object for a given sid using (live) tick datafeed.<br>
An other script could display candlesticks using Matplotlib for a given timeframe.<br>
These 2 scripts could communicate each other using IPC or socket or much better...<br>
a messaging system (like ZMQ, RabbitMQ...)<br>
See for example<br>
<a href="http://www.youtube.com/watch?v=BXJelQyIYnY">http://www.youtube.com/watch?v=BXJelQyIYnY</a><br>
it&#39;s using IPC...</p>

<p>About TALib - <a href="https://github.com/mrjbq7/ta-lib/tree/master/talib">https://github.com/mrjbq7/ta-lib/tree/master/talib</a><br>
You can now (12 days ago) directly feed TALib abstract function with a Pandas DataFrame<br>
import talib<br>
from talib import abstract<br>
abstract.SMA(df)</p>

<p>A last comment:<br>
maybe you should also think your history object as easily improvable to manage other data (not only OHLCV) but for example RangeBar or Renko charts.</p>

<p>PS: please excuse my poor english  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524896093582681a6500038b' id='524896093582681a6500038b'>
<a href='#524896093582681a6500038b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380488714000' class='quanto-date posted-at response-posted-at' href='#524896093582681a6500038b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Perhaps you&#39;ve thought of it, but I&#39;d have a look at a couple cases:</p>

<ol>
<li>What happens when you feed asynchronous data (e.g. datetime stamps that don&#39;t fall on the whole minute)?<br></li>
<li>You&#39;ve talked about adding other types of securities/futures/etc. (e.g. Forex).  In general, it seems that you&#39;ll need to deal with 24/7/365 asynchronous data feeds, right?<br></li>
<li>I agree with Simon&#39;s sentiment above that you need to provide exact details on how the filling will be done.  Also, if users want do do their own filling, you might provide details.<br></li>
<li>Are you planning to provide guidance on how to generate a length N trailing window of OHLCV bars (e.g. 15 minute) on a rolling basis, updated every minute?  This would basically be a specialized moving (rolling) statistic like the ones described on <a href="http://pandas.pydata.org/pandas-docs/dev/computation.html">http://pandas.pydata.org/pandas-docs/dev/computation.html</a>.</li>
</ol>

<p>Grant</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52489a563582686f6a000021' id='52489a563582686f6a000021'>
<a href='#52489a563582686f6a000021'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1380489815000' class='quanto-date posted-at response-posted-at' href='#52489a563582686f6a000021'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Grant,</p>

<p>I assume the answer to 4. would be:</p>

<pre><code>N = 15    # window length  
strNminutes = str(N) + &#39;m&#39;

def handle_data(context, data):  
    price_history = data.history.minutes(strNminutes, &#39;price&#39;)  
</code></pre>

<p>Elegant! But only the closing price. Repeat for O, H, L and V.</p>

<p>P.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5248cd2ac6426d63f200037b' id='5248cd2ac6426d63f200037b'>
<a href='#5248cd2ac6426d63f200037b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380502828000' class='quanto-date posted-at response-posted-at' href='#5248cd2ac6426d63f200037b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Peter,</p>

<p>Perhaps I wasn&#39;t clear on my #4 above.  If you have a look at the moving (rolling) statistics available in pandas (<a href="http://pandas.pydata.org/pandas-docs/dev/computation.html">http://pandas.pydata.org/pandas-docs/dev/computation.html</a>), they actually return a new pandas time series, with statistics applied over a rolling window.  I think that the proposed new functionality would just return the data over the last N minutes.  For example, this would yield 15 minutes of price data:</p>

<pre><code>minute_prices = data.history.minutes(&#39;15m&#39;, &#39;price&#39;)  
</code></pre>

<p>I&#39;m thinking of a rolling_bar function, in analogy, for example, to the rolling_mean function described on <a href="http://Moving%20%28rolling%29%20statistics%20/%20moments">http://pandas.pydata.org/pandas-docs/dev/computation.html</a> under &quot;Moving (rolling) statistics / moments.&quot;  Basically, there ought to be a way to generate OHLCV data on a rolling basis from the original minute-level data.  Note that this is different from a trailing window of 15 OHLCV minute-level bars.</p>

<p>Are you perhaps suggesting the same thing above with:</p>

<pre><code>data.history.minutes(26, &#39;15m&#39;, &#39;price&#39;)  
</code></pre>

<p>Would this return a pandas time series, with 26 rows, each containing a 15-minute OHLCV re-sampled bar?</p>

<p>The Quantopian folks provide some guidance in their <a href="https://github.com/quantopian/quantopian-drafts/blob/master/data-history-draft.md">draft</a> under the &quot;Resampling&quot; section, but it seems that the whole approach could be re-cast into the rolling_bar statistic that I&#39;m suggesting to yield the OHLCV data with one call.</p>

<p>Grant</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5249e1dffaf69ed60000004c' id='5249e1dffaf69ed60000004c'>
<a href='#5249e1dffaf69ed60000004c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5019a7055f23060002000002'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8c909680c18a7ce44f242e6923776110?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5019a7055f23060002000002'>Eddie Hebert</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1380573665000' class='quanto-date posted-at response-posted-at' href='#5249e1dffaf69ed60000004c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi all, First off – thank you for your questions and suggestions, your feedback is important to us and we definitely want to get this feature right! Let me speak to the two major themes you have all gravitated towards first. Then, I have several individual replies. We will continue to update this thread throughout the week, as well as updating the documentation to reflect changes as they are made.</p>

<p>(1) Filling in for missing data – you will have the following options to handle missing data points:</p>

<p>&#39;ffill=False&#39;, would have the same DatetimeIndex as if the stock were fully liquid (i.e. the minutes and days would be all of the market open minutes and days), with the empty minutes or days having a &#39;np.nan&#39; for all of the OHLCV values.</p>

<p>&#39;ffill=True&#39; - fill the pricing information forward with the last known value (with the exception of inserting a &quot;0&quot; for volume)</p>

<p>In the case that there is no last known value the time series will be padded with leading nans, until a price for that stock occurs, after which the behavior will be defined by the options above.</p>

<p>(2) Syntax for specifying frequency vs. duration of historical data – there was much internal debate on the right syntax for a user to separately specify both the frequency and the duration (or window length) of the ‘history’ object – and it’s very possible we’re still not quite there – so suggestions on that front are very welcome. </p>

<p>Our goal is not to recreate or supersede pandas elegant resampling functionality – but rather to give you the ability to define upfront how much data your algo will need – and let you code from there. The simplest thing to do would be to always dump the highest frequency data we allow (minutely) and only ask you how far back you want to look (15 minutes, 2 days etc.). The problem we saw there was that many users have algos that operate on a much longer timeframe and across a large universe of securities, and saddling those folks with minutely data to constantly be discarding seemed onerous. So we opted to provide the ability for your algorithm to ask for EITHER daily or minutely data (that’s the frequency piece) and then separately to define how far back you want to look.</p>

<p>Now for the one-offs:<br>
@WorkingForCoins with your questions about the most recent bar, there is a section in the document about getting the most recent bar and those previous to it here, <a href="https://github.com/quantopian/quantopian-drafts/blob/master/data-history-draft.md#current-and-previous-bar">https://github.com/quantopian/quantopian-drafts/blob/master/data-history-draft.md#current-and-previous-bar</a><br>
In addition, there is a method, currently available on the live site, called &quot;get_datetime&quot; which returns the minute that &quot;handle_data&quot; is handling.<br>
Is that what you were looking for?</p>

<p>Also, WorkingForCoins that new feature of TALib with direct handling of DataFrames is good news. I just opened this issue in Zipline to keep track of it, <a href="https://github.com/quantopian/zipline/issues/222">https://github.com/quantopian/zipline/issues/222</a></p>

<p>@Grant – in the interest of robustness we have decided not to handle each security’s data as an independent time series – but rather to pad the historical data window specified so that each minute of data is represented regardless of whether there are 1, 10 or 100 securities in the universe.</p>

<p>One way to get your desired stream of an individual stock&#39;s history would be to use the pd.Series method &quot;valid()&quot;, which returns all non-nan values.</p>

<pre><code>history = data.history.minutes(&quot;50m&quot;, &#39;price&#39;)

for s in data:  
    sid_history = history[s].valid()
</code></pre>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5249ebc34e2e7e57a7000068' id='5249ebc34e2e7e57a7000068'>
<a href='#5249ebc34e2e7e57a7000068'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380576196000' class='quanto-date posted-at response-posted-at' href='#5249ebc34e2e7e57a7000068'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Eddie,</p>

<p>With regard to your &quot;(1) Filling in for missing data...&quot; above, it sounds that even for the case of one security, you&#39;ll be filling empty minutes with NaN&#39;s, correct?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5249ee1dfaf69ed60000008c' id='5249ee1dfaf69ed60000008c'>
<a href='#5249ee1dfaf69ed60000008c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5019a7055f23060002000002'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8c909680c18a7ce44f242e6923776110?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5019a7055f23060002000002'>Eddie Hebert</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1380576801000' class='quanto-date posted-at response-posted-at' href='#5249ee1dfaf69ed60000008c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, it is correct that there will be values for every market minute, irrespective of the number of securities being used by the algorithm.<br>
One distinction is that the &quot;ffill&quot; flag will determine whether that filling is done with &quot;np.nan&quot;s or forward-filled with the previously seen price.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5249f82d96ba033ec2000080' id='5249f82d96ba033ec2000080'>
<a href='#5249f82d96ba033ec2000080'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380579374000' class='quanto-date posted-at response-posted-at' href='#5249f82d96ba033ec2000080'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>A few corner cases to consider:</p>

<ol>
<li>Trading in a given security is suspended, but the market in which it trades is still open.  Presumably, the filling rules still apply, correct?<br></li>
<li>What if the market shuts down during a normal trading day (e.g. a computer glitch).  Would all securities get OHLCV data filled during the shutdown?  Or would the market minutes get skipped for all securities?</li>
</ol>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5249fa394e2e7e57a70000a6' id='5249fa394e2e7e57a70000a6'>
<a href='#5249fa394e2e7e57a70000a6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1380579898000' class='quanto-date posted-at response-posted-at' href='#5249fa394e2e7e57a70000a6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Eddie,</p>

<p>As as said it all looks good. But as the &#39;15m&#39; in</p>

<pre><code>minute_prices = data.history.minutes(&#39;15m&#39;, &#39;price&#39;)  
</code></pre>

<p>is very different to the &#39;15Min&#39; in</p>

<pre><code>converted = ts.asfreq(&#39;15Min&#39;, method=&#39;pad&#39;)  
</code></pre>

<p>please consider something like </p>

<pre><code>minute_prices = data.history.minutes(15, &#39;1Min&#39;, &#39;price&#39;)  
</code></pre>

<p>P.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524a9d474e2e7e7b3c00015a' id='524a9d474e2e7e7b3c00015a'>
<a href='#524a9d474e2e7e7b3c00015a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380621640000' class='quanto-date posted-at response-posted-at' href='#524a9d474e2e7e7b3c00015a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Under &quot;TALib Port&quot; it is is not clear how the TA-Lib parameters are set.</p>

<pre><code>def initialize(context):  
    set_universe(DollarVolumeUniverse(95, 95.1))

def handle_data(context, data):  
    price_history = data.history.days(&#39;30d&#39;, &#39;price&#39;)  
    macd_result = talib.MACD(price_history)  
</code></pre>

<p>If the defaults are not used, do the parameters get set within the call to MACD in handle_data?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524aa72b96ba03241a000169' id='524aa72b96ba03241a000169'>
<a href='#524aa72b96ba03241a000169'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/518dfcd21ee7cde87a000022'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/802dba78839794011a22dda146b50897?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/518dfcd21ee7cde87a000022'>Working ForCoins</a>
</div>
<a UTCms='1380624172000' class='quanto-date posted-at response-posted-at' href='#524aa72b96ba03241a000169'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I don&#39;t know a lot about TA-Lib port into Zipline (which will be probably improved)<br>
But what I can say is that with latest TA-Lib Python port you can do</p>

<pre><code>abstract.MA(df, timeperiod=3, matype=0)
</code></pre>

<p>But <code>abstract.MA(df, {&#39;timeperiod&#39;: 3, &#39;matype&#39;: 0})</code> doesn&#39;t work</p>

<p>If parameters are stored in a dict you need to unpack this dict like</p>

<pre><code>abstract.MA(df, **{&#39;timeperiod&#39;: 3, &#39;matype&#39;: 0})  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524acd30faf69ee51d000193' id='524acd30faf69ee51d000193'>
<a href='#524acd30faf69ee51d000193'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1380633905000' class='quanto-date posted-at response-posted-at' href='#524acd30faf69ee51d000193'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>As to getting 15 minutes OHLC, this should be fairly easy:  </p>

<pre><code>data.history.minutes(&#39;60m&#39;, &#39;price&#39;).resample(&#39;15m&#39;, how=&#39;ohlc&#39;)  
</code></pre>

<p>Should give you the OHLC of the last hour for each 15m bin (so a dataframe with 4 rows). Is that an acceptable way?</p>

<p>I think we should try to leverage pandas as much as possible here as it comes with great resampling capabilities instead of replicated it in the Quantopian-API.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='524ad22e4e2e7e17d70001dd' id='524ad22e4e2e7e17d70001dd'>
<a href='#524ad22e4e2e7e17d70001dd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1380635182000' class='quanto-date posted-at response-posted-at' href='#524ad22e4e2e7e17d70001dd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Again, when I read that, I instinctively think, &quot;How can they resample 60m bars into 15m bars?&quot;, before realizing again that you&#39;ve used &quot;60m&quot; to refer to a length of time, rather than a period.</p>

<p>data.history.minutes(60, &#39;price&#39;).resample(&#39;15m&#39;, how=&#39;ohlc&#39;)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524ae0b796ba036a75000202' id='524ae0b796ba036a75000202'>
<a href='#524ae0b796ba036a75000202'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1380638905000' class='quanto-date posted-at response-posted-at' href='#524ae0b796ba036a75000202'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Thomas,</p>

<p>That makes sense but it has the potential to confuse i.e.&#39;m&#39; and &#39;Min&#39; have to be used in the same line:</p>

<pre><code>data.history.minutes(&#39;60m&#39;, &#39;price&#39;).resample(&#39;15Min&#39;, how=&#39;ohlc&#39;)  
</code></pre>

<p>which I think is the correct syntax. And how do we parameterise these? This</p>

<pre><code>lookBackDays = 10  
strPeriod = str(lookBackDays * 390)  
strBarSize = &#39;15Min&#39;  
data.history.minutes(strPeriod, &#39;price&#39;).resample(strBarSize, how=&#39;ohlc&#39;)  
</code></pre>

<p>is messy. I don&#39;t know enough pandas - is this a pandas trait?</p>

<p>P.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524ae17f4bd215a136000200' id='524ae17f4bd215a136000200'>
<a href='#524ae17f4bd215a136000200'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50f97faeaa4b3d78fd0000ee'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f18d32ae5bfc439c5b75bfa9f29e953a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50f97faeaa4b3d78fd0000ee'>Jessica Stauth</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1380639105000' class='quanto-date posted-at response-posted-at' href='#524ae17f4bd215a136000200'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Simon - definitely agree it&#39;s not perfection, but we did bat around a number of alternatives which all had problems. How would you expect it to look?</p>

<p>Would you prefer something like:<br>
data.history(frequency=&#39;minutes&#39;, duration=&#39;60&#39;, value=&#39;price&#39;)<br>
where frequency can be &#39;minutes&#39; or &#39;days&#39;, duration can be any integer, and value can be price, volume, etc?</p>

<p>or do you want to ask for any arbitrary &#39;bar size&#39; upfront like this:<br>
data.history(barsize=&quot;15m&quot;, count=30, value=&#39;price&#39;)</p>

<p>And my only issue with option #2 is that it feels like we&#39;re rolling a lot of duplicative resampling functionality inside the API, where it might be more flexible to leave it up to the user to do this in pandas. But I might be throwing the baby out with the bathwater on that concern - would love your thoughts.</p>

<p>Jess  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='524ae5444e2e7e57a7000299' id='524ae5444e2e7e57a7000299'>
<a href='#524ae5444e2e7e57a7000299'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1380640069000' class='quanto-date posted-at response-posted-at' href='#524ae5444e2e7e57a7000299'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Well, I guess the answer to that question depends on, &quot;Who are your users?&quot;  :)</p>

<p>Another question I would pose, rhetorically, is, &quot;Who really wants daily data in a minutely backtest/live trading anyway?&quot;  That is to say, if I have a daily strategy, ought I expect implicitly that it be evaluated exactly once a day?  </p>

<p>If I were a TA man, coding a 50day &gt; 200day moving average crossover, would I ever want that inequality tested every minute?  </p>

<p>If the answers to those questions are &quot;nobody&quot;, &quot;yes&quot; and &quot;no&quot;, then your API requirements are simplified:</p>

<p>data.history(length=60, frequency=&#39;1m&#39;)</p>

<p>Just a thought.</p>

<p>EDIT - the above isn&#39;t &quot;simplified&quot;, my mistake.  What I meant was, that the the bar frequency would drive the simulation or vice versa, so that it would be implicit.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524ae98996ba036a75000235' id='524ae98996ba036a75000235'>
<a href='#524ae98996ba036a75000235'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1380641163000' class='quanto-date posted-at response-posted-at' href='#524ae98996ba036a75000235'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter: Yes, you are correct. The syntax should be the same in both cases.</p>

<p>I think Simon has a point. I am not sure we really need the frequency argument, unless I&#39;m misunderstanding. Would frequency=&#39;5m&#39; only give you every fifth minute or do OHLC over 5 min bins?</p>

<p>Also, when one wants day OHLC in minute mode one could do:  </p>

<pre><code>data.history(length=10*6.5*60).resample(&#39;1D&#39;, how=&#39;ohlc&#39;)  
</code></pre>

<p>Simon&#39;s example would become:<br>
<code>
data.history(length=60).resample(&#39;5Min&#39;)  
</code>
To only keep every fifth minute.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='524af2464bd2158bdb00020e' id='524af2464bd2158bdb00020e'>
<a href='#524af2464bd2158bdb00020e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1380643399000' class='quanto-date posted-at response-posted-at' href='#524af2464bd2158bdb00020e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I think you very rarely want every fifth minute, one expects it will be the OHLC of the five minutes.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524af2ee4bd2150d3500021d' id='524af2ee4bd2150d3500021d'>
<a href='#524af2ee4bd2150d3500021d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1380643567000' class='quanto-date posted-at response-posted-at' href='#524af2ee4bd2150d3500021d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Simon: So are you proposing of integrating .resample(freq, how=&#39;ohlc&#39;) into data.history()? I.e.  </p>

<pre><code>data.history(length=60).resample(&#39;5Min&#39;, how=&#39;ohlc&#39;) == data.history(length=60, frequency=&#39;5Min&#39;)  
</code></pre>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='524af8484bd2150d35000243' id='524af8484bd2150d35000243'>
<a href='#524af8484bd2150d35000243'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1380644938000' class='quanto-date posted-at response-posted-at' href='#524af8484bd2150d35000243'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>If you are going to provide 5 minute bars in a simulation, they should be a bar for the entire previous five minutes, not the fifth minute bar with the previous four ignored, that was my point there.</p>

<p>More generally, I think you should consider whether the flexibility to request data of different frequencies than that in which the algorithm is being evaluated is worthwhile.  If not, then you can just fix a strategy as &quot;Daily&quot; or &quot;Minutely&quot;, feed it daily or minute bars once per period and forget about the frequency argument entirely, with the only parameter being how far back the data has to go.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524becd75768cd35cf000176' id='524becd75768cd35cf000176'>
<a href='#524becd75768cd35cf000176'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380707545000' class='quanto-date posted-at response-posted-at' href='#524becd75768cd35cf000176'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello all,</p>

<p>Some feedback (perhaps re-iterating some comments above):</p>

<ul>
<li>The fields/flags and their syntax should be consistent across Quantopian and pandas.<br></li>
<li>Would it be possible to just keep things simple, and provide data.history(length=N), and then provide examples of how to apply pandas?  N would correspond to the number of market tics when the security could have traded (N days or N minutes, depending on the base frequency of the backtest).  The trailing window of data would be available at the start of the backtest (rather than after a &quot;warm-up&quot; period, as presently required).  By the way, I&#39;m not sure that this would be any different than the current batch transform with refresh_period = 0, so I&#39;ve been wondering (aside from eliminating the warm-up issue), why you are adding the history functionality.<br></li>
<li>It is still kinda murky what happens when Quantopian includes markets other than U.S. equities (e.g. foreign).  It seems that the data structure won&#39;t work since the datetime stamps won&#39;t align (e.g. Asian, European, and U.S. markets all have different open/close times).  It seems that the database should have another flag, besides the OHLCV data, to indicate whether the market was open for a given security, right?</li>
</ul>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524c36e85768cd7a1200022a' id='524c36e85768cd7a1200022a'>
<a href='#524c36e85768cd7a1200022a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/518dfcd21ee7cde87a000022'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/802dba78839794011a22dda146b50897?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/518dfcd21ee7cde87a000022'>Working ForCoins</a>
</div>
<a UTCms='1380726505000' class='quanto-date posted-at response-posted-at' href='#524c36e85768cd7a1200022a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello all too,</p>

<p>I don&#39;t understand necessity of data alignment and why you want not to have a &quot;rolling OHLCV Dataframe&quot; for each timeframe / symbol<br>
I may be wrong but this is how I would consider this problem</p>

<p>I will first in initialize method create variables to manage history<br>
Let&#39;s say that each rolling DataFrame will have 65535 points history depth and that my strategy need to store 1 minute timeframe and a daily timeframe for both EURUSD and EURCHF</p>

<p>Internal history object could be a dict like this:</p>

<pre><code>{  
  &#39;EURUSD&#39;: {  
      &#39;bid&#39;: value,  
      &#39;ask&#39;: value,  
      &#39;last&#39;: value,  
      &#39;last_vol&#39;: value,  
      &#39;last_type&#39;: [&#39;buy&#39;|&#39;sell&#39;]  
      &#39;tick&#39;: &lt;rolling_tick_data&gt;  
      &#39;OHLCV&#39;: {  
          &#39;1Min&#39;: {  
              &#39;bid&#39;: &lt;rolling_ohlc_data&gt;,  
              &#39;ask&#39;: &lt;rolling_ohlc_data&gt;  
          }  
          &#39;5Min&#39;: {  
              ...  
          },  
              ...  
          &#39;15Min&#39;: {  
              ...  
          },  
      }  
      ,

   &#39;EURCHF&#39;: {  
      &#39;bid&#39;: value,  
      &#39;ask&#39;: value,  
      &#39;last&#39;: value,  
      &#39;last_vol&#39;: value,  
      &#39;last_type&#39;: [&#39;buy&#39;|&#39;sell&#39;]  
      &#39;tick&#39;: &lt;rolling_tick_data&gt;  
      &#39;OHLCV&#39;: {  
          &#39;1Min&#39;: {  
              &#39;bid&#39;: &lt;rolling_ohlc_data&gt;,  
              &#39;ask&#39;: &lt;rolling_ohlc_data&gt;  
          }  
          &#39;5Min&#39;: {  
              ...  
          },  
              ...  
          &#39;15Min&#39;: {  
              ...  
          },  
      }  
}
</code></pre>

<p>Initialize function will contains lines like:</p>

<pre><code>N = 65535  
data.history.store(&#39;EURUSD&#39;) # will create &#39;EURUSD&#39; key into history dict and every other sub-keys  
data.history.create_tick_buffer(&#39;EURUSD&#39;, N)  
data.history.create_ohlcv_buffer(&#39;EURUSD&#39;, &#39;1Min&#39;, N)  
data.history.create_ohlcv_buffer(&#39;EURUSD&#39;, &#39;1D&#39;, N)

data.history.store(&#39;EURCHF&#39;)  
data.history.create_tick_buffer(&#39;EURCHF&#39;, N)  
data.history.create_ohlcv_buffer(&#39;EURCHF&#39;, &#39;1Min&#39;, N)  
data.history.create_ohlcv_buffer(&#39;EURCHF&#39;, &#39;1D&#39;, N)
</code></pre>

<p>I really think that it&#39;s necessary to store both not compressed data (such as tick data) and compressed data (like OHLCV)<br>
because you can&#39;t rely on resampling big ticks data into &#39;handle_data&#39; method<br>
Do you resample tick data or even 1 minute timeframe data to get OHLCV daily data 7 days before ?<br>
If you are doing this it will probably be very long and also very memory consuming !</p>

<p>An implementation of this RollingOHLCV could be:<br>
(it should probably be improved)</p>

<pre><code>class RollingOHLCVData():  
    def __init__(self, N):  
        self.size = N  

        self.df = pd.DataFrame(index=np.arange(N-1,-1,-1))  

        self.df[&#39;open&#39;] = np.nan  
        self.df[&#39;high&#39;] = np.nan  
        self.df[&#39;low&#39;] = np.nan  
        self.df[&#39;close&#39;] = np.nan  

        self.df[&#39;volume&#39;] = np.nan  

        self.flag_first_append = True

    def append(self, price, volume, new_candle=False):  
        if new_candle or self.flag_first_append:  
            print(&quot;new_candle&quot;)  
            self.flag_first_append = False

            self.df = self.df.shift(-1)  

            self.df[&#39;open&#39;][0] = price  
            self.df[&#39;high&#39;][0] = price  
            self.df[&#39;low&#39;][0] = price  
            self.df[&#39;close&#39;][0] = price

            self.df[&#39;volume&#39;][0] = volume  

        else:  
            self.df[&#39;close&#39;][0] = price  
            if price &gt; self.df[&#39;high&#39;][0]:  
                self.df[&#39;high&#39;][0] = price  

            if price &lt; self.df[&#39;low&#39;][0]:  
                self.df[&#39;low&#39;][0] = price  

            self.df[&#39;volume&#39;][0] += volume  

    def __repr__(self):  
        s = self.df.to_string()  
        return(s)  
</code></pre>

<p>Into handle data we could access to price</p>

<p>like data.history[&#39;EURUSD&#39;][&#39;OHLCV&#39;][&#39;1Min&#39;][&#39;close&#39;][0]</p>

<p>you could also have access to k bar backward data.history[&#39;EURUSD&#39;][&#39;1Min&#39;][&#39;close&#39;][k]</p>

<p>What should happen if no tick happens during 1 minute ?</p>

<p>I think we should keep previous close bar price and set volume to 0<br>
(we could also add a flag column into the rolling dataframe for that case)</p>

<p>That&#39;s just an idea...</p>

<p>An other idea (but maybe after implementing what I wrote before) could be<br>
use a kind of &quot;lazy&quot; structure which will be created depending of what you need.</p>

<p>for example if you receive a tick data for EURUSD and a source code line into<br>
handle_data of your strategy requests 2 bars before current bar open price<br>
zipline could say &quot;Oh my dear!!! I haven&#39;t store this data... Let&#39;s build a structure<br>
able to store what they are requesting me! It will be ready for next event!&quot;</p>

<p>In such a case maybe accessing data using &#39;[&#39; &#39;]&#39; is not the best idea and we should provide<br>
an accessor for that.... maybe we could also overload operator [] using <code>itemgetter</code></p>

<p>W4C  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524c3c4d5bef924ae0000150' id='524c3c4d5bef924ae0000150'>
<a href='#524c3c4d5bef924ae0000150'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1380727886000' class='quanto-date posted-at response-posted-at' href='#524c3c4d5bef924ae0000150'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello W4C,</p>

<p>I cannot speak for Quantopian but I assume the first paragraph of their Business Plan specifies an event model based on 1-minute data (from which is derived daily data) implemented in, and leveraging, Python/pandas.</p>

<p>From this I believe data alignment follows as this is the nature of Data Frames and Data Panels. Should Forex data ever be available - other than via &#39;fetch&#39; - I have no doubt that this will be aggregated into 1 minute OHLCV bars. Additionally, I doubt that Bid/Ask prices will ever be offered within the Quantopian data.</p>

<p>P.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524c422d5768cdcf66000294' id='524c422d5768cdcf66000294'>
<a href='#524c422d5768cdcf66000294'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/518dfcd21ee7cde87a000022'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/802dba78839794011a22dda146b50897?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/518dfcd21ee7cde87a000022'>Working ForCoins</a>
</div>
<a UTCms='1380729390000' class='quanto-date posted-at response-posted-at' href='#524c422d5768cdcf66000294'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Spread is an important problem in a Forex strategy (or when trading CFD). I don&#39;t understand why Quantopian could ignore this.</p>

<p>When trading CFD, you can buy/sell contracts (underlying is shares) during night (market closed) and so spread is different (higher) than daily spread (market open).<br>
Moreover 1 minute OHLCV bars is not enough if you want to trade realtime... (at least for some scalping strategies) you need to feed your strategy using tick data.<br>
Some Forex tick data are available here <a href="http://www.truefx.com/">http://www.truefx.com/</a> but you can probably find other tick data elsewhere for backtesting</p>

<p>About live trading. You can get data not only &quot;fetching&quot; them but also using broker API such as Interactive Brokers (or probably some others)</p>

<p>here is a sample<br>
<a href="https://code.google.com/p/trading-with-python/source/browse/#svn%2Ftrunk%2Flib%2FinteractiveBrokers">https://code.google.com/p/trading-with-python/source/browse/#svn%2Ftrunk%2Flib%2FinteractiveBrokers</a><br>
   (from <a href="http://www.tradingwithpython.com/?page_id=504">http://www.tradingwithpython.com/?page_id=504</a> )<br>
<a href="https://code.google.com/p/ibpy/">https://code.google.com/p/ibpy/</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524c44b65bef92fd6c000167' id='524c44b65bef92fd6c000167'>
<a href='#524c44b65bef92fd6c000167'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1380730039000' class='quanto-date posted-at response-posted-at' href='#524c44b65bef92fd6c000167'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello W4C,</p>

<p>I&#39;m not disagreeing with you. I&#39;m just relaying an impression I get from <a href="https://www.quantopian.com/posts/timeframes-discussion">https://www.quantopian.com/posts/timeframes-discussion</a></p>

<p><i>&quot;@Peter - good question - but totally unrelated to the historical data timeframes question I was trying to answer here :)</p>

<p>Quantopian&#39;s backtesting and live trading are all built around minute-level pricing data and that is the fastest access that Quantopian-IB link will give you to the market. For the equity markets this is pretty standard for any type of trading that falls outside of market making or what is often referred to as high frequency trading&#39; or HFT. As you described, you are exposed to intra-minute price risk.&quot;</i></p>

<p>P.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524c4e78f8c7503c340002d7' id='524c4e78f8c7503c340002d7'>
<a href='#524c4e78f8c7503c340002d7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/518dfcd21ee7cde87a000022'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/802dba78839794011a22dda146b50897?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/518dfcd21ee7cde87a000022'>Working ForCoins</a>
</div>
<a UTCms='1380732538000' class='quanto-date posted-at response-posted-at' href='#524c4e78f8c7503c340002d7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Peter,</p>

<p>sorry for being so rude...</p>

<p>if Zipline can&#39;t provide what I&#39;m looking for (tick data storing) and also different rolling buffers to store OHLCV data for different timeframes... I will probably build something myself but I prefer to first have a look at what exists (in order not to reinvent a square wheel).</p>

<p>Moreover there is also an other problem about storing volume (are they integer ?)<br>
Quantopian / Zipline seems to be first &quot;shares oriented&quot; so volume is integer and that&#39;s a problem for both Forex and CFD where volume are decimal (with a fixed number of digits)</p>

<p>I see two ideas about it:<br>
- using python decimal type <a href="http://docs.python.org/2/library/decimal.html">http://docs.python.org/2/library/decimal.html</a><br>
- store every data as integer but when you get price or volume it will be divided by 10^digits and apply a function to &quot;normalize&quot; using a given digits number<br>
(that&#39;s what Metatrader 4 is doing <a href="http://docs.mql4.com/convert/NormalizeDouble">http://docs.mql4.com/convert/NormalizeDouble</a> ) but that&#39;s maybe not the best example.</p>

<p>So there is a need for a variable like Digits <a href="http://docs.mql4.com/predefined/variables/Digits">http://docs.mql4.com/predefined/variables/Digits</a> or more general a function like MarketInfo<br>
<a href="http://docs.mql4.com/common/MarketInfo">http://docs.mql4.com/common/MarketInfo</a></p>

<p>That&#39;s again my own opinion which is linked to markets in which I&#39;m interested in.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524c51a4b593229fe3000005' id='524c51a4b593229fe3000005'>
<a href='#524c51a4b593229fe3000005'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/518dfcd21ee7cde87a000022'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/802dba78839794011a22dda146b50897?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/518dfcd21ee7cde87a000022'>Working ForCoins</a>
</div>
<a UTCms='1380733349000' class='quanto-date posted-at response-posted-at' href='#524c51a4b593229fe3000005'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Simon</p>

<p>&quot;If I were a TA man, coding a 50day &gt; 200day moving average crossover, would I ever want that inequality tested every minute?&quot;</p>

<p>I also think that managing this into handle_data is not a good idea.</p>

<p>Maybe a kind of signal/slot pattern could be useful.</p>

<p>Signal send when there is a new candle on a daily candlestick chart.<br>
and linked to a slot  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='524e875457222bf75a0001ff' id='524e875457222bf75a0001ff'>
<a href='#524e875457222bf75a0001ff'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380878168000' class='quanto-date posted-at response-posted-at' href='#524e875457222bf75a0001ff'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>In order for data.history to accumulate data, does it need to be called for every call to handle_data?  Or could it be in a conditional statement (if condition met, then call data.history)?</p>

<p>Also, does data.history have to be in handle_data?  Or can it also be in other functions?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52500606bf0d6328c200010d' id='52500606bf0d6328c200010d'>
<a href='#52500606bf0d6328c200010d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380976135000' class='quanto-date posted-at response-posted-at' href='#52500606bf0d6328c200010d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>For the warm-up, you should provide more detail on how it will be handled, including when the benchmark will start (see my comment on <a href="https://www.quantopian.com/posts/benchmark-has-returns-for-day-1-why">https://www.quantopian.com/posts/benchmark-has-returns-for-day-1-why</a>).  Presently, it seems that there is a problem with the start day/minute of the benchmark, since it starts when an order can be submitted (the start of the backtest).  Shouldn&#39;t it start on the earliest day/minute a gain/loss could be realized?</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52500c0319ff328c500000ec' id='52500c0319ff328c500000ec'>
<a href='#52500c0319ff328c500000ec'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380977668000' class='quanto-date posted-at response-posted-at' href='#52500c0319ff328c500000ec'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I suggest adding a &quot;Technical Implementation&quot; section to <a href="https://github.com/quantopian/quantopian-drafts/blob/master/data-history-draft.md">https://github.com/quantopian/quantopian-drafts/blob/master/data-history-draft.md</a>.  It is not clear how data.history will work &quot;under the hood.&quot;  At the start of a backtest, I gather that you will somehow find all references to sids, and then start accumulating the data for all of them, prior to the start of the backtest.  What happens if the list of sids changes during the backtest?  Or what if the user wants to delay the accumulation?  Also, there must be a memory limitation?  You might want to provide guidance on how to manage it, in the limit of a large number of sids and a large window size.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52500ee6bf0d63a1d70000f6' id='52500ee6bf0d63a1d70000f6'>
<a href='#52500ee6bf0d63a1d70000f6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/522b34d1aaaff3bcdd0000ec'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5141db3d49c417997bc084e64011a100?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/522b34d1aaaff3bcdd0000ec'>Richard Diehl</a>
</div>
<a UTCms='1380978407000' class='quanto-date posted-at response-posted-at' href='#52500ee6bf0d63a1d70000f6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Eddie,<br>
    So. If I understand it correctly, I can use either data.history.minutes(&#39;3d&#39;, &#39;price&#39;).resample(&quot;1D&quot;)  or  data.history.days(&#39;3d&#39;, &#39;price&#39;)<br>
to get a daily price series, where the last day uses the most recent partial values. So I can trade at for example an hour prior to close, and examine the daily charts (just as I would with stockcharts.com). And I can at the same time look at minute data or other data to fine tune entries and exits. Sounds perfect. It&#39;s also a bit more transparent than batch transform.<br>
Rich  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52502f21d79099fad000015d' id='52502f21d79099fad000015d'>
<a href='#52502f21d79099fad000015d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1380986658000' class='quanto-date posted-at response-posted-at' href='#52502f21d79099fad000015d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Eddie (and Richard),</p>

<p>I&#39;m kinda unclear, as well.  It seems that to apply the pandas resampling to obtain daily bars in a minutely backtest, it would be (as Thomas W. shows above for different timeframes, data.history.minutes(&#39;60m&#39;, &#39;price&#39;).resample(&#39;15m&#39;, how=&#39;ohlc&#39;)):</p>

<pre><code>data.history.minutes(&#39;5d&#39;, &#39;price&#39;).resample(&#39;D&#39;, how=&#39;ohlc&#39;)  
</code></pre>

<p>Would this return, every minute, the prior 4 days of daily OHLCV data (i.e. a pandas timeseries with 4 rows)?  And at the closing minute, would it return 5 days of daily OHLCV data (since at closing, the current day&#39;s OHLCV would be available?</p>

<p>Or would it return 4 full days of OHLCV and a partial day of OHLCV (up to the current minute) (i.e. a pandas timeseries with 5 rows, with the 5th row changing every minute).?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52532884cc02e75859000007' id='52532884cc02e75859000007'>
<a href='#52532884cc02e75859000007'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5019a7055f23060002000002'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8c909680c18a7ce44f242e6923776110?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5019a7055f23060002000002'>Eddie Hebert</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1381181573000' class='quanto-date posted-at response-posted-at' href='#52532884cc02e75859000007'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thank you so much for your thoughtful and passionate reviews of the data.history specification. Several of your suggestions have been incorporated into our latest revision, and we believe it is a much stronger design as a result.</p>

<p>You can see the latest spec here: <a href="https://github.com/quantopian/quantopian-drafts/blob/master/data-history-draft.md">https://github.com/quantopian/quantopian-drafts/blob/master/data-history-draft.md</a></p>

<p>We have started implementing the data.history method as specified. We will keep you updated on our progress, and we welcome further feedback.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='525331cccb5e48652c000030' id='525331cccb5e48652c000030'>
<a href='#525331cccb5e48652c000030'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9d73fb2eb0002000231'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4a9a839742731aad6e110e1d3586e020?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9d73fb2eb0002000231'>Simon Thornington</a>
</div>
<a UTCms='1381183950000' class='quanto-date posted-at response-posted-at' href='#525331cccb5e48652c000030'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Nice.  re: the field, does &quot;price&quot; lead to a frame that contains all of open/high/low/close ?  Or if one wants to build OHLC bars, one must make four history requests ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5253350bcb5e486db0000023' id='5253350bcb5e486db0000023'>
<a href='#5253350bcb5e486db0000023'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1381184780000' class='quanto-date posted-at response-posted-at' href='#5253350bcb5e486db0000023'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Eddie,</p>

<p>Could you elaborate on:</p>

<p><b><i>Frequency of one day and above (i.e., &#39;1d&#39;, &#39;2d&#39;, &#39;1W&#39;,&#39;1M&#39;, etc.) have a limit of being within the date range of the backtest. e.g. if the simulation date range was from 2011-01-01 to 2011-12-31, the limit for bar_count at a frequency of &#39;1D&#39; would be 252, the limit for a frequency of &#39;2D&#39; would be 176, for &#39;1M&#39; would be 12, etc.</i></b></p>

<p>If the backtest dates were 2011-01-01 to 2011-06-30 what would be returned by:</p>

<pre><code>data.history(bar_count=200, frequency=&#39;1d&#39;, field=&#39;price&#39;)  
</code></pre>

<p>i.e. 200 bars or approx. 126 bars? (I&#39;m guessing &#39;176&#39; above is a typo. not bad arithmetic!) I&#39;m thinking in terms of a 200-day MA in a six month backtest.</p>

<p>Are multiple history requests allowed? If so is the 2000 data point limit for all or for each?</p>

<p>P.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52534f89cc02e7585900005c' id='52534f89cc02e7585900005c'>
<a href='#52534f89cc02e7585900005c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5019a7055f23060002000002'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8c909680c18a7ce44f242e6923776110?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5019a7055f23060002000002'>Eddie Hebert</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1381191563000' class='quanto-date posted-at response-posted-at' href='#52534f89cc02e7585900005c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Simon:</p>

<p>With the current spec, yes, four history requests would have to be made.<br>
But, we had discussed it while working on the spec, and while adding the ability to return multiple at once is out of scope for the first release of the new API, it&#39;s something that we may enable in the future via an additional parameter.</p>

<p>Peter:</p>

<p>Starting with the first handle_data call of the backtests, i.e. at bar 0, the history will return with the 199 preceding business days in 2010 and the first business day in 2011.</p>

<p>Multiple history requests are allowed, a goal is to enable multi-factor algorithms.<br>
Some of the limits will be tuned and re-calibrated during development, but currently it&#39;s envisioned that the 2000 cap only applies to minute, and for daily pricing data, all available bars within the universe.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='52535384cb5e48652c00007f' id='52535384cb5e48652c00007f'>
<a href='#52535384cb5e48652c00007f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1381192582000' class='quanto-date posted-at response-posted-at' href='#52535384cb5e48652c00007f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Eddie,</p>

<p>Regarding the 2000 minute bar limit (&quot;In minute simulations, the number of data points in a history is limited to 2000...&quot;), this sorta rules out the multiple time frames some folks were looking for, since it is only ~ 5 days.  I&#39;d assumed you&#39;d provide a much longer window (e.g. 30-90 days of minute data), that could then be re-sampled down to daily OHLCV bars (using pandas).</p>

<p>Or perhaps one can actually obtain 2000 days, in minute mode, with:</p>

<pre><code>data.history(bar_count=2000, frequency=&#39;1d&#39;, field=&#39;price&#39;)  
</code></pre>

<p>Presumably a &gt; 2000 bar minutely window will still be available with the batch transform?  Or will it be limited, too?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5253553754e6fe19f3000042' id='5253553754e6fe19f3000042'>
<a href='#5253553754e6fe19f3000042'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5019a7055f23060002000002'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8c909680c18a7ce44f242e6923776110?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5019a7055f23060002000002'>Eddie Hebert</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1381193016000' class='quanto-date posted-at response-posted-at' href='#5253553754e6fe19f3000042'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant:</p>

<p>Your example would work in both daily <em>and</em> minute modes, and you&#39;ve zeroed in one on of the main driving features of the new API. i.e., opening up longer time frames to minute backtests.</p>

<p>We may need to improve the language of the spec as it moves from spec to documentation, but in the section that talks about the limits, the units were meant to be in the bars selected by the history function, not the units of the backtest bars.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5253d55b54e6fe19f3000128' id='5253d55b54e6fe19f3000128'>
<a href='#5253d55b54e6fe19f3000128'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1381225820000' class='quanto-date posted-at response-posted-at' href='#5253d55b54e6fe19f3000128'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>In the &quot;Illiquidity and Forward Filling&quot; section, I suggest adding a bit more detail:</p>

<ul>
<li>Presumably, prices for missing bars will be forward-filled, but volumes will be set to zero.<br></li>
<li>As for the batch transform, if there is no prior (i.e. the first bar in the window is missing), there will be no filling.<br></li>
<li>In the case of all empty bars over the entire window, will the security be listed?  Or will the column be dropped?</li>
</ul>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5260f882bc3290e44e00013f' id='5260f882bc3290e44e00013f'>
<a href='#5260f882bc3290e44e00013f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1382086789000' class='quanto-date posted-at response-posted-at' href='#5260f882bc3290e44e00013f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Eddie,</p>

<p>I&#39;m a bit confused about the relationship between the data that will be available via history, and the stream of events that the backtester uses.  It appears that the event stream is already forward-filled, prior to the backtest start (e.g. <a href="https://www.quantopian.com/posts/thinly-traded-stocks-why-no-gaps">https://www.quantopian.com/posts/thinly-traded-stocks-why-no-gaps</a>), with no way to turn off the filling.  Presumably, the history method won&#39;t be operating on the filled data, but rather the unmodified event stream, right?  But will handle_data still be running on the forward-filled event stream (with non-zero volumes for non-events and lagging datetime stamps)?  If so, I think that this could lead to confusion.  For example, if I turn off the forward filling on the history method, then the data provided by history won&#39;t match the event stream data (assuming that you continue to forward fill the event stream data with no way to turn off the filling).</p>

<p>Sorry, I&#39;m having a trouble articulating the problem...perhaps you or someone else can clarify my point (or set me straight that there is no problem).  I think it comes down to laying out how history, handle_data, order, slippage, etc. will manage the multi-sid case with some (or all) of the securities not trading every minute/day.</p>

<p>Grant</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52a1b34593bb8ee74f00011f' id='52a1b34593bb8ee74f00011f'>
<a href='#52a1b34593bb8ee74f00011f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1386328903000' class='quanto-date posted-at response-posted-at' href='#52a1b34593bb8ee74f00011f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Eddie,</p>

<p>How is the order of the dataframe columns determined (see <a href="https://www.quantopian.com/posts/history-api-how-to-order-sids">https://www.quantopian.com/posts/history-api-how-to-order-sids</a>)?  Could the columns be ordered by increasing sid number?  Presently, it appears that this is not the case.</p>

<p>Also, you never replied to my Oct. 18 post immediately above.  If you get the chance, please jot down a response.</p>

<p>Thanks,</p>

<p>Grant</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52a21c454b1770ea6600000c' id='52a21c454b1770ea6600000c'>
<a href='#52a21c454b1770ea6600000c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50f97faeaa4b3d78fd0000ee'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f18d32ae5bfc439c5b75bfa9f29e953a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50f97faeaa4b3d78fd0000ee'>Jessica Stauth</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1386355783000' class='quanto-date posted-at response-posted-at' href='#52a21c454b1770ea6600000c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Grant, </p>

<p>We are getting very close to releasing a first cut of the history() API, so I think you&#39;re questions will largely be answered then, or at least we&#39;ll have a version of docs we can iterate on.</p>

<p>For your question on ordering would you mind sharing a use case so that I can get a better handle on how to advise you? In my experience python code that relies implicitly on ordering as opposed to explicitly on indexing tends to be brittle. </p>

<p>Best, Jess  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='52a270d28abedc9e5300002c' id='52a270d28abedc9e5300002c'>
<a href='#52a270d28abedc9e5300002c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1386377430000' class='quanto-date posted-at response-posted-at' href='#52a270d28abedc9e5300002c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Jess,</p>

<p>One use case is to get the sid data into a numpy ndarray for analysis, in a specific order.  Presently, if I understand correctly, the history API does not order the securities in the dataframe output (or the order is not obvious).  One approach is to use a sort on the list of sids (e.g. by sid number), and then apply the same ordering to the dataframe (as I show in <a href="https://www.quantopian.com/posts/history-api-how-to-order-sids">https://www.quantopian.com/posts/history-api-how-to-order-sids</a>).  It would be preferred to apply an arbitrary order to the dataframe.  If I poke around in Pandas I can probably sort it out.  If you or anyone there knows how, just let me know.</p>

<p>Grant</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52d90252583d45dfd30000c1' id='52d90252583d45dfd30000c1'>
<a href='#52d90252583d45dfd30000c1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1389953620000' class='quanto-date posted-at response-posted-at' href='#52d90252583d45dfd30000c1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Quantopian folks,</p>

<p>How&#39;s the full release of the history API coming along?  It would be nice to have access to the trailing data down to the minute level (other than via the legacy batch transform or by writing a custom accumulator), with an algorithm &quot;warm up&quot; period.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52d9109a583d450dc80000e2' id='52d9109a583d450dc80000e2'>
<a href='#52d9109a583d450dc80000e2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/518dfcd21ee7cde87a000022'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/802dba78839794011a22dda146b50897?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/518dfcd21ee7cde87a000022'>Working ForCoins</a>
</div>
<a UTCms='1389957276000' class='quanto-date posted-at response-posted-at' href='#52d9109a583d450dc80000e2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi,</p>

<p>I really think that Simon sentence was very clear &quot;If I were a TA man, coding a 50day &gt; 200day moving average crossover, would I ever want that inequality tested every minute?&quot;<br>
Zipline should use circular buffers and publish / subscribe pattern (pypubsub, pydispatcher...) that&#39;s probably even better than signal/slot pattern.<br>
A strategy should always define custom accumulators (for tick data but also for OHLCV data - one for bid and on for ask price) at startup.<br>
OHLCV accumulators could send a message for a given topic (for exemple when a new candle appears)<br>
so accumulators should be created with a topic string.<br>
At strategy startup we should subscribe to interesting topics (in this case it will be symbol.OHLCV.Daily)<br>
I don&#39;t know if what I&#39;m trying to explain is clear but that&#39;s how I try to directed the development of my own software<br>
(unfortunately I have not a lot of free time to do it)
but I agree that it would be a big rewrite</p>

<p>WFC  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54c15e0e32b2e4c517000005' id='54c15e0e32b2e4c517000005'>
<a href='#54c15e0e32b2e4c517000005'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54ad90b62002472a98000370'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/42322fc6b492e5caa3f8d7fb76d08ce0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54ad90b62002472a98000370'>dalin qin</a>
</div>
<a UTCms='1421958682000' class='quanto-date posted-at response-posted-at' href='#54c15e0e32b2e4c517000005'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I see currently we still need to use batch_transform right?  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/draft-proposal-of-new-data-history-api'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/draft-proposal-of-new-data-history-api'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#086e6d6d6c6a696b6348797d69667c6778616966266b6765">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
