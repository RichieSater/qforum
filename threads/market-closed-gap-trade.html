<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
market-closed gap trade
</title>
<meta content='This algorithm came out of a discussion on https://www.quantopian.com/posts/how-do-i-shift-the-moving-average-of-an-imported-csv-chart.Basic outline:For development, set:set_commission(commission.PerShare(cost=0))  set_slippage(slippage.FixedSlippage(spread=0.00))  Consider a list of 100 securities (the Nasdaq 100, I think)Using a 30-day trailing window, compute the difference (gap) between the daily opening price and the prior daily closing priceNormalize the gap using a z-scoreEach day,...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="DnU8OYw+AIrJjBtJFKK/6UF+np1qe1iYMifNhXIvlgtyE0p0LsjSaXCRQnhbTRedefC99BC3TYOwKBbv2Gr0sA==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=false;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/market-closed-gap-trade' property='og:url'>
<meta content='market-closed gap trade' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/market-closed-gap-trade' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='market-closed gap trade' property='og:title'>
<meta content='This algorithm came out of a discussion on https://www.quantopian.com/posts/how-do-i-shift-the-moving-average-of-an-imported-csv-chart.Basic outline:For development, set:set_commission(commission.PerShare(cost=0))  set_slippage(slippage.FixedSlippage(spread=0.00))  Consider a list of 100 securities (the Nasdaq 100, I think)Using a 30-day trailing window, compute the difference (gap) between the daily opening price and the prior daily closing priceNormalize the gap using a z-scoreEach day,...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/market-closed-gap-trade">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='5300b24d391854466d0001e3'>
<div class='post-container' data-post-id='5300b24d391854466d0001e3' id='5300b24d391854466d0001e3'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>market-closed gap trade</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<span class='posted-at'>posted </span>
<span UTCms='1392554573000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=market-closed gap trade&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fmarket-closed-gap-trade%3Futm_source%3Dwebsite_share%26utm_campaign%3Dmarket-closed-gap-trade%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fmarket-closed-gap-trade%3Futm_source%3Dwebsite_share%26utm_campaign%3Dmarket-closed-gap-trade%26utm_medium%3Dlinkedin&amp;title=market-closed+gap+trade+%28Grant+Kiehne%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/market-closed-gap-trade?utm_source=website_share&amp;utm_campaign=market-closed-gap-trade&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Grant Kiehne" />
<div class='body-text'>
<div class='body-text-container post-body'><p>This algorithm came out of a discussion on <a href="https://www.quantopian.com/posts/how-do-i-shift-the-moving-average-of-an-imported-csv-chart">https://www.quantopian.com/posts/how-do-i-shift-the-moving-average-of-an-imported-csv-chart</a>.</p>

<p>Basic outline:</p>

<ul>
<li>For development, set:</li>
</ul>

<pre><code>set_commission(commission.PerShare(cost=0))  
set_slippage(slippage.FixedSlippage(spread=0.00))  
</code></pre>

<ul>
<li>Consider a list of 100 securities (the Nasdaq 100, I think)<br></li>
<li>Using a 30-day trailing window, compute the difference (gap) between the daily opening price and the prior daily closing price<br></li>
<li>Normalize the gap using a z-score<br></li>
<li>Each day, identify the pair of stocks corresponding to the min and max gap z-scores<br></li>
<li>Buy the stock with the min gap z-score, and short the stock with the max gap z-score<br></li>
<li>After 3 pm, close open positions</li>
</ul>

<p>Comments/questions/improvements welcome.</p>

<p>Grant</p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>47 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='5300cce61f159f4911000241' id='5300cce61f159f4911000241'>
<a href='#5300cce61f159f4911000241'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1392561383000' class='quanto-date posted-at response-posted-at' href='#5300cce61f159f4911000241'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Grant,</p>

<p>I think you are closing orders &quot;&gt; 15&quot; hundred hours i.e. at 16:00. This means they are filled at 09:31 if they are not cancelled overnight by Quantopian. It&#39;s not clear to me what the status of cancelling overnight orders is now and in the future. See: <a href="https://www.quantopian.com/posts/intraday-trades">https://www.quantopian.com/posts/intraday-trades</a></p>

<p>P.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5300d6fdc415eaa2660002f4' id='5300d6fdc415eaa2660002f4'>
<a href='#5300d6fdc415eaa2660002f4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50f97faeaa4b3d78fd0000ee'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f18d32ae5bfc439c5b75bfa9f29e953a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50f97faeaa4b3d78fd0000ee'>Jessica Stauth</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1392563967000' class='quanto-date posted-at response-posted-at' href='#5300d6fdc415eaa2660002f4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Orders placed in the last minute of the day (or open orders hanging around from anytime prior) are cancelled at EOD both in simulation and in broker-backed live trading. The last opportunity for an algo to place a trade is at 3:59pm (on days w/normal market hours of course).</p>

<p>If you try to create orders overnight in some way I don&#39;t think that will work, but I&#39;d have to look at an example to be sure.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5300e470e1b65d17f800025e' id='5300e470e1b65d17f800025e'>
<a href='#5300e470e1b65d17f800025e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1392567411000' class='quanto-date posted-at response-posted-at' href='#5300e470e1b65d17f800025e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Jess,</p>

<p>I think in Grant&#39;s algo above an order is placed at 16:00 and is filled at the 09:31 bar price. If this is the case when will the backtester be brought in line with paper/live trading? (Dan&#39;s comment at <a href="https://www.quantopian.com/posts/intraday-trades">https://www.quantopian.com/posts/intraday-trades</a> suggests the reverse is the case.)</p>

<p>Also, are any Stop, Limit and Stop Limit orders cancelled overnight or just unfulfilled Market orders?</p>

<p>P.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5301055518466b36bd00004a' id='5301055518466b36bd00004a'>
<a href='#5301055518466b36bd00004a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1392575830000' class='quanto-date posted-at response-posted-at' href='#5301055518466b36bd00004a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Peter,</p>

<p>Yeah, that&#39;s an algorithm bug.  I&#39;d intended to close out before EOD.  But it appears that you&#39;ve uncovered a backtester bug (or at least inconsistency with live trading).  Indeed, when I look at the Transaction Details, all of the action is at 9:30ish in the morning, so the close-out orders are being carried over to the next morning.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='530105771f159fee3100028f' id='530105771f159fee3100028f'>
<a href='#530105771f159fee3100028f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50f97faeaa4b3d78fd0000ee'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f18d32ae5bfc439c5b75bfa9f29e953a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50f97faeaa4b3d78fd0000ee'>Jessica Stauth</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1392575864000' class='quanto-date posted-at response-posted-at' href='#530105771f159fee3100028f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Peter,</p>

<p>I just went over this with Dan again to make sure: my answer was correct for live trading, where we cancel all orders EOD. But you&#39;re right - in the backtest we do not cancel any orders, they can hang around and get executed the next day.</p>

<p>We will look at bringing these two into line I think, as this seems like one of the few places where we do have an inconsistency in behavior between backtested and simulated execution.</p>

<p>What I would suggest in the meantime to maintain as close as possible parity with live trading is to add logic that cancels all open orders at 4:00pm and not to place new orders at 4pm. Not a great answer I&#39;ll grant you - but for now that should work I think.</p>

<p>Best regards, Jess  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='53010eef391854029b000296' id='53010eef391854029b000296'>
<a href='#53010eef391854029b000296'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1392578288000' class='quanto-date posted-at response-posted-at' href='#53010eef391854029b000296'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s the algo, with the close-out orders at 3 pm or later:</p>

<pre><code>def intradingwindow_check(context):  
    # Converts all time-zones into US EST to avoid confusion  
    loc_dt = get_datetime().astimezone(timezone(&#39;US/Eastern&#39;))  
    # if loc_dt.hour &gt; 12 and loc_dt.hour &lt; 15:  
    # if loc_dt.hour == 10 and loc_dt.minute == 0:  
    if loc_dt.hour &gt; 14:  
        return True  
    else:  
        return False  
</code></pre>

<p>For some reason, 2/25 results in the close-out ordering going off the rails.  Will need to sort that out.  --Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53011d7c391854029b0002b1' id='53011d7c391854029b0002b1'>
<a href='#53011d7c391854029b0002b1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1392582014000' class='quanto-date posted-at response-posted-at' href='#53011d7c391854029b0002b1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>To remedy the close-out ordering problem mentioned above, I used:</p>

<pre><code>if context.portfolio.positions_value != 0.0 and intradingwindow_check(context):  
        for stock in context.stocks:  
            if not bool(get_open_orders(stock)):  
                amount = context.portfolio.positions[stock].amount  
                if amount != 0:  
                    order(stock,-amount)  
</code></pre>

<p>I think the problem was that without checking for open orders, excess orders were submitted for a thinly traded security.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='530130d9e1b65d8d440002f6' id='530130d9e1b65d8d440002f6'>
<a href='#530130d9e1b65d8d440002f6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1392586973000' class='quanto-date posted-at response-posted-at' href='#530130d9e1b65d8d440002f6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s a version w/ set_universe.  Not sure if I violate typical margin limits here or not...perhaps someone can point me to some code to assess this (probably an opportunity for a standardized Quantopian helper function).  --Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53013453e1b65d18f50002ec' id='53013453e1b65d18f50002ec'>
<a href='#53013453e1b65d18f50002ec'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1392587860000' class='quanto-date posted-at response-posted-at' href='#53013453e1b65d18f50002ec'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Grant,</p>

<p>With your $1M starting cash you simultaneously go long $1M and short $1M which I don&#39;t think is allowed. As the Quantopian search feature only returns 25 results it&#39;s hard to find this <a href="https://www.quantopian.com/posts/template-limiting-leverage-by-brandon-ogle-and-dan-sandberg">https://www.quantopian.com/posts/template-limiting-leverage-by-brandon-ogle-and-dan-sandberg</a> now but this should be the starting point. (Search for &quot;margin call&quot;.)</p>

<p>P.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5301f76cb2002798b6000173' id='5301f76cb2002798b6000173'>
<a href='#5301f76cb2002798b6000173'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1392637805000' class='quanto-date posted-at response-posted-at' href='#5301f76cb2002798b6000173'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Peter,</p>

<p>I&#39;ll have to learn more about this margin thingy (although I don&#39;t even know how to trade with my own money, let alone borrowed).  Presumably, in real-world trading, Interactive Brokers (IB) would just cancel (or hold?) orders that exceed limits, and send a notification via e-mail (automated phone call?), which brings up a good question for the Quantopian folks.  Will the algorithm receive any communication from IB regarding how much capital can be allocated and in what fashion (long/short/borrowed)?  In other words, will the algorithm have access to info. from IB giving the current bounds to avoid a margin call (perhaps including any pending orders)?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5301fab8003d2683e1000193' id='5301fab8003d2683e1000193'>
<a href='#5301fab8003d2683e1000193'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1392638649000' class='quanto-date posted-at response-posted-at' href='#5301fab8003d2683e1000193'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Grant,</p>

<p>IB use real-time margining from what I read so they reject any orders that would lead to a margin call. Available margin would be available to view in TWS but it would be useful (essential?) if this could be available to the algo. </p>

<p>P.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5302bbfbebc8a909b5000137' id='5302bbfbebc8a909b5000137'>
<a href='#5302bbfbebc8a909b5000137'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1392688124000' class='quanto-date posted-at response-posted-at' href='#5302bbfbebc8a909b5000137'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Peter and Jess,</p>

<p>Here&#39;s an example of an order (TZV) that got carried over to the next day, even though I tried to get it filled before EOD:</p>

<pre><code>2013-02-21 09:36:00     TZV     BUY     28097   $37.74  $1,060,380.78  
2013-02-25 09:31:00     TZV     SELL    -28097  $37.95  ($1,066,281.15)  
2013-02-25 09:32:00     RNN     BUY     3219538     $0.33   $1,068,886.62  
2013-02-25 15:48:00     RNN     SELL    -3219538    $0.33   ($1,052,788.93)  
</code></pre>

<p>The code is set up to close out before EOD (e.g. RNN), but sometimes, orders carry over (e.g TZV).  The problem I see is that if open orders are automatically cancelled at EOD, then the code will have to compensate by closing out as early as possible the next morning (which I think my code does).  I&#39;ve posted a separate thread to address the question (see <a href="https://www.quantopian.com/posts/why-cancel-orders-at-end-of-day">https://www.quantopian.com/posts/why-cancel-orders-at-end-of-day</a>), but I thought I&#39;d give you some insight into why I thought to ask the question in the first place.  It basically means that every algorithm has to have code to potentially re-submit any orders that got automatically cancelled (but perhaps this is standard coding practice to be regularly checking to see that the portfolio is in the desired state at any given time).</p>

<p>Grant</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5303f37b1b2172f2e300000d' id='5303f37b1b2172f2e300000d'>
<a href='#5303f37b1b2172f2e300000d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1392767868000' class='quanto-date posted-at response-posted-at' href='#5303f37b1b2172f2e300000d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Jess,</p>

<p>Just a thought, but is the EOD order cancellation mechanism for live trading already coded into zipline, and I just need to use it for backtesting?  Or is it not part of the open source code?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5304c81dae1456a1350001df' id='5304c81dae1456a1350001df'>
<a href='#5304c81dae1456a1350001df'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5244c851589ab3e43c00000c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f708b0fdce9848586b22942c2a122e2d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5244c851589ab3e43c00000c'>Pumplerod</a>
</div>
<a UTCms='1392822303000' class='quanto-date posted-at response-posted-at' href='#5304c81dae1456a1350001df'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>apologies for this python/pandas related question but what exactly is happening with the syntax myPandasDataFrame[1:,:]?<br>
I don&#39;t know what the comma in there is doing, and I can&#39;t find reference to using this syntax anywhere.</p>

<p>but it seems like you&#39;re taking the 2nd to the end of the list for opens and the start to the penultimate item for closes?  Could that be correct?  If so, why do this?</p>

<pre><code>    opens = history(30,&#39;1d&#39;,&#39;open_price&#39;,ffill=False).as_matrix(context.stocks)[1:,:]  
    closes = history(30,&#39;1d&#39;,&#39;close_price&#39;,ffill=False).as_matrix(context.stocks)[0:-1,:]

</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5304ce0a1b217273850001e1' id='5304ce0a1b217273850001e1'>
<a href='#5304ce0a1b217273850001e1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1392823819000' class='quanto-date posted-at response-posted-at' href='#5304ce0a1b217273850001e1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello P.,</p>

<p>I don&#39;t understand that syntax either. I&#39;m going to guess that it&#39;s meant to discard the minute value value from &#39;history&#39;?</p>

<p>To answer the second part of the question:</p>

<pre><code>Open    100    104    103    110

Close   102    106    109    108

Gap       ?     +2     -3     +1  
</code></pre>

<p>P.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5304dc5b1796cae15d0002e4' id='5304dc5b1796cae15d0002e4'>
<a href='#5304dc5b1796cae15d0002e4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b9b56c02cabe5dae000143'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e9388ae5102f3b152fa6225f955a29d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b9b56c02cabe5dae000143'>Alisa Deychman</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1392827484000' class='quanto-date posted-at response-posted-at' href='#5304dc5b1796cae15d0002e4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Pumplerod, </p>

<p>Let&#39;s say that you have a dataframe of stocks on the rows and OHLC values on the columns. Now, when you call df.ix[1:, :] this says for all the stock in the rows, <strong>except</strong> for the first stock, return all the OHLC values. This will return another dataframe. In this syntax the comma is distinguishing between the rows and columns of the dataframe. </p>

<p>Now let&#39;s push the example a little bit further.  Let&#39;s say that you have the same dataframe as before, but you only want the open price. You can say df.ix[1:, 0] which will return all the stocks except the first one and their open prices.</p>

<p>Also, note that you need the &quot;.ix&quot; notation when you&#39;re slicing into the dataframe since you have both integers and letters.</p>

<p>Cheers,<br>
Alisa  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5304f12fae1456e136000259' id='5304f12fae1456e136000259'>
<a href='#5304f12fae1456e136000259'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5244c851589ab3e43c00000c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f708b0fdce9848586b22942c2a122e2d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5244c851589ab3e43c00000c'>Pumplerod</a>
</div>
<a UTCms='1392832817000' class='quanto-date posted-at response-posted-at' href='#5304f12fae1456e136000259'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hmm.  Then in grants example (Which doesn&#39;t use the &quot;.ix&quot; notation) is it selecting all open values for all but the first stock and all closing values for all but the last stock?  I must be missing something pretty basic.  I can see some logic behind finding the gap between yesterday&#39;s close and today&#39;s open, which Peter seems to pointing out.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53055ef963a9ab6bba0000e2' id='53055ef963a9ab6bba0000e2'>
<a href='#53055ef963a9ab6bba0000e2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1392860922000' class='quanto-date posted-at response-posted-at' href='#53055ef963a9ab6bba0000e2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Peter and Pumplerod,</p>

<p>The code I think you are trying to sort out is:</p>

<pre><code>    opens = history(30,&#39;1d&#39;,&#39;open_price&#39;,ffill=False).as_matrix(context.stocks)[1:,:]  
    closes = history(30,&#39;1d&#39;,&#39;close_price&#39;,ffill=False).as_matrix(context.stocks)[0:-1,:]  
    gap = pd.DataFrame(opens - closes).as_matrix()  
</code></pre>

<p>The idea is to subtract the closing prices from the opening ones.  So, the slicing [1:,:] of the opens eliminates the first row, which corresponds to the oldest open.  And the slicing [0:-1,:] of the closes eliminates the last row, which corresponds to the most recent close.  So, when the closes are subtracted from the opens, elementwise, the resulting matrix is the gap between the open, and the prior close, for each day.  So, for example, the last row in gap will correspond to the opening price for the day minus the closing price for the prior day.</p>

<p>By the way, this will work, too:</p>

<pre><code>gap = opens - closes  
</code></pre>

<p>I think that originally I&#39;d used a pandas function to filter out NaN&#39;s, but as it turned out, I dropped the approach.</p>

<p>Overall, the code I posted was kinda hacked together, and surely can be improved, including perhaps using the &quot;.ix&quot; notation Alisa refers to.</p>

<p>Hope this helps.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5305853963a9abc8db000121' id='5305853963a9abc8db000121'>
<a href='#5305853963a9abc8db000121'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5244c851589ab3e43c00000c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f708b0fdce9848586b22942c2a122e2d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5244c851589ab3e43c00000c'>Pumplerod</a>
</div>
<a UTCms='1392870714000' class='quanto-date posted-at response-posted-at' href='#5305853963a9abc8db000121'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yes, it does grant, thanks.  I need to learn more about working with arrays.  I&#39;m always looping over each element, where it seems much more elegant to use these built in methods.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5308ecaa2bad59aa1b000235' id='5308ecaa2bad59aa1b000235'>
<a href='#5308ecaa2bad59aa1b000235'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1393093804000' class='quanto-date posted-at response-posted-at' href='#5308ecaa2bad59aa1b000235'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s an update.  I added the function cancel_orders_EOD to cancel open orders at EOD.  Seems to work, since before adding it, I got:</p>

<pre><code>2013-02-21 09:36:00     TZV     BUY     28097   $37.74  $1,060,380.78  
2013-02-25 09:31:00     TZV     SELL    -28097  $37.95  ($1,066,281.15)  
2013-02-25 09:32:00     RNN     BUY     3219538     $0.33   $1,068,886.62  
2013-02-25 15:48:00     RNN     SELL    -3219538    $0.33   ($1,052,788.93)  
</code></pre>

<p>Now, the result is:</p>

<pre><code>2013-02-21 09:36:00     TZV     BUY     27473   $37.74  $1,036,831.02  
2013-02-25 10:05:00     TZV     SELL    -27473  $38.16  ($1,048,342.21)  
</code></pre>

<p>Still more work to do, but the EOD cancellation seems to be consistent with the anticipated live trading behavior.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5320f2dbb9eb71052b0000c3' id='5320f2dbb9eb71052b0000c3'>
<a href='#5320f2dbb9eb71052b0000c3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394668254000' class='quanto-date posted-at response-posted-at' href='#5320f2dbb9eb71052b0000c3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Another update.  I added an error function to compute the percent to put into the security of the day:</p>

<pre><code>    a = 0.25  
    pct = math.erf(-a*min_gap_z)  
    record(pct=pct)  
    order_target_percent(context.stocks[k_min],pct)  
</code></pre>

<p>Seems to smooth out the returns a bit.  I also made a few other changes, such as (typically) buying near the open, and selling at 10 am (some securities are very thinly traded, so buy/sell doesn&#39;t always go through as directed).</p>

<p>--Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5321179cb9eb7183ca0000f6' id='5321179cb9eb7183ca0000f6'>
<a href='#5321179cb9eb7183ca0000f6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1394677662000' class='quanto-date posted-at response-posted-at' href='#5321179cb9eb7183ca0000f6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>thanks grant.   I get the feeling i should move to intraday by default, my current work is all using interday, so I am guessing the extra aftermarket volitility may impact my algorithm designs.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53217d1ec781783e860001f2' id='53217d1ec781783e860001f2'>
<a href='#53217d1ec781783e860001f2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394703648000' class='quanto-date posted-at response-posted-at' href='#53217d1ec781783e860001f2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Please take note that the code I posted is a messy work-in-progress (I can hardly follow it), which I&#39;m trying to understand how to structure.  One thought is to use some form of a finite state machine architecture (see the nice example posted by Ed Bartosh on <a href="https://www.quantopian.com/posts/finite-state-machine-in-python">https://www.quantopian.com/posts/finite-state-machine-in-python</a>).  Using low dollar-volume stocks seems like a good way to go in developing code, to mimic a worst-case real-world trading scenario (e.g. I&#39;ve turned off the slippage model, and still see that after buying near the open, sometimes the algorithm can&#39;t sell until the next day).</p>

<p>Grant   </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53225cc27274bfb53200008a' id='53225cc27274bfb53200008a'>
<a href='#53225cc27274bfb53200008a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5258725aa09fa7ebaa000024'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7734b86e32e834268bee6749eb322fb4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5258725aa09fa7ebaa000024'>David Edwards</a>
</div>
<a UTCms='1394760900000' class='quanto-date posted-at response-posted-at' href='#53225cc27274bfb53200008a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, I&#39;m liking this strategy. Thanks for keeping us up to date on it.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5322f4154ca31b946a00023a' id='5322f4154ca31b946a00023a'>
<a href='#5322f4154ca31b946a00023a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1394799638000' class='quanto-date posted-at response-posted-at' href='#5322f4154ca31b946a00023a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>fyi i tried running a backtest of this from 2003 and the model doesn&#39;t perform well.   please be careful of overfitting!   this is the first intraday backtest I tried...    it ran for about 4 hours before timing out at 50% (tried 2003 to present)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5322f7624ca31ba351000232' id='5322f7624ca31ba351000232'>
<a href='#5322f7624ca31ba351000232'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50b24ec26d284c0200000088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e238d8d7d6bb1f460ed27e0507045632?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50b24ec26d284c0200000088'>Peter Cawthron</a>
</div>
<a UTCms='1394800483000' class='quanto-date posted-at response-posted-at' href='#5322f7624ca31ba351000232'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Jason,</p>

<p>Are you sure it timed out? I use Chrome and sometimes it is necessary to refresh the full backtest page. Also the end time for the algo often isn&#39;t shown until the page is refreshed.</p>

<p>(A few months ago I felt Chrome was better suited to Quantopian than Firefox but I haven&#39;t revisited this lately.)</p>

<p>P.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5322fabf8fb2c4ef11000231' id='5322fabf8fb2c4ef11000231'>
<a href='#5322fabf8fb2c4ef11000231'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1394801345000' class='quanto-date posted-at response-posted-at' href='#5322fabf8fb2c4ef11000231'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter:  I just checked the backtests and it says &quot;Exception&quot; so yeah, i guess it tanked.  i&#39;ll try attaching it here:  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5322faf67274bf47f000024a' id='5322faf67274bf47f000024a'>
<a href='#5322faf67274bf47f000024a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1394801399000' class='quanto-date posted-at response-posted-at' href='#5322faf67274bf47f000024a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>i guess it got through 2009 before crashing.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5322fd7f8fb2c4ef11000236' id='5322fd7f8fb2c4ef11000236'>
<a href='#5322fd7f8fb2c4ef11000236'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394802049000' class='quanto-date posted-at response-posted-at' href='#5322fd7f8fb2c4ef11000236'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Jason,</p>

<p>Yes, in many ways, this hacked together algorithm is a work-in-progress.  It has piqued my interest since there does seem to be some &quot;money left on the table&quot; for low dollar-volume/thinly traded securities.  To really sort out what&#39;s going on, I think that an R&amp;D platform would be required, to look at statistics versus time.  Backtesting is kinda the last verification step, with validation being paper and finally real-money trading at IB.  I&#39;ve been scratching my head how to do the R&amp;D part, so if anyone has a recommendation, I&#39;m interested.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53233f281abc5c8a6c000017' id='53233f281abc5c8a6c000017'>
<a href='#53233f281abc5c8a6c000017'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394818858000' class='quanto-date posted-at response-posted-at' href='#53233f281abc5c8a6c000017'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s a run w/:</p>

<pre><code>    price = data[context.stocks[k_min]].price  
    shares = cash/price  
    order(context.stocks[k_min],shares,limit_price=price,stop_price=price)  
</code></pre>

<p>Oddly, it just stops trading mid-June, 2012.  Gotta sort out why.</p>

<p>[EDIT] I suspect that the problem is due to my blanket checking for open orders prior to selling.  With the limit/stop in, perhaps an order is hanging around that prevents the algorithm from executing properly.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5323459a83f34b952a000029' id='5323459a83f34b952a000029'>
<a href='#5323459a83f34b952a000029'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50cb68ecd959a30200000208'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7dd7f54c0fb64caa4cfa6fe4894efe39?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50cb68ecd959a30200000208'>Mike Thoun</a>
</div>
<a UTCms='1394820508000' class='quanto-date posted-at response-posted-at' href='#5323459a83f34b952a000029'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant,</p>

<p>Just curious, what was the reason behind setting your universe to the 20-22nd percentile vs any other range?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53234eacbcc31c3d3f000043' id='53234eacbcc31c3d3f000043'>
<a href='#53234eacbcc31c3d3f000043'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394822829000' class='quanto-date posted-at response-posted-at' href='#53234eacbcc31c3d3f000043'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Mike,</p>

<p>Well, I just started playing around with set_universe.  I recall that for higher dollar-volume securities the performance was poor.  And the other day, I tried very low dollar-volume, which was bad, as well.  So, presently, I can continue to develop the algorithm with the 20-22nd percentile range, but it is not sacred.</p>

<p>My intuition (based on no real-world trading experience) is that low dollar-volume stocks might be the way to go.  High dollar-volume ones are going to be very efficient incorporating overnight/weekend information, and there will be less over-reaction/panicky price swings.  But this is just an uneducated hunch at this point.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='532361511abc5c82e1000048' id='532361511abc5c82e1000048'>
<a href='#532361511abc5c82e1000048'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5244c851589ab3e43c00000c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f708b0fdce9848586b22942c2a122e2d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5244c851589ab3e43c00000c'>Pumplerod</a>
</div>
<a UTCms='1394827603000' class='quanto-date posted-at response-posted-at' href='#532361511abc5c82e1000048'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I have noticed that when I attempt to use securities from the lower end of the dollar/Volume universe that there is trouble executing trades.  Even when I try something as simple as buy/sell just 100 shares, there is often carryover into the next day.  When I use securities in the 98-100% range this does not occur.  For me, this makes looking at the results a bit confusing.  Are others finding this to be true as well?  And is this expected behavior?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5323642583f34b952a00007e' id='5323642583f34b952a00007e'>
<a href='#5323642583f34b952a00007e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394828327000' class='quanto-date posted-at response-posted-at' href='#5323642583f34b952a00007e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yes, I&#39;ve seen the same thing, but I think that it comes with the territory (i.e. in the real world, for thinly traded securities, buying and selling can&#39;t be done on-demand).  I do believe it is the expected behavior, since my understanding is that the backtester relies on historical trade events (rolled up minute bars from real trade data) to trigger buying/selling (although I can&#39;t lay out the exact mechanics -- Quantopian folks, can you elaborate?).  --Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5323678b37437580f900008c' id='5323678b37437580f900008c'>
<a href='#5323678b37437580f900008c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b9b56c02cabe5dae000143'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e9388ae5102f3b152fa6225f955a29d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b9b56c02cabe5dae000143'>Alisa Deychman</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1394829197000' class='quanto-date posted-at response-posted-at' href='#5323678b37437580f900008c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant you&#39;re exactly right - this is the expected behavior comes with the territory for thinly traded securities. For illiquid stocks, sometimes there are not enough trades on the market to buy/sell even 100 shares in one day. So the execution will carry over several days until the order is filled. This is contrary to a liquid stock, like Apple, which will be fully filled in the next bar because of the high availability.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5323748bbcc31c1f60000091' id='5323748bbcc31c1f60000091'>
<a href='#5323748bbcc31c1f60000091'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5244c851589ab3e43c00000c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f708b0fdce9848586b22942c2a122e2d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5244c851589ab3e43c00000c'>Pumplerod</a>
</div>
<a UTCms='1394832525000' class='quanto-date posted-at response-posted-at' href='#5323748bbcc31c1f60000091'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>So, it seems like an intraday trading method for low dollar/volume stocks would be difficult to get any reliability from.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5323786783f34b87c400008a' id='5323786783f34b87c400008a'>
<a href='#5323786783f34b87c400008a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394833513000' class='quanto-date posted-at response-posted-at' href='#5323786783f34b87c400008a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Pumplerod,</p>

<p>Again, I ain&#39;t no expert, but there should be ways of mitigate the liquidity risk.  And I figure there must be a lot less competition, so maybe the reward is greater?</p>

<p>One important question is how well can the Quantopian backtester model thinly traded stocks?  Or does one have to go to a paper trading scenario at IB to really understand the situation?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53237a7fbcc31c094500009e' id='53237a7fbcc31c094500009e'>
<a href='#53237a7fbcc31c094500009e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394834048000' class='quanto-date posted-at response-posted-at' href='#53237a7fbcc31c094500009e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The backtest above got stuck on SNK (<a href="http://finance.yahoo.com/q?s=SNK">http://finance.yahoo.com/q?s=SNK</a>).  Any idea what happened?</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5323ac3f1abc5c82e10000d5' id='5323ac3f1abc5c82e10000d5'>
<a href='#5323ac3f1abc5c82e10000d5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1394846785000' class='quanto-date posted-at response-posted-at' href='#5323ac3f1abc5c82e10000d5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant, I&#39;m using quantopian for my R&amp;D, currently working on a strategy based around stochastic oscillators.  generally I do development/tuning against a benchmark security (currently SPY because i&#39;m interested in high volume etf&#39;s) and then I run verification pass on other similar etfs.   finally, i try running a test on the 99.5 to 100 percent universe.</p>

<p>however my current algorithm goes crazy when using the universe, and no debug support means it&#39;s hard to track down the issue.   plus, I hate the 3 minute wait just for running a interday backtest (for a single security) so I might have to try zipline, especially once I try to move my algorithms to something that better simulates a real-world market.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='532431b5cc1417029400009b' id='532431b5cc1417029400009b'>
<a href='#532431b5cc1417029400009b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394880951000' class='quanto-date posted-at response-posted-at' href='#532431b5cc1417029400009b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Jason,</p>

<p>For your bug issue, you could try posting some stripped-down code to the forum, removing anything you need to keep private.  You might also elaborate on what you mean by the algorithm going crazy.</p>

<p>Regarding the time it takes to run a backtest, you can run multiple backtests in parallel (unless something has changed, there is no limit).  It is a manual process to launch each backtest, but to keep track of parameters that you are varying , you can write them out to the log.  A trick I&#39;ve used is to use a random number generator to sample a parameter space (however, as I recall, it is important to re-seed the generator, otherwise it won&#39;t be random--I&#39;ll dig up the info. and post it separately to the forum).</p>

<p>Note that if you are planning on paper/real money trading with Quantopian/IB, you&#39;ll need to write your algos to run on minute bars.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='532442eaca1480f2e0000092' id='532442eaca1480f2e0000092'>
<a href='#532442eaca1480f2e0000092'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394885356000' class='quanto-date posted-at response-posted-at' href='#532442eaca1480f2e0000092'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Update on SNK:</p>

<p><a href="http://www.nyse.com/pdfs/TraderUpdateSusp%28SKN&amp;SVW%29.pdf">http://www.nyse.com/pdfs/TraderUpdateSusp%28SKN&amp;SVW%29.pdf</a></p>

<p>Per the document, SNK is the symbol for Bank of America SPX Capped Leveraged Index Return<br>
Notes (CUSIP 06052K281), with a maturity of 6/29/2012.</p>

<p>So, the algorithm bought into SNK, and then couldn&#39;t sell (likely due to the lack of SNK events in the database).  However, presumably, anyone holding the notes after de-listing would receive a cash payment, right?</p>

<p>How to handle this (in a general sense, not by putting in logic to exclude SNK from context.stocks)?</p>

<p>Grant</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5324b496414dc53567003847' id='5324b496414dc53567003847'>
<a href='#5324b496414dc53567003847'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394914456000' class='quanto-date posted-at response-posted-at' href='#5324b496414dc53567003847'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I excluded SNK, and got the attached result.  Note that the slippage model is disabled.  Also, I need to add some checks that there is no excessive borrowing, or other unreal-isms.</p>

<p>For a comparison, I&#39;m also running with:</p>

<pre><code>set_slippage(slippage.VolumeShareSlippage(volume_limit=0.25, price_impact=0.1))  
</code></pre>

<p>The return basically mirrors the market about the horizontal axis--very negative, but not yet clear why.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5324d1dccc1417f743003c60' id='5324d1dccc1417f743003c60'>
<a href='#5324d1dccc1417f743003c60'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394921949000' class='quanto-date posted-at response-posted-at' href='#5324d1dccc1417f743003c60'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s the result w/:</p>

<pre><code>set_slippage(slippage.VolumeShareSlippage(volume_limit=0.25, price_impact=0.1))  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5324efa5cc1417f74300746c' id='5324efa5cc1417f74300746c'>
<a href='#5324efa5cc1417f74300746c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5244c851589ab3e43c00000c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f708b0fdce9848586b22942c2a122e2d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5244c851589ab3e43c00000c'>Pumplerod</a>
</div>
<a UTCms='1394929574000' class='quanto-date posted-at response-posted-at' href='#5324efa5cc1417f74300746c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I made a slight variation of your algo Grant, where I wanted to try and spread out the risk over a set of securities rather than just pick the security with the min z-score.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53251bf2f72cbf7d7300fb60' id='53251bf2f72cbf7d7300fb60'>
<a href='#53251bf2f72cbf7d7300fb60'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1394940916000' class='quanto-date posted-at response-posted-at' href='#53251bf2f72cbf7d7300fb60'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant I setup a framework to help manage things, like ensuring the pool of invested securities doesn&#39;t exceed my capital, etc.   I&#39;d share it but </p>

<p>1) it is my first-try so is a bit of a mess<br>
2) doesn&#39;t work with intraday so kind of pointless to design algorithms around this heavy framework<br>
3) potential disaster bugs:  as I described, when using the universe from 2003 to present, my algo goes crazy: starts exceeds the capital limits I put in place and then a month or two later the whole thing crashes to -100%    I&#39;m guessing it&#39;s hitting either a security that fails spectacularly, or one that gets delisted.  I&#39;ll try hard-coding the securities and A/B test them until I find the cause.<br>
4) no offline support:  so hard to debug, and slow to backtest  (I&#39;ve spent a good 100 hours on this over the last 2 weeks)</p>

<p>so when I resolve those issues I&#39;ll post the framework up on github no problem.     If someone wants my framework now just lemmi know, though I don&#39;t think it&#39;d be very useful to anyone but myself at the moment.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5325957453f242d66f01c7c4' id='5325957453f242d66f01c7c4'>
<a href='#5325957453f242d66f01c7c4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1394972023000' class='quanto-date posted-at response-posted-at' href='#5325957453f242d66f01c7c4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Pumplerod,</p>

<p>I had the same thought in the back of my mind.  I think that my next consideration will be to understand how to apply an accurate slippage model (which, in the end, would require validation via paper trading at IB).  If the whole idea falls apart with realistic slippage, then it&#39;s just an exercise in writing code.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53259f9adece74853901fd24' id='53259f9adece74853901fd24'>
<a href='#53259f9adece74853901fd24'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1394974619000' class='quanto-date posted-at response-posted-at' href='#53259f9adece74853901fd24'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>one thing I notice about my stochastic algo that may (or may not) be applicable to you,  but as my algo accumulates state over time, it&#39;s effectivively non-deterministic.  that means if I change the start date slightly the decisions my algo makes over time will be different.   I&#39;m thinking about changing it to look at fixed windows of history (recomputing the state each timestep) so it becomes deterministic.  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/market-closed-gap-trade'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/market-closed-gap-trade'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#721417171610131119320307131c061d021b131c5c111d1f">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
