<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
How to create a Break-Out model?
</title>
<meta content='Hi all, I&#39;m new here. Hope you guys help me build something here in the world of Python.I want to create a simple model, which is based on &#39;Break-Out&#39; strategy.In this post, I want to start with a simple one.For example, I want to build a &#39;5-day Break-Out&#39; strategy (intraday):Total Investment: 10000001st Long Entry:If price &gt; highest high over the past 5 days (Not the high price of 5 days ago!!) thenbuy 50% of maximum investment.2nd Long Entry:If price &gt; yesterday&#39;s high then buy the rest of...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="VezU3tAbu3giDbhyb7YJHUeRFbNxf6sx2Fatn7ot8lcpiqKTcu1pm5sQ4UMgWaFpfx822guzvipaWXb1EGiQ7A==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=false;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/how-to-create-a-break-out-model' property='og:url'>
<meta content='How to create a Break-Out model?' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/how-to-create-a-break-out-model' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='How to create a Break-Out model?' property='og:title'>
<meta content='Hi all, I&#39;m new here. Hope you guys help me build something here in the world of Python.I want to create a simple model, which is based on &#39;Break-Out&#39; strategy.In this post, I want to start with a simple one.For example, I want to build a &#39;5-day Break-Out&#39; strategy (intraday):Total Investment: 10000001st Long Entry:If price &gt; highest high over the past 5 days (Not the high price of 5 days ago!!) thenbuy 50% of maximum investment.2nd Long Entry:If price &gt; yesterday&#39;s high then buy the rest of...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/how-to-create-a-break-out-model">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='52e9b2aaad07e9fcb3000180'>
<div class='post-container' data-post-id='52e9b2aaad07e9fcb3000180' id='52e9b2aaad07e9fcb3000180'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>How to create a Break-Out model?</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/524c5c27f12db56c5e00004e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ad9fd24211bfdde17bbb79907e6dcbb2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/524c5c27f12db56c5e00004e'>Kyu P</a>
</div>
<span class='posted-at'>posted </span>
<span UTCms='1391047338000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=How to create a Break-Out model?&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fhow-to-create-a-break-out-model%3Futm_source%3Dwebsite_share%26utm_campaign%3Dhow-to-create-a-break-out-model%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fhow-to-create-a-break-out-model%3Futm_source%3Dwebsite_share%26utm_campaign%3Dhow-to-create-a-break-out-model%26utm_medium%3Dlinkedin&amp;title=How+to+create+a+Break-Out+model%3F+%28Kyu+P%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/how-to-create-a-break-out-model?utm_source=website_share&amp;utm_campaign=how-to-create-a-break-out-model&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Kyu P" />
<div class='body-text'>
<div class='body-text-container post-body'><p>Hi all, </p>

<p>I&#39;m new here. Hope you guys help me build something here in the world of Python.<br>
I want to create a simple model, which is based on &#39;Break-Out&#39; strategy.<br>
In this post, I want to start with a simple one.</p>

<hr>

<p>For example, I want to build a <strong>&#39;5-day Break-Out&#39;</strong> strategy (intraday):</p>

<p><strong>Total Investment</strong>: 1000000</p>

<p><strong>1st Long Entry</strong>:<br>
If price &gt; highest high over the past 5 days (Not the high price of 5 days ago!!) then<br>
buy 50% of maximum investment.</p>

<p><strong>2nd Long Entry</strong>:<br>
If price &gt; yesterday&#39;s high then buy the rest of 50% of maximum investment.</p>

<p><strong>Long exit</strong>:<br>
If price &lt; moving average (30) then sell all the current shares of long position.</p>

<p><strong>Short strategy is exactly opposite to Long strategy</strong>.</p>

<p><strong>Exit on close of day</strong>:<br>
Sell(if position is long) or BuytoCover(if short) all current shares at 15:55(EST).</p>

<hr>

<p>Please help me.<br>
Thank you.  </p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>11 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='52eaa1222e0427e9f0000028' id='52eaa1222e0427e9f0000028'>
<a href='#52eaa1222e0427e9f0000028'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52cacb99c2e27e441d0000d0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5cdb386e9f68cc7b45ee673d9ebea0d3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52cacb99c2e27e441d0000d0'>Deleted User</a>
</div>
<a UTCms='1391108388000' class='quanto-date posted-at response-posted-at' href='#52eaa1222e0427e9f0000028'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hey Kyu,</p>

<p>Regarding your long strategies, if the price is greater than the highest high over the past 5 days (1st Long Entry), then it must also be greater than yesterday&#39;s high (2nd Long Entry). For the 2nd Long Entry, you say &#39;buy the rest of 50% of maximum investment,&#39; but shouldn&#39;t it be &#39;buy the rest of 50% of maximum investment&#39;&#39; for the 1st Long Entry and &#39;buy 50% of maximum investment&#39; for 2nd Long Entry. I assume you would want to take a long position in 50% of the max investment if price &gt; yesterday&#39;s high and then 50% more (100% total) if the price is also greater than the 5 day high.</p>

<p>Let me know what you think.</p>

<p>Ryan  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52eab56005ead4b24800027b' id='52eab56005ead4b24800027b'>
<a href='#52eab56005ead4b24800027b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52cacb99c2e27e441d0000d0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5cdb386e9f68cc7b45ee673d9ebea0d3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52cacb99c2e27e441d0000d0'>Deleted User</a>
</div>
<a UTCms='1391113574000' class='quanto-date posted-at response-posted-at' href='#52eab56005ead4b24800027b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hey Kyu, </p>

<p>Here is a first attempt at coding your idea using Quantopian. Let me know your feedback.</p>

<p>Ryan</p>

<pre><code>import numpy as np  
from pytz import timezone  
from datetime import datetime, timedelta  
from zipline.utils.tradingcalendar import get_early_closes

def initialize(context):  
    # Choose asset to include in the algo  
    context.stock = sid(24)  
    # Initialize start and end dates to check for early closes  
    start_date = context.stock.security_start_date  
    end_date = context.stock.security_end_date  
    context.early_closes = get_early_closes(start_date,end_date).date  
    context.minutes_before_close = 5  
    # Setting our maximum position size  
    context.max_notional = 100000.1  
    context.min_notional = -100000.0

def handle_data(context, data):  
    price = data[context.stock].price  
    notional = context.portfolio.positions[context.stock].amount * price  
    # Compute maxmimum high price over the past five days  
    max_5_day_high = max(np.array(history(bar_count=5, frequency=&#39;1d&#39;, field=&#39;high&#39;)))  
    # Compute minimum low price over the past five days  
    min_5_day_low = min(np.array(history(bar_count=5, frequency=&#39;1d&#39;, field=&#39;low&#39;)))  
    # Compute yesterday&#39;s high  
    yesterday_high = np.array(history(bar_count=1, frequency=&#39;1d&#39;, field=&#39;high&#39;))  
    # Compute yesterday&#39;s low  
    yesterday_low = np.array(history(bar_count=1, frequency=&#39;1d&#39;, field=&#39;low&#39;))  
    # Compute the 30 day moving average  
    moving_avg_30 = data[context.stock].mavg(30)  
    # Long Strategy  
    if price &gt;=  max_5_day_high and notional &lt; context.max_notional:  
        print(&#39;Enter long strategy&#39;)  
        order_target_value(context.stock, context.max_notional)  
    elif price &lt;  max_5_day_high and price &gt;= yesterday_high and notional &lt; context.max_notional:  
        print(&#39;Enter long strategy&#39;)  
        order_target_value(context.stock, 0.5*context.max_notional)  
    # Exit long strategy  
    else:  
        if price &lt; moving_avg_30 and notional &gt; 0:  
            order_target_percent(context.stock, 0)  
    # Short Strategy  
    if price &lt;=  min_5_day_low and notional &gt; context.min_notional:  
        print(&#39;Enter short strategy&#39;)  
        order_target_value(context.stock, context.min_notional)  
    elif price &gt;  min_5_day_low and price &lt;= yesterday_low and notional &gt; context.min_notional:  
        print(&#39;Enter short strategy&#39;)  
        order_target_value(context.stock, 0.5*context.min_notional)  
    # Exit short strategy  
    else:  
        if price &gt; moving_avg_30 and notional &lt; 0:  
            order_target_percent(context.stock, 0)  
    # Exit position at end of day  
    if endofday_check(context) == True:  
        order_target_percent(context.stock, 0)  
    else:  
        pass

# Check for the end of the trading day  
def endofday_check(context):  
    # Converts all time-zones into US EST  
    loc_dt = get_datetime().astimezone(timezone(&#39;US/Eastern&#39;))  
    date = get_datetime().date()  
    # Checks for an early close on special dates - market closes at 1:00PM  
    if date in context.early_closes:  
        # Returns true if it&#39;s 1:00PM - minutes so in this case 12:55PM  
        if loc_dt.hour == 12 and loc_dt.minute == (60-context.minutes_before_close):  
            log.debug(get_datetime())  
            return True  
        else:  
            return False  
    # Returns true if it&#39;s 4:00PM EST - minutes so in this case at 3:55PM  
    # Daylight savings time are accounted for, so it will automatically adjust to DST  
    elif loc_dt.hour == 15 and loc_dt.minute == (60-context.minutes_before_close):  
        log.debug(get_datetime())  
        return True  
    else:  
        return False  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52eba9cae212a2dea300018f' id='52eba9cae212a2dea300018f'>
<a href='#52eba9cae212a2dea300018f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/524c5c27f12db56c5e00004e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ad9fd24211bfdde17bbb79907e6dcbb2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/524c5c27f12db56c5e00004e'>Kyu P</a>
</div>
<a UTCms='1391176140000' class='quanto-date posted-at response-posted-at' href='#52eba9cae212a2dea300018f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Ryan,</p>

<p>Thank you so much. Again, I&#39;m learning a lot.</p>

<p>However, it doesn&#39;t seem to work as I expected. I have another backtesting tool coded in different language, the result looks totally different.</p>

<p>Questions:<br>
1). If I set the moving avg to 180, this means that it is based on the calculation of past 180 minutes, right? (because this is a minute base backtest!)<br>
2). Can I add <strong>profit target</strong> and <strong>stop loss</strong> based on #of ticks?</p>

<p>Some problems:<br>
1). It does NOT seem to close all the open positions at the end of day.<br>
I added the following to see the log info for it as below.</p>

<pre><code>Exit position at end of day  
    if endofday_check(context) == True:  
        order_target_percent(context.stock, 0)  
        log.info(&#39;Exit, end of day&#39; + str(endofday_check(context)))  
    else:  
        pass  
</code></pre>

<p>But I can&#39;t see any logs showing that closed at the end of day.</p>

<p>2). Also, please see below. This is the logs after I tested with FAS :<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 109.776], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 109.442], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 109.442], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 109.137], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 108.414], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 108.109], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 107.998], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 107.637], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 107.637], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 106.926], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 106.609], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 105.915], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 105.415], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 105.387], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 104.665], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 104.165], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 103.478], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 103.192], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 102.359], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 102.276], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 102.276], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 101.831], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 100.498], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 99.998], -1000000.0<br>
2008-11-12handle_data:53INFOSE#1, 5L, [ 97.22], -1000000.0</p>

<p>(SE: Short Entry, 5L: 5-day Low.)</p>

<p>As you can see above, on 11/12/2008, total #25 short entry signals were generated based on 5-day low with min_notional. (Do we have unlimited cash??)<br>
This doesn&#39;t seem to be right. Isn&#39;t it supposed to be just 1 entry with max/min_notional?<br>
Please check this.</p>

<p>To make sure that this strategy goes to the right direction as I tested on other platform, I want to change this strategy simpler: </p>

<p>1). <strong>Entries are based on only <em>5-day high and 5-day low</em> with max/min_notional.</strong></p>

<p>2).I want to add <strong>profit target</strong> and <strong>stop loss</strong> based on the #of ticks. Is this possible here? Can you help me?<br>
For example, my profit target is 500 ticks up from my cost basis. And stop loss is 300 ticks down from my cost basis.<br>
So the <em>Sell</em> and <em>BuyToCover</em> orders should be <strong>Limit Order.</strong></p>

<p>3). Close at the end of day (15:55 EST): please double check this...</p>

<p>I really appreciate it in advance if you check all of these and correct all the bugs and errors if any.<br>
I&#39;m learning a lot from you and all the memebrs of this forum.</p>

<p>Thank you again.<br>
.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52ebc1452e0427bd7b000262' id='52ebc1452e0427bd7b000262'>
<a href='#52ebc1452e0427bd7b000262'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52cacb99c2e27e441d0000d0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5cdb386e9f68cc7b45ee673d9ebea0d3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52cacb99c2e27e441d0000d0'>Deleted User</a>
</div>
<a UTCms='1391182151000' class='quanto-date posted-at response-posted-at' href='#52ebc1452e0427bd7b000262'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hey Kyu,</p>

<p>Here are answers to your first two questions.</p>

<p>1) The argument to mavg specifies the number of days for the moving average, not minutes, even if the backtest is running in minute mode. mavg(180) would give the moving average of the past 180 days, not minutes.</p>

<p>2) Yes, you can add profit target and stop loss functions. Here are a few threads where community members have explored these issues.<br>
<a href="https://www.quantopian.com/posts/use-a-trailing-stop-loss">https://www.quantopian.com/posts/use-a-trailing-stop-loss</a><br>
<a href="https://www.quantopian.com/posts/auto-adjusting-stop-loss">https://www.quantopian.com/posts/auto-adjusting-stop-loss</a><br>
<a href="https://www.quantopian.com/posts/stops">https://www.quantopian.com/posts/stops</a><br>
<a href="https://www.quantopian.com/posts/simple-dual-vwap-with-percentage-based-take-profit-and-stop-loss">https://www.quantopian.com/posts/simple-dual-vwap-with-percentage-based-take-profit-and-stop-loss</a></p>

<p>I will continue to look at the other issues today.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52ebce2ee212a25e950001ec' id='52ebce2ee212a25e950001ec'>
<a href='#52ebce2ee212a25e950001ec'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52cacb99c2e27e441d0000d0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5cdb386e9f68cc7b45ee673d9ebea0d3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52cacb99c2e27e441d0000d0'>Deleted User</a>
</div>
<a UTCms='1391185455000' class='quanto-date posted-at response-posted-at' href='#52ebce2ee212a25e950001ec'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>1). It does NOT seem to close all the open positions at the end of day.</p>
</blockquote>

<p>Take a look at the attached backtest. From what I see, we place an order to close the position 5 minutes before close. We then check the outstanding orders one minute before close, and usually by this time all of the orders to exit the position have been filled, so there are no outstanding orders and the notional of the position is zero. Take a look at the logs.</p>

<p>Here are some of the changes to the code that generate the logs.</p>

<pre><code>if endofday_check_v2(context) == True:  
        log.info(&#39;End of day order check, time is %s&#39; % get_datetime().astimezone(timezone(&#39;US/Eastern&#39;)))  
        log.info(&#39;Notional is %s&#39;% notional)  
        # retrieve all the open orders and log the total open amount  
        # for each order  
        open_orders = get_open_orders()  
        # open_orders is a dictionary keyed by sid, with values that are lists of orders.  
        if open_orders:  
            # iterate over the dictionary  
            for security, orders in open_orders.iteritems():  
                # iterate over the orders  
                for oo in orders:  
                    message = &#39;Open order for {amount} shares in {stock}&#39;  
                    message = message.format(amount=oo.amount, stock=security)  
                    log.info(message)  
    else:  
        pass  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52ebd4f10c276e4cfc000056' id='52ebd4f10c276e4cfc000056'>
<a href='#52ebd4f10c276e4cfc000056'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52cacb99c2e27e441d0000d0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5cdb386e9f68cc7b45ee673d9ebea0d3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52cacb99c2e27e441d0000d0'>Deleted User</a>
</div>
<a UTCms='1391187186000' class='quanto-date posted-at response-posted-at' href='#52ebd4f10c276e4cfc000056'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><strong>2). Also, please see below. This is the logs after I tested with FAS :</strong></p>

<p>I apologize, I don&#39;t know what FAS is. Did you backtest the strategy on a different platform. In the logic below, the strategy should only place an order when the current notional value of the portfolio is within the investment limits specified by context.max_notional and context.min_notional. Does this help? While there may be 25 short entry &quot;signals&quot; in the day where the price falls below the minimum 5-day low. Perhaps not all of the orders are being filled by the next bar, so the system does not  recognize that the minimum notional has been reached. When I backtest with Quantopian, there are certainly not so many short entry signals.</p>

<pre><code>if price &gt;=  max_5_day_high and notional &lt; context.max_notional:  
        print(&#39;Enter long strategy&#39;)  
</code></pre>

<pre><code>if price &lt;=  min_5_day_low and notional &gt; context.min_notional:  
        print(&#39;Enter short strategy&#39;)  
</code></pre>

<p>Cheers,<br>
Ryan  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52ebe94e0c276e4cfc00007c' id='52ebe94e0c276e4cfc00007c'>
<a href='#52ebe94e0c276e4cfc00007c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52cacb99c2e27e441d0000d0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5cdb386e9f68cc7b45ee673d9ebea0d3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52cacb99c2e27e441d0000d0'>Deleted User</a>
</div>
<a UTCms='1391192400000' class='quanto-date posted-at response-posted-at' href='#52ebe94e0c276e4cfc00007c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I modified the code to include flags that indicate whether a long/short strategy has been exited on the day. Now, the algorithm should not enter into multiple long or short strategies in the same day, which should alleviate the issue that you encountered where 25 short entry signals were generated in a day. The algorithm right now does not re-open a position the following day after exiting the position at the end of the day. I assume you would want to re-enter the position the next trading day rather than starting with an empty portfolio.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52ebeea22e0427e9f00002bf' id='52ebeea22e0427e9f00002bf'>
<a href='#52ebeea22e0427e9f00002bf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52cacb99c2e27e441d0000d0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5cdb386e9f68cc7b45ee673d9ebea0d3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52cacb99c2e27e441d0000d0'>Deleted User</a>
</div>
<a UTCms='1391193768000' class='quanto-date posted-at response-posted-at' href='#52ebeea22e0427e9f00002bf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><strong>1). Entries are based on only 5-day high and 5-day low with max/min_notional.</strong></p>

<p>Here is a version that does this and does not include the signal for the 2nd Long/Short entry based on yesterday&#39;s price.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52ebfc9de212a2178b000252' id='52ebfc9de212a2178b000252'>
<a href='#52ebfc9de212a2178b000252'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/524c5c27f12db56c5e00004e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ad9fd24211bfdde17bbb79907e6dcbb2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/524c5c27f12db56c5e00004e'>Kyu P</a>
</div>
<a UTCms='1391197342000' class='quanto-date posted-at response-posted-at' href='#52ebfc9de212a2178b000252'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Ryan, </p>

<p>Thanks so much again.</p>

<p>1). If mavg is based on <em>only</em> <strong>daily</strong> basis, how can I create <strong>minute</strong> basis moving average? Should I create a function for this?</p>

<p>2). I see this model closes open positions at the end of day. However, I don&#39;t understand below.<br>
Please see the logs (this is with mavg(10) and 5_day entry model).</p>

<p>2014-01-27handle_data:96INFONotional is 0.0                                                         -->  <strong>It looks like closed all the open positions on 1/27</strong><br>
2014-01-28PRINTEnter short strategy                                                                       -->  <strong>Short entry on 1/28</strong><br>
2014-01-28endofday_check:129DEBUG2014-01-28 20:55:00+00:00<br>
2014-01-28handle_data:73INFOExit, end of day, time is 2014-01-28 15:55:00-05:00<br>
2014-01-28handle_data:74INFONotional is -100047.4002<br>
2014-01-28handle_data:90INFOOpen order for 198 shares in Security(24 [AAPL])<br>
2014-01-28PRINTEnter short strategy                                                                       --> <strong>Enter another short?? on the same day?</strong><br>
2014-01-28endofday_check_v2:151DEBUG2014-01-28 20:59:00+00:00<br>
2014-01-28handle_data:95INFOEnd of day order check, time is 2014-01-28 15:59:00-05:00<br>
2014-01-28handle_data:96INFONotional is -99593.35                                              -->  <strong>This looks like there&#39;s a still open position</strong><br>
2014-01-29endofday_check:129DEBUG2014-01-29 20:55:00+00:00<br>
2014-01-29handle_data:73INFOExit, end of day, time is 2014-01-29 15:55:00-05:00<br>
2014-01-29handle_data:74INFONotional is -98763.98                                               --> <strong>What is this?</strong><br>
2014-01-29handle_data:90INFOOpen order for 197 shares in Security(24 [AAPL])<br>
2014-01-29PRINTEnter short strategy<br>
2014-01-29endofday_check_v2:151DEBUG2014-01-29 20:59:00+00:00<br>
2014-01-29handle_data:95INFOEnd of day order check, time is 2014-01-29 15:59:00-05:00<br>
2014-01-29handle_data:96INFONotional is -99708.8704<br>
2014-01-30endofday_check:129DEBUG2014-01-30 20:55:00+00:00<br>
2014-01-30handle_data:73INFOExit, end of day, time is 2014-01-30 15:55:00-05:00<br>
2014-01-30handle_data:74INFONotional is -99386.57                                                        --> <strong>I&#39;m lost....</strong><br>
2014-01-30handle_data:90INFOOpen order for 199 shares in Security(24 [AAPL])<br>
2014-01-30endofday_check_v2:151DEBUG2014-01-30 20:59:00+00:00<br>
2014-01-30handle_data:95INFOEnd of day order check, time is 2014-01-30 15:59:00-05:00<br>
2014-01-30handle_data:96INFONotional is 0.0</p>

<p>End of logs. </p>

<p>Can you explain the logs above? I don&#39;t quite understand them. Please help me.<br>
<strong>Also, I just checked with other platform with same entry strategy, it generated short signals everyday from 1/28 to today(1/31). But this model did not generate short signal on 1/30.</strong></p>

<p>See also below <strong>Low</strong> prices that I got from Yahoo Finance:</p>

<p>Jan 30, 2014,   496.70<br>
Jan 29, 2014,   498.62<br>
Jan 28, 2014,   502.07<br>
Jan 27, 2014,   545.75 </p>

<p>3). I wanted to close all the positions at 15:55(EST) and start a new trading day with <strong>NO OPEN POSITION at 09:30(EST)</strong> daily.</p>

<p>4). </p>

<blockquote>
<p>Now, the algorithm should not enter into multiple long or short strategies in the same day, which should alleviate the issue that you encountered where 25 short entry signals were generated in a day. </p>
</blockquote>

<p>--> Why does this model NOT enter multiple enter in the same day? If the current shares are 0 after exit during the market session and if there&#39;s a right condition, it should generate any entry signals multiple times.  </p>

<blockquote>
<p>The algorithm right now does not re-open a position the following day after exiting the position at the end of the day.</p>
</blockquote>

<p>--> Why? </p>

<p>Sorry to keep asking you. I&#39;ve already learned a lot from you. But please help me a little more.</p>

<p>Thanks.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='52ec0738e212a2178b000269' id='52ec0738e212a2178b000269'>
<a href='#52ec0738e212a2178b000269'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b9b56c02cabe5dae000143'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e9388ae5102f3b152fa6225f955a29d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b9b56c02cabe5dae000143'>Alisa Deychman</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1391200057000' class='quanto-date posted-at response-posted-at' href='#52ec0738e212a2178b000269'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Kyu,</p>

<p>To chime in here, I wanted to clarify the differences in prices between Quantopian and Yahoo Finance. There is a difference between the last trade price and EOD price, which will not match. The last trade price is taken from the tick bar at 3:59PM and is used in Quantopian as &quot;close price&quot;. Yahoo EOD price is calculated from the closing auctions which are computed after market hours. Quantopian provides intraday minute data and does not cover the open/close auctions. However, the prices should match closely because you will receive the market open price at 9:31AM. For more info, see this thread here: <a href="https://www.quantopian.com/posts/load-bars-from-yahoo-values-differ-from-quantopian-values-dot-dot-dot">https://www.quantopian.com/posts/load-bars-from-yahoo-values-differ-from-quantopian-values-dot-dot-dot</a></p>

<p>And welcome to Quantopian! Keep firing questions, we&#39;re glad to help out. </p>

<p>Alisa  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='52ec0bd6e212a2178b000272' id='52ec0bd6e212a2178b000272'>
<a href='#52ec0bd6e212a2178b000272'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52cacb99c2e27e441d0000d0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5cdb386e9f68cc7b45ee673d9ebea0d3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52cacb99c2e27e441d0000d0'>Deleted User</a>
</div>
<a UTCms='1391201239000' class='quanto-date posted-at response-posted-at' href='#52ec0bd6e212a2178b000272'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hey Kyu,</p>

<p>It looks like the algorithm was entering a short position at the very end of the day (minutes before close) after the context.long_position_exited and context.short_position_exited flags were set back to zero. I made a change so the flags are set to zero at the beginning of the next day so multiple long or short strategies are not entered on the same day. Try the attached algo again and see the logs. Entering multiple long/short strategies daily (as opposed to only one) is a matter of preference (I am mostly trying to make an educational demonstration). You can change the code to allow multiple long positions in a day. I am also happy to help you write code to re-open the position at the beginning of the next day.</p>

<p>As of now, there is no function that computes a moving average at the minute level. This should be easy to code, however!</p>

<p>Ryan  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/how-to-create-a-break-out-model'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/how-to-create-a-break-out-model'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#593f3c3c3d3b383a3219282c38372d3629303837773a3634">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
