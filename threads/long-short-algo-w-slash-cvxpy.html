<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
long-short algo w/ CVXPY
</title>
<meta content='Here&#39;s a long-short algo with CVXPY, perhaps of interest.  Nothing too sexy, but it shows that CVXPY can be used. Note that although the long-term beta is low, there is nothing forcing a market neutral portfolio on a week-by-week basis, so a contest entry might not satisfy the abs(beta) &lt; 0.3 rule.' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="8mugHW2KK3tiP1CXzCTQ3qVe46r8+XZypFE6Y5s/67qODdZQz3z5mNsiCaaDy3iqndDAw4Y1Y2kmXuEJMXqJAQ==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=false;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/long-short-algo-w-slash-cvxpy' property='og:url'>
<meta content='long-short algo w/ CVXPY' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/long-short-algo-w-slash-cvxpy' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='long-short algo w/ CVXPY' property='og:title'>
<meta content='Here&#39;s a long-short algo with CVXPY, perhaps of interest.  Nothing too sexy, but it shows that CVXPY can be used. Note that although the long-term beta is low, there is nothing forcing a market neutral portfolio on a week-by-week basis, so a contest entry might not satisfy the abs(beta) &lt; 0.3 rule.' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/long-short-algo-w-slash-cvxpy">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='585a9ce026a993066f00001f'>
<div class='post-container' data-post-id='585a9ce026a993066f00001f' id='585a9ce026a993066f00001f'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>long-short algo w/ CVXPY</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<span class='posted-at'>posted </span>
<span UTCms='1482333408000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=long-short algo w/ CVXPY&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Flong-short-algo-w-slash-cvxpy%3Futm_source%3Dwebsite_share%26utm_campaign%3Dlong-short-algo-w-slash-cvxpy%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Flong-short-algo-w-slash-cvxpy%3Futm_source%3Dwebsite_share%26utm_campaign%3Dlong-short-algo-w-slash-cvxpy%26utm_medium%3Dlinkedin&amp;title=long-short+algo+w%2F+CVXPY+%28Grant+Kiehne%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class='tags tag-row'>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Mean Reversion' data-tag-id='55c50e7d8d4710ec6e00000d' href='/posts/tag/Mean-Reversion/newest'>Mean Reversion</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Portfolio Optimization' data-tag-id='55d33f293f6ba10061000000' href='/posts/tag/Portfolio-Optimization/newest'>Portfolio Optimization</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Market Neutral' data-tag-id='55d33f6e3f6ba10061000002' href='/posts/tag/Market-Neutral/newest'>Market Neutral</a>
</div>
<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/long-short-algo-w-slash-cvxpy?utm_source=website_share&amp;utm_campaign=long-short-algo-w-slash-cvxpy&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Grant Kiehne" />
<div class='body-text'>
<div class='body-text-container post-body'><p>Here&#39;s a long-short algo with CVXPY, perhaps of interest.  Nothing too sexy, but it shows that CVXPY can be used.</p>

<p>Note that although the long-term beta is low, there is nothing forcing a market neutral portfolio on a week-by-week basis, so a contest entry might not satisfy the abs(beta) &lt; 0.3 rule.  </p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>31 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='585af9f65a784c12cd00008d' id='585af9f65a784c12cd00008d'>
<a href='#585af9f65a784c12cd00008d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1482357246000' class='quanto-date posted-at response-posted-at' href='#585af9f65a784c12cd00008d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, I changed a single number in your trading strategy. Made 3 successive iteration with a slight increase each time. Here are the results:</p>

<p><a href="http://alphapowertrading.com/images/divers/CVXPY.png">http://alphapowertrading.com/images/divers/CVXPY.png</a></p>

<p>The question is: would you take it, meaning that slight increase? Would you accept the higher return with its higher risk? And where the added value would have for origin the change of one number in your program.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585afd5f067f32001200015e' id='585afd5f067f32001200015e'>
<a href='#585afd5f067f32001200015e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571d1bab2616ef09ce0002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a69e9457dd2832a76875bcae334d5baf?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571d1bab2616ef09ce0002b6'>Dan Whitnable</a>
</div>
<a UTCms='1482358116000' class='quanto-date posted-at response-posted-at' href='#585afd5f067f32001200015e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, this is very interesting! Two areas near to my heart - optimization and mean reversion. </p>

<p>Question, what are these two constraints trying to accomplish?</p>

<pre><code>cvx.sum_entries(x_tilde*x) &gt;= 1  
and  
 x &gt;= 0.2/m

</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585b2a1c067f3200120003ba' id='585b2a1c067f3200120003ba'>
<a href='#585b2a1c067f3200120003ba'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1482369571000' class='quanto-date posted-at response-posted-at' href='#585b2a1c067f3200120003ba'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, if the previous chart was not enough, just in case, and to make a point. By accepting higher drawdowns and higher volatility, one can push a trading strategy&#39;s performance higher.</p>

<p>You might not like the trading strategy&#39;s behavior, I don&#39;t know. But, nonetheless, higher returns are associated with higher risks. </p>

<p>I added two more incremental changes with the following results:</p>

<p><a href="http://alphapowertrading.com/images/divers/CVXPY_plus2.png">http://alphapowertrading.com/images/divers/CVXPY_plus2.png</a></p>

<p>From the above chart we can see the progression, higher volatility, higher beta, higher drawdown, but also higher CAGR. Based on the last column, one could say the opportunity cost of a single number change might amount to $ 117 million. Not bad for a digit. </p>

<p>Note, that I did not change any of the code logic, only that one number which step by step was incremented since it has a direct impact on n*u*PT, as in: (1+z)*n*u*PT.</p>

<p>But, as said, some might not like to trade that way. And, it might not be enough for others.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585b2b0a351e310015000437' id='585b2b0a351e310015000437'>
<a href='#585b2b0a351e310015000437'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1482369816000' class='quanto-date posted-at response-posted-at' href='#585b2b0a351e310015000437'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Guy - I can&#39;t really comment intelligently, since I don&#39;t know which &quot;single number&quot; you changed.</p>

<p>@ Dan - I&#39;ll post the code with a bunch of comments (probably tomorrow), and explain what I think the principle of the thing is, along with what the optimization constraints are intended to accomplish.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585b3234d200d90015000487' id='585b3234d200d90015000487'>
<a href='#585b3234d200d90015000487'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1482371641000' class='quanto-date posted-at response-posted-at' href='#585b3234d200d90015000487'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, the point I wanted to make is easy. Once you have a workable trading strategy as the one you provided, you can change a single number and change its mission considerably, even triple its CAGR. </p>

<p>Such a wide range of outcomes, without even changing a single line of code, does say that maybe the structure of the strategy itself might provide added benefits to a trading script. </p>

<p>Just wanted to let you know that it can be done, and with ease.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585beaff067f322d8300004c' id='585beaff067f322d8300004c'>
<a href='#585beaff067f322d8300004c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1482418950000' class='quanto-date posted-at response-posted-at' href='#585beaff067f322d8300004c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s an update, with comments.  Note that with 
<code>context.use_hedge = False</code> there is no SPY hedging instrument applied.  I&#39;ll post a version with <code>context.use_hedge = True</code> for comparison.</p>

<p>Hopefully my comments are helpful; if not, just let me know.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585bebf3704457594800046e' id='585bebf3704457594800046e'>
<a href='#585bebf3704457594800046e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1482419193000' class='quanto-date posted-at response-posted-at' href='#585bebf3704457594800046e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s the version with 
<code>context.use_hedge = True</code>.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585bfe50c2159e21f90001c9' id='585bfe50c2159e21f90001c9'>
<a href='#585bfe50c2159e21f90001c9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1482423896000' class='quanto-date posted-at response-posted-at' href='#585bfe50c2159e21f90001c9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Another run.  Take note:</p>

<p>No hedging instrument.<br>
Commissions &amp; slippage disabled.<br>
Daily trading, instead of weekly.</p>

<pre><code># control to determine use of hedging instrument  
    context.use_hedge = False  
    # disable slippage &amp; commissions  
    set_slippage(slippage.FixedSlippage(spread=0.00))  
    set_commission(commission.PerShare(cost=0, min_trade_cost=0))

    # get the portfolio weights  
    schedule_function(get_weights, date_rules.every_day(), time_rules.market_open(hours=1))  
    # place orders to adjust positions  
    schedule_function(rebalance, date_rules.every_day(), time_rules.market_open(hours=1))  
</code></pre>

<p>100 stocks instead of 50</p>

<pre><code>top_market_cap = market_cap.top(100, mask = (Q1500US() &amp; profitable))  
</code></pre>

<p>390 minute COM smoothing, instead of 30 minutes</p>

<pre><code># get minutely prices &amp; smooth  
    prices = data.history(context.stocks, &#39;price&#39;, 5*390, &#39;1m&#39;).dropna(axis=1)  
    context.stocks = list(prices.columns.values)  
    prices = prices.ewm(com=390).mean().as_matrix(context.stocks)  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585c084c70445732fc000205' id='585c084c70445732fc000205'>
<a href='#585c084c70445732fc000205'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571d1bab2616ef09ce0002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a69e9457dd2832a76875bcae334d5baf?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571d1bab2616ef09ce0002b6'>Dan Whitnable</a>
</div>
<a UTCms='1482426451000' class='quanto-date posted-at response-posted-at' href='#585c084c70445732fc000205'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, I&#39;ll confess that I didn&#39;t completely read (and comprehend) the article you referred to  &quot;On-Line Portfolio Selection with Moving Average Reversion&quot;, so this may be a naive question...</p>

<p>Why are you optimizing for the minimum distance from the current portfolio? At first glance wouldn&#39;t one want to optimize for the maximum profit like below</p>

<pre><code>    objective = cvx.Maximize(cvx.sum_entries(b_t*x)))


</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585c0ecf351e315a530000b6' id='585c0ecf351e315a530000b6'>
<a href='#585c0ecf351e315a530000b6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1482428122000' class='quanto-date posted-at response-posted-at' href='#585c0ecf351e315a530000b6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Dan W.</p>

<p>It seems counter-intuitive.  The basic idea is to minimize the &quot;distance&quot; between the old portfolio vector and the new one, subject to constraints.  The distance metric is not where the magic happens; it is used, since one wants to make the smallest change possible, while still satisfying the constraints.  Loosely, it&#39;s sorta like: remodel my house such that it is nearly exactly as before, except that I want it to be worth as much as possible on the market, given that I&#39;m unwilling to borrow money, and we only have so much to allocate to the various improvements.  Oh, and by the way, I&#39;d like to try to do something to every room in the house.</p>

<p>Presumably the optimization is pushing to meet the inequality constraint in the maximal way, adjusting 
<code>x</code> so that <code>cvx.sum_entries(x_tilde*x)</code> is a large as possible.  You could try <code>cvx.sum_entries(x_tilde*x) == 1</code> for comparison.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585c12605a784c5a57000108' id='585c12605a784c5a57000108'>
<a href='#585c12605a784c5a57000108'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1482429030000' class='quanto-date posted-at response-posted-at' href='#585c12605a784c5a57000108'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Rather than 
<code>cvx.sum_entries(x_tilde*x) == 1</code> you could try something like:</p>

<pre><code>constraints = [cvx.sum_entries(x) == 1, cvx.sum_entries(x_tilde*x) &gt;= 1, cvx.sum_entries(x_tilde*x) &lt;= 1.005, x &gt;= 0.5/m]  
</code></pre>

<p>The equality constraint may be too restrictive.  If <code>cvx.sum_entries(x_tilde*x) &gt;= 1</code> is better, then it would suggest that the optimizer is not stopping at  <code>cvx.sum_entries(x_tilde*x) == 1</code>.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585c154e70445775f9000035' id='585c154e70445775f9000035'>
<a href='#585c154e70445775f9000035'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571d1bab2616ef09ce0002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a69e9457dd2832a76875bcae334d5baf?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571d1bab2616ef09ce0002b6'>Dan Whitnable</a>
</div>
<a UTCms='1482429783000' class='quanto-date posted-at response-posted-at' href='#585c154e70445775f9000035'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Good analogy to the house remodeling. I&#39;ll need to think about this. Thanks!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585c97d98aa85e706d00000d' id='585c97d98aa85e706d00000d'>
<a href='#585c97d98aa85e706d00000d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1482463201000' class='quanto-date posted-at response-posted-at' href='#585c97d98aa85e706d00000d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, I continued to make some tests using your trading strategy. This time, I used your other program: the Long Only Mean Reversion with CVXPY. You will find those results in the second panel in the chart below. </p>

<p>The test conditions were the same. Each column used the same numbers as in the first program, and it was the only thing changed for that series of tests. This way, we can compare the two strategies all things considered. Not a single line of code was changed except for the numbers. This enabled comparing strategies as in: is strategy A better than strategy B?</p>

<p>Just by the numbers, I would prefer strategy A. Less volatility, smoother ride, better profits.</p>

<p>However, you made modifications to strategy A which at first glance appeared to not having improved the output even if you had put aside commissions and slippage. </p>

<p>I had to made a test of that too, but under the same conditions, meaning using the same numbers as in the previous tests. This way, each column would have this one number the same for each scenario.</p>

<h1>1  CVXPY Tests</h1>

<p><a href="http://alphapowertrading.com/images/divers/CVXPY_3tests_w_comms.png">http://alphapowertrading.com/images/divers/CVXPY_3tests_w_comms.png</a></p>

<p>The changes you made to strategy A really improved the overall performance as shown in the third panel. I reinstated the default frictional costs settings in that test in order to be on the same basis as in the first and second panel tests.</p>

<p>The main reason why panel 3 generates more profits is due to your modifications. They increased the number of trade candidates, the number of trade opportunities, and a lot more trades were taken. And since there is a positive edge in the methodology, it generated a lot more profits as in: (1+z)*n*u*PT. All 3 sets of tests had z increasing starting from 0.00.</p>

<p>If I had to choose, I would pick your last modifications (frictional costs included) even if the risks seem higher. I think I will be able to reduce those drawdowns when I will look at the code itself. I am not ready for that yet. One thing is sure, however, with your modifications the strategy trades a lot more. Maybe some of it might not be necessary or productive. But, nonetheless, it makes its money and that is what counts.</p>

<p>Thanks, it was interesting to see the tests pan out. Still being in my learning phase, your programs are helping me with a good example of things that could done with Quantopian. </p>

<p>In my opinion, the better strategy is in panel 3. Even if it did not look like it to start with.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='585d02698aa85e5ba700006a' id='585d02698aa85e5ba700006a'>
<a href='#585d02698aa85e5ba700006a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1482490480000' class='quanto-date posted-at response-posted-at' href='#585d02698aa85e5ba700006a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Guy -</p>

<p>Glad that you find the algos I posted useful.  I would definitely take the next step and formulate your own understanding and version.  I am a total amateur hack, in more domains than I know, including programming and finance.  In the grand scheme of things, I doubt that I&#39;ve done anything novel here.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58600487804b513732000433' id='58600487804b513732000433'>
<a href='#58600487804b513732000433'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1482687629000' class='quanto-date posted-at response-posted-at' href='#58600487804b513732000433'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, I continued to investigate your two CVXPY strategies. Here is some added analysis. </p>

<p>Refer to the chart in the previous post. Column 2 show some portfolio metrics of the original version of your programs. The strategy of interest is the Long - Short Algo (panels 1 and 3). The Long Only - Mean Reversion strategy (panel 2) can be viewed as just part of the also ran like not warranting the added risk for the lesser return than panel 1.</p>

<p>In the third panel version, you increased the number of  selectable trade candidates (doubled), and thereby increased the number of trade opportunities. However, these changes did not improve the overall picture. On the contrary, it slightly reduced performance. The move also increased frictional costs. We can&#39;t say that the metrics displayed for the original versions in panels 1 and 3 are that different. In panel 3, I used a different random seed number than pi (nice touch btw). but, that could not have had that much of an impact. I also reinstated frictional costs.</p>

<p>Based on performance results alone, I would say that the CVXPY method used is not significantly different than having bought an index equivalent (SPY). Technically, all that work but nothing to show for it. All the generated alpha being eaten up by the frictional costs on thousands and thousands of trades.</p>

<p>I had to find out why the modification I made to your programs increased performance. In my last post I proposed a tentative solution with the equation: A(t) = A(0) + (1+z)∙n∙u∙PT, as I increased z, I would be improving performance. There was some kind of linear relationship in there. After further analysis, it is more like:  A(t) = A(0) + (1+z)^t ∙n∙u∙PT. </p>

<p>And since z was the only number that was changed from test to test, I had to conclude that (1+z)^t was the only reason for the performance improvement. The boost in panel 3 compared to panel one was that you increased the number of trade opportunities which could be taken advantage of resulting in an increased number of trades.</p>

<p>I made other tests. I wanted to extract if it was indeed (1+z)^t or simply (1+z)? In the beginning the difference is not that large, it is only with time that the difference will show. Therefore, I made successive tests going back 5, 6, 7, 8, 9 and 10 years. What I wanted to see was if I would get an expanding spread above the benchmark? And it is what I got. Confirming that (1+z)^t was at play.</p>

<p>I was left with WHY? One explanation was that if  A(t) = A(0)∙(1+r)^t, was a CAGR representation of the portfolio, where r was the benchmark return, then, z to be accounted for must have had for impact:  A(t) = A(0)∙(1+r+z)^t. That is what made the difference. As I increased z, it increased general performance over time, imperceptibly at first, but still at a compounding rate. The more I increased z, as shown by the other columns in the presented chart, the more the performance would increase. It did this for all the tests. I did not test for upper limits, but a napkin calculation showed they were in sight. </p>

<p>The only reason for the improved performance was: (1+z)^t. Evidently, with z=0, you are back to square one. </p>

<p>After having done all that, I reached the conclusion that there was nothing in the original CVXPY methodology as presented. In the sense that it does not perform better than a benchmark, its alpha tends to zero: (α → 0).</p>

<p>With such a conclusion, I might as well find another strategy candidate with a better alpha potential. A strategy with some built in alpha will have for equation: A(t) = A(0)∙(1+r+α)^t, which I can then transform into: A(t) = A(0)∙(1+r+α+z)^t, leading to even higher performance levels since α and z can be expressed in CAGR terms.</p>

<p>So, sorry on that one. I find it is simply not enough to build on.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58601b42a9b1210015000086' id='58601b42a9b1210015000086'>
<a href='#58601b42a9b1210015000086'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1482693451000' class='quanto-date posted-at response-posted-at' href='#58601b42a9b1210015000086'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Guy -</p>

<p>My main objective was to &quot;kick the tires&quot; on the CVXPY implementation (recently released to Quantopian).  Perhaps it&#39;ll find some profitable use down the road.</p>

<p>Cheers,</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5885d6f0edb0d50588e4bfdc' id='5885d6f0edb0d50588e4bfdc'>
<a href='#5885d6f0edb0d50588e4bfdc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1485166320000' class='quanto-date posted-at response-posted-at' href='#5885d6f0edb0d50588e4bfdc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s another version to consider.  --Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5885d8e1c2175b2325f8dd42' id='5885d8e1c2175b2325f8dd42'>
<a href='#5885d8e1c2175b2325f8dd42'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1485166817000' class='quanto-date posted-at response-posted-at' href='#5885d8e1c2175b2325f8dd42'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s the tear sheet for the backtest immediately above.  --Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b5e53bebd945612a31de4f' id='58b5e53bebd945612a31de4f'>
<a href='#58b5e53bebd945612a31de4f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5798eb3a18ea41894c000720'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2357b9f052be40a501a0dab896e71674?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5798eb3a18ea41894c000720'>Joseph Everly</a>
</div>
<a UTCms='1488315707000' class='quanto-date posted-at response-posted-at' href='#58b5e53bebd945612a31de4f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant,</p>

<p>I was curious to fiddle around with CVXPY for optimization.  There is backtested strategy that I really like on the forum (<a href="https://www.quantopian.com/posts/trading-the-high-yield-low-volatility-stocks-of-the-s-and-p500">https://www.quantopian.com/posts/trading-the-high-yield-low-volatility-stocks-of-the-s-and-p500</a>) that uses pipeline to pull in the lowest volatility and highest yielding stocks, so I grabbed the pipeline logic from it and used your code for CVXPY to try to have it optimize the portfolio from just the list of highest yielding lowest volatility stocks.  I also made it long only.</p>

<p>Do you understand enough about the guts of CVXPY to understand why this backtest would show that the number of securities held consistently shrinks over time?  Performance is good, but the number of stocks held gets so low that risk is more concentrated.  I can&#39;t explain why the number of stocks held would shrink so much.  If you have any ideas, can you clue me in?</p>

<p>Thanks for your time!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b69b2ed50cab2084c911a3' id='58b69b2ed50cab2084c911a3'>
<a href='#58b69b2ed50cab2084c911a3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1488362286000' class='quanto-date posted-at response-posted-at' href='#58b69b2ed50cab2084c911a3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Joseph,</p>

<p>I made a few changes, and perhaps got your algo to work.  Note that it now trades daily, and for testing, I set:</p>

<pre><code>    set_slippage(slippage.FixedSlippage(spread=0.00))  
    set_commission(commission.PerShare(cost=0, min_trade_cost=0))  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b6dbb0c073192773a2ae9e' id='58b6dbb0c073192773a2ae9e'>
<a href='#58b6dbb0c073192773a2ae9e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5798eb3a18ea41894c000720'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2357b9f052be40a501a0dab896e71674?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5798eb3a18ea41894c000720'>Joseph Everly</a>
</div>
<a UTCms='1488378800000' class='quanto-date posted-at response-posted-at' href='#58b6dbb0c073192773a2ae9e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Awesome Grant!  Thank you so much!  I will study it and figure out the changes you made so I have a better understanding of it.  I plan to play around with the number of stocks - I believe that holding a smaller number of positions (~20 or so) should yield better results.</p>

<p>I appreciate your time,</p>

<p>Joseph  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b72f999481124cae3f2b7b' id='58b72f999481124cae3f2b7b'>
<a href='#58b72f999481124cae3f2b7b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5798eb3a18ea41894c000720'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2357b9f052be40a501a0dab896e71674?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5798eb3a18ea41894c000720'>Joseph Everly</a>
</div>
<a UTCms='1488400281000' class='quanto-date posted-at response-posted-at' href='#58b72f999481124cae3f2b7b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant,</p>

<p>Here is a somewhat optimized version (hopefully not too overfit) of the algorithm you helped me with.  I put commissions/slippage back in, because my hope is to eventually live trade something similar.  I also changed the lookback period (N) to 50 days, added some home-brewed stop-loss code, and reduced the universe of stocks down to the 10 lowest volatility, highest yielding stocks in the Q500 over the past 3 years.  I know this increases the risk, but I am personally not a fan of portfolios with too large a basket of stocks, partly because I don&#39;t have unlimited capital and want to limit my transaction costs.  Curious to get other people&#39;s opinions on the drawbacks of using something like this.  </p>

<p>DISCLAIMER: I know it isn&#39;t what Q is looking for in terms of an allocation, but I feel like something like this would work well for a retirement account.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b73f3a83b244000ab69f1f' id='58b73f3a83b244000ab69f1f'>
<a href='#58b73f3a83b244000ab69f1f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1488404282000' class='quanto-date posted-at response-posted-at' href='#58b73f3a83b244000ab69f1f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Intraday leverage hits 1.4, margin.<br>
It made 218k however required 196k to do so.  By that measure, 111%. Benchmark 101%.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b74cf483b2444781b69cb2' id='58b74cf483b2444781b69cb2'>
<a href='#58b74cf483b2444781b69cb2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5798eb3a18ea41894c000720'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2357b9f052be40a501a0dab896e71674?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5798eb3a18ea41894c000720'>Joseph Everly</a>
</div>
<a UTCms='1488407796000' class='quanto-date posted-at response-posted-at' href='#58b74cf483b2444781b69cb2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Blue - are you assuming that it used 1.4 leverage the entire time?  I know it isn&#39;t allowed in a retirement account, so the timing would have to be sorted out before you could use it to trade your IRA.  The target leverage is 1.0, and it appears to stay at 1.0 most of the time, but there may be times that a buy executes before a sell, which I would think could be fixed pretty easily.  I&#39;m not certain that I fully understand where you got the 196k number - it starts with 100k, and it certainly doesn&#39;t go 1.96 leverage at the outset, so I assume it uses 196k at some point during the backtest (prob at the point it hits 1.4 leverage).  Can you help me understand your math? </p>

<p>I ran a larger backtest, and it looks like this strategy didn&#39;t outperform until after 2008, so the &quot;hunt for yield&quot; may have something to do with it, and it may not work so well if interest rates rise.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b7512ad50cab2dd7c911b5' id='58b7512ad50cab2dd7c911b5'>
<a href='#58b7512ad50cab2dd7c911b5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1488408874000' class='quanto-date posted-at response-posted-at' href='#58b7512ad50cab2dd7c911b5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Blue -</p>

<p>I&#39;d be interested in understanding better, too.  Does leverage &gt; 1 as orders are being filled matter?  It should be the average gross leverage that is key, right?  You seem to be suggesting the the results are invalid by a lot.  Really?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b79ac8d50cab104ec91251' id='58b79ac8d50cab104ec91251'>
<a href='#58b79ac8d50cab104ec91251'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55f9ea41c51f6fe282000166'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/09d3ca2aba7e225443d1f3eab69d67ae?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55f9ea41c51f6fe282000166'>Maxim Girbu</a>
</div>
<a UTCms='1488427720000' class='quanto-date posted-at response-posted-at' href='#58b79ac8d50cab104ec91251'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I am wondering, is there a way to add the optimization constrain to pick the stocks with the lowest correlations  within the group ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b79ee0c30a634f6a06d3d6' id='58b79ee0c30a634f6a06d3d6'>
<a href='#58b79ee0c30a634f6a06d3d6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1488428768000' class='quanto-date posted-at response-posted-at' href='#58b79ee0c30a634f6a06d3d6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>500% returns are possible, just not as written currently, basically. I gave you the more real world default slippage/commissions figures by mistake, sorry about that. So please indulge me as I address that one.</p>

<p>In the past I have been sounding an alarm like results with huge margin are invalid by a lot, since then I think I&#39;m tempering to: We&#39;re going to get bitten if we think margin comes for free. And more importantly, we can write a lot higher quality algorithms if we open our eyes to any negative cash, quit turning a blind eye to it. It is a big positive for us to be on that firm footing, knowing. Or, the backtest is going to be way off compared to real money, real world, and that&#39;s unnecessary.</p>

<p>When I have brought this up, as I often do, over the last two years, I&#39;ve been mostly ignored so I&#39;m glad to see you guys at least not just casually brushing it aside. </p>

<p>In that algo with defaults, 96k was borrowed just for part of one day perhaps, or leverage does not always return to 1 by the end of the day and it just isn&#39;t visible due to chart smoothing. The leverage high happened around Apr 2012 while the largest dip into negative cash happened Aug 2016. They are both probably due to sells not going through, per the 2.5% default slippage. In the real market those might be executed. If not, then if one does not have a margin account, the buys will be rejected. With a margin account there will be costs not modeled. Can someone model margin costs?</p>

<p>Either way, results would be further away than is desirable in my opinion from what the chart shows, to be at all optimistic about the strategy, as is, or some algos out there that do that sort of thing (big borrowing) could even lead folks down a primrose path to painful losses. Not recommendable. However if you reign in negative cash then it will be a result that can be trusted a lot more. That encapsulates my point of view.</p>

<p>Here&#39;s the code with some instrumentation added to the zero slippage/commission version. If you really want to turn the lights on, add <a href="https://www.quantopian.com/posts/track-orders">track_orders</a> and set &#39;start&#39; to a date just before any area of interest, otherwise it might overwhelm the logging window or take a long time scrolling down to it. </p>

<p>There are various ways to delay buys until selling is done. I&#39;m confident you&#39;ll be happier with the results that way.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b7fa3a2a4106000a9f0c0c' id='58b7fa3a2a4106000a9f0c0c'>
<a href='#58b7fa3a2a4106000a9f0c0c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1488452154000' class='quanto-date posted-at response-posted-at' href='#58b7fa3a2a4106000a9f0c0c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Maxim -</p>

<p>Good question regarding minimizing the correlation.  I wonder if clustering would be better suited (e.g. <a href="http://scikit-learn.org/stable/auto_examples/applications/plot_stock_market.html">http://scikit-learn.org/stable/auto_examples/applications/plot_stock_market.html</a> ).  The ideas is to slice and dice the universe into groups of similar stocks, and then pick one (or more) from each group.</p>

<p>@ Blue -</p>

<p>Thanks.  I suppose that the most conservative approach would be to run the backtest, capturing the max leverage ever hit (minute-by-minute).  Then the gross leverage could be adjusted downward from 1.0 until the max minute-by-minute leverage is 1.0.  This puts a pot of cash on the side that earns no return, and so the overall return is dampened.  This way, with the standard Quantopian slippage and commission models, perhaps one would have a baseline of the worst-case; assuming the strategy is sound, it could only get better.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b82b504c2ade791415c5df' id='58b82b504c2ade791415c5df'>
<a href='#58b82b504c2ade791415c5df'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5674b7bd1869e73f4a000334'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e411d64f7a123f5c2102614fafa48b58?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5674b7bd1869e73f4a000334'>Luke Izlar</a>
</div>
<a UTCms='1488464720000' class='quanto-date posted-at response-posted-at' href='#58b82b504c2ade791415c5df'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant, it&#39;s not easy, but it&#39;s a lot better/accurate to write code that very strictly controls buying and selling to prevent the leverage spikes than to reduce leverage until they don&#39;t go above 1.0.  It&#39;s been on my mind a lot lately and I&#39;ve written/copied so much code attempting to deal with it. You have to first accurately model your cash, can&#39;t rely on quantopian&#39;s cash measurements, then you have to write your own order() function that basically does what order_target_percent() does because you can&#39;t rely on quantopians target functions. It&#39;s a real pain. I&#39;ve been meaning to compile and write a post that encompases a &quot;perfect&quot; ordering scheme but I haven&#39;t gotten around to it and I&#39;m not exactly a pro.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b84ff90e3f837441e4e1d7' id='58b84ff90e3f837441e4e1d7'>
<a href='#58b84ff90e3f837441e4e1d7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5798eb3a18ea41894c000720'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2357b9f052be40a501a0dab896e71674?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5798eb3a18ea41894c000720'>Joseph Everly</a>
</div>
<a UTCms='1488474105000' class='quanto-date posted-at response-posted-at' href='#58b84ff90e3f837441e4e1d7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Out of curiosity, I took the same algorithm and separated the buy and sell orders by 5 minutes (to hopefully make sure that stocks were sold before others were bought).  I also recorded the max leverage that Q observed each minute.  It did get up to 1.05 at one point, which I can certainly live with.  Results aren&#39;t materially different, but drawdown does increase quite a bit.</p>

<p>I have another question for those with experience in the matter: I did some searching, and I wasn&#39;t able to confirm whether or not IB charges any interest for intra-day margin.  The things I read indicated that they calculated it on what you were holding at the close.  This link indicates that most brokerages don&#39;t/shouldn&#39;t charge anything on intra-day - (<a href="https://www.elitetrader.com/et/threads/quick-question-on-margin-interest.87811/">https://www.elitetrader.com/et/threads/quick-question-on-margin-interest.87811/</a>).  Of course risk is increased, but only for a 1-2 minute period while transactions are executing, which I think it something I would be able to live with.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='58b940e54f831d7fd8d4495c' id='58b940e54f831d7fd8d4495c'>
<a href='#58b940e54f831d7fd8d4495c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1488535781000' class='quanto-date posted-at response-posted-at' href='#58b940e54f831d7fd8d4495c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I just posted:</p>

<p><a href="https://www.quantopian.com/posts/quantopian-and-robinhood-lessons-learned-and-best-practices">https://www.quantopian.com/posts/quantopian-and-robinhood-lessons-learned-and-best-practices</a></p>

<p>This might be a better place to discuss this business of &quot;non-margin&quot; trading.  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/long-short-algo-w-slash-cvxpy'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/long-short-algo-w-slash-cvxpy'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#87e1e2e2e3e5e6e4ecc7f6f2e6e9f3e8f7eee6e9a9e4e8ea">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
