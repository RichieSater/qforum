<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
All That Glitters Are Bugs! A Concrete Notebook Example
</title>
<meta content='I was preparing this algo for the new contest so all the settings are updated including new Fixed Basis Slippage, QTradableStocksUS,  and risk_loading_pipeline.  Ran a four year backtest and results seem to have potential. Ran a full roundtrip tearsheet and the evaluate backtest procedure to see compliance.  Below is link to image of backtest, followed by full tearsheet: Image of Backtest' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="fzhULayNKb3XKCpOTCPOMEy9DIwovWsmXmFqqnYcJ/0DXiJgDnv7Xm41c38DzGZEdDMv5VJxfj3cbrHA3FlFRg==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=false;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/all-that-glitters-are-bugs-a-concrete-notebook-example' property='og:url'>
<meta content='All That Glitters Are Bugs! A Concrete Notebook Example' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/all-that-glitters-are-bugs-a-concrete-notebook-example' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='All That Glitters Are Bugs! A Concrete Notebook Example' property='og:title'>
<meta content='I was preparing this algo for the new contest so all the settings are updated including new Fixed Basis Slippage, QTradableStocksUS,  and risk_loading_pipeline.  Ran a four year backtest and results seem to have potential. Ran a full roundtrip tearsheet and the evaluate backtest procedure to see compliance.  Below is link to image of backtest, followed by full tearsheet: Image of Backtest' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/all-that-glitters-are-bugs-a-concrete-notebook-example">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='5a65fe7553469f001c55dbc6'>
<div class='post-container' data-post-id='5a65fe7553469f001c55dbc6' id='5a65fe7553469f001c55dbc6'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>All That Glitters Are Bugs! A Concrete Notebook Example</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<span class='posted-at'>posted </span>
<span UTCms='1516633717000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=All That Glitters Are Bugs! A Concrete Notebook Example&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fall-that-glitters-are-bugs-a-concrete-notebook-example%3Futm_source%3Dwebsite_share%26utm_campaign%3Dall-that-glitters-are-bugs-a-concrete-notebook-example%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fall-that-glitters-are-bugs-a-concrete-notebook-example%3Futm_source%3Dwebsite_share%26utm_campaign%3Dall-that-glitters-are-bugs-a-concrete-notebook-example%26utm_medium%3Dlinkedin&amp;title=All+That+Glitters+Are+Bugs%21+A+Concrete+Notebook+Example+%28James+Villa%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/all-that-glitters-are-bugs-a-concrete-notebook-example?utm_source=website_share&amp;utm_campaign=all-that-glitters-are-bugs-a-concrete-notebook-example&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="James Villa" />
<div class='body-text'>
<div class='body-text-container post-body'><p>I was preparing this algo for the new contest so all the settings are updated including new Fixed Basis Slippage, QTradableStocksUS,  and risk_loading_pipeline.  Ran a four year backtest and results seem to have potential. Ran a full roundtrip tearsheet and the evaluate backtest procedure to see compliance.  Below is link to image of backtest, followed by full tearsheet:<br>
<a href="https://docs.google.com/document/d/1cylgNOqDnLuiKLe4tZn1Z1O8Sxz2V2kkE5q07TzaIUQ/edit?usp=sharing">Image of Backtest</a></p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>53 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='5a661296f6eb4b731399010d' id='5a661296f6eb4b731399010d'>
<a href='#5a661296f6eb4b731399010d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516638870000' class='quanto-date posted-at response-posted-at' href='#5a661296f6eb4b731399010d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>And here are the results of the evaluation of compliance.  It failed in 5 out of 9 tests! I need to do some further digging....</p>

<p>Checking positions concentration limit...<br>
FAIL: Max position concentration of 20.16% &gt; 5.0%.</p>

<p>Checking leverage limits...<br>
FAIL: Leverage range of 0.75x-1.19x is not between 0.8x-1.1x.</p>

<p>Checking turnover limits...<br>
PASS: Mean turnover range of 10.39%-22.71% is between 5.0%-65.0%.</p>

<p>Checking net exposure limit...<br>
FAIL: Net exposure (absolute value) of 32.82% on 2015-11-11 &gt; 10.0%.</p>

<p>Checking beta-to-SPY limit...<br>
FAIL: 99th percentile absolute beta of 0.43 &gt; 0.3.</p>

<p>Checking sector exposure limits...<br>
PASS: All sector exposures were between +/-0.20.</p>

<p>Checking style exposure limits...<br>
PASS: All style exposures were between +/-0.40.</p>

<p>Checking investment in tradable universe...<br>
FAIL: Investment in QTradableStocksUS of 0.00% on 2014-01-03 is &lt; 90.0%.</p>

<p>Checking that algorithm has positive returns...<br>
PASS: Cumulative returns of 1.30 is positive.</p>

<p>Results:<br>
4/9 tests passed.</p>

<p>Score computed between 2016-01-05 and 2018-01-19.<br>
Cumulative Score: 6.122867  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a66141ee7fa4665568b4696' id='5a66141ee7fa4665568b4696'>
<a href='#5a66141ee7fa4665568b4696'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516639262000' class='quanto-date posted-at response-posted-at' href='#5a66141ee7fa4665568b4696'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>And this is the block of algo code that deals with Optimize API and its constraints:  </p>

<pre><code>    # Setup Optimization Objective  
    objective = opt.MaximizeAlpha(predictions_top_bottom)

    # Setup Optimization Constraints  
    beta_neutral = opt.FactorExposure(  
        context.beta.dropna(),  
        min_exposures={&#39;beta&#39;: -MAX_BETA_EXPOSURE},  
        max_exposures={&#39;beta&#39;: MAX_BETA_EXPOSURE},  
    )  
    constrain_gross_leverage = opt.MaxGrossExposure(1.0)  
    constrain_pos_size = opt.PositionConcentration.with_equal_bounds(  
        -0.05,  
        +0.05,  
    )  
    market_neutral = opt.DollarNeutral()

    if predictions_top_bottom.index.duplicated().any():  
        log.debug(predictions_top_bottom.head())

    sector_neutral = opt.NetGroupExposure.with_equal_bounds(  
        labels=context.risk_factors.Sector.dropna(),  
        min=-0.2,  
        max=0.2,  
    )

    # Run the optimization. This will calculate new portfolio weights and  
    # manage moving our portfolio toward the target.  
    order_optimal_portfolio(  
        objective=objective,  
        constraints=[  
            constrain_gross_leverage,  
            constrain_pos_size,  
            market_neutral,  
            sector_neutral,  
            beta_neutral,  
        ],  
    )  
</code></pre>

<p>MAX_BETA_EXPOSURE = 0.3  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a661f9e53469f4ded55d070' id='5a661f9e53469f4ded55d070'>
<a href='#5a661f9e53469f4ded55d070'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1516642206000' class='quanto-date posted-at response-posted-at' href='#5a661f9e53469f4ded55d070'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>James, thanks for sharing this example. Looking at the results, I have a few comments and questions:</p>

<p><strong>General</strong><br>
It looks like there might be a data issue ~April 2017. Have you drilled into the positions on those days and see if anything jumps out as a data error? If not, would you be willing to create a support ticket and grant our support team permission to look at the backtest?</p>

<p><strong>Position Concentration</strong><br>
It looks like you only have 1-3 positions that are outside the 5% limit. If there&#39;s a data error in 2017, I&#39;m wondering if this is related. I&#39;d recommend looking into when your algorithm had its largest holdings and seeing if you can pinpoint the reason. On top of a data error, you should consider your rebalance frequency. For example, if you rebalance once per month, you might simply be holding names that go up or down in value enough to push them about the 5% limit. You could try supplying a stricter constraint to <code>order_optimal_portfolio</code> (maybe 3%?) to see how it affects the result.</p>

<p><strong>Leverage</strong><br>
On the lower end, it looks like your portfolio takes a bit of time to get to 1x leverage. Is that expected? I&#39;m wondering if you can create a rule for your algo to get into its initial portfolio a little more quickly. On the upper end, it looks like the spike in 2017 is pushing the algo over the 1.1x limit. Again, I&#39;m interested to know what&#39;s causing the sudden jump in returns.</p>

<p><strong>Dollar Neutral</strong><br>
In 2017, it looks like the dollar exposure jumps with the sudden jump in returns. However, it looks like there&#39;s a bigger drift between long and short holdings at the end of 2015. One reason that this could occur would be a slower rebalance schedule. Another could be that your orders for short positions are getting canceled. I&#39;d be interested to hear your thoughts on this.</p>

<p><strong>Beta-to-SPY</strong><br>
It looks like this algo is pretty consistently positively correlated with the market. Most of the time, it seems to be within the limit of 0.3, but I&#39;d recommend iterating on your alpha factor in research to see if it&#39;s inherently correlated to SPY. Of course, the issue might be tied to the long exposure, so I&#39;d suggest looking into that first. As mentioned in <a href="https://www.quantopian.com/posts/quantopian-contest-tutorial">this post</a>, we&#39;re working on content to help you with beta analysis in the research step.</p>

<p><strong>Tradable Universe</strong><br>
Unfortunately, without seeing the code, it&#39;s hard for me to dissect this one. Given that the failure is reporting 01/03/2014 as being 0% invested in the QTU, my first instinct is that the algo is slow to enter its initial portfolio, which may not be properly handled by the notebook. I&#39;ll have to investigate further. Same question as above on this: would it be possible for the algo to enter into its initial portfolio more quickly?</p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a66247453469f4ded55d0d4' id='5a66247453469f4ded55d0d4'>
<a href='#5a66247453469f4ded55d0d4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516643444000' class='quanto-date posted-at response-posted-at' href='#5a66247453469f4ded55d0d4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Let&#39;s tackle the easy ones first. This failure: </p>

<blockquote>
<p>Checking investment in tradable universe...<br>
FAIL: Investment in QTradableStocksUS of 0.00% on 2014-01-03 is &lt; 90.0%.</p>
</blockquote>

<p>My base universe is set to QTradableStocksUS.   On 2014-01-03, the first trading day of the algo, upon checking the transactions that day, I found out  all trades were done with ETFs something not allowed in the contest. So why did the algo execute these trades when my code instructs it to trade only the  QTradableStocksUS. Let&#39;s call this Bug #1, the cockroach type!</p>

<p>These next two failures are somewhat related:</p>

<blockquote>
<p>Checking positions concentration limit...<br>
FAIL: Max position concentration of 20.16% &gt; 5.0%.</p>
</blockquote>

<p>Checking leverage limits...<br>
FAIL: Leverage range of 0.75x-1.19x is not between 0.8x-1.1x.</p>

<p>Again we&#39;ve asked Optimize API to constraint these two to be within the contest thresholds.  Apparently, it did not accomplished its job.  But deeper digging in the Transactions section reveal that somewhere around 3/15/2017and 3/17/2017, something very strange happened with a particular stock, symbol &quot;LLEX&quot;, an energy company. Its price was at $0.13 at 3/15/2017 and shot up to $4.50 on 3/17/2017, made over $3 million that day! I thought maybe there was a reverse split that was not adjusted by the data provider or Quantopian  so I checked Yahoo historical data and there was no reported reverse split. So I have to conclude that this is a price reporting bug by Quantopian&#39;s data provider. But since it is potentially a two pronged bug (Optimize and price data) let&#39;s call Bug #2, the Beetle type .</p>

<p>The next failure is:</p>

<blockquote>
<p>Checking net exposure limit...<br>
FAIL: Net exposure (absolute value) of 32.82% on 2015-11-11 &gt; 10.0%.</p>
</blockquote>

<p>Wow,32.82% on  on 2015-11-11, I checked the Transactions on that day it has longs of about $970K and shorts of about $496K on 910 transactions. I&#39;m thinking maybe a lot of partial fills but I filtered for top 200 market cap. But again, why didn&#39;t Dollar Neutral constraint handle this well? So let&#39;s call this bug, the fly type.</p>

<p>The last failure:</p>

<blockquote>
<p>Checking beta-to-SPY limit...<br>
FAIL: 99th percentile absolute beta of 0.43 &gt; 0.3.</p>
</blockquote>

<p>I noticed while observing the algo run, beta was high in the beginning and slowly tapered off until its final ex post value of 0.24. Again, why did beta neutral constraint not take care of this? I&#39;ve already said a lot about this beta constraint, so for now let&#39;s just call this bug, the mosquito type!</p>

<p>So there you have it.  I&#39;d rather have the community and the Q staff comment and give feedbacks on these findings. I&#39;m exhausted already!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a662507e7fa464e128b45c8' id='5a662507e7fa464e128b45c8'>
<a href='#5a662507e7fa464e128b45c8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1516643591000' class='quanto-date posted-at response-posted-at' href='#5a662507e7fa464e128b45c8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, the strategy trades leveraged ETFs. Stuff like DUST and NUGT. Also trades ETNs, which, if I recollect, should not part of the QtradableStocksUS universe. </p>

<p>LLEX had a 1:10 reverse split 24/06/2016 which explains the huge jump in 2016.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a662913e7fa4614598b44f0' id='5a662913e7fa4614598b44f0'>
<a href='#5a662913e7fa4614598b44f0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516644628000' class='quanto-date posted-at response-posted-at' href='#5a662913e7fa4614598b44f0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie , thanks for your quick response. You beat me to the punch, just posted my findings. Please read and recomment. I would specially like you to comment on why Optimize API doesn&#39;t seem to be doing a good job in constraining to contest threshold.</p>

<p>@Guy, thanks for your feedback.  On the first day of trading  1/3/2014, the algo traded all ETFs which I know is not allowed in the contest. I have set my based universe to trade only QTradableStocksUS, so why did it do this? This one is definitely a code bug.  If in fact LLEX had a reverse split on  24/06/2016, why was it only reflected on 3/17/2017? Date of announcement vs. date of effectiveness? Still aren&#39;t we supposed to be working with  adjusted price to have apples to apples comparision? This one is definitely a price reporting bug.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a662aeae7fa4665568b4881' id='5a662aeae7fa4665568b4881'>
<a href='#5a662aeae7fa4665568b4881'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1516645098000' class='quanto-date posted-at response-posted-at' href='#5a662aeae7fa4665568b4881'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James: Any chance you could share your backtest + code so I can dig into the issues? If you created a support request, grant permission on the backtest, and mention that you&#39;d like me to take a look at it, I can go through our support channel to see what I can dig up. Unfortunately, I&#39;m fairly limited to asking questions instead of answering them without seeing the code. Most of your findings are correct, but I don&#39;t yet agree with the conclusion that the Optimize API is failing. The behavior could have several possible explanations (I mentioned some of them, like trade frequency, above). I&#39;ll need to dig into the code to figure out exactly what&#39;s going on.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a662ec2f6eb4b732f99011a' id='5a662ec2f6eb4b732f99011a'>
<a href='#5a662ec2f6eb4b732f99011a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516646082000' class='quanto-date posted-at response-posted-at' href='#5a662ec2f6eb4b732f99011a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, at this point I&#39;d rather not because as I mentioned in my opening that this algo is potentially my contest entry, after I sort out the kinks.  But the basic code is a clone from &quot;Machine Learning Part III&quot;.  The only changes I made were: </p>

<p>1.change base universe to QTradableStocksUS<br>
2. change alpha factors with my  3 secret sauces<br>
3. added beta costraint to Optimize API (as shown in blockquote above)<br>
4. set all constraints to match contest thresholds.(as shown in blockquote above)<br>
5. No. of training days to 126<br>
6. No. of forward predict days to 1.<br>
7. Almost forgot, change type of Classifier</p>

<p>While you&#39;re at It, would also like to also direct you and other Q staff to my other findings in these threads :  <a href="https://www.quantopian.com/posts/possible-implementation-bug-with-beta">possible-implementation-bug-with-beta</a> and <a href="https://www.quantopian.com/posts/beta-constraint-in-risk-model-totally-unnecessary">beta-constraint-in-risk-model-totally-unnecessary</a></p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a6634c953469f4ded55d285' id='5a6634c953469f4ded55d285'>
<a href='#5a6634c953469f4ded55d285'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516647625000' class='quanto-date posted-at response-posted-at' href='#5a6634c953469f4ded55d285'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Karl, thanks but no thanks on your suggestions. You like me to give you a tutorial on Optimize API and debug your overfitted code?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a663916e7fa465e138b44f3' id='5a663916e7fa465e138b44f3'>
<a href='#5a663916e7fa465e138b44f3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516648726000' class='quanto-date posted-at response-posted-at' href='#5a663916e7fa465e138b44f3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Karl, again with your bad habit of deleting posts. On your PS of your just deleted post, you got to be kidding me, on where the parameters  of Optimize API should be or is &quot;missing&quot;.  Look and stare at the code which is the Q model code. You&#39;re just sourgraping because I&#39;ve schooled you several times. Be a man, man!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a663e1a53469f6b6f55d007' id='5a663e1a53469f6b6f55d007'>
<a href='#5a663e1a53469f6b6f55d007'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1516650010000' class='quanto-date posted-at response-posted-at' href='#5a663e1a53469f6b6f55d007'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James: Here are some of the first steps that I would recommend taking to debug:</p>

<ol>
<li>Look at the objective function being passed to <code>order_optimal_portfolio</code> on day 1. Does it include the ETFs? If so, there might be a bug in the pipeline, or the construction of the objective function.<br></li>
<li>Figure out the cause of the jump in returns in March/April 2017. If you look at the positions on the day before and the day after the jump, you will likely be able to find a single asset causing the problem. If that&#39;s the case, let me know which it is, what the date of the price jump (or drop) is, and roughly how big the change is.<br></li>
<li>If you are calling <code>order_optimal_portfolio</code> less frequently than daily, try to determine if your constraints are failing the day of/after the call to <code>order_optimal_portfolio</code>, or if the portfolio is drifting and failing the constraints later in the week/month.</li>
</ol>

<p>Remember, the Optimize API does not guarantee that your portfolio will satisfy all of the contest constraints. Here are a few important properties to know about using <code>order_optimal_portfolio</code>.<br>
- The constraints supplied to <code>order_optimal_portfolio</code> are not applied on a continuous basis, they are applied once when the algorithm places its orders.<br>
- The constraints supplied to <code>order_optimal_portfolio</code> are based on historical data, which can vary in predictiveness for different metrics.<br>
- Portfolio-level metrics like beta-to-SPY are controlled with per-asset constraints, which tends to have more variance in success.</p>

<p>There is no guarantee that constraining your portfolio on historical data means that it will adhere to the constraint in perpetuity. Take an extreme, but simple example where you have a <code>TargetPortfolioWeights</code> objective specifying a target of 50% in asset AAAA and 50% in BBBB. Let&#39;s say you supply a max position constraint of 50% to <code>order_optimal_portfolio</code>. Let&#39;s assume when <code>order_optimal_portfolio</code> is called, your orders fill exactly at the price at which the order was placed, and you get 50% AAAA and 50% BBBB in your portfolio. The next day, the price of AAAA doubles, and now your portfolio is 67% AAAA and 33% BBBB. In this example, we supplied a constraint of 50% max position concentration which was respected when we placed our orders. However, the next day, our portfolio exceeded this limit since we didn&#39;t re-check the status of our portfolio. This is something that needs to be handled by the algorithm.</p>

<p>While the example might be a bit extreme, I&#39;m trying to demonstrate that the risk metrics of a portfolio aren&#39;t solely controlled by the Optimize API. To account for something like price drift, I&#39;d recommend leaving a cushion on certain constraints like position concentration (try specifying something less than 5%). If your algorithm checks its signal on a weekly basis, you might still want to use <a href="https://www.quantopian.com/help#quantopian_optimize_calculate_optimal_portfolio">calculate_optimal_portfolio</a> on a daily basis to make sure you don&#39;t drift too far from a portfolio that lives within the constraints of the contest.</p>

<p>Finally, on the other thread about beta, my take is that you&#39;ve identified that supplying a constraint based on historical, per-asset beta is frequently not a great way to predict tomorrow&#39;s portfolio beta. We&#39;re working on a content piece that analyzes beta-to-SPY at the research step of an alpha factor, which might be a better way to control portfolio beta. I think there are also a series of experiments that can be done to see if there are other per-asset constraints that can be supplied to constrain portfolio beta. You mentioned the similarities between beta-to-SPY and dollar neutrality, so there may be some algos that simply don&#39;t need a separate constraint for beta. Of course, there may still be some algos that do benefit from some sort of extra beta constraint. One thing you could try is defining a slightly different per-asset beta that is partly based on a prior assumption that assets have a beta-to-SPY of 1. There&#39;s an example of this in the <a href="https://www.quantopian.com/lectures/example-long-short-equity-algorithm">long-short equity lecture example</a>. There&#39;s not necessarily one solution that applies to every algo, so I think it&#39;s worth experimenting and figuring out what works best for your case.</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a664b75f6eb4b5bcf99016c' id='5a664b75f6eb4b5bcf99016c'>
<a href='#5a664b75f6eb4b5bcf99016c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1516653429000' class='quanto-date posted-at response-posted-at' href='#5a664b75f6eb4b5bcf99016c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, notwithstanding everything that was said in prior posts, there is a “bug” in the tear sheet with the round-trip calculations.</p>

<p>You have a strategy doing some 42,658 trades with an average net profit per trade of –$41.98 resulting in a loss of: –$1,790,806.99. How can the charts show a positive return? The charts or the calculations are right, but not both!</p>

<p><img src="https://image-proxy.quantopian.com/e679055618985747d85db651fb281ec25b473c60/687474703a2f2f616c706861706f77657274726164696e672e636f6d2f7175616e746f7069616e2f506f737369626c655f4275675f4a616d65735f30322e706e67" />  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a66513ff6eb4b4b6c9904a8' id='5a66513ff6eb4b4b6c9904a8'>
<a href='#5a66513ff6eb4b4b6c9904a8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516654911000' class='quanto-date posted-at response-posted-at' href='#5a66513ff6eb4b4b6c9904a8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Guy, nice catch!  Yeah, so which is right the chart or the PnL report? Head scratch!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a665bd6e7fa4612098b46ac' id='5a665bd6e7fa4612098b46ac'>
<a href='#5a665bd6e7fa4612098b46ac'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516657622000' class='quanto-date posted-at response-posted-at' href='#5a665bd6e7fa4612098b46ac'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, aside from Guy&#39;s recent catch . Let&#39;s breakdown what we know so far:</p>

<ol>
<li><p>Price reporting bug on LLEX ,  price on 3/15/17 is $0.13 and shot up to $4.50 on 3/17/2017, The  10:1 reverse split was not adjusted by your data provider. I don&#39;t know if Q internally does a data integrity check  of data provider&#39;s data.  If not then I think you should.</p></li>
<li><p>On algo trading ETFs , I don&#39;t  really know but it could well be on my end. I&#39;ll double check again.</p></li>
<li><p>On Optimize API&#39;s ability to constrain effectively, the jury is still out on this. As you illustrated above in your two stock example, the disconnect is in Optimize API&#39;s inability to see the ex post factos and thus sometimes results in disparities.  As there are going to be black swan events now and then , perhaps the solution is relaxing the restrictions in the thresholds to account for these occurences. If for example leverage thresholds is violated only once or twice a year, then it can still pass the test.</p></li>
<li><p>On the other thread, I think exposing beta calculation to be user configurable is a huge problem.  Once you let the user change regression lengths of beta calculation, then the beta threshold becomes relative to its window length, I don&#39;t think this is the intent.  </p></li>
</ol>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a666618f6eb4b543e99014d' id='5a666618f6eb4b543e99014d'>
<a href='#5a666618f6eb4b543e99014d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1516660248000' class='quanto-date posted-at response-posted-at' href='#5a666618f6eb4b543e99014d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James, I did a bit of digging on LLEX. It looks like the stock split occurred in 2016 as <a href="https://www.thestreet.com/story/13619548/1/lilis-energy-executes-110-reverse-stock-split--files-for-nasdaq-relisting.html">LLEX was filing for NASDAQ relisting</a>. Unfortunately, we do not get data for OTC stocks, so our pricing data looks like it has a bit of a gap between when the stock was delisted and when it was relisted. This is a limitation of the platform.</p>

<p>The good news is that LLEX wasn&#39;t in the QTU (see the bottom part of the attached notebook), so once you figure out the issue with the universe, the data issue should go away with it.</p>

<ol>
<li><p>The contest requirements will have some protection against outlier events, but the algo you shared in this post still won&#39;t meet some of the criteria. We&#39;ll have more on the exact outlier guarding in the next couple of weeks.</p></li>
<li><p>To be clear, the portfolio beta risk metric is not defined by the algo author. The same definition is used for all backtests. I&#39;m suggesting that authors can decide what is best used to control the beta of their algorithm (I&#39;m not sure if we disagree on this one, or if there&#39;s just a misunderstanding).</p></li>
</ol>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a6670ac53469f273555d078' id='5a6670ac53469f273555d078'>
<a href='#5a6670ac53469f273555d078'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516662956000' class='quanto-date posted-at response-posted-at' href='#5a6670ac53469f273555d078'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, thanks for your response. The issue of ETF and OTC trades could well be on my end, just have to find it.</p>

<p>On no.2 above,  going by the Q model code, beta calculation is done in the pipeline and regression length can be changed by the author, i.e . your default is 260  which I could change to 5 . The result of this calculation is picked by the beta constraint in Optimize API and checked against the set min/max beta exposure. Changing window lengths of beta will also change the distribution of betas threfore the beta threshold of +- 0.3 now becomes relative to the window length, and I don&#39;t think this is the intend.  I suspect there is also another beta calculation inside Optimize API. If this is true, then the question now is which one takes precedence and how is the interplay between these two calculations affecting constraining beta?   I hope I made my point clearer.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a67043f75ebca0015f95adb' id='5a67043f75ebca0015f95adb'>
<a href='#5a67043f75ebca0015f95adb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516700735000' class='quanto-date posted-at response-posted-at' href='#5a67043f75ebca0015f95adb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Jamie -</p>

<blockquote>
<p>We&#39;re working on a content piece that analyzes beta-to-SPY at the research step of an alpha factor, which might be a better way to control portfolio beta.</p>
</blockquote>

<p>As you suspect, <a href="https://www.quantopian.com/posts/building-a-better-beta">building a better beta</a> will require constructing a beta factor that is predictive across the 
<code>QTradableStocksUS</code>.  To this end, it would be interesting to understand how good <code>SimpleBeta</code> is in predicting beta, and for which stocks it works, and for which it falls apart.  For example, there is evidence that for high-volatility stocks, it is a poor predictor:</p>

<pre><code>universe = (  
        AnnualizedVolatility(mask=QTradableStocksUS())  
        .percentile_between(85, 100))  
</code></pre>

<p>It would be interesting to know the predictability of beta versus an arbitrary &quot;slice&quot; of the <code>QTradableStocksUS</code>.  Additionally, my intuition at this point is that tightly controlling beta to zero (by picking an appropriate &quot;slice&quot; of the <code>QTradableStocksUS</code>) will make it very challenging to do much better than the risk-free rate, over the long term, on average.  In other words, if the universe is selected solely for the purpose of obtaining beta ~ 0, it won&#39;t have enough variability for profitable trading.  Trying to control beta to zero and at the same time making an uncorrelated profit, on a portfolio of 100-150 stocks, may be near impossible; a portfolio of stocks with predictable betas won&#39;t be so &quot;tradable.&quot;</p>

<p>I&#39;d also be interested in your comments on computing beta using <a href="https://www.quantopian.com/posts/ols-vs-tls-for-regression">OLS versus TLS</a>.  The potential pitfall in applying the former is <a href="https://en.wikipedia.org/wiki/Regression_dilution">regression dilution</a>.</p>

<p>Finally, regarding the <code>QTradableStocksUS</code> constraint, as I understand, the composition changes versus time.  So is the test being applied point-in-time?  For example, if the algo doesn&#39;t exit stocks that are no longer in the <code>QTradableStocksUS</code>, will it fail the constraint?</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a671520ba5f4e001a22efdc' id='5a671520ba5f4e001a22efdc'>
<a href='#5a671520ba5f4e001a22efdc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516705056000' class='quanto-date posted-at response-posted-at' href='#5a671520ba5f4e001a22efdc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Jamie -</p>

<p>You are welcome to look at this, as well (code published for the masses):</p>

<p><a href="https://www.quantopian.com/posts/new-contest-entry-trial">https://www.quantopian.com/posts/new-contest-entry-trial</a></p>

<p>What is the standard tear sheet to be using?  Perhaps you could run it, and attach it there.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a67235fba5f4e17d422f0df' id='5a67235fba5f4e17d422f0df'>
<a href='#5a67235fba5f4e17d422f0df'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516708703000' class='quanto-date posted-at response-posted-at' href='#5a67235fba5f4e17d422f0df'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Grant, went out on a hot date yesterday? Hope you enjoyed your brief respite. Anyway, you have raised some very good and interesting points above and would like to hear about the outcome of Q&#39;s research and tests regarding these.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a67296f4bbe85001bdd212a' id='5a67296f4bbe85001bdd212a'>
<a href='#5a67296f4bbe85001bdd212a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516710255000' class='quanto-date posted-at response-posted-at' href='#5a67296f4bbe85001bdd212a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, I took  a look at  Q documentation on Optimization  and quote below some snippets of it with emphasis being bold:</p>

<blockquote>
<p>order_optimal_portfolio(objective, constraints)<br>
Calculate an optimal portfolio and place orders toward that portfolio.</p>
</blockquote>

<p>Parameters:<br>
objective (Objective) -- The objective to be minimized/maximized by the new portfolio.<br>
constraints (list[Constraint]) -- Constraints that must be respected by the new portfolio.<br>
universe (iterable[Asset]) -- DEPRECATED. This parameter is ignored.<br>
<strong>Raises:<br>
InfeasibleConstraints -- Raised when there is no possible portfolio that satisfies the received constraints.</strong><br>
UnboundedObjective -- Raised when the received constraints are not sufficient to put an upper (or lower) bound on the calculated portfolio weights.<br>
Returns:<br>
order_ids (pd.Series[Asset -&gt; str]) -- The unique identifiers for the orders that were placed.</p>

<p>Debugging Optimizations<br>
<strong>One issue users may encounter when using the Optimize API is that it&#39;s possible to accidentally ask the optimizer to solve problems for which no solution exists</strong>. There are two common ways this can happen:</p>

<p><strong>There is no possible portfolio that satisfies all required constraints. When this happens, the optimizer raises an InfeasibleConstraints exception.</strong><br>
The constraints supplied to the optimization fail to enforce an upper bound on the objective function being maximized. When this happens, the optimizer raises an UnboundedObjective exception.<br>
Debugging an UnboundedObjective error is usually straightforward. UnboundedObjective is most commonly encountered when using the MaximizeAlpha objective without any other constraints. Since MaximizeAlpha tries to put as much capital as possible to the assets with the largest alpha values, additional constraints are necessary to prevent the optimizer from trying to allocate &quot;infinite&quot; capital.</p>

<p>Debugging an InfeasibleConstraints can be more challenging. If the optimizer raises InfeasibleConstraints, <strong>it means that every possible set of portfolio weights violates at least one of our constraints</strong>. Since different portfolios may violate different constraints, there may not be a single constraint we can point to as the culprit</p>

<p>One symptom that code implementation is broken is when the purpose of the code does not attain its objective or some operation of the code is not triggering when it&#39;s suppose to.</p>

<p>In the above notebook example, on day one of trading the algo, right of the bat, violated the  QTradableStocksUS constraint. Shouldn&#39;t the Optimize API via the order_optimal_portfolio operation halted and raised the InfeasibleConstraints Error, saving the user and Q computational resources? The documentation says it should but it doesn&#39;t. This is part of my reasoning why I suspect that from the perspective of code implementation, Optimize API may not be doing its job properly and efficiently.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a6738c3ba5f4e72cf22e854' id='5a6738c3ba5f4e72cf22e854'>
<a href='#5a6738c3ba5f4e72cf22e854'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1516714179000' class='quanto-date posted-at response-posted-at' href='#5a6738c3ba5f4e72cf22e854'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James: Unfortunately, there&#39;s no way to supply <code>QTradableStocksUS</code> as a constraint to <code>order_optimal_portfolio</code>. Instead, your portfolio will be selected from the universe of stocks defined in your <code>objective</code> function. I suspect that if you look at <code>predictions_top_bottom</code> in your code, you might find names that aren&#39;t in the QTU. Looking at that variable is the best place to start debugging this behavior.</p>

<p>On your point above about beta, there is no other beta constraint computed by Optimize. Optimize only knows about historical/current pricing and volume data plus the objective and constraints you supply. Even the <code>beta_neutral</code> constraint is defined as a general <code>FactorExposure</code> constraint. </p>

<blockquote>
<p>by the Q model code, beta calculation is done in the pipeline and regression length can be changed by the author, i.e . your default is 260 which I could change to 5 . The result of this calculation is picked by the beta constraint in Optimize API and checked against the set min/max beta exposure.</p>
</blockquote>

<p>You&#39;re right that you can modify the beta definition that you use in the constraint. The way you should think about this is that we are asking the community to write algorithms that meet specific criteria. You can achieve these criteria however you&#39;d like. To help you achieve these, we build and publish tools for you to use. Some of the tools we published are strictly required, because we don&#39;t believe it&#39;s reliable to meet the constraint without using it (e.g. QTU). For others, we suggest possible use cases, but ultimately leave it up to you how you want to achieve the criteria. I think the position concentration example is a good example of this. There&#39;s a <code>PositionConcentration</code> constraint that you can use to control your position concentration, but you can choose the bounds, the frequency at which you check the constraint (how frequently you call <code>order_optimal_portfolio</code>), and more. This is no different for beta-to-SPY.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a6753c9ba5f4e729822ea47' id='5a6753c9ba5f4e729822ea47'>
<a href='#5a6753c9ba5f4e729822ea47'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516721097000' class='quanto-date posted-at response-posted-at' href='#5a6753c9ba5f4e729822ea47'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie,</p>

<blockquote>
<p>Unfortunately, there&#39;s no way to supply QTradableStocksUS as a constraint to order_optimal_portfolio. Instead, your portfolio will be selected from the universe of stocks defined in your objective function. </p>
</blockquote>

<p>Ok, I can understand that there is no way to suppy QTU as a constraint. But from a code implementation perspective and efficiency, you can do this:  </p>

<pre><code>    # Run the optimization. This will calculate new portfolio weights and  
    # manage moving our portfolio toward the target.  
    algo.order_optimal_portfolio(  
        objective=objective,  
        constraints=[  
            constrain_gross_leverage,  
            constrain_pos_size,  
            market_neutral,  
            sector_neutral,  
            beta_neutral,  
        ],  
    )  
#Pseudo code after each call to order_optimal_portfolio to account for contest criteria that is not in Optimize API  
if stock selection is not &gt;= 90% of QTU then halt operation and give Error Code: &quot;did not meet QTU criterion&quot;  
or if Mean Daily Turnover &lt; 5% or &gt; 65% of Trailing 90 days then halt operation and give Error Code: &quot;did not meet Daily Turnover criterion&quot;.  
</code></pre>

<p>Isn&#39;t this more efficient, code flow wise?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a67570fba5f4e001a22f522' id='5a67570fba5f4e001a22f522'>
<a href='#5a67570fba5f4e001a22f522'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516721935000' class='quanto-date posted-at response-posted-at' href='#5a67570fba5f4e001a22f522'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie,</p>

<blockquote>
<p>On your point above about beta, there is no other beta constraint computed by Optimize. Optimize only knows about historical/current pricing and volume data plus the objective and constraints you supply. Even the beta_neutral constraint is defined as a general FactorExposure constraint.</p>
</blockquote>

<p>Are you sure about this? How come when I comment out beta calculation in pipeline and comment out the beta constraint  in Optimize API, beta is reflected in performance graph and report. It must be calculating it somewhere, don&#39;t you think?</p>

<blockquote>
<p>You&#39;re right that you can modify the beta definition that you use in the constraint. The way you should think about this is that we are asking the community to write algorithms that meet specific criteria. You can achieve these criteria however you&#39;d like. To help you achieve these, we build and publish tools for you to use. Some of the tools we published are strictly required, because we don&#39;t believe it&#39;s reliable to meet the constraint without using it (e.g. QTU). For others, we suggest possible use cases, but ultimately leave it up to you how you want to achieve the criteria. I think the position concentration example is a good example of this. There&#39;s a PositionConcentration constraint that you can use to control your position concentration, but you can choose the bounds, the frequency at which you check the constraint (how frequently you call order_optimal_portfolio), and more. This is no different for beta-to-SPY.</p>
</blockquote>

<p>Let me put in the way the hedge fund industry interprets a beta neutral strategy. When a manager says he deploys a beta neutral strategy, the measure of beta is based on industry standards which is one year daily returns.  No manager will say I deploy a beta neutral strategy based on a five day daily returns. Tweaking beta as a measure of beta neutrality is not an option because it is standardized.  This is what I mean when I say that if you change regression lengths of beta then the measurement now becomes relative vis a vis the change in window lengths.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a67633c75ebca482ef95584' id='5a67633c75ebca482ef95584'>
<a href='#5a67633c75ebca482ef95584'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1516725052000' class='quanto-date posted-at response-posted-at' href='#5a67633c75ebca482ef95584'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James, I think you are forgetting one thing. </p>

<p>Some might like to use the Optimize API outside the contest arena where it would be their responsibility to choose whatever objective functions they might like with whatever type of restrictions they want.</p>

<p>For instance, I do not like the minimum turnover constraint. I think no minimum should be used. If you can generate some alpha with as low a turnover as possible, all the better for you. Less churning, less commissions, less fees. But, then, I am not forced to participate in any contests.</p>

<p>If you look at the 5% concentration criteria, it is easily satisfied. A portfolio with 20+ stocks would do the trick. However, flying so close to the limit will have you exceed it on an outlier. Therefore, you should pad your selection with some leeway: go for 50+ stocks. I do not like the 5% concentration either. But then again, no one is forcing me to participate in a contest.</p>

<p>I find the Optimize API a most interesting tool to have. You set your objective functions, give it your constraints, and voilà, it outputs the best portfolio weights to meet those objectives. </p>

<p>The real problem are not the constraints. Those may be anything you want. You are just telling your payoff matrix to behave within such and such limits. If there is a solution, the Optimize API will give it to the best of its abilities.</p>

<p>The real problem is in the objective functions. These are functions “you” supply that are intended to be surrogates for profit generation. You want to provide predictive price functions to a blob of price variance where most, on Quantopian, ignore that this swarm is highly unpredictable from day to day. Most often, those predictive functions trade on market noise. </p>

<p>If these functions had predictive value, it would show, and in a big way. They would be able to produce more than the risk-free rate, and maybe, most importantly, exceed market averages: E[R(m)], generate some real alpha.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a6768dcba5f4e0b3822e928' id='5a6768dcba5f4e0b3822e928'>
<a href='#5a6768dcba5f4e0b3822e928'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516726492000' class='quanto-date posted-at response-posted-at' href='#5a6768dcba5f4e0b3822e928'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Guy, you are absolutely correct that optimization (not Optimize API per se) is a very useful tool in trading systems development. I use it a lot in my work specifically, Covariance Matrix Adaptation Evolution Strategy optimization and Particle Swarm Optimization while Optimize API uses what you call convex optimization, and there are many other flavors of optimization one can choose from.    However, in the context of this thread, I was honing in on the contest criteria and the effectivity, efficiency and code implementation of Optimize API. </p>

<p>Guy, your catch on the &quot;bug&quot; on PnL reporting is such a great find  and it is quite disappointing that nobody from Q seem to be addressing this or at the very least acknowledging it and say that they are/or will be working at rectifying it.  Cheers!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a6770fd4bbe85274edd1b25' id='5a6770fd4bbe85274edd1b25'>
<a href='#5a6770fd4bbe85274edd1b25'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1516728573000' class='quanto-date posted-at response-posted-at' href='#5a6770fd4bbe85274edd1b25'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James, yes, concerning the “bug”. They should address the problem head on. One thing we do need in all these simulations is to have the ability to trust the data and the outcome. </p>

<p>I would add to my previous post that even if I do not like the 5% concentration restriction, in a contest, I would easily live with it. In my kind of scenario, it would not matter much over a short-term contest interval. It is over the long run that I would be more permissible.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a6772a375ebca0efcf95544' id='5a6772a375ebca0efcf95544'>
<a href='#5a6772a375ebca0efcf95544'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1516728995000' class='quanto-date posted-at response-posted-at' href='#5a6772a375ebca0efcf95544'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James: The beta that is used to create the constraints for <code>order_optimal_portfolio</code> is defined <em>per asset</em>. The portfolio beta that you see in a pyfolio tearsheet is not computed from that input. It is computed by regressing the portfolio returns (simulated using <a href="https://github.com/quantopian/zipline">Zipline</a>) against the returns of SPY. That code lives in <a href="https://github.com/quantopian/pyfolio/blob/master/pyfolio/timeseries.py#L507">pyfolio</a> and <a href="https://github.com/quantopian/empyrical/blob/master/empyrical/stats.py#L824">empyrical</a>, so the definition of beta used to compute the beta of a backtest is independent of whatever you supply to <code>order_optimal_portfolio</code>.</p>

<p>@Guy: I apologize, I forgot to respond to your bug report. Indeed the round-trip numbers look wrong. After doing some digging, it appears as though spinoffs aren&#39;t properly accounted for in the round-trip analysis, but I&#39;m not sure if that&#39;s the only issue. I filed an issue in pyfolio repo <a href="https://github.com/quantopian/pyfolio/issues/510">here</a>. Thanks for reporting it.</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a6773424bbe850015dd27ea' id='5a6773424bbe850015dd27ea'>
<a href='#5a6773424bbe850015dd27ea'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516729154000' class='quanto-date posted-at response-posted-at' href='#5a6773424bbe850015dd27ea'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Guy, </p>

<blockquote>
<p>One thing we do need in all these simulations is to have the ability to trust the data and the outcome.</p>
</blockquote>

<p>Spot on, Guy, this exactly what I&#39;m trying to do when I&#39;m decomposing different parts of the whole algorithmic flow of code to make sure everyone is playing a leveled field particularly in reference to the contest. That it cannot be easily &quot;gamed&quot; and / or program logic ,data and outcomes can be trusted.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a67785aba5f4e7b6722ea74' id='5a67785aba5f4e7b6722ea74'>
<a href='#5a67785aba5f4e7b6722ea74'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1516730458000' class='quanto-date posted-at response-posted-at' href='#5a67785aba5f4e7b6722ea74'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James, we should not constrain the program logic. It is part of the whole purpose of doing all these simulations. Design whatever trading strategy you want based on whatever decision process you want, even as weird as you want them. </p>

<p>However, whatever you may use, show that it has some value, generate some positive alpha. And, the only way to do that, is to show what your simulation, under “normal” conditions, could do it. By normal is meant, using a reasonable stock selection universe on whatever criteria where all the trades were indeed feasible over the simulation interval. Going forward is another matter altogether.</p>

<p>If we all use the Optimize API and the “QTU”, then that is a leveled playing field. That is what the contest&#39;s constraints are designed to do.  </p>

<p>As to all the objective functions that we may design, they are all admissible. Even some “voodoo” stuff if we can program some. And, if your “voodoo” stuff is productive, and you win the contest, then all I would say is: bravo, you won, fair and square.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a6778dc4bbe854d0fdd188c' id='5a6778dc4bbe854d0fdd188c'>
<a href='#5a6778dc4bbe854d0fdd188c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516730588000' class='quanto-date posted-at response-posted-at' href='#5a6778dc4bbe854d0fdd188c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, I&#39;m  talking about the beta number you see in the performance graph after a backtest under Results Overview. Is this calculation done by pyfolio and empyrical which is totally independent of beta calculation in author&#39;s code with no interaction or interplay at all.  If this is right, then it is the proper way. However, you don&#39;t seem to have a grasp of why beta calculation should not be user configurable because as a measure of beta neutrality and by industry practice and standards this is fixed at one year daily returns, so that managers and investors alike are comparing apples to apples.</p>

<p>This is not to say that you cannot use beta calculation that is user configurable, if you use it as a direct alpha factor or in relation to an alpha factor.  But not as a measure of beta neutrality or as a variable in beta constraint.  And this is why I call it an implementation bug.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a677bc4ba5f4e2a4622e9fe' id='5a677bc4ba5f4e2a4622e9fe'>
<a href='#5a677bc4ba5f4e2a4622e9fe'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516731332000' class='quanto-date posted-at response-posted-at' href='#5a677bc4ba5f4e2a4622e9fe'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Guy, when I say program logic what I meant was in the context of  code programming logic.  I think what you meant to say and correct me if I&#39;m wrong, is we should not constrain trading logic.  This I totally agree with you, I&#39;ve seen traders make money on astrology or following moon cycles!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a677c8aba5f4e113d22e81f' id='5a677c8aba5f4e113d22e81f'>
<a href='#5a677c8aba5f4e113d22e81f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1516731530000' class='quanto-date posted-at response-posted-at' href='#5a677c8aba5f4e113d22e81f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James: Yes, the backtest beta is generated in Zipline, which uses empyrical under the hood. I am not disagreeing with the fact that the beta metric should not be user configurable. I am just saying that it&#39;s not user configurable. The definition of portfolio beta is fixed in empyrical and is independent of any algorithm code, just like all of the other backtest metric definitions like returns, Sharpe, max drawdown etc.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a677f134bbe850012dd27dd' id='5a677f134bbe850012dd27dd'>
<a href='#5a677f134bbe850012dd27dd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516732179000' class='quanto-date posted-at response-posted-at' href='#5a677f134bbe850012dd27dd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, unless this is a typo error:</p>

<blockquote>
<p>I am just saying that it&#39;s not user configurable.</p>
</blockquote>

<p>But it is user configurable in the pipeline, as I said earlier, I change SimpleBeta regression length from 260 to 5 and its results is the one being evaluated by beta constrain in Optimize API which is also user configurable.  What am I missing?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a6781d6ba5f4e113d22e88b' id='5a6781d6ba5f4e113d22e88b'>
<a href='#5a6781d6ba5f4e113d22e88b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1516732886000' class='quanto-date posted-at response-posted-at' href='#5a6781d6ba5f4e113d22e88b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James: The beta metric reported in pyfolio or at the end of the backtest is not user configurable.</p>

<p>Creating a factor in pipeline, regardless of the name or definition, does not change the definition of the backtest or pyfolio risk metrics, it just gets you data that you can use in your algorithm to make trading decisions. <code>SimpleBeta</code> is just another Pipeline factor. Using it in your algorithm does not change any backtest metric definitions. </p>

<p>You can then use that definition of <code>SimpleBeta</code> as a constraint in Optimize, which may influence the portfolio that your algorithm trades. But this does not change the definition of the backtest or pyfolio risk metrics.</p>

<p>No matter what factors you use in Pipeline or Optimize, your backtest beta-to-SPY metric will be based on <a href="https://github.com/quantopian/empyrical/blob/master/empyrical/stats.py#L852">this definition</a> from empyrical, which only takes portfolio returns and benchmark returns as input.</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a67858a75ebca482ef95867' id='5a67858a75ebca482ef95867'>
<a href='#5a67858a75ebca482ef95867'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516733834000' class='quanto-date posted-at response-posted-at' href='#5a67858a75ebca482ef95867'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, this is where you are wrong, the output of SimpleBeta in the pipeline is picked up in Optimize API via the beta constraint where it is evaluated by the settings of your desired thresholds : minimum / maximum beta exposures and this in turn reports to the evaluation algorithm to see if it complied with contest threshold of +-0.3.  The beta calculation in Zipline just gives you the final beta of the algo by  regressing the portfolio returns against the returns of SPY. and does not play any role in determining whether beta complied with the contest thresholds.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a67885c75ebca0efcf95742' id='5a67885c75ebca0efcf95742'>
<a href='#5a67885c75ebca0efcf95742'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1516734557000' class='quanto-date posted-at response-posted-at' href='#5a67885c75ebca0efcf95742'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James: The evaluation notebook uses the backtest result object (first line in the first cell), which uses the metrics from zipline/empyrical. </p>

<p>Optimize does not report to the research notebook. Optimize converts an objective and a series constraints into a set of orders for the algorithm.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a678b5aba5f4e5a1822e843' id='5a678b5aba5f4e5a1822e843'>
<a href='#5a678b5aba5f4e5a1822e843'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516735322000' class='quanto-date posted-at response-posted-at' href='#5a678b5aba5f4e5a1822e843'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie,</p>

<blockquote>
<p>Optimize converts an objective and a series constraints into a set of orders for the algorithm.</p>
</blockquote>

<p>And these set of orders is with the objective not only to Maximize Alpha but also stay within bounds of contest thresholds which is the reason for constraints in the first place. Were you involved in coding the algorithm?</p>

<ul>
<li> </li>
</ul>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a67bfbbba5f4e7c7222ea90' id='5a67bfbbba5f4e7c7222ea90'>
<a href='#5a67bfbbba5f4e7c7222ea90'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516748731000' class='quanto-date posted-at response-posted-at' href='#5a67bfbbba5f4e7c7222ea90'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi James -</p>

<p>The Optimize API is more-or-less described by Scott on <a href="https://www.quantopian.com/posts/request-for-feedback-portfolio-optimization-api">https://www.quantopian.com/posts/request-for-feedback-portfolio-optimization-api</a>.  It has been in the works for awhile, and as I understand, it is all based on solving what&#39;s called a convex optimization problem.  I think it uses <a href="http://www.cvxpy.org/en/latest/">CVXPY</a> which is also available to Quantopian users for their algos directly; the Optimize API is a kind of API wrapper.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a67e74c4bbe855a20dd21a0' id='5a67e74c4bbe855a20dd21a0'>
<a href='#5a67e74c4bbe855a20dd21a0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516758860000' class='quanto-date posted-at response-posted-at' href='#5a67e74c4bbe855a20dd21a0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Grant,</p>

<p>Thanks for the reference. I am very familiar with optimization techniques as I use them a lot in my work. Optimization is basically a search algorithm based on different assumptions of what the solution space shape is.  Convex optimization is based on the  assumption that the solution space is shaped like a convex when minimizing the objective or concave when maximizing. This is very efficient in linear models  and both global and local optimal solutions are one and the same. I happen to belong to the school of thought that the financial markets are nonlinear and nonstationary that is why  I employ nonlinear optimization techniques like genetic/evolutionary algorithms, i.e. Particle Swarm Optimization. In nonlinear optimization the global optimal solution is not necessarily the local optimal solution because there are multiple solutions possible. But all optimizationis are structured the same way, you have  an objective (can also be multiple objectives) which are subject to constraints.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a685c9c9289fc0012dbc782' id='5a685c9c9289fc0012dbc782'>
<a href='#5a685c9c9289fc0012dbc782'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516788892000' class='quanto-date posted-at response-posted-at' href='#5a685c9c9289fc0012dbc782'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>James -</p>

<p>Sorry, I didn&#39;t realize you were so familiar with optimization (more so than I am, no doubt).</p>

<p>One thing I&#39;m realizing about this beast is that generally, if the Optimize API is doing a lot of heavy lifting, it is probably a bad thing.  In fact, it seems that if the algo output (the combined &quot;alpha factor&quot; i.e. portfolio weights, per the <a href="https://blog.quantopian.com/a-professional-quant-equity-workflow/">workflow</a>) doesn&#39;t basically conform to the <a href="https://www.quantopian.com/posts/a-new-contest-is-coming-more-winners-and-a-new-scoring-system">constraints</a>, there is a problem.  I get the sense that the ideal algo would not need the Optimize API at all, with its multitude of diversification/risk-managing constraints.</p>

<p>@ Jamie - please see attached for yet another example.  It is an algo that, to obtain a beta ~ 0 over a 2-year time frame, requires that I set the beta constraint in the Optimize API to:</p>

<pre><code>MIN_BETA_EXPOSURE = -0.3  
MAX_BETA_EXPOSURE = -0.3  
</code></pre>

<p>If I don&#39;t set this bias, I get a beta ~ +0.2 for a 2-year backtest (see attached).  I&#39;m offering this up in the hope that someone can shed some light on this mystery.  It seems counter-intuitive that things could be so outta whack; it does appear to be an existence proof that the Optimize API, as implemented, is not effective in controlling beta on a forward basis (I agree with James that this is a &quot;bug&quot; in some respects, in that the Optimize API isn&#39;t even close to doing what one would expect it to do--barf when it realizes that the beta &quot;constraint&quot; isn&#39;t being met).</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a689ee39289fc0aa7dbcae1' id='5a689ee39289fc0aa7dbcae1'>
<a href='#5a689ee39289fc0aa7dbcae1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1516805859000' class='quanto-date posted-at response-posted-at' href='#5a689ee39289fc0aa7dbcae1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant, there might be nothing wrong with the Optimize API when you set the min and max beta to -/- 0.30. It is just that the combined impact of the other constraints have precedence. Something like the dollar-neutral thing will force an equilibrium on exposure, and by itself limit the boundaries of the beta excursions. In fact, you will be forcing the portfolio beta to approach zero from either side.</p>

<p>Try the same code while only changing the beta min and max to -/- 0.90. You will get the same results you did. Yet, the API again complied to your request. It did not exceed the -/- 0.90 just as it did not exceed the -/- 0.30. </p>

<p>You are providing more than one constraints, and it is the impact of all of them that you see, not just one.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a68a4174f5fe20015ce0876' id='5a68a4174f5fe20015ce0876'>
<a href='#5a68a4174f5fe20015ce0876'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1516807191000' class='quanto-date posted-at response-posted-at' href='#5a68a4174f5fe20015ce0876'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant, just in case you were wandering, setting the min and max beta to +/+ 0.90 in your scenario with also give the same results.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a69169f9289fc501cdbc35f' id='5a69169f9289fc501cdbc35f'>
<a href='#5a69169f9289fc501cdbc35f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516836511000' class='quanto-date posted-at response-posted-at' href='#5a69169f9289fc501cdbc35f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Guy,</p>

<p>If I set:</p>

<pre><code>MIN_BETA_EXPOSURE = 0.9  
MAX_BETA_EXPOSURE = 0.9  
</code></pre>

<p>and uncomment out the constraint:</p>

<pre><code>    beta_neutral = opt.FactorExposure(  
        loadings=pipeline_data[[&#39;beta&#39;]],  
        min_exposures={&#39;beta&#39;:MIN_BETA_EXPOSURE},  
        max_exposures={&#39;beta&#39;:MAX_BETA_EXPOSURE}  
        )  
    constraints.append(beta_neutral)  
</code></pre>

<p>I get:</p>

<p>InfeasibleConstraints: The attempted optimization failed because no portfolio could be found that satisfied all required constraints. The following special portfolios were spot checked and found to be in violation of at least one constraint: Target Portfolio (as provided to TargetWeights): Would violate FactorExposure([&#39;beta&#39;]) because: Exposure to &#39;beta&#39; (0.000902370515674) would be less than min exposure (0.9). Current Portfolio (at the time of the optimization): Would violate FactorExposure([&#39;beta&#39;]) because: Exposure to &#39;beta&#39; (0.0) would be less than min exposure (0.9). Empty Portfolio (no positions): Would violate FactorExposure([&#39;beta&#39;]) because: Exposure to &#39;beta&#39; (0.0) would be less than min exposure (0.9).</p>

<p>So, it is doing something.</p>

<p>I suspect what&#39;s going on is that the trailing beta indicator is not a forward beta indicator, for some universes of stocks.  A more predictive beta indicator is required.  It does make me wonder how the beta would be controlled for real.  Using a trailing 1-year window and regressing against SPY doesn&#39;t seem like it&#39;ll cut it.  I&#39;m thinking there should be an easy way to adapt Alphalens to see what is going on, since to write a humdinger Quantopian algo, I think beta needs to control beta better without a hack.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a69178e9289fc173bdbbf4c' id='5a69178e9289fc173bdbbf4c'>
<a href='#5a69178e9289fc173bdbbf4c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1516836750000' class='quanto-date posted-at response-posted-at' href='#5a69178e9289fc173bdbbf4c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant, yes, agree.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a6928019289fc1715dbc0a5' id='5a6928019289fc1715dbc0a5'>
<a href='#5a6928019289fc1715dbc0a5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516840961000' class='quanto-date posted-at response-posted-at' href='#5a6928019289fc1715dbc0a5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant,</p>

<p>Did you intentionally set min / max beta exposure to be equal at 0.9? This is called the equality constraint. I&#39;m gald you did because this is the first time I&#39;ve seen the InfeasibleConstraints being triggered.  In one of my posts above where I quoted Q Optimize API,documentation, I asked Jamie why this   InfeasibleConstraints error is not being triggered when beta violates constraint settings? I never really got an answer.  The error can not be more clearer as it states:  <strong>InfeasibleConstraints: The attempted optimization failed because no portfolio could be found that satisfied all required constraints</strong></p>

<p>So my question now is why was it triggered when this equality constraint was violated and not when inequality constraints (i.e +- 0.3) is violated?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a699f745b32910016cefa5c' id='5a699f745b32910016cefa5c'>
<a href='#5a699f745b32910016cefa5c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516871540000' class='quanto-date posted-at response-posted-at' href='#5a699f745b32910016cefa5c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>So my question now is why was it triggered when this equality constraint was violated and not when inequality constraints (i.e +- 0.3) is violated? </p>
</blockquote>

<p>@ James -</p>

<p>The likely explanation here is that the Optimize API is working as designed.  It takes in data, applies its optimization routine, and returns a result.  The disconnect is that for beta, the data provided is stale.  If you have a look at the help page, the constraint is simply:</p>

<pre><code>(new_weights * loadings[column]).sum() &gt;= min_exposure[column]
(new_weights * loadings[column]).sum() &lt;= max_exposure[column]
</code></pre>

<p>The problem is that the risk control problem is being solved in the <em>past</em> not the future.  In the case of beta, we are using the beta computed from a 1-year trailing window, so it ends up being a the beta from ~ 6 months ago.  So, if the constraints can be satisfied using stale betas, then no exception will result.  However, it doesn&#39;t mean that the constraint is met point-in-time (i.e. it might fail with the current stock betas).  So, when the algo returns are regressed against SPY, it appears that the risk control is not working; I suspect it is, but it is just trailing risk control (unless a beta-bias is imposed, as I did, but I&#39;m probably applying look-ahead bias...shameful, but I&#39;m hoping it persists for my Contest 38 submission where beta ~ 0 should be a score booster).</p>

<p>If you Google &quot;beta forecasting&quot; you&#39;ll see that this is nothing new under the sun.  For example, see the conclusions in:</p>

<p><a href="https://forecasters.org/wp-content/uploads/gravity_forms/7-2a51b93047891f1ec3608bdbd77ca58d/2014/07/Reeves_Jonathan_ISF2014.pdf">https://forecasters.org/wp-content/uploads/gravity_forms/7-2a51b93047891f1ec3608bdbd77ca58d/2014/07/Reeves_Jonathan_ISF2014.pdf</a></p>

<blockquote>
<p>This paper demonstrates that when reliable higher frequency returns are available, these<br>
will deliver more accurate one-month-ahead beta forecasts, relative to forecasts from re-<br>
turns measured at a lower frequency.</p>
</blockquote>

<p>It is easy enough to try--write a version of SimpleBeta that will take in minutely returns, and then use the betas in the Optimize API.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a69a92e5b32910010cefb97' id='5a69a92e5b32910010cefb97'>
<a href='#5a69a92e5b32910010cefb97'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516874030000' class='quanto-date posted-at response-posted-at' href='#5a69a92e5b32910010cefb97'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant,</p>

<p>Let&#39;s take the case of your baseline algo, the code follows all Q specs and was able to achieve zero beta but failed in Position Concentration. Position concentration is a point in time variable and is not influenced by ex post factos like beta and leverage can. Why did Optimize API not flag this  <strong>InfeasibleConstraints: The attempted optimization failed because no portfolio could be found that satisfied all required constraints</strong>, point in time?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a69ab4ca494900014e60318' id='5a69ab4ca494900014e60318'>
<a href='#5a69ab4ca494900014e60318'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516874572000' class='quanto-date posted-at response-posted-at' href='#5a69ab4ca494900014e60318'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I guess I wouldn&#39;t read too much into which constraints fail and which pass.  The optimization takes all constraints into account as a whole, and either finds a solution or doesn&#39;t.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a69afc0a494900014e6038e' id='5a69afc0a494900014e6038e'>
<a href='#5a69afc0a494900014e6038e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516875712000' class='quanto-date posted-at response-posted-at' href='#5a69afc0a494900014e6038e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant,</p>

<p>OK if that&#39;s the way you want to interpret it.</p>

<p>I did something to your algo that would may it pass all constraints except the style exposure:<br>
<strong>Checking style exposure limits...<br>
FAIL: Mean short_term_reversal exposure of 0.912 on 2017-03-06 is not between +/-0.40.</strong></p>

<p>This I expected because your style is purely mean reversion. I don&#39;t want to publish it here because it will show how one can exploit the vulnerabilites of Q code implementation and  thus be able to &quot;game&quot; it.  But since this is your code and you seem to be the only listening to what I&#39;m saying, I can share it with you via private email.  Do you want me to share it with you and you decide what you want to do with it?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a69b5ff5b32910019cefd47' id='5a69b5ff5b32910019cefd47'>
<a href='#5a69b5ff5b32910019cefd47'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516877311000' class='quanto-date posted-at response-posted-at' href='#5a69b5ff5b32910019cefd47'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yes, I&#39;m aware of the short_term_reversal style risk.  If you found a gaping hole that would allow gaming, I suggest publishing it and letting Q know.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a69b82fa494900017e60478' id='5a69b82fa494900017e60478'>
<a href='#5a69b82fa494900017e60478'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516877871000' class='quanto-date posted-at response-posted-at' href='#5a69b82fa494900017e60478'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant,</p>

<p>In your baseline algo where you sucessfully achieved zero beta you were able to pass style exposure but not position concentration, am I right?</p>

<p>I don&#39;t want to publish it, let them ask me then I will.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a69b9a80bdece001661b956' id='5a69b9a80bdece001661b956'>
<a href='#5a69b9a80bdece001661b956'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516878248000' class='quanto-date posted-at response-posted-at' href='#5a69b9a80bdece001661b956'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s the notebook of the &quot;hack&quot;:  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a69c071a494900017e605a2' id='5a69c071a494900017e605a2'>
<a href='#5a69c071a494900017e605a2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516879985000' class='quanto-date posted-at response-posted-at' href='#5a69c071a494900017e605a2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yep.  The whole point of the risk model style constraint is to kill this type of algo that relies heavily on short_term_reversal.  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/all-that-glitters-are-bugs-a-concrete-notebook-example'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/all-that-glitters-are-bugs-a-concrete-notebook-example'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#37515252535556545c77464256594358475e56591954585a">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
