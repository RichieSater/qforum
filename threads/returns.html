<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Returns
</title>
<meta content='The &quot;Returns&quot; value during and after a test that you see can be tricky so it&#39;s good to know how that really works.Here are some examples.In every case below, there is a buy of 2 shares in 2009 when the price was low, for $24.41, and at the end of the run the stocks 2-share value is $230.96.The Returns value from the IDE at the end of the run is shown.The other value I&#39;m calling &quot;True Returns&quot; is based only on what was actually spent, so if cash sat in the brokerage account unused, that...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="YJOcEhGoIqXMNoiDRy2we69FRM4BrY08zjly0k8zQMMc9epfs17wRnUr0bIIwhgPl8tnp3thmCdMNqm45XYieA==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=false;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/returns' property='og:url'>
<meta content='Returns' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/returns' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Returns' property='og:title'>
<meta content='The &quot;Returns&quot; value during and after a test that you see can be tricky so it&#39;s good to know how that really works.Here are some examples.In every case below, there is a buy of 2 shares in 2009 when the price was low, for $24.41, and at the end of the run the stocks 2-share value is $230.96.The Returns value from the IDE at the end of the run is shown.The other value I&#39;m calling &quot;True Returns&quot; is based only on what was actually spent, so if cash sat in the brokerage account unused, that...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/returns">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='546c4b4d970c24d2720001f9'>
<div class='post-container' data-post-id='546c4b4d970c24d2720001f9' id='546c4b4d970c24d2720001f9'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Returns</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<span class='posted-at'>edited </span>
<span UTCms='1422001007000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Returns&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Freturns%3Futm_source%3Dwebsite_share%26utm_campaign%3Dtrue-returns%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Freturns%3Futm_source%3Dwebsite_share%26utm_campaign%3Dtrue-returns%26utm_medium%3Dlinkedin&amp;title=Returns+%28Blue+Seahawk%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/returns?utm_source=website_share&amp;utm_campaign=true-returns&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Blue Seahawk" />
<div class='body-text'>
<div class='body-text-container post-body'><p>The &quot;Returns&quot; value during and after a test that you see can be tricky so it&#39;s good to know how that really works.</p>

<p>Here are some examples.<br>
In every case below, there is a buy of 2 shares in 2009 when the price was low, for $24.41, and at the end of the run the stocks 2-share value is $230.96.<br>
The Returns value from the IDE at the end of the run is shown.<br>
The other value I&#39;m calling &quot;True Returns&quot; is based only on what was actually spent, so if cash sat in the brokerage account unused, that portion is not considered relevant.</p>

<ol>
<li>This uses the default initial cash value of one million:</li>
</ol>

<pre><code>      Initial Cash: $1,000,000  
Quantopian Returns: 0%  
Out:  
            Initial cash: $1000000.00  
      Buy 2 AAPL for total $24.41  
      Ending stock value: $230.96  
            True returns:         846%  
</code></pre>

<ol>
<li> Here the initial cash at one thousand is closer to what was spent in this case:</li>
</ol>

<pre><code>       Initial Cash: $1,000  
Quantopian Returns: 25.6%  
Out:  
            Initial cash: $1000.00  
      Buy 2 AAPL for total $24.41  
      Ending stock value: $230.96  
            True Returns:         846%  
</code></pre>

<ol>
<li>This time the initial cash is only one dollar, resulting in negative cash.</li>
</ol>

<pre><code>      Initial Cash: $1  
Quantopian Returns: 25590.2%  
Out:  
            Initial cash: $1.00  
      Buy 2 AAPL for total $24.41  
      Negative cash!! Borrowing $23.41   &lt;======  
      Ending stock value: $230.96  
            True Returns:         846%  
</code></pre>

<p>The Quantopian Returns value in the IDE uses starting cash instead of drawdown and ignores any negative cash.<br>
While on the other hand, if you start with a million and spend only $1000, the remaining unused part of that million is considered significant, it is included in the figure.</p>

<p>Anyway, here&#39;s some code that can be used to play around and understand it better.<br>
All the best.  </p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>39 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='546c4c445cb4f654cc000223' id='546c4c445cb4f654cc000223'>
<a href='#546c4c445cb4f654cc000223'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1416383563000' class='quanto-date posted-at response-posted-at' href='#546c4c445cb4f654cc000223'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Same code as above using a GUI value of one dollar instead of one thousand. (GUI stands for Graphical User Interface)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='546d1c76e2fd6613b1000014' id='546d1c76e2fd6613b1000014'>
<a href='#546d1c76e2fd6613b1000014'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/544e4e072e3b44400f000009'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/565e41a29e0bf9f2de0864ee72290186?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/544e4e072e3b44400f000009'>Rob Welsh</a>
</div>
<a UTCms='1416436857000' class='quanto-date posted-at response-posted-at' href='#546d1c76e2fd6613b1000014'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>To get around that issue and get useful metrics and a reasonable comparison with the benchmark graph, I&#39;ve been computing my shares to purchase based upon the account value as was done in the examples. Then if making final preparation for live trading, replace the bogus share computation with the actual number of shares to trade. Still, it would be good if that info was documented.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54a8224e852309c3de00007b' id='54a8224e852309c3de00007b'>
<a href='#54a8224e852309c3de00007b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1420304977000' class='quanto-date posted-at response-posted-at' href='#54a8224e852309c3de00007b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This time the initial capital is the default $1,000,000 (just has some code cleaned up) where Returns are reported as 0%.<br>
Notice the real Returns value if you run it is actually still 846%. $24.41 was spent to make $230.96.  100 * ($230.96 - $24.41) / $24.41</p>

<p>Changing the initial capital should not cause large changes in results, instead, the calculation should be based on <strong>capital used</strong>.<br>
<a href="https://www.quantopian.com/posts/cash-vs-returns">https://www.quantopian.com/posts/cash-vs-returns</a> also has some discussion on this.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54a87091b2f630762b00000b' id='54a87091b2f630762b00000b'>
<a href='#54a87091b2f630762b00000b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/549cf0135ed2413b280001b5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/97aa436744edd58f961990ea084bbdf3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/549cf0135ed2413b280001b5'>Adam Roder</a>
</div>
<a UTCms='1420325012000' class='quanto-date posted-at response-posted-at' href='#54a87091b2f630762b00000b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The nomenclature of the site is correct: if you declare a value for capital, then do not deploy any of it, your &quot;return on capital&quot; is zero.  If you&#39;d like to calculate your own metric and track it, awesome, but the site is not wrong.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54a8ad81be5fb8a7f60002f5' id='54a8ad81be5fb8a7f60002f5'>
<a href='#54a8ad81be5fb8a7f60002f5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1420340611000' class='quanto-date posted-at response-posted-at' href='#54a8ad81be5fb8a7f60002f5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>All opinions welcome.</p>

<p>My perspective: The results equation is meant to represent output per actual input, and replacing starting_cash with a drawdown model will remedy many issues all at once:<br>
1. People will have a sound and certain reflection of their code performance immediately without needing to worry about adjusting initial capital for different results followed by re-run, they will know right off the top how well their code is really doing.<br>
2. Suddenly Alpha, Beta, Sharpe, Sortino, Volatility, Drawdown, Information Ratio and Returns percentage as well as the chart will be trustworthy as to the true performance of their algorithm with certainty no matter what the initial capital value is set to.<br>
3. Evaluations for the hedge fund Quantopian Managers Program will be deterministic vs variable based on initial capital.<br>
4. Negative cash will no longer be ignored as if it were irrelevant (it is currently cast aside in the results calculation, yet it is a part of real input).<br>
5. Unused cash will no longer be included in the calculation (it was not used and therefore is not part of real input).<br>
6. I think it is a safe bet that one of the first things many people consider when encountering a backtest (in the community) is the right side of the chart. That is taken to be an indication of how well the algo does, so they will be able to trust that result instead of the current situation where they would have to observe the initial capital and analyze the algorithm contents and run the algo with additional code to find out how much capital was actually used and whether the code ventured into negative cash (and/or to what degree) or did not use much to be able to determine where that chart result falls in the spectrum between good and bad.<br>
7. There can no longer be charts that look good while the code is actually bad or charts that look bad while the code is actually good.<br>
8. The Quantopian brand will be improved for a great 2015 and beyond.</p>

<p>Those are my opinions, formed in part by having added <a href="https://www.quantopian.com/posts/run-summary">Run Summary</a> to probably more than 100 algorithms of others while testing that and observing the results. (I have struggled over this same issue in that code, stubbornly came around to this conclusion, and candidly I think it currently has a bug wrt to this by the way, need to muster up the energy to make it righter).</p>

<p>Q could draw up a version with the change, make available around the office and round up some thoughts, and if all goes well, then to backtests, eventually live.<br>
A start could be changing these two lines in performance/period.py, need to bring in max_drawdown from the rval dictionary I think, and then try &#39;er out and see how it looks.<br>
An additional condition will be necessary to handle short selling.</p>

<pre><code>    def calculate_performance(self):  
        self.ending_value = self.calculate_positions_value()  
        total_at_start    = self.starting_cash + self.starting_value  
        self.ending_cash  = self.starting_cash + self.period_cash_flow  
        total_at_end      = self.ending_cash + self.ending_value  
        max_drawdown      = self.max_drawdown  
        #self.pnl         = total_at_end - total_at_start

        if max_drawdown != 0:  
            self.returns = (total_at_end - max_drawdown) / max_drawdown  
            #self.returns = self.pnl / total_at_start  
        else:  
            self.returns = 0.0  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54a8b6c0be5fb8a7f6000315' id='54a8b6c0be5fb8a7f6000315'>
<a href='#54a8b6c0be5fb8a7f6000315'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51d125a71144e60865000044'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b7dd86784deedc047d5ad0fb30378bdd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51d125a71144e60865000044'>Peter Bakker</a>
</div>
<a UTCms='1420342978000' class='quanto-date posted-at response-posted-at' href='#54a8b6c0be5fb8a7f6000315'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I do agree with you Gary, but also Adam is right. What we need is basically a metric that expresses the return on capital usage and the &quot;max_drawdown&quot; would express that. In the examples above...although the return with a million is low in percentage the risk is also almost nil, currency risk aside. In my algorithms I deploy I create on purpose a cushion that will cater for the settlement delay of my account (Ozzies cannot have a margin account, they are legally forced to take a cash account) to prevent drawing into negative and therefore not executing my algorithms properly. That means that on fast-trading algorithms I can only use 50% of my deployable capital which in the end would make my Quantopian return low but my capitial at risk return would be equal to a fully invested account.</p>

<p>The return calculation is missing a super important thing (I mentioned this to you earlier Gary): Of all buy and sells I did what % of my transactions were profitable and of all transactions what was the average profit when there was a profit and what was the average loss when there was a loss. I tend to optimise for those %&#39;s and absolute figures to determine improvement of my algorithm.</p>

<p>Of course this needs some extensive coding around the edge scenario&#39;s (shorts, scaling in, taking partial profits and what&#39;s left in holding at the end) but I think it would increase the tinkering a lot. I have this on my todo list as an extension on the RunSummary code but time seems to slip away in life ;).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54ae744e8e680f6e030000fb' id='54ae744e8e680f6e030000fb'>
<a href='#54ae744e8e680f6e030000fb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1420719184000' class='quanto-date posted-at response-posted-at' href='#54ae744e8e680f6e030000fb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@PB I remember, and those ideas sound really useful, similarly I tried to code a rebalancing that would reward winners with more weight and visa versa, got stuck, shelved for now. Lately I&#39;ve been wrestling with trying to calculate returns on individual securities, really tough.</p>

<p>Alright, especially with the <a href="https://www.quantopian.com/open">paper trading $100,000 Quantopian Open prize/challenge</a>, which is connected to later live trading, I&#39;d like to invite us all to consider a scenario:<br>
Two people each run the same algorithm.<br>
One starts with $10,000 initial capital.<br>
The second starts with $1 million.<br>
After some time, the total drawdown for each is $9,500.</p>

<p>Here, an algo bought some shares once a month during 2014 and was run six times where the only change was the Initial Capital. The more money in the account, the worse the results.<br>
<img src="http://sellerline.com/stocks/quantopian/true_returns_spreadsheet.jpg" alt=""><br>
So currently, it would seem there are two ways to achieve a good looking result real/money or paper:<br>
1. Try to keep only enough money in the account to be able to buy whatever amount the algo might need.<br>
2. Establish a margin account and be borrowing on it (the IDE will not reflect reality).<br>
This also means you cannot really use the metrics to gage how well your algo is doing, at least not very easily (you would have to set it to however much your algo uses, however some code will trade differently based on the starting cash). If you change the initial capital, it will change the results in this way in the case of a basic algo.</p>

<p>Below are screenshots of four of the six runs and the one at the bottom includes the custom chart of calculated Returns.<br>
The key point is: For each run, the custom chart Returns using (profit / drawdown) were exactly the same as the one you see in the custom chart, initial capital becomes no more significant than cash in one&#39;s own bank account at home.<br>
Since Alpha, Beta, Sharpe ... are calculated from Returns, those also would have all been consistent across the board in all six runs had Returns been calculated by (profit / drawdown) instead of initial capital.</p>

<p><img src="http://sellerline.com/stocks/quantopian/true_returns_1.jpg" alt=""></p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b2a7d0d78af770910003ba' id='54b2a7d0d78af770910003ba'>
<a href='#54b2a7d0d78af770910003ba'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/500da26d5152d20002000008'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7806a9f9b8bfcad2054cb313567f1b00?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/500da26d5152d20002000008'>Jonathan Kamens</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1420994515000' class='quanto-date posted-at response-posted-at' href='#54b2a7d0d78af770910003ba'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Suppose you&#39;re an analyst working for a hedge fund, and, your boss the portfolio manager says, &quot;Here&#39;s $1,000,000 of the fund&#39;s money for you to invest as you see fit.&quot;</p>

<p>You decide that &quot;as you see fit&quot; is to buy $10,000 worth of stock, and leave the other $990,000 of cash sitting in your account, untouched.</p>

<p>A year later, the $10,000 worth of stock you purchased doubles in value, to $20,000.</p>

<p>You go to your boss and say, &quot;Look, I made a 100% return on investment!&quot;</p>

<p>Your boss will fire you. You did not make a 100% ROI, you made 1%.</p>

<p>Quantopian&#39;s metrics are your boss at the hedge fund. If your algorithm has a capital base of $1,000,000, then your algorithm is expected to maximize the value it can extract from that $1,000,000. If your algorithm decides to only invest $10,000 of that $1,000,000, then your algorithm is making poor decisions and is likely to perform poorly.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='54b2bee5d75558f8ed000072' id='54b2bee5d75558f8ed000072'>
<a href='#54b2bee5d75558f8ed000072'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53d46cdb75f57a2832005a6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/62b39881ee19f936224017339779d9d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53d46cdb75f57a2832005a6b'>Market Tech</a>
</div>
<a UTCms='1421000424000' class='quanto-date posted-at response-posted-at' href='#54b2bee5d75558f8ed000072'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>There may be another way to think about this return business which makes sense to everyone:</p>

<p><em>A single Quantopian trading strategy does NOT represent your full unit of measure when it comes to trading one&#39;s &quot;account.&quot;</em></p>

<p>Imagine if one&#39;s retirement account contained $1M (I wish). You would never invest all of that into a single strategy. Never. Yes, each of these Quantopian trading strategies is pinned to and controls a single IB account -- that&#39;s true. But you would never just dump your whole $1M into that single IB account and have one strategy work that entire financial resource. The truth is much more complex, but can probably be simplified. The simple solution is to cut your $1M into smaller chunks and trade each independently. The complex is touched upon below.</p>

<p>Undoubtedly one would take a portion of that $1M and attribute it to a single strategy (no matter how many instruments it traded). The amount you devote to a single strategy would be your risk tolerance level for this strategy. Say the strategy trades insurance + home improvement companies during hurricane season. Maybe it&#39;s pretty risky; 30% drawdowns but 50% returns in heavy weather years. Would you put your whole $1M into that strategy? Hell no. Maybe 10% of your total account. More likely 5% or so. But, and here&#39;s the point about returns... you would expect that strategy to leverage ALL of that $50k right? You&#39;re managing total account risk outside of this strategy. Concerning your full account, maybe you&#39;re 50% invested in equity trading strategies. 30% in fixed income 10% cash and 10% precious metals. That&#39;s you managing risk outside of any one strategy. This particular strategy, however, does not know this, nor does it care. This hurricane strategy has one task, take $50k and work it, fully. </p>

<p>So $50k for this one strategy is about right, for it and it alone. Just one chunk of your $1M. (Or $500k for equity trading as stipulated above.)</p>

<p>You then have other strategies you would devote a portion of your account into. Each of which would assume that it had complete control of its total balance and that it should leverage, to the maximum level permissible, its account resource.</p>

<p>The complex part is what does strategy apportioning risk mean when it comes to a strategy which has its own internal trade risk metrics and measurements. Does a safe, well diversified strategy merit 10%, 20% of your total account? Regardless of the portion of your total account you attribute to any one strategy you would expect the strategy to be able to trade its sub-account balance fully, or not as it sees fit. You have risk within risk now. This complicates the sub-account portioning. But a simple way to look at this is never risk more than the standard 2% of your total wealth in any one strategy. If a strategy has a yearly drawdown of 20% then you could invest a maximum of $100k in it. (20% of 100k = 20k which equals 2% of $1M). That&#39;s the complex part.</p>

<p>I know IB provides for the creation of sub or &quot;client&quot; accounts to which some portion of a master account can be attributed. The Q supports this ability and so this is the right way to approach division of risk among multiple strategies. Each of which retains full control over its own portion allotted to it. (Thanks Jonathan K.)</p>

<p>The basic concept here is that a single Quantopian strategy does not represent your whole investing scheme. Its one slice of a bigger account pie. It should, however, be able to leverage that whole slice fully. Not doing so defeats the strategy&#39;s singular purpose of producing a maximum return for the funds given it.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b2c5f3d75558f8ed00008d' id='54b2c5f3d75558f8ed00008d'>
<a href='#54b2c5f3d75558f8ed00008d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/500da26d5152d20002000008'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7806a9f9b8bfcad2054cb313567f1b00?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/500da26d5152d20002000008'>Jonathan Kamens</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1421002229000' class='quanto-date posted-at response-posted-at' href='#54b2c5f3d75558f8ed00008d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Market Tech, yes, that&#39;s exactly right.</p>

<p>To answer your question, as I understand it, not only do we support the use of dedicated per-algorithm IB sub-accounts, we <em>encourage</em> it, and in fact we only allow one algorithm to trade against any particular IB account number at any given time.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='54b2ee183e903c401700048c' id='54b2ee183e903c401700048c'>
<a href='#54b2ee183e903c401700048c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1421012507000' class='quanto-date posted-at response-posted-at' href='#54b2ee183e903c401700048c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Well, my take is that if, for example, you end up holding a portion of the portfolio in cash, this is just another allocation decision that impacts returns.  If there is &quot;money on the sidelines&quot; it counts.  I&#39;m not sure that Quantopian needs to conjure up another metric, since one can always set the cash to zero in your algorithm, if you want to understand the &quot;all in&quot; return.  --Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b458e6d76665141e000092' id='54b458e6d76665141e000092'>
<a href='#54b458e6d76665141e000092'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1421105385000' class='quanto-date posted-at response-posted-at' href='#54b458e6d76665141e000092'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>&quot;since one can always set the cash to zero in your algorithm&quot;. Please explain.</p>

<p>There are fine algos where the quant is led to believe they are awful by everything shown in the IDE, and frequently algos are posted where the strategy is bad yet the IDE makes them appear to be great. The current condition allows a lot of room for confusion.</p>

<p>[6/2016 removed a less important comment about drawdown]</p>

<p>Another point I wanted to add, returns in the industry have been thought of in more than one way:<br>
<a href="http://en.wikipedia.org/wiki/Rate_of_return">http://en.wikipedia.org/wiki/Rate_of_return</a><br>
(they don&#39;t discuss maximum on the first so not entirely clear to me)</p>

<p>@JK Your 100% gain per year is fantastic code, all the quant would have to do is adjust cash usage.<br>
The way you have it set up, the quant will be fooled into thinking it is garbage and will throw it away.<br>
Can you see why that&#39;s bad?<br>
You&#39;re talking End Zone, third party investor scenarios.<br>
What about the other 100 yards on the field? What about all of the preparation? Quants working on strategies. Don&#39;t you want them to see what&#39;s really going on?<br>
Why do you ignore negative cash borrowing as if it never happened?<br>
Why do you count unused cash in the returns calculation? It&#39;s no different than the million buried in one&#39;s basement.<br>
The word &quot;Returns&quot; is &quot;Returns&quot; for a reason, it is return on what was invested/activated.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b4f8d928f8e347340002de' id='54b4f8d928f8e347340002de'>
<a href='#54b4f8d928f8e347340002de'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1421146332000' class='quanto-date posted-at response-posted-at' href='#54b4f8d928f8e347340002de'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Gary,</p>

<p>For example, if you have a long-only algo, and you use order_target_percent, with the total stock allocation 100% in the market, then the cash will be approximately zero.  There is no setting, but the code can be written so that you allocate 100% of the capital to the market, rather than leaving some in a cash buffer.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b6fb1de07f6f1ee30004a4' id='54b6fb1de07f6f1ee30004a4'>
<a href='#54b6fb1de07f6f1ee30004a4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1421277983000' class='quanto-date posted-at response-posted-at' href='#54b6fb1de07f6f1ee30004a4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@GK Impossible. As anyone with experience knows, as soon as you make some changes, different stocks are opened/closed at different times and especially with the $10M contest dollars, partial fills are entirely unpredictable so that argument is invalid.</p>

<p>[Edit: Some extraneous wordiness removed later by author and the above changed 10/2016]</p>

<p>It took me some 11 months last year to wake up to what was happening. </p>

<p>Ok, so what now. This post has comments from only 7 people while over 1100 views and very few have cloned the algos. Please clone/run one of the shared backtests in this post, modify the initial capital a few times and notice the results, seems to me that would help grasp what&#39;s happening (I suspect many do not really comprehend it) and why it ought to matter to most of us.</p>

<p>There must be some who agree with me. You&#39;re out there, I could use some back up. </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b707042c25615b3b000494' id='54b707042c25615b3b000494'>
<a href='#54b707042c25615b3b000494'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53d46cdb75f57a2832005a6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/62b39881ee19f936224017339779d9d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53d46cdb75f57a2832005a6b'>Market Tech</a>
</div>
<a UTCms='1421281031000' class='quanto-date posted-at response-posted-at' href='#54b707042c25615b3b000494'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Two children are given $100 and told to buy trading cards - for &quot;investment&quot; purposes.</p>

<p>Child one goes and buys 100 cards at $1 a piece - &quot;the market looks good&quot; she says.<br>
Child two buys 1 card and retains $99 of the cash - &quot;the market looks bad&quot; he says.</p>

<p>A year goes by.</p>

<p>Child one sells all of her cards which increased a penny apiece, net return $1.<br>
Child two sells his 1 card but his card doubled in price, net return $1.</p>

<p>Are you saying that child one made 1% in profit while child two made 100% profit?</p>

<p>Let&#39;s say we repeat the experiment restarting with $100 apiece.<br>
Both children buy identical numbers of cards as they did before, 100 cards for child one, 1 card for child two.</p>

<p>Another year goes by.</p>

<p>This time all cards for all children have doubled in value.<br>
Both children cash out.<br>
Child one now has $200, net return $100.<br>
Child two has $101, net return $1.</p>

<p>Are you going to say that both children earned 100% profit on their capital?</p>

<p>Both children had $100 to invest. That was their capital. What was the return on capital during their investment? Return on allotted capital is the measurement here. Whether you buy 1 share or 100 is up to you. But the returns are measured against allotted capital. That capital is unavailable for other investment. It has been dedicated to this investment strategy and cannot be used for another purpose. If the strategy does not invest the capital then it must remain in the account, untouched. Yet it still forms the basis for the return on capital.</p>

<p>You may be thinking that untouched capital is somehow available for other strategies to use. It is not. This is not to say that all capital must remain invested at all times. But the strategy must have available to it (and it alone) all the funds allotted to it so when the time comes the cash is there to invest.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b70daf2c25615b3b0004b3' id='54b70daf2c25615b3b0004b3'>
<a href='#54b70daf2c25615b3b0004b3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1421282737000' class='quanto-date posted-at response-posted-at' href='#54b70daf2c25615b3b0004b3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Child three bought $500 worth of cards on that $100, was never informed of the fact that borrowing had occurred, made a huge return, said wow look at me, my investment strategy is pure genius, showed an investor the impressive graph from the IDE and exclaimed, see there!  My initial capital was only $100 and now look at all this profit on $100!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b71062e07f6f1ee30004f7' id='54b71062e07f6f1ee30004f7'>
<a href='#54b71062e07f6f1ee30004f7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53d46cdb75f57a2832005a6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/62b39881ee19f936224017339779d9d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53d46cdb75f57a2832005a6b'>Market Tech</a>
</div>
<a UTCms='1421283428000' class='quanto-date posted-at response-posted-at' href='#54b71062e07f6f1ee30004f7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Leverage is a considerable concern with regards to looking at a simple P&amp;L curve -- true. Without knowing that leverage was employed child three would indeed be crowned an investing genius. So perhaps a metric that stated &quot;MaxLeverage&quot; would be worth knowing. And indeed if you add the context.account.leverage field to a record() statement you can show, at the will of the quant of course, how much cash (over and above initial capital) was actually used. I would be of a mind to dismiss any strategy that used a leverage &gt; 1.0. All profits (or losses) can be multiplied by leverage. But knowing the presence of leverage is the first step. And you&#39;re right, this is a buried factor that should be surfaced.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b721e2578f565484000564' id='54b721e2578f565484000564'>
<a href='#54b721e2578f565484000564'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4fe8beb792a029000200000d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fe3ffe502559d05f16eb9fe41ab7e9a1?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4fe8beb792a029000200000d'>Dan Dunn</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1421287908000' class='quanto-date posted-at response-posted-at' href='#54b721e2578f565484000564'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;ve read this topic with interest, and had several offline conversations with participants and readers.  For what it&#39;s worth, this is my thinking:</p>

<ul>
<li>We need to do better at helping people manage their leverage, cash, borrowing, whatever you want to call it.  We need to make the use of leverage more obvious in shared algorithms too.  I readily agree!  It&#39;s one of the many things that&#39;s been on our list for a while.  I can give you a list of reasons we haven&#39;t gotten to it yet, but it would be a boring exercise.  Adding leverage as a first-world risk variable earlier this month was a good step in this direction, and there will be more later this year I&#39;m sure.<br></li>
<li>There are a number of algo writers who prefer a returns calculation that is based on money used, not money held.  I understand why, and I would like to provide it at some point.  This feature request isn&#39;t quite as high on the list simply because anyone who wants it can calculate it themselves.  But, we want to make it easy, so we will at some point.<br></li>
<li>I&#39;m not persuaded there is a such a thing as &quot;true returns.&quot;  There are a lot of ways to calculate returns; in different use cases some methods are better than others, and no one method is always the best method.</li>
</ul>

<p>This discussion is valuable.  I&#39;m regularly delighted at how much this community&#39;s wisdom is driving Quantopian&#39;s development.  Thank you all.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='54b7364ba35e88ee3b00001f' id='54b7364ba35e88ee3b00001f'>
<a href='#54b7364ba35e88ee3b00001f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1421293134000' class='quanto-date posted-at response-posted-at' href='#54b7364ba35e88ee3b00001f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for your input.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b741594fa0a27d82000045' id='54b741594fa0a27d82000045'>
<a href='#54b741594fa0a27d82000045'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51d125a71144e60865000044'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b7dd86784deedc047d5ad0fb30378bdd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51d125a71144e60865000044'>Peter Bakker</a>
</div>
<a UTCms='1421295964000' class='quanto-date posted-at response-posted-at' href='#54b741594fa0a27d82000045'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I want to throw in another thing relevant to this discussion: Algorithms should be tradeable. One thing mentioned above is the leverage. If you have a leverage higher than 1.3 you are probably not a retail investor.<br>
Another thing is settlements of funds. Some accounts are marked as cash accounts. This means that any strategy that rebalances by selling something on the &quot;signal day&quot; and buying something else in the same bar is not going to be an executable strategy (I found this out through live trading in Quantopian). So to make the strategy work and produce returns in backtesting is something completely different than doing so in real life, as settlement delays and variable leverage allowance is going to influence the Real Returns. So if we could add the type of account to get_environment(), the environment variables of Quantopian (IB has several defined accounts, cash, port.margin, RegT.margin, 401, etc, etc) and we could use those params as a start, then tested returns and real returns might be more alike. </p>

<p>@DanDunn: is that on the roadmap? </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b95af27abf125a81001497' id='54b95af27abf125a81001497'>
<a href='#54b95af27abf125a81001497'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5258725aa09fa7ebaa000024'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7734b86e32e834268bee6749eb322fb4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5258725aa09fa7ebaa000024'>David Edwards</a>
</div>
<a UTCms='1421433595000' class='quanto-date posted-at response-posted-at' href='#54b95af27abf125a81001497'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This is a good discussion, here&#39;s my thought process on the subject. </p>

<p>Cash should be treated the same as any other position in your portfolio. If you have cash in your account, you have a long position on US dollars. Cash just has a very low return (roughly 0% interest) and a very low risk profile. </p>

<p>If you have a negative cash balance, you have a short position on the dollar. Shorting dollars works the same way as shorting any other asset, you borrow the asset and trade it at its current going rate (face value) for some other asset. Later, you can cover your short dollar position by trading the asset for dollars again, if the asset appreciated relative to the dollar (net of interest and fees), then you&#39;ve made a few bucks on the trade.</p>

<p>As for return on initial capital, <strong>if the capital exists, you must account for it</strong>, the form the capital is currently in is irrelevant. Suppose I&#39;m your money manager and you give me $100K to invest on your behalf. One day you call me and ask what your current returns are and I tell you that I&#39;ve made 20%, how much do you assume your account is currently worth?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b95f3b17fa761aa700008f' id='54b95f3b17fa761aa700008f'>
<a href='#54b95f3b17fa761aa700008f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52644024ca8d93cd83000381'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8d551ab607ccce0c136f928118af5ac8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52644024ca8d93cd83000381'>Pynance IO</a>
</div>
<a UTCms='1421434695000' class='quanto-date posted-at response-posted-at' href='#54b95f3b17fa761aa700008f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Being in cash has risk associated, and an opportunity cost. It should certainly be considered when considering return on capital, just like any other asset. I don&#39;t see a compelling reason to make an exception, and if anything I&#39;d rather see a more dynamic model -- options, multiple currency classes, FX exchange rates etc. -- rather than a simplification of tracking.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b962e17abf125a810014eb' id='54b962e17abf125a810014eb'>
<a href='#54b962e17abf125a810014eb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53d46cdb75f57a2832005a6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/62b39881ee19f936224017339779d9d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53d46cdb75f57a2832005a6b'>Market Tech</a>
</div>
<a UTCms='1421435621000' class='quanto-date posted-at response-posted-at' href='#54b962e17abf125a810014eb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Dave E. You reminded me of a post I once made on the TWSAPI list that effectively stated that all trades, and even the act of not trading, are decisions to go both long and short in two (or more) entities. When you earn $100 and stuff that into your mattress you are in essence long USD and short everything else (in the world). Removing that $100 and buying shares in some stock you are now long the stock and short the dollar. Removing that $100 and buying anything, silver, wine, groceries, firewood, shoes, anything -- you are, maybe unbeknownst to you, shorting the dollar and buying long whatever it is you purchased. Your post should remind everyone that money in the bank (or in your pocket) is a long bet on the dollar. What should be a <em>strategic</em> long bet on the dollar. Yes with opportunity costs taken into consideration. But who&#39;d of thought that by keeping that $1 in your pocket and NOT buying that Swiss chocolate candy bar you just earned 10%!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b99be65aece27ea50000bb' id='54b99be65aece27ea50000bb'>
<a href='#54b99be65aece27ea50000bb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1421450217000' class='quanto-date posted-at response-posted-at' href='#54b99be65aece27ea50000bb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><img src="http://sellerline.com/stocks/quantopian/maxspent_calvin.gif" alt="">  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b9f534d80f04bcd10001dd' id='54b9f534d80f04bcd10001dd'>
<a href='#54b9f534d80f04bcd10001dd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1421473078000' class='quanto-date posted-at response-posted-at' href='#54b9f534d80f04bcd10001dd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Both of Calvin&#39;s algos have no leverage--er, margin. (thanks fawce for the correction below)</p>

<p>Here&#39;s a realistic example posted by David Edwards where the algo shows only 3.7% however it is actually almost four times higher at 14.4%. That better code quality is not reflected in the metrics because he didn&#39;t utilize all of the capital, very common.</p>

<p><strong>Quantopian Tutorial with Sample Momentum Algorithm - Lesson 1: The basics of the IDE</strong><br>
<a href="https://www.quantopian.com/posts/quantopian-tutorial-with-sample-momentum-algorithm-lesson-1-the-basics-of-the-ide#54b79bcea35e88ffb4000151">https://www.quantopian.com/posts/quantopian-tutorial-with-sample-momentum-algorithm-lesson-1-the-basics-of-the-ide#54b79bcea35e88ffb4000151</a></p>

<p>The charts and metrics we see on Quantopian currently (2015-01) are only correct in algos that use 100% of starting capital at some point without going over.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b9fbf0168604a9a200021a' id='54b9fbf0168604a9a200021a'>
<a href='#54b9fbf0168604a9a200021a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52644024ca8d93cd83000381'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8d551ab607ccce0c136f928118af5ac8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52644024ca8d93cd83000381'>Pynance IO</a>
</div>
<a UTCms='1421474804000' class='quanto-date posted-at response-posted-at' href='#54b9fbf0168604a9a200021a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Gary, the issue here seems to be what the purpose of the returns metric is. As I see it, it is not meant to track how well the money which got into the market performs, but how effectively the algo manages funds allocated by capital base.</p>

<p>As in your example, if that algo returns 3.7% rather than 14.4%, but that is only because it is not using it&#39;s full potential and investing, say, 1/4 of the available capital, that&#39;s a code problem that I want to know about. Further if your idea were implemented, you may see that 14.4% and get no indication that you have some bug keeping your capital on the sidelines for no reason. So, when you say &quot;in terms of code quality&quot; that&#39;s misleading, because if your code isn&#39;t effectively using the funds which it has under management, that&#39;s a code problem.</p>

<p>One solution is to log the portion of capital which gets invested, on average, and/or the peak. However, since my ultimate goal is to make a return on capital allocated irrespective of what actually gets into the market, I am more interested in performance relative to that number.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54ba276c168604a9a2000298' id='54ba276c168604a9a2000298'>
<a href='#54ba276c168604a9a2000298'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1421485935000' class='quanto-date posted-at response-posted-at' href='#54ba276c168604a9a2000298'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Sounds like many want numbers locked into imaginary use of 100% of capital, I get that.<br>
We need a way to serve both schools of thought.  Who has an idea on how to add other figures? Optionally?</p>

<p>For this notion, forget image-creation in Javascript on the client side. HTML and CSS? Meh, perhaps:<br>
<img src="https://image-proxy.quantopian.com/5d8b131bb4a8536a38f1887fb1bb79eabb9e70b3/687474703a2f2f73656c6c65726c696e652e636f6d2f73746f636b732f7175616e746f7069616e2f72657475726e735f696465612e6a7067" /></p>

<p>Low quality image, sorry.<br>
Btw obviously one can&#39;t have both borrowing and unused cash on the same run, that is for illustrative purposes only.</p>

<p>Thinking out loud.  I already understand it is a big undertaking. ...<br>
There could be a dropdown/option for returns style (plus alpha, beta, sharpe etc), I don&#39;t really like that.<br>
A setting in one&#39;s profile? No.<br>
Possibly at least just a bar along the bottom of the chart to indicate unused cash.<br>
Or could lightly shade the chart background in areas where cash goes negative. Then what about unused cash?<br>
Maybe a vertical side bar.<br>
There&#39;s a lot of clear real estate above the chart next to the buttons for added content.<br>
Your turn.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54ba4c19d80f04a9d7000297' id='54ba4c19d80f04a9d7000297'>
<a href='#54ba4c19d80f04a9d7000297'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/535a81c51f0913316a000242'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/25e01741319f428a0e81b61b4b37b406?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/535a81c51f0913316a000242'>Lucas Silva</a>
</div>
<a UTCms='1421495323000' class='quanto-date posted-at response-posted-at' href='#54ba4c19d80f04a9d7000297'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Everyone expect return to be calculated the way it is, changing it would make it confusing.<br>
Gary has a good point that a metric to measure Algorithm Efficiency would be nice but it is<br>
so hard to define a standard one that it is better to provide all raw information and each user<br>
combine the metrics into their own efficiency value. </p>

<p>I don&#39;t think True Return or return on allocated money can be used without combining with some<br>
method to count the risk.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54ba579dc3d094165c000299' id='54ba579dc3d094165c000299'>
<a href='#54ba579dc3d094165c000299'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1421498271000' class='quanto-date posted-at response-posted-at' href='#54ba579dc3d094165c000299'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;d encourage a broader view here.  One idea I&#39;ve had in mind awhile is the concept of a virtual advisor/assistant/technical support rep.  The basic concept is that a new user could configure their backtest session by answering a series of questions, with the goal of setting up for a realistic simulation for that particular user.  It could be a kind of interactive, guided Q &amp; A, tutorial session, that would result in a custom settings file to be imported:</p>

<pre><code>import my_backtest_settings  
</code></pre>

<p>Then, custom feedback could be provided relative to the settings.  In analogy to simulation software used in science and engineering, unrealistic events (i.e. not realizable vis-a-vis the settings) would generate advisories, warnings, and errors (particularly for time-consuming minutely backtests, it would make sense to stop the algo for errors).  Imagine using an electrical circuit simulation program that doesn&#39;t, by default, adhere to the laws of physics; the same principle applies to financial simulations.</p>

<p>Quantopian is already going down this path with trading guards (<a href="https://www.quantopian.com/help#ide-trading-guards">https://www.quantopian.com/help#ide-trading-guards</a>), but eventually it all needs to pulled together into a set of custom settings that ensure that the backtest is a realistic simulation for a given user.</p>

<p>To Gary&#39;s point, one of the settings could be some measure of the efficiency of capital application, so that an advisory could be issued (I wouldn&#39;t call it a &quot;warning&quot; since anybody who got out of the market into cash prior to 2008-2009 is a genius).  His Calvin example above would result in an advisory, &quot;Potential inefficient use of capital...&quot;</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54baf988bb901d493900000a' id='54baf988bb901d493900000a'>
<a href='#54baf988bb901d493900000a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5258725aa09fa7ebaa000024'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7734b86e32e834268bee6749eb322fb4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5258725aa09fa7ebaa000024'>David Edwards</a>
</div>
<a UTCms='1421539723000' class='quanto-date posted-at response-posted-at' href='#54baf988bb901d493900000a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I understand the point of view about wanting to have a metric based on the capital allocated, but a standardization problem arises when you start creating new metrics. Something that is intuitive for one person may not be intuitive for another, so Quantopian&#39;s methodology is to strictly adhere to what has been widely accepted by the academic community. </p>

<p>After taking an initial look, I think this kind of metric is only valid for long only strategies. I tossed a short sale of 1 share of SPY into this algo, and your print-run summary shows a 160% return, which is not true (the value printed in the logs, not the recorded variable). In order to justify using something it has to be 100% consistent, and work in 100% of possible scenarios. Decades of academic groundwork has been laid down and is widely accepted, I don&#39;t see a way to justify adding something the academic community wouldn&#39;t agree with.</p>

<p>Unless something is an accepted truth in academia, we cannot include it in the API because it creates more confusion than it fixes. However, you will always have the ability to create and record whatever metrics you find most useful within the API.</p>

<p>David  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54bb3799befc3b913f00014b' id='54bb3799befc3b913f00014b'>
<a href='#54bb3799befc3b913f00014b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4e2887701c8cf8364f000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f0da8e39938dae306beaf315b3cb0156?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4e2887701c8cf8364f000001'>John Fawcett</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1421555611000' class='quanto-date posted-at response-posted-at' href='#54bb3799befc3b913f00014b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi,</p>

<p>When I saw Gary&#39;s gif (really got me to laugh, in a good way), I&#39;ve been waiting to for a bit of quiet time to reply. First, I&#39;d like to clarify the behavior that Gary is depicting in the gif. In both cases, there is leverage. I thought it would be useful to explain that point a bit, and define some common terms.</p>

<ul>
<li><strong>Leverage</strong> is just a way of explaining how much market exposure you have relative to the value of your portfolio. Leverage is always defined for a portfolio as a ratio between the total value of your stock positions (excluding cash) and the net liquidating value of your portfolio (stock + cash).<br></li>
<li><strong>Net Liquidating Value</strong> of a portfolio is the cash you would have if you sold all your positions. Net Liquidating Value is the denominator for the leverage ratio. Say you have a $100 in cash, and a single share of ACME worth $100. The net liquidation value of your portfolio is $200. The leverage of that same portfolio is $100 / $200 = 0.5.<br></li>
<li><strong>Margin</strong> is the name for credit extended to you to invest. Leverage doesn&#39;t mean to borrow, but there is a colloquialism in finance to say &quot;you are using leverage&quot;. That actually means that you are buying and selling on <strong>margin</strong> -- borrowing in order to invest. For stocks, you can borrow cash to buy stock, and you can borrow stock to sell it (short selling, which adds a wrinkle to leverage calculations that I&#39;m ignoring here). Margin is the real missing piece for Quantopian&#39;s simulation -- we don&#39;t limit borrowing at all. </li>
</ul>

<p>Leverage is always an informative value, regardless of whether you are using margin. One way to think about it is how much will changes in your stock position be magnified in your portfolio. Let&#39;s go through three examples: one where you have exactly enough cash to buy 1 share of stock, a second where you have much more cash, and a third where you need to borrow cash to buy the stock.  </p>

<p><strong>Case 1: Just the right amount of cash</strong><br>
If you start with $100 in cash, and buy 1 share of ACME for $100, your total stock value will be $100. Your net liquidating value will also be $100. And your leverage would be 1.0. You would have borrowed no cash or stock. If ACME goes to $110, you would have a 10% return. That&#39;s a tidy example that satisfies everyone&#39;s intuition about returns.</p>

<p><strong>Case 2: Much more cash to start</strong><br>
Now, imagine you start with $1,000,000. You then buy 1 share of ACME for $100. Your total stock value would be $100. Your net liquidating value would be $100 in stock plus $999,900 in cash, or $1,000,000. Your leverage = $100 / $1,000,000 = 0.0001. If ACME goes to $110, you would have a 0.001% return. If you ignore your leverage, this example is frustrating. In this case, the leverage figure is minuscule -- it means you have a tiny amount of exposure.</p>

<p><strong>Case 3: Very little cash to start</strong><br>
Finally, imagine you start with $1. You borrow $99 and buy 1 share of ACME for $100. Your total stock value is $100, like before. But your net liquidating value will have to account for the $99 loan you received -- $100 in stock - $99 loan = $1 net liquidating value. Your leverage is 100x. When ACME goes to $110, you will have 10 times your original money, for returns of 1,000%.</p>

<p>While all three cases have very different returns, they also have very different leverage, and you can make sense of the portfolio returns versus the returns of ACME based on the leverage.</p>

<p>Here are a few other facts that can help build your intuition for leverage:</p>

<ul>
<li>Changes in the value of your stock positions will change your leverage. Above I calculated the leverage after the share of ACME is purchased.<br></li>
<li>Changes in the amount of cash will change your leverage. Borrowing cash, receiving dividends, shorting stocks -- all change your leverage.<br></li>
<li>A portfolio with leverage &gt; 1 will tend to increase in leverage as the portfolio value falls, and decrease in leverage as the portfolio value rises.<br></li>
<li>A portfolio with leverage &lt; 1 will tend to decrease in leverage as the portfolio value falls, and increase in leverage as the portfolio value rises.</li>
</ul>

<p>Lastly, I wanted to comment on Gary&#39;s request for the calculation of returns on the capital actually deployed in your positions. I think of the returns figure that Gary is describing as being per position. In a portfolio, you look at the returns for the portfolio as a whole, but you&#39;ll also want to see the returns for each individual position. If we had per position returns, all three examples above would show a 10% return on the position in ACME. That&#39;s very useful information, and I think it is a complement to the existing returns calculation.</p>

<p>thanks,<br>
fawce  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='54bbf07f0c6921fd4a000195' id='54bbf07f0c6921fd4a000195'>
<a href='#54bbf07f0c6921fd4a000195'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1421602946000' class='quanto-date posted-at response-posted-at' href='#54bbf07f0c6921fd4a000195'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><img src="http://sellerline.com/stocks/quantopian/maxspent_calvin_2.gif" alt="">  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54bc72e1f0f0f68b8f000084' id='54bc72e1f0f0f68b8f000084'>
<a href='#54bc72e1f0f0f68b8f000084'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5258725aa09fa7ebaa000024'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7734b86e32e834268bee6749eb322fb4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5258725aa09fa7ebaa000024'>David Edwards</a>
</div>
<a UTCms='1421636324000' class='quanto-date posted-at response-posted-at' href='#54bc72e1f0f0f68b8f000084'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Haha, Awesome Gary! Here is a couple resources from IB about how they handle margin accounts. Specifically Reg-T margin accounts.<br>
<a href="https://www.interactivebrokers.com/en/index.php?f=marginnew&amp;p=overview1">IB Margin overview</a></p>

<p><a href="https://www.interactivebrokers.com/en/index.php?f=margin&amp;p=overview3">IB Margin examples</a></p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54d5a6e387347daf9f00016e' id='54d5a6e387347daf9f00016e'>
<a href='#54d5a6e387347daf9f00016e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1423288039000' class='quanto-date posted-at response-posted-at' href='#54d5a6e387347daf9f00016e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks DE.  Incidentally the algo you posted says right there in two places that it wasn&#39;t geared for shorting so your critique was not applicable. I like your earlier point about cash as another position, just that during code development it isn&#39;t productive to need to be constrained to have to worry about that in my opinion. The quant says: How does this change affect the output? Trying to maintain 100% usage of cash can be like chasing one&#39;s tail.</p>

<p>Here, several anti folks used third-party investor hypotheticals. Third-party will be relevant in the hedge fund. And yet, it&#39;s like saying, when we arrive at the party we have to be all dressed up in suit and tie at our best, and that&#39;s ok, however, getting there is a whole different can of worms, fording rivers and fixing flats on dusty roads. It&#39;s our work-clothes environment I&#39;m addressing. Software development. Preparation. Understanding. Clarity. Certainty. Programming. Not the actual investing phase, not yet.</p>

<p>Here&#39;s an illustration of the problem:<br>
I had been working with my latest code for the last couple of days and just could not for the life of me achieve much beyond the benchmark without a lot of volatility.<br>
Then I swapped these two lines:  </p>

<pre><code>    TakeProfit(context, sec)  
    #order_target(sec, 0)  
</code></pre>

<p>And bam!  Suddenly the output leapt from 68% to 153%. Awesome looking graph. Great!  Right?  Right?? </p>

<p>Wrong. It only <strong>appeared</strong> to be an improvement because ending cash went from positive to negative.<br>
Most people don&#39;t realize it is even happening.</p>

<p>The real result if I had used exactly 100% of initial capital was <strong>worse</strong>. It was down from 68% to 55%. Think about that. Don&#39;t just brush that aside.<br>
The UI said it was more than twice as good as before. Many people would then continue building on that now inferior foundation.<br>
There could be entries in the contest right now doing surprisingly worse than they expected because of this.<br>
There could be real live money at stake, algos that looked great and then poof.</p>

<p>It is impossible to guarantee using 100% of initial capital always, while making changes, even with the simplest of algorithms.<br>
Frankly I don&#39;t see how anyone can argue that the current situation is healthy in the least unless maybe they like that people are being mis-led by the charts and metrics often and therefore being held back. Or maybe people would just rather have a tooth pulled than admit I&#39;m making perfect sense? Or they&#39;ll say, you&#39;re right but--. Hey, no buts. Heh.</p>

<p>I&#39;m suggesting that it can be worthwhile to consider ways to add this metric, <strong>IF</strong> I were 100% in ... then what would my result be. That&#39;s perfect. That&#39;s critical to efficient development. Maybe an option, a tab, something, we can use our heads and creativity, we&#39;re smart people (theoretically).  And thanks fawce for the info on leverage vs margin, first time Calvin and I understood that.  :D  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54d6839a87347daf9f0003f0' id='54d6839a87347daf9f0003f0'>
<a href='#54d6839a87347daf9f0003f0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5258725aa09fa7ebaa000024'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7734b86e32e834268bee6749eb322fb4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5258725aa09fa7ebaa000024'>David Edwards</a>
</div>
<a UTCms='1423344541000' class='quanto-date posted-at response-posted-at' href='#54d6839a87347daf9f0003f0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Gary,<br>
I think Fawce nailed it when he said that this could be achieved by tracking returns on a per position basis in addition to the portfolio level where you&#39;re only concerned with the sum of their effect. Right now the daily PNL is recorded for each position, but the returns on a per position basis would be very useful and could/should be added sometime as well. It would be great to have the ability to plot PNL curves for each security in your portfolio, something like viewing the growth of $100 in just the stock XYZ leg of the portfolio.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54d7f552d0d76e47c0000302' id='54d7f552d0d76e47c0000302'>
<a href='#54d7f552d0d76e47c0000302'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1423439188000' class='quanto-date posted-at response-posted-at' href='#54d7f552d0d76e47c0000302'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Now you switched over to talking about the full backtest environment rather than the IDE chart and metrics under discussion. Ok I think I&#39;ll take a breather (head starting to hurt, tough wall).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56b97083c3c398e7390005bf' id='56b97083c3c398e7390005bf'>
<a href='#56b97083c3c398e7390005bf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1454993542000' class='quanto-date posted-at response-posted-at' href='#56b97083c3c398e7390005bf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Feb 8, 2016 (originally). This marks one year since that last message.</p>

<p><a href="https://www.quantopian.com/posts/pvr">PvR (Profit vs Risk)</a> is a tool I developed to work around this problem.
Using PvR within the last week there have been dramatic improvements to two particular algorithms in profit per dollar activated/spent/risked:</p>

<ol>
<li>58.3% ==&gt; 200% <a href="https://www.quantopian.com/posts/for-robinhood-trading#56b62cbd1efdb381fd0000e4">For Robinhood trading</a><br></li>
<li>108% ==&gt; 344% <a href="https://www.quantopian.com/posts/minimum-variance-w-slash-constraint#56b9683cc3c398a1c200053e">minimum variance w/ constraint</a></li>
</ol>

<p>There was an <a href="https://www.quantopian.com/posts/value-template-long-only-w-slash-trend-filter#55da82a09dc9d44b4b000155">overview of this issue</a> posted Aug 23, 2015</p>

<p>[quote]</p>

<p><em>I would just like to highlight what I think are some truly important take-home messages in this thread. I think Gary’s posts here, here, and within this thread reveal serious deficiencies in the Quantopian backtester. And it looks to me like Gary’s assertions are irrefutable. In many cases, what is displayed in Q’s cumulative returns plot is inaccurate - therefore misleading and untrustworthy.<br>
Here’s what I derive from Gary’s work:</em></p>

<p><em>1. Negative cash flows are frequently obscure and are not accounted for in the returns value and metrics.<br>
2. The Quantopian returns value in the IDE uses initial cash (instead of drawdown) and ignores any negative cash.<br>
3. Backtests are using money they don’t have.<br>
4. The backtest returns and metrics will only be accurate to the degree the algorithm spends 100% of initial capital at some point and no more.<br>
5. Negative cash can increase in magnitude while leverage remains around 1. (The leverage value can’t be trusted either.)<br>
6. For many algorithms, true performance will be worse than what appears in the GUI; for others, the user’s code would actually outperform what the chart indicates. That the UI can reflect returns much better than live trading would produce should concern every developer.<br>
7. The ability to follow the algorithm’s use of capital and monitor unused cash is critical.<br>
8. The “MaxSpentReturns” value in the custom chart is the one we should rely on while developing code, not the value in the backtester.<br>
9. All algorithms should take margin into account.</em></p>

<p><em>For simulations, trading profits and the trading decision model tend to capture most of our attention. But experimental results - in terms of real portfolio end values - must accurately account for margin, drawdown, and leverage. Quantopian&#39;s backtester apparently doesn&#39;t.</em></p>

<p><em>This is not a small issue.</em></p>

<p>[/quote]</p>

<p>Based on the positive results from this metric, it is obvious that it would be highly beneficial to Quantopian and its software developer members.<br>
Rather than maybe, some day, this ought to be priority 1, severity 1.<br>
Could possibly be a third trace on the main chart.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='570637b916f2e108a700012a' id='570637b916f2e108a700012a'>
<a href='#570637b916f2e108a700012a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/562a1289674f851bcb0004e2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d5bd698ff611c488050f57c663ac725a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/562a1289674f851bcb0004e2'>Lake Austin</a>
</div>
<a UTCms='1460025278000' class='quanto-date posted-at response-posted-at' href='#570637b916f2e108a700012a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>John Fawcett  made this very clear.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='582ff35578bd0300150003f4' id='582ff35578bd0300150003f4'>
<a href='#582ff35578bd0300150003f4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1479537501000' class='quanto-date posted-at response-posted-at' href='#582ff35578bd0300150003f4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>John Fawcett made this very clear. </p>
</blockquote>

<p>Except that leverage is not part of the returns calculation and to figure how well one&#39;s stocks are performing, injecting leverage into the equation can&#39;t get there. It can only be done by keeping track of amount risked, put into play.  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/returns'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/returns'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#10767575747271737b506165717e647f6079717e3e737f7d">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
