<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
zipline compatible script
</title>
<meta content='I&#39;m trying to write a script that&#39;s compatable with zipline for offline testing.this looks very tedious, as it appears the quantopian script is actually the body of a class deriving from the zipline.TradingAlgorithm classcould anyone suggest an elegant way of doing this?  I&#39;m not a python person so I&#39;m probably messing up.edit:  i ended up writing a framework here:   https://github.com/Novaleaf/QuantShim  but in the future I&#39;ll be dropping zipline due to its differences/defects.' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="PdCgSkovjvfFdyM1kwPd/bfuM5ytWc8WgcXFx/ItWVVBttYH6NlcFHxqegTc7HWJj2AQ9deV2g0Dyh6tWGg77g==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=false;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/zipline-compatible-script' property='og:url'>
<meta content='zipline compatible script' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/zipline-compatible-script' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='zipline compatible script' property='og:title'>
<meta content='I&#39;m trying to write a script that&#39;s compatable with zipline for offline testing.this looks very tedious, as it appears the quantopian script is actually the body of a class deriving from the zipline.TradingAlgorithm classcould anyone suggest an elegant way of doing this?  I&#39;m not a python person so I&#39;m probably messing up.edit:  i ended up writing a framework here:   https://github.com/Novaleaf/QuantShim  but in the future I&#39;ll be dropping zipline due to its differences/defects.' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/zipline-compatible-script">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='5333ab769db47edbf8000039'>
<div class='post-container' data-post-id='5333ab769db47edbf8000039' id='5333ab769db47edbf8000039'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>zipline compatible script</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<span class='posted-at'>edited </span>
<span UTCms='1401395202000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=zipline compatible script&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fzipline-compatible-script%3Futm_source%3Dwebsite_share%26utm_campaign%3Dzipline-compatable-script%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fzipline-compatible-script%3Futm_source%3Dwebsite_share%26utm_campaign%3Dzipline-compatable-script%26utm_medium%3Dlinkedin&amp;title=zipline+compatible+script+%28Jason+Swearingen%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/zipline-compatible-script?utm_source=website_share&amp;utm_campaign=zipline-compatable-script&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Jason Swearingen" />
<div class='body-text'>
<div class='body-text-container post-body'><p>I&#39;m trying to write a script that&#39;s compatable with zipline for offline testing.</p>

<p>this looks very tedious, as it appears the quantopian script is actually the body of a class deriving from the zipline.TradingAlgorithm class</p>

<p>could anyone suggest an elegant way of doing this?  I&#39;m not a python person so I&#39;m probably messing up.</p>

<p>edit:  i ended up writing a framework here:   <strong><a href="https://github.com/Novaleaf/QuantShim">https://github.com/Novaleaf/QuantShim</a></strong>  but in the future I&#39;ll be dropping zipline due to its differences/defects.</p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>23 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='5333ac5ab71934d361000022' id='5333ac5ab71934d361000022'>
<a href='#5333ac5ab71934d361000022'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1395895388000' class='quanto-date posted-at response-posted-at' href='#5333ac5ab71934d361000022'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>also i see required variables such as data_frequency are not exposed to the quantopian script.   so it seems not possible .....  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5333d33f9db47edbf8000082' id='5333d33f9db47edbf8000082'>
<a href='#5333d33f9db47edbf8000082'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/514a23ed46a2329dd8000027'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f292ab7887c2e8698d013b40e1718e8b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/514a23ed46a2329dd8000027'>Suminda Dharmasena</a>
</div>
<a UTCms='1395905345000' class='quanto-date posted-at response-posted-at' href='#5333d33f9db47edbf8000082'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Use the following after checking out the code from github:</p>

<pre><code># -*- coding: utf-8 -*-  
&quot;&quot;&quot;
Created on Thu Mar 20 12:17:18 2014

@author: Suminda  
&quot;&quot;&quot;

# Delete unused imports once algo is finished

from datetime import datetime

from zipline import *  
from zipline.algorithm import *  
from zipline.api import *  
from zipline.api import *  
from zipline.data import *  
from zipline.errors import *  
from zipline.finance import *  
from zipline.gens import *  
from zipline.protocol import *  
from zipline.sources import *  
from zipline.transforms import *  
from zipline.utils import *  
from zipline.version import *

class commission:  
    def __init__(self):  
        self.PerShare = PerShare  
        self.PerTrade = PerTrade

commission = commission()

class slippage:  
    def __init__(self):  
        self.VolumeShareSlippage = VolumeShareSlippage  
        self.FixedSlippage = FixedSlippage

slippage = slippage()

# Logging. Following imports are not approved in Quantopian  
####################################################################################

import logbook  
import sys

log_format = &quot;{record.extra[algo_dt]}  {record.message}&quot;

zipline_logging = logbook.NestedSetup([  
    logbook.StreamHandler(sys.stdout, level=logbook.INFO, format_string=log_format),  
    logbook.StreamHandler(sys.stdout, level=logbook.DEBUG, format_string=log_format),  
    logbook.StreamHandler(sys.stdout, level=logbook.WARNING, format_string=log_format),  
    logbook.StreamHandler(sys.stdout, level=logbook.NOTICE, format_string=log_format),  
    logbook.StreamHandler(sys.stderr, level=logbook.ERROR, format_string=log_format),  
])
zipline_logging.push_application()

log = logbook.Logger(&#39;Main Logger&#39;)

# Cut and past between the ### line below to Quantopian. Change symbols to sids. E.g. &#39;AAPL&#39; to sid(24)  
####################################################################################

# Place Quantopian approved imports here

def initialize(context):  
    pass


def handle_date(context, data):  
    order(symbol(&#39;AAPL&#39;), 10)


####################################################################################  
# Cut and past between the ### line above to Quantopian. Change symbols to sids. E.g. &#39;AAPL&#39; to sid(24)

if __name__ == &#39;__main__&#39;:  
    import pylab as pl  
    # Any other non approved imports to make things work or to plot results  
    start = datetime(2008, 1, 1, 0, 0, 0, 0, pytz.utc)  
    end = datetime(2014, 1, 1, 0, 0, 0, 0, pytz.utc)  
    # Reference any stocks data you need below  
    data = load_from_yahoo(stocks=[&#39;AAPL&#39;], indexes={}, start=start,  
                           end=end)  
    data = data.dropna()  

    algo = TradingAlgorithm(initialize=initialize,  
                            handle_data=handle_date)  

    results = algo.run(data)  
    results.portfolio_value.plot()  

    pl.show()  
</code></pre>

<p>You need to add following patch to api.py file:</p>

<pre><code>class sid:  
    &quot;&quot;&quot;Default sid lookup for any source that directly maps the  
    sid a symbol.  
    &quot;&quot;&quot;  
    def __init__(self, sid_to_symbol):  
        &quot;&quot;&quot;Initialise the maping of sids to symbols  
        :Arguments:  
            sid_to_symbol : dict  
                Contains the maping  
        &quot;&quot;&quot;  
        self.sid_to_symbol = sid_to_symbol  
    def __call__(self, sid_num):  
        &quot;&quot;&quot;Retrive the symbol corresponding to the sid  
        :Arguments:  
            sid_num : int  
                sid for which the symbol needs to be retrived  
        :Returns:  
            Mapped symbol  
        &quot;&quot;&quot;  
        return self.sid_to_symbol[sid_num]

__all__ = [  
    &#39;sid&#39;,  
    &#39;symbol&#39;,  
    &#39;slippage&#39;,  
    &#39;commission&#39;,  
    &#39;math_utils&#39;,  
    &#39;batch_transform&#39;,  
    &#39;FixedSlippage&#39;,  
    &#39;VolumeShareSlippage&#39;  
]

</code></pre>

<p>Following improvements are needed:</p>

<ul>
<li><code>symbol</code> and <code>sid</code> need to return a security object. Implication is that you cannot call any of the security objects methods as this is represented as a string.</li>
</ul>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5333d436b719341558000073' id='5333d436b719341558000073'>
<a href='#5333d436b719341558000073'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/514a23ed46a2329dd8000027'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f292ab7887c2e8698d013b40e1718e8b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/514a23ed46a2329dd8000027'>Suminda Dharmasena</a>
</div>
<a UTCms='1395905592000' class='quanto-date posted-at response-posted-at' href='#5333d436b719341558000073'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hope the above helps.</p>

<p>if you want to save the results use replacing last part of the file above with this.</p>

<pre><code>####################################################################################  
# Cut and past between the ### line above to Quantopian. Change symbols to sids. E.g. &#39;AAPL&#39; to sid(24)

if __name__ == &#39;__main__&#39;:  
    import pylab as pl  
    from pandas import ExcelWriter  
    import matplotlib.pyplot as plt

    # Any other non approved imports to make things work or to plot results

    start = datetime(1998, 12, 31, 0, 0, 0, 0, pytz.utc)  
    end = datetime(2014, 3, 22, 0, 0, 0, 0, pytz.utc)

    # Reference any stocks data you need below  
    data = load_from_yahoo(stocks=[&#39;SPY&#39;, &#39;XLY&#39;, &#39;XLP&#39;, &#39;XLE&#39;, &#39;XLF&#39;, &#39;XLV&#39;, &#39;XLI&#39;, &#39;XLB&#39;, &#39;XLK&#39;, &#39;XLU&#39;], indexes={}, start=start,  
                           end=end)  
    data = data.dropna()  
    algo = TradingAlgorithm(initialize=initialize,  
                            handle_data=handle_data, capital_base=10000, instant_fill=True)

    results = algo.run(data)

    results.to_csv(&#39;results.csv&#39;)  
</code></pre>

<p>NB: This does not work with Zipline version 0.6 so you have to get the latest from Github.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5333d4bf1af0314dde00007f' id='5333d4bf1af0314dde00007f'>
<a href='#5333d4bf1af0314dde00007f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/514a23ed46a2329dd8000027'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f292ab7887c2e8698d013b40e1718e8b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/514a23ed46a2329dd8000027'>Suminda Dharmasena</a>
</div>
<a UTCms='1395905728000' class='quanto-date posted-at response-posted-at' href='#5333d4bf1af0314dde00007f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Complete api.py file is below so you might not make a mistake:</p>

<pre><code>#  
# Copyright 2014 Quantopian, Inc.  
#  
# Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);  
# you may not use this file except in compliance with the License.  
# You may obtain a copy of the License at  
#  
#     http://www.apache.org/licenses/LICENSE-2.0  
#  
# Unless required by applicable law or agreed to in writing, software  
# distributed under the License is distributed on an &quot;AS IS&quot; BASIS,  
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  
# See the License for the specific language governing permissions and  
# limitations under the License.

# Note that part of the API is implemented in TradingAlgorithm as  
# methods (e.g. order). These are added to this namespace via the  
# decorator `api_methods` inside of algorithm.py.

import zipline  
from .finance import (commission, slippage)  
from .utils import math_utils


from zipline.finance.slippage import (  
    FixedSlippage,  
    VolumeShareSlippage,  
)


batch_transform = zipline.transforms.BatchTransform


def symbol(symbol_str, as_of_date=None):  
    &quot;&quot;&quot;Default symbol lookup for any source that directly maps the  
    symbol to the identifier (e.g. yahoo finance).

    Keyword argument as_of_date is ignored.  
    &quot;&quot;&quot;  
    return symbol_str


class sid:  
    &quot;&quot;&quot;Default sid lookup for any source that directly maps the  
    sid a symbol.  
    &quot;&quot;&quot;  
    def __init__(self, sid_to_symbol):  
        &quot;&quot;&quot;Initialise the maping of sids to symbols  
        :Arguments:  
            sid_to_symbol : dict  
                Contains the maping  
        &quot;&quot;&quot;  
        self.sid_to_symbol = sid_to_symbol  
    def __call__(self, sid_num):  
        &quot;&quot;&quot;Retrive the symbol corresponding to the sid  
        :Arguments:  
            sid_num : int  
                sid for which the symbol needs to be retrived  
        :Returns:  
            Mapped symbol  
        &quot;&quot;&quot;  
        return self.sid_to_symbol[sid_num]

__all__ = [  
    &#39;sid&#39;,  
    &#39;symbol&#39;,  
    &#39;slippage&#39;,  
    &#39;commission&#39;,  
    &#39;math_utils&#39;,  
    &#39;batch_transform&#39;,  
    &#39;FixedSlippage&#39;,  
    &#39;VolumeShareSlippage&#39;  
]

</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5333d59299a9b84b89000084' id='5333d59299a9b84b89000084'>
<a href='#5333d59299a9b84b89000084'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/514a23ed46a2329dd8000027'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f292ab7887c2e8698d013b40e1718e8b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/514a23ed46a2329dd8000027'>Suminda Dharmasena</a>
</div>
<a UTCms='1395905939000' class='quanto-date posted-at response-posted-at' href='#5333d59299a9b84b89000084'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>If you want to use sid you have do the following at the top of your script file:</p>

<pre><code>sid = sid({24 : &#39;AAPL&#39;})  
</code></pre>

<p>then you can use sid as usual as long you give the mapping for all the symbols you like above.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5333d6189db47ec018000093' id='5333d6189db47ec018000093'>
<a href='#5333d6189db47ec018000093'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/514a23ed46a2329dd8000027'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f292ab7887c2e8698d013b40e1718e8b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/514a23ed46a2329dd8000027'>Suminda Dharmasena</a>
</div>
<a UTCms='1395906074000' class='quanto-date posted-at response-posted-at' href='#5333d6189db47ec018000093'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Another important thing to remember is that you have to have the Yahoo ticker list for all the tickers you would be using. (This appears towards the bottom of the file.)</p>

<pre><code>data = load_from_yahoo(stocks=[&#39;AAPL&#39;], indexes={}, start=start,  
                           end=end)  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5333e9489db47edbf80000a3' id='5333e9489db47edbf80000a3'>
<a href='#5333e9489db47edbf80000a3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1395910986000' class='quanto-date posted-at response-posted-at' href='#5333e9489db47edbf80000a3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>thanks Suminda!  I actually spent the last 3 hours writing a framework that should work in both places.   I just got it working in quantopian,  so now I need to get zipline operational to test with.   after that, I&#39;ll make a github project for it.</p>

<p>the main difference with your code is i&#39;m a python noob so I didn&#39;t think about wild-card importing, and i wrote shims for things, plus a new &quot;Framework&quot; class as a facade to abstract all the platform shims/glue away from the user&#39;s algorithm.     </p>

<p>though i&#39;m doing this for use in visual studio, so it&#39;s probably not very &#39;pythonic&#39;</p>

<p>anyway, i&#39;ll post it once i get it tested under zipline.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5333eccb99a9b88da40000c2' id='5333eccb99a9b88da40000c2'>
<a href='#5333eccb99a9b88da40000c2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1395911885000' class='quanto-date posted-at response-posted-at' href='#5333eccb99a9b88da40000c2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>trying to read your code Suminda...  maybe too pythonic for me :P    like i don&#39;t understand </p>

<pre><code>sid = sid({24 : &#39;AAPL&#39;})  
</code></pre>

<p>wouldn&#39;t I want to use the context.mySid=sid(24) ?</p>

<p>i also like how you pass the initialize and handle_data methods to the framework.   i&#39;ll have to do that too.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5333f1dc1af031a3e80000d3' id='5333f1dc1af031a3e80000d3'>
<a href='#5333f1dc1af031a3e80000d3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/514a23ed46a2329dd8000027'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f292ab7887c2e8698d013b40e1718e8b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/514a23ed46a2329dd8000027'>Suminda Dharmasena</a>
</div>
<a UTCms='1395913181000' class='quanto-date posted-at response-posted-at' href='#5333f1dc1af031a3e80000d3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>In you python script you have to use</p>

<pre><code>... sid(24)
</code></pre>

<p>but Zipline does not know about sids so you have give a mapping before this will work. So when you define the sid object you have to pass the mapping to its constructor.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='533402071af03197ad0000e1' id='533402071af03197ad0000e1'>
<a href='#533402071af03197ad0000e1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1395917321000' class='quanto-date posted-at response-posted-at' href='#533402071af03197ad0000e1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>yeah i&#39;m running into that problem now.   also i see that the yahoo data loader is returning the data as a single dataframe.   pretty disappointing to see all these discrepancies.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='533419181af0314dde00013f' id='533419181af0314dde00013f'>
<a href='#533419181af0314dde00013f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1395923225000' class='quanto-date posted-at response-posted-at' href='#533419181af0314dde00013f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>i guess it&#39;s working now..   no need to do any code changes to switch to/from quantopian.  </p>

<p>fyi i circumvented the whole sid problem by just using sid to be a string on zipline, and int on quantopian.  everything still works.</p>

<p>i&#39;ll put this on github in the morning.  honestly going through all this code makes me either hate zipline&#39;s codebase, or python in general.  not sure which.  I probably won&#39;t continue improving this.  it&#39;s just too retarded how the runtimes are so different.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53344ad196e3b37c3b000011' id='53344ad196e3b37c3b000011'>
<a href='#53344ad196e3b37c3b000011'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5258725aa09fa7ebaa000024'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/7734b86e32e834268bee6749eb322fb4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5258725aa09fa7ebaa000024'>David Edwards</a>
</div>
<a UTCms='1395935955000' class='quanto-date posted-at response-posted-at' href='#53344ad196e3b37c3b000011'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for all this Suminda! It will be a big help for setting up a decent local env.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5334d7facabea3de500001bd' id='5334d7facabea3de500001bd'>
<a href='#5334d7facabea3de500001bd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1395972091000' class='quanto-date posted-at response-posted-at' href='#5334d7facabea3de500001bd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>actually not sure there&#39;s interest in a cross-plat framework anyway.   so I&#39;ll paste my current framework below.   <strong><a href="https://github.com/Novaleaf/QuantShim">on this github will be my continued work,</a></strong> but i&#39;ll be abandoning zipline use because of it&#39;s various differences/defects.</p>

<p>current code that works on both is:  </p>

<pre><code>
# Import the libraries we will use here  
import datetime  
import pytz  
import math  
import numpy  
import pandas  
import scipy  
import scipy.stats  
import zipline

#from zipline import *  
#from zipline.algorithm import *  
##from zipline.api import *  
#from zipline.data import *  
#from zipline.errors import *  
#from zipline.finance import *  
#from zipline.gens import *  
#from zipline.protocol import *  
#from zipline.sources import *  
#from zipline.transforms import *  
#from zipline.utils import *  
#from zipline.version import *





#global constants  
global true  
true = 1  
global false  
false = 0




#quantopian shims  
class Shims():  
    class Context():  
        def __init__(this , portfolio = zipline.protocol.Portfolio()): #, tradingAlgorithm = zipline.TradingAlgorithm()):  
            this.portfolio = portfolio  
            #this.tradingAlgorithm = tradingAlgorithm  
            pass  
        pass



    class _Logger():  
        &#39;&#39;&#39;shim for exposing the same logging definitions to visualstudio intelisence&#39;&#39;&#39;  
        #def __init__(this):  
        #   pass    

        def error(this, message):  
            print(&quot;{0} !!ERROR!! {1}&quot;.format(this.framework.get_datetime(),message))  
            pass  
        def info(this, message):  
            print(&quot;{0} info {1}&quot;.format(this.framework.get_datetime(),message))  
            pass  
        def warn(this, message):  
            print(&quot;{0} WARN {1}&quot;.format(this.framework.get_datetime(),message))  
            pass  
        def debug(this, message):  
            print(&quot;{0} debug {1}&quot;.format(this.framework.get_datetime(),message))  
            pass  
        pass



    class _TradingAlgorithm_QuantopianShim:  
        &#39;&#39;&#39;shim of zipline.TradingAlgorithm for use on quantopian &#39;&#39;&#39;  
        def __init__(this):  
            #this.logger = Shims._Logger()  
            #this.logger = log  
            pass  


        def order(this,sid,amount,limit_price=None, stop_price=None):  
            &#39;&#39;&#39;  
            Places an order for the specified security of the specified number of shares. Order type is inferred from the parameters used. If only sid and amount are used as parameters, the order is placed as a market order.  
            Parameters  
            sid: A security object.  
            amount: The integer amount of shares. Positive means buy, negative means sell.  
            limit_price: (optional) The price at which the limit order becomes active. If used with stop_price, the price where the limit order becomes active after stop_price is reached.  
            stop_price: (optional) The price at which the order converts to a market order. If used with limit_price, the price where the order converts to a limit order.  
            Returns  
            An order id.  
            &#39;&#39;&#39;  
            sec = this.context.framework.targetedSecurities[sid]  
            #this.logger.info(sec)  
            order(sec,amount,limit_price,stop_price)  
            pass

        def order_percent(self, sid, percent, limit_price=None, stop_price=None):  
            &quot;&quot;&quot;  
            Place an order in the specified security corresponding to the given  
            percent of the current portfolio value.

            Note that percent must expressed as a decimal (0.50 means 50\%).  
            &quot;&quot;&quot;  
            value = self.context.portfolio.portfolio_value * percent  
            return self.order_value(sid, value, limit_price, stop_price)

        def order_target(self, sid, target, limit_price=None, stop_price=None):  
            &quot;&quot;&quot;  
            Place an order to adjust a position to a target number of shares. If  
            the position doesn&#39;t already exist, this is equivalent to placing a new  
            order. If the position does exist, this is equivalent to placing an  
            order for the difference between the target number of shares and the  
            current number of shares.  
            &quot;&quot;&quot;  
            if sid in self.context.portfolio.positions:  
                current_position = self.context.portfolio.positions[sid].amount  
                req_shares = target - current_position  
                return self.order(sid, req_shares, limit_price, stop_price)  
            else:  
                return self.order(sid, target, limit_price, stop_price)

        def order_target_value(self, sid, target, limit_price=None,  
                               stop_price=None):  
            &quot;&quot;&quot;  
            Place an order to adjust a position to a target value. If  
            the position doesn&#39;t already exist, this is equivalent to placing a new  
            order. If the position does exist, this is equivalent to placing an  
            order for the difference between the target value and the  
            current value.  
            &quot;&quot;&quot;  
            if sid in self.context.portfolio.positions:  
                current_position = self.context.portfolio.positions[sid].amount  
                current_price = self.context.portfolio.positions[sid].last_sale_price  
                current_value = current_position * current_price  
                req_value = target - current_value  
                return self.order_value(sid, req_value, limit_price, stop_price)  
            else:  
                return self.order_value(sid, target, limit_price, stop_price)

        def order_target_percent(self, sid, target, limit_price=None,  
                                 stop_price=None):  
            &quot;&quot;&quot;  
            Place an order to adjust a position to a target percent of the  
            current portfolio value. If the position doesn&#39;t already exist, this is  
            equivalent to placing a new order. If the position does exist, this is  
            equivalent to placing an order for the difference between the target  
            percent and the current percent.

            Note that target must expressed as a decimal (0.50 means 50\%).  
            &quot;&quot;&quot;  
            if sid in self.context.portfolio.positions:  
                current_position = self.context.portfolio.positions[sid].amount  
                current_price = self.context.portfolio.positions[sid].last_sale_price  
                current_value = current_position * current_price  
            else:  
                current_value = 0  
            target_value = self.context.portfolio.portfolio_value * target

            req_value = target_value - current_value  
            return self.order_value(sid, req_value, limit_price, stop_price)

        pass

    class _TradingAlgorithm_ZiplineShim(zipline.TradingAlgorithm):  
        &#39;&#39;&#39;auto-generates a context to use&#39;&#39;&#39;  
        def initialize(this):  
            #delay initialize until start of first handle-data, so our portfolio object is available  
            #this.__isInitialized = false;  
            this.context = Shims.Context()  
            this.context.tradingAlgorithm = this  
            #this.context.portfolio = this.portfolio  
            pass

        def handle_data(this,data):  
            this.context.portfolio = this.portfolio  
            #if not this.__isInitialized:  
            #    this.__isInitialized=true  
            #    this.context.portfolio=this.portfolio  
            this.context.framework.update_timestep(data)  
            pass  
        pass


class FrameworkBase():  
    def __init__(this, context, isOffline):  
        this.isOffline = isOffline  
        this.context = context  
        this.tradingAlgorithm = Shims._TradingAlgorithm_QuantopianShim() #prepopulate to allow intelisence  
        this.tradingAlgorithm = context.tradingAlgorithm  
        this.targetedSecurities = {}  
        this._targetedSecurityIds=[0]  
        del this._targetedSecurityIds[:]  
        if is_offline_Zipline:  
            this.logger = Shims._Logger()  
            this.logger.framework = this  
        else:  
            this.logger = log  
        pass  
    def initialize(this):  
        #do init here  
        if this.isOffline:  
            #passed to the run method  
            this._offlineZiplineData = this.abstract_loadDataOffline_DataFrames()  
            this._targetedSecurityIds = list(this._offlineZiplineData.columns.values)  
        else:  
            this._targetedSecurityIds = [sec.sid for sec in this.abstract_loadDataOnline_SecArray()]  
            #this.tradingAlgorithm.logger.info(len(this.securityIds))  
            #this.tradingAlgorithm.logger.info(this.securityIds)  
        pass

    def abstract_loadDataOffline_DataFrames(this):  
        &#39;&#39;&#39;return a pandas dataframes of securities, ex: using the zipline.utils.factory.load_from_yahoo method  
        these will be indexed in .securityId&#39;s for you to lookup in your abstract_handle_data(data)&#39;&#39;&#39;  
        return pandas.DataFrame()  
        pass  
    def abstract_loadDataOnline_SecArray(this):  
        &#39;&#39;&#39;return an array of securities, ex: [sid(123)]  
        these will be indexed in .securityId&#39;s for you to lookup in your abstract_handle_data(data)&#39;&#39;&#39;  
        return []  
        pass

    def abstract_update_timestep_handle_data(this,data=pandas.DataFrame()):

        &#39;&#39;&#39;find the securities you loaded by .securityId.  
        if the security isn&#39;t present in data  
        , it&#39;s temporally unavailable (not yet listed or already removed from the exchange)  
        &#39;&#39;&#39;  
        pass

    def update_timestep(this,data):  
        &#39;&#39;&#39;invoked by the tradingAlgorithm shim every update.  internally we will call abstract_update_timestep_handle_data()&#39;&#39;&#39;  
        this.targetedSecurities.clear()  
        for qsec in data:  
            if not this.isOffline:  
                sid = qsec.sid  
            else:  
                #if offline zipline, qsec is a string ex: &quot;SPY&quot;  
                sid = qsec;  
                qsec = data[qsec]

            if len(this._targetedSecurityIds)==0 or this._targetedSecurityIds.index(sid)&gt;=0:  
                this.targetedSecurities[sid]=qsec  
        this.data = data  
        this.abstract_update_timestep_handle_data(data)  
    pass

    def get_datetime(this):  
        if is_offline_Zipline:  
            if len(this.targetedSecurities)==0:  
                return datetime.datetime.fromtimestamp(0,pytz.UTC)  
            else:  
                return this.targetedSecurities.values()[0].datetime  
        else:  
            return get_datetime()  
        pass

#entrypoints  
def initialize(context=Shims.Context()):  
    &#39;&#39;&#39;initialize method used when running on quantopian&#39;&#39;&#39;  
    context.tradingAlgorithm = Shims._TradingAlgorithm_QuantopianShim()  
    context.tradingAlgorithm.context = context  
    context.framework = constructFramework(context,false)  
    context.framework.initialize()

    pass

def handle_data(context=Shims.Context(),data=pandas.DataFrame()):  
    &#39;&#39;&#39;update method run every timestep on quantopian&#39;&#39;&#39;  
    context.framework.update_timestep(data)  
    pass

global constructFramework  
def initalize_zipline():  
    &#39;&#39;&#39;initialize method run when using zipline&#39;&#39;&#39;  
    tradingAlgorithm = Shims._TradingAlgorithm_ZiplineShim()  
    context = tradingAlgorithm.context;  
    context.framework = constructFramework(context,true)  
    context.framework.initialize()  
    tradingAlgorithm.run(context.framework._offlineZiplineData)  
    pass




##############  CROSS PLATFORM USERCODE BELOW.   EDIT BELOW THIS LINE

class ExampleAlgo(FrameworkBase):  
    def abstract_loadDataOffline_DataFrames(this):  
        &#39;&#39;&#39;only called when offline (zipline)&#39;&#39;&#39;  
        # Load data  
        start = datetime.datetime(2002, 1, 4, 0, 0, 0, 0, pytz.utc)  
        end = datetime.datetime(2002, 3, 1, 0, 0, 0, 0, pytz.utc)  
        data = zipline.utils.factory.load_from_yahoo(stocks=[&#39;SPY&#39;, &#39;XLY&#39;], indexes={}, start=start,  
                           end=end, adjusted=False)  
        return data  
        pass  
    def abstract_loadDataOnline_SecArray(this):  
        &#39;&#39;&#39;only called when online (quantopian)&#39;&#39;&#39;  
        return [  
                sid(8554), # SPY S&amp;P 500  
                ]  
        pass

    def abstract_update_timestep_handle_data(this, data = pandas.DataFrame()):  
        &#39;&#39;&#39; order 1 share of the first security each timestep&#39;&#39;&#39;  
        if(len(this._targetedSecurityIds)&gt;0):  
            this.logger.info(&quot;buy {0} x1&quot;.format(this._targetedSecurityIds[0]));  
            this.tradingAlgorithm.order(this._targetedSecurityIds[0],1)  
            pass  
        else:  
            this.logger.info(&quot;no security found this timestep&quot;);  
    pass  

##############  CONFIGURATION BELOW

def constructFramework(context,isOffline):  
    &#39;&#39;&#39;factory method to return your custom framework/trading algo&#39;&#39;&#39;  
    return ExampleAlgo(context,isOffline);

############## OFLINE RUNNER BELOW.  EDIT ABOVE THIS LINE  
is_offline_Zipline = false  
if __name__ == &#39;__main__&#39;:  
    #import pylab  
    is_offline_Zipline = true

if(is_offline_Zipline):  
    initalize_zipline()  
    pass

</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='533514dc96e3b3f33e000210' id='533514dc96e3b3f33e000210'>
<a href='#533514dc96e3b3f33e000210'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1395987678000' class='quanto-date posted-at response-posted-at' href='#533514dc96e3b3f33e000210'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>fyi the github repo has an improved (but quantopian only) version of my framework now.   I need this as an intraday/live trading framework, so I&#39;ll be continually updating it until it&#39;s on par with my previous (interday only) framework.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53362701a4745ff4d3000179' id='53362701a4745ff4d3000179'>
<a href='#53362701a4745ff4d3000179'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1396057858000' class='quanto-date posted-at response-posted-at' href='#53362701a4745ff4d3000179'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jason: Nice work! But why can&#39;t you use zipline.api for this? Should reduce your code burden.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5336297ea4745ff4d3000189' id='5336297ea4745ff4d3000189'>
<a href='#5336297ea4745ff4d3000189'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1396058495000' class='quanto-date posted-at response-posted-at' href='#5336297ea4745ff4d3000189'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Thomas, I didn&#39;t know such a thing existed (you replied acknowledging my rant about no docs)    I searched online and I see this: <a href="https://github.com/quantopian/zipline/blob/master/zipline/api.py">https://github.com/quantopian/zipline/blob/master/zipline/api.py</a> but it&#39;s not obvious to me how that would help?  Could you please elaborate?   Sorry I&#39;m not a python person so I might be missing something obvious to the PEP inclined.</p>

<p>also fyi during my search just now I found what appear to be the built html version of the docs:  <a href="http://zipline.readthedocs.org/en/latest/">http://zipline.readthedocs.org/en/latest/</a>  Is that reasonablly up to date?</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53362a64bfba6ccb88000163' id='53362a64bfba6ccb88000163'>
<a href='#53362a64bfba6ccb88000163'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1396058725000' class='quanto-date posted-at response-posted-at' href='#53362a64bfba6ccb88000163'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>it looks like with zipline.api I should be able to add this to the offline-zipline version, is this correct?  </p>

<pre><code>import zipline.api  
symbol(&quot;SPY&quot;)  
#etc for the quantopian slippage/commision/etc global methods  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5336301e2981043818000143' id='5336301e2981043818000143'>
<a href='#5336301e2981043818000143'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1396060192000' class='quanto-date posted-at response-posted-at' href='#5336301e2981043818000143'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Unfortunately the readthedocs is not up-to-date. We&#39;ll add new docs to zipline.io.</p>

<p>zipline.api is work in progress so that&#39;s why it&#39;s not advertised but the idea is to be able to write Quantopian algos that can be run on zipline (and vice versa). Thus if you do (although explicit imports are to be preferred in Python):</p>

<pre><code>from zipline.api import *  
</code></pre>

<p>You should get some of the functionality like the order methods, symbol() etc (if your zipline is from github master). See here for a simple example of instantiating an algorithm like that:<br>
<a href="https://github.com/quantopian/zipline/blob/master/zipline/examples/quantopian_buy_apple.py">https://github.com/quantopian/zipline/blob/master/zipline/examples/quantopian_buy_apple.py</a>  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5336352c298104381800014c' id='5336352c298104381800014c'>
<a href='#5336352c298104381800014c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530db036ff0da19ab9000253'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4b4da70bef68f9e309c46e2661d4eeb8?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530db036ff0da19ab9000253'>Jason Swearingen</a>
</div>
<a UTCms='1396061486000' class='quanto-date posted-at response-posted-at' href='#5336352c298104381800014c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>ok thank you!  I&#39;ll work on getting the project zipline compatable again after I finish adding features.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='538609b89f4f6e2ed500002b' id='538609b89f4f6e2ed500002b'>
<a href='#538609b89f4f6e2ed500002b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1401293242000' class='quanto-date posted-at response-posted-at' href='#538609b89f4f6e2ed500002b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Check out our new blog post on this topic:<br>
<a href="http://blog.quantopian.com/unifying-zipline-quantopian/">http://blog.quantopian.com/unifying-zipline-quantopian/</a>  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='53860d719f4f6e8209000037' id='53860d719f4f6e8209000037'>
<a href='#53860d719f4f6e8209000037'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/514a23ed46a2329dd8000027'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f292ab7887c2e8698d013b40e1718e8b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/514a23ed46a2329dd8000027'>Suminda Dharmasena</a>
</div>
<a UTCms='1401294196000' class='quanto-date posted-at response-posted-at' href='#53860d719f4f6e8209000037'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>OK Great</p>

<p>BTW, are the docs updated for the IPython Magic? (Pl. assume no knowledge in Python, IPython, Zipline, Quantopian)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='53860e5f20c8963b3200003e' id='53860e5f20c8963b3200003e'>
<a href='#53860e5f20c8963b3200003e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f1edd0b03b228000d000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/81292895877c628963a3b56b408533e7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f1edd0b03b228000d000001'>Thomas Wiecki</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1401294433000' class='quanto-date posted-at response-posted-at' href='#53860e5f20c8963b3200003e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Not yet, but they will be for the 0.6.2 release.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='538613f0f68da5c3fe000038' id='538613f0f68da5c3fe000038'>
<a href='#538613f0f68da5c3fe000038'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/514a23ed46a2329dd8000027'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f292ab7887c2e8698d013b40e1718e8b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/514a23ed46a2329dd8000027'>Suminda Dharmasena</a>
</div>
<a UTCms='1401295858000' class='quanto-date posted-at response-posted-at' href='#538613f0f68da5c3fe000038'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>OK.</p>

<p>Another thing is we are in no man&#39;s land since the batch_trasform is deprecated and buggy and history is not yet fully functional and implementation is quaky and does not support minute mode at least. When writing an algo for live trading without backfilling it will not run immediately.  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/zipline-compatible-script'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/zipline-compatible-script'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#46202323222427252d06373327283229362f27286825292b">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
