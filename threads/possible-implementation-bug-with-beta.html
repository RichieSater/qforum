<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Possible Implementation Bug With Beta?
</title>
<meta content='There is a possible inconsistency and/or vulnerabilty in code from the Q model algo cloned from here  Quantopian Risk Model In Algorithms . I would rather call it a possible implementation bug. This snippet of code pertaining to beta (also recently changed to SimpleBeta) is exposed for users to change: # Alpha Combination  # -----------------  # Assign every asset a combined rank and center the values at 0.  # For UNIVERSE_SIZE=500, the range of values should be roughly -250 to 250. ...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="ZcXGbYw90dCer1rd5XIznIO0rhJWEWSBhbZhlBr3kHQZo7AgLssDMyeyA+yqnZvouzqNeyzdcZoHubr+sLLyzw==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=false;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/possible-implementation-bug-with-beta' property='og:url'>
<meta content='Possible Implementation Bug With Beta?' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/possible-implementation-bug-with-beta' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Possible Implementation Bug With Beta?' property='og:title'>
<meta content='There is a possible inconsistency and/or vulnerabilty in code from the Q model algo cloned from here  Quantopian Risk Model In Algorithms . I would rather call it a possible implementation bug. This snippet of code pertaining to beta (also recently changed to SimpleBeta) is exposed for users to change: # Alpha Combination  # -----------------  # Assign every asset a combined rank and center the values at 0.  # For UNIVERSE_SIZE=500, the range of values should be roughly -250 to 250. ...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/possible-implementation-bug-with-beta">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='5a631a558379cd1378af37c9'>
<div class='post-container' data-post-id='5a631a558379cd1378af37c9' id='5a631a558379cd1378af37c9'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Possible Implementation Bug With Beta?</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<span class='posted-at'>posted </span>
<span UTCms='1516444245000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Possible Implementation Bug With Beta?&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fpossible-implementation-bug-with-beta%3Futm_source%3Dwebsite_share%26utm_campaign%3Dpossible-implementation-bug-with-beta%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fpossible-implementation-bug-with-beta%3Futm_source%3Dwebsite_share%26utm_campaign%3Dpossible-implementation-bug-with-beta%26utm_medium%3Dlinkedin&amp;title=Possible+Implementation+Bug+With+Beta%3F+%28James+Villa%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/possible-implementation-bug-with-beta?utm_source=website_share&amp;utm_campaign=possible-implementation-bug-with-beta&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="James Villa" />
<div class='body-text'>
<div class='body-text-container post-body'><p>There is a possible inconsistency and/or vulnerabilty in code from the Q model algo cloned from here <a href="https://www.quantopian.com/posts/quantopian-risk-model-in-algorithms">Quantopian Risk Model In Algorithms</a>. I would rather call it a possible implementation bug. This snippet of code pertaining to beta (also recently changed to SimpleBeta) is exposed for users to change:</p>

<pre><code># Alpha Combination  
# -----------------  
# Assign every asset a combined rank and center the values at 0.  
# For UNIVERSE_SIZE=500, the range of values should be roughly -250 to 250.  
combined_alpha = (fcf_zscore + yield_zscore + sentiment_zscore).rank().demean()  
**beta = 0.66*RollingLinearRegressionOfReturns(  
                target=sid(8554),  
                returns_length=5,  
                regression_length=260,  
                mask=combined_alpha.notnull() &amp; Sector().notnull()  
                ).beta + 0.33*1.0**  
</code></pre>

<p>This beta calculation is used to constrain beta to minimum and maximum levels per user setting in Optimize API:</p>

<pre><code># Constrain beta-to-SPY to remain under the contest criteria.  
beta_neutral = opt.FactorExposure(  
    pipeline_data[[&#39;beta&#39;]],  
    **min_exposures={&#39;beta&#39;: -0.05},  
    max_exposures={&#39;beta&#39;: 0.05},**  
)  
</code></pre>

<p>Contest threshold for beta is between +- 0.30. If user has the option to change window length in beta calculation, (1) doesn&#39;t this create inconsistencies with the beta threshold of +-0.30 because the beta distribution of different window lengths is also different, and (2) doesn&#39;t this create vulnerabilities in the sense that it could be used to &quot;game&quot; the algo if the beta constraint operation in Optimize API actually worked. I think the beta calculation code should be hardwired to standardized one year daily returns and hidden from user to change parameters perhaps in the riskloadings pipeline.  Beta calculation should have fixed window length not configurable by user to be standardized, otherwise, the contest threshold for beta of between +- 0.30 becomes relative. So let&#39;s test this and see what the impact is against the baseline code. The only change we will make is change the regression_length=260 to regression_length=63. Below is first the baseline and next is the revision:</p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>20 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='5a631d6630e79823d45631ae' id='5a631d6630e79823d45631ae'>
<a href='#5a631d6630e79823d45631ae'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516445030000' class='quanto-date posted-at response-posted-at' href='#5a631d6630e79823d45631ae'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>And here is revised algo that changes the regression_length from 260 to 63.  The differences from baseline are:<br>
     Total Returns  +0.29%<br>
      Alpha - None, both the same<br>
     Beta -0.01<br>
     Sharpe -0.03<br>
     Sortino -0.05<br>
     Volatility - None, both the same<br>
     Max Drawdown +0.13</p>

<p>Now draw your conclusions....  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a632efd30e79823d45632d6' id='5a632efd30e79823d45632d6'>
<a href='#5a632efd30e79823d45632d6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516449533000' class='quanto-date posted-at response-posted-at' href='#5a632efd30e79823d45632d6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>It is also important to note that when I ran different  scenarios by changing or tweaking user configurable parameters, I get the same exact result as with revision (1)  basically an improvement in total returns and maximum drawdowns but a degradation in Sharpe and Sortino and no effect on others.  Revision (2) uses SimpleBeta instead of the older RollingRegression method and changing the window_length from 260 to 63 and revision (3) is eliminating all references and calculations of beta in line with my hypothesis in this thread <a href="https://www.quantopian.com/posts/beta-constraint-in-risk-model-totally-unnecessary">beta-constraint-in-risk-model-totally-unnecessary</a></p>

<p>Now when I tried Grant&#39;s proposed tweak in the above mentioned thread :</p>

<blockquote>
<p>A brief note, in case folks are dinking around with trying to null out beta. I&#39;ve found that a bias is required by the Optimize API constraints to see a dramatic effect:</p>
</blockquote>

<p>MIN_BETA_EXPOSURE = -1<br>
MAX_BETA_EXPOSURE = -0.5<br>
I think what&#39;s going on is that for a volatile universe, the trailing beta factor is not predictive for stocks that are tending to run up with the bull market. So, a biased Optimize API constraint on beta is required to compensate for the lack of predictability.</p>

<p>So, in this Q model algo under examine, revision(4) we change MIN_BETA_EXPOSURE = -1  and MAX_BETA_EXPOSURE = -0.5 per Grant.<br>
I get this error:</p>

<blockquote>
<p>ValueError: NaN or Inf values provided to FactorExposure for argument &#39;loadings&#39;.<br>
Rows/Columns with NaNs:<br>
row=Equity(8817 [GGP]) col=&#39;beta&#39;<br>
row=Equity(21284 [ITMN]) col=&#39;beta&#39;<br>
row=Equity(22269 [SLXP]) col=&#39;beta&#39;<br>
row=Equity(30464 [VHC]) col=&#39;beta&#39;<br>
Rows/Columns with Infs:<br>
None<br>
There was a runtime error on line 147.</p>
</blockquote>

<p>I suspected it had something to do with old beta calculation using RollingRegression method, so I replace it with SimpleBeta default settings and eliminated the error and also gave exact same results as revision(1). Here is it, with Grant&#39;s &quot;wacky&quot; tweak:</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a633b108379cd1378af39da' id='5a633b108379cd1378af39da'>
<a href='#5a633b108379cd1378af39da'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1516452624000' class='quanto-date posted-at response-posted-at' href='#5a633b108379cd1378af39da'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Demeaning beta as a test, no difference.</p>

<pre><code>context.pipeline_data = algo.pipeline_output(&#39;pipe&#39;)  
context.pipeline_data.beta -= context.pipeline_data.beta.mean()  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a633e574491d2032ce7ed1e' id='5a633e574491d2032ce7ed1e'>
<a href='#5a633e574491d2032ce7ed1e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516453463000' class='quanto-date posted-at response-posted-at' href='#5a633e574491d2032ce7ed1e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Blue, when you say &quot;no difference&quot;, is it no difference to baseline or revisions(1-4)?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a63457f8379cd3dfaaf318a' id='5a63457f8379cd3dfaaf318a'>
<a href='#5a63457f8379cd3dfaaf318a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516455295000' class='quanto-date posted-at response-posted-at' href='#5a63457f8379cd3dfaaf318a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi James -</p>

<p>I think the main issue here may be that in order for the Optimize API to be effective in keeping beta in check, it needs a beta <em>forecast</em> (just like an alpha factor needs to be predictive).  The whacky thing I did, biasing the beta constraint, is probably plain old look-ahead bias (over-fitting...call it what you will).  What&#39;s needed is a way to predict beta in such a way that the Optimize API can do a better job going forward, while still being able to trade volatile stocks that don&#39;t move in lock-step with the market.  At least that&#39;s my intuition at this point.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a63471a30e7980b8f563c4f' id='5a63471a30e7980b8f563c4f'>
<a href='#5a63471a30e7980b8f563c4f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516455706000' class='quanto-date posted-at response-posted-at' href='#5a63471a30e7980b8f563c4f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Observations here and simultaneuosly in Grant&#39;s thread here <a href="https://www.quantopian.com/posts/beta-constraint-study">beta-constraint-study</a> lead to several findings that are confirming of my hypothesis in this thread  <a href="https://www.quantopian.com/posts/beta-constraint-in-risk-model-totally-unnecessary">beta-constraint-in-risk-model-totally-unnecessary</a> that beta is not only totally unnecessary but also (1) beta constraint in Optimize  does not do a good job constraining beta to configurable set levels, (2) implementation bug, exposing beta calculation to become user configurable lead to inconsistencies and vulnerabilities and (3) doing away with beta totally has positive effects in terms of increased returns and improved drawdowns. In short, it does not work properly.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a634d098379cd769daf3b64' id='5a634d098379cd769daf3b64'>
<a href='#5a634d098379cd769daf3b64'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516457225000' class='quanto-date posted-at response-posted-at' href='#5a634d098379cd769daf3b64'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I suspect that nothing is broken.  The fundamental issue is that if one picks stocks that are not volatile and have common betas (e.g. are all strongly correlated with SPY), then using a simple trailing window regression beta estimate is fine.  However, it may be impossible to do much better than the risk-free rate trading them long-short.  So, one needs to look to another universe of stocks, which is less predictable, and this is where things fall apart.</p>

<p>So, I think to move this forward, it would be of interest to hear of ways of predicting beta better as an input to the optimization.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a6354ed8379cd0a8caf3734' id='5a6354ed8379cd0a8caf3734'>
<a href='#5a6354ed8379cd0a8caf3734'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516459245000' class='quanto-date posted-at response-posted-at' href='#5a6354ed8379cd0a8caf3734'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant, it is broken, simply does not work properly as intended. You can try making it work, good luck with that.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a6357be8379cd721faf2e12' id='5a6357be8379cd721faf2e12'>
<a href='#5a6357be8379cd721faf2e12'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516459966000' class='quanto-date posted-at response-posted-at' href='#5a6357be8379cd721faf2e12'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I think it is a question of what is broken.  For example, the Optimize API seems o.k.:  </p>

<pre><code>class FactorExposure(loadings, min_exposures, max_exposures)

Constraint requiring bounded net exposure to a set of risk factors.

Factor loadings are specified as a DataFrame of floats whose columns are factor labels and whose index contains Assets. Minimum and maximum factor exposures are specified as maps from factor label to min/max net exposure.

For each column in the loadings frame, we constrain:

(new_weights * loadings[column]).sum() &gt;= min_exposure[column]  
(new_weights * loadings[column]).sum() &lt;= max_exposure[column]

Parameters: 

    loadings (pd.DataFrame) -- An (assets x labels) frame of weights for each (asset, factor) pair.  
    min_exposures (dict or pd.Series) -- Minimum net exposure values for each factor.  
    max_exposures (dict or pd.Series) -- Maximum net exposure values for each factor.
</code></pre>

<p>It does work, as I showed, by biasing the beta contraint (offsetting its mean from zero).  So this would suggest that if one had a way of predicting the required offset better point-in-time, then it would work.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a6361ad30e7980b8f563e23' id='5a6361ad30e7980b8f563e23'>
<a href='#5a6361ad30e7980b8f563e23'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516462509000' class='quanto-date posted-at response-posted-at' href='#5a6361ad30e7980b8f563e23'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant, one symptom that it is broken is when its purpose does not attain the desired objective. The purpose of constraining beta in Optimize API is with the desired objective of complying with the beta thresholds of a fixed range +- 0.30.  Numerous examples both you and I ran shows that it is not doing a job in constraining beta to what the user set it to be, i.e. +- 0.05.  You can only validly test the effectiveness or not of constraining beta to desired levels as long as they are set inbounds of the beta thresholds.  Now under your scenario you have gone out of bounds of the beta thresholds and it gave you funky results. You have in effect changed the purpose of beta constraint to something else!  It is no longer meant to  constraint beta to comply with the thresholds but now asking that beta to &quot;explore where it has never gone before&quot;, and that does not also mean that you will find the holy grail.  It simply means it is broken.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a63648f30e7980b8f563e55' id='5a63648f30e7980b8f563e55'>
<a href='#5a63648f30e7980b8f563e55'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516463247000' class='quanto-date posted-at response-posted-at' href='#5a63648f30e7980b8f563e55'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><blockquote>
<p>one symptom that it is broken is when its purpose does not attain the desired objective</p>
</blockquote>

<p>Agreed.  The problem potentially, though, is that forecasting beta with complete accuracy is probably not so easy.  I&#39;m wondering if Alphalens could be adapted to look at beta as a factor, not for forecasting returns but forecasting itself?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a636c7430e79818b1563b82' id='5a636c7430e79818b1563b82'>
<a href='#5a636c7430e79818b1563b82'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516465268000' class='quanto-date posted-at response-posted-at' href='#5a636c7430e79818b1563b82'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant, you are one tough nut to crack, LOL!  Generally, if one can forecast a future variable with a statistically significant degree of accuracy, you are creating alpha. Empirical studies already shows that the stock universe generally moves with the market, the underlying foundation of my hypothesis in the other thread.  In beta to SPY terms computed using industry standards (one year daily returns), this translates to a stock&#39;s beta to almost always have a positive correlation with SPY and on the average, will be highly correlated.  Above two sigma or black swan scenarios do occur, i.e. Facebook IPO, its initial price movements may be totally uncorrelated to SPY movements point in time.   So if you can accurately predict beta and improve your returns then yes, I would have to say you are creating  alpha because you found a way to arbitrage price inefficiencies cause by beta variations. Good luck with that!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a637dc68379cd0a8caf3a64' id='5a637dc68379cd0a8caf3a64'>
<a href='#5a637dc68379cd0a8caf3a64'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516469702000' class='quanto-date posted-at response-posted-at' href='#5a637dc68379cd0a8caf3a64'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yes, the idea that one is going to null out beta perfectly with a simple trailing beta indicator won&#39;t work so well (and I agree that it is a mirage that it is working, when dealing with a basket of stocks that are all highly correlated to SPY and the correlation persists...in this case, the dollar-neutral constraint suffices and additionally, it will be really hard to make money because of all of the CAPM/EMH arguments).  Hence, I started exploring the extremes of the QTradableStocksUS.  The hard part is getting beta ~ 0, since the Q recipe doesn&#39;t work (unless one is dealing with SPY-like baskets, which won&#39;t have much alpha in the first place).  At least that&#39;s what I&#39;m gathering from all of this...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a63980f30e7980461563bef' id='5a63980f30e7980461563bef'>
<a href='#5a63980f30e7980461563bef'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1516476431000' class='quanto-date posted-at response-posted-at' href='#5a63980f30e7980461563bef'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>To answer, there are three backtests above my demean test and I used the first one, baseline. <em>The other two have beta_neutral commented out, no difference would be expected.</em> I&#39;d suggest maybe try flipping beta values and see if there is a difference. And then without market_neutral.</p>

<pre><code>context.pipeline_data = algo.pipeline_output(&#39;pipe&#39;)  
context.pipeline_data.beta *= -1  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a639e7b30e798000e56451e' id='5a639e7b30e798000e56451e'>
<a href='#5a639e7b30e798000e56451e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516478075000' class='quanto-date posted-at response-posted-at' href='#5a639e7b30e798000e56451e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Blue, forgive me for not understanding your answer (maybe my low IQ is kicking in!). Am I interpreting this correct, you took the baseline code, you demeaned the beta in the pipeline and then commented out the beta neutral constraint in the Optimize API and you get the same results as the baseline? Am I correct in my interpretation?  This is rather not suprising because once you comment out the beta constraint in Optimize API, no amount of data transformation (in your case, demean)  to beta can or should have any effect to the algo performance since you&#39;ve already eliminated the beta constraint in Optimize API. It will still calculate the algos ex post beta. Beta can only have an effect to the algo&#39;s performance, if you incorporated it as an alpha factor to your algo.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a63e145746872000e06e9e4' id='5a63e145746872000e06e9e4'>
<a href='#5a63e145746872000e06e9e4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1516495173000' class='quanto-date posted-at response-posted-at' href='#5a63e145746872000e06e9e4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Whew, those were some impressive misunderstandings of what I said. Welp, we all have tough days so I can understand.<br>
I&#39;ll just present more detail since I have more results to add now.<br>
The idea is to throw bogus beta values at it to see how much difference they make.<br>
This is a test, this is only a test. If this had been a competing algorithm the metrics would be better.</p>

<p>In the following, just like in my stuff above, beta_neutral is always active ...</p>

<pre><code>Original baseline (the first backtest at the top of this page)  
 Ret    Bench   Alpha   Beta  Shrp  Srtno  Vltly    DD  
37.21%  74.36%   0.09  -0.06  1.75   2.67   0.05  -4.22%

Original baseline with beta demeaned (all shifted downward by the average so-to-speak)  
 Ret    Bench   Alpha   Beta  Shrp  Srtno  Vltly    DD  
37.23%  74.36%   0.09  -0.06  1.75   2.67   0.05  -4.22%

Original baseline with beta * -1 (positive made negative and negative made positive)  
 Ret    Bench   Alpha   Beta  Shrp  Srtno  Vltly    DD  
37.21%  74.36%   0.09  -0.06  1.75   2.67   0.05  -4.22%

Original baseline with market_neutral deactivated, no other changes  
 Ret    Bench   Alpha   Beta  Shrp  Srtno  Vltly    DD  
40.4%   74.36%   0.10  -0.04  1.90   2.92   0.05  -4.32%

Original baseline with market_neutral deactivated and beta * -1  
 Ret    Bench   Alpha   Beta  Shrp  Srtno  Vltly    DD  
40.4%   74.36%   0.10  -0.04  1.90   2.92   0.05  -4.32%  
</code></pre>

<p>Conclusion: beta_neutral appears to be having no effect and there isn&#39;t enough information to draw much more of a conclusion except ...<br>
Beyond that, a theory could be that alpha and sentiment (incorporated into combined_alpha) are significant and beta is pretty much nothing by comparison. I imagine that can be the case when algo beta is already in fairly good shape.</p>

<p>. .</p>

<p>Below is the code I used to multiply beta values by -1 to flip them upside-down.<br>
Now, someone might think, why on earth would you do that? Because, when Optimize sees low beta, for example, below zero, I&#39;m assuming it would say, let&#39;s apply a little more weight to stocks with higher beta values, and part of the overall complaint on this page, as I understand it, is, that that may not be working right, so, if Opt is in fact doing that, it would now be giving more weight to stocks that actually have lower beta values, and one could expect the algorithm overall beta to move even further away from zero. Again, it is a test, the point is to learn something, and what&#39;s learned is, while I expected an effect, there is no effect.</p>

<pre><code>def before_trading_start(context, data):  
    context.risk_loading_pipeline = algo.pipeline_output(&#39;risk_loading_pipeline&#39;)  
    context.pipeline_data = algo.pipeline_output(&#39;pipe&#39;)

    # Multiplying beta values by -1  
    # If beta_neutral is doing much, this should show quite a difference.  
    ori = context.pipeline_data.copy().head(1)  
    context.pipeline_data[&#39;beta&#39;] = context.pipeline_data[&#39;beta&#39;].copy() * -1

    return    # Comment this to deactivate it if you want to verify that the changes stuck  
    log.info(&#39;{} -&gt; {}  {}&#39;.format(  
            &#39;%.1f&#39; % ori.beta,  
            &#39;%.1f&#39; % context.pipeline_data.beta.head(1),  
            ori.index  
    ))

</code></pre>

<p>A more effective test would be to check any allocation differences with and without beta_neutral along with their beta values. This was just quicker.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a649b36746872001706f783' id='5a649b36746872001706f783'>
<a href='#5a649b36746872001706f783'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516542774000' class='quanto-date posted-at response-posted-at' href='#5a649b36746872001706f783'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi James -</p>

<p>I don&#39;t have the financial modeling background that some here have, but I gather that there are several dimensions of this problem to consider:</p>

<ol>
<li>The combination of the two constraints and their interplay: dollar-neutral and beta-neutral.  Point-in-time, dollar neutrality means that if one closes out all of the long positions and ends up with some cash, and does the same with the short positions, there&#39;s nothing left.  It can be implemented with an 
<code>order_target_percent</code> approach such that the portfolio weights sum to zero (although this doesn&#39;t guarantee dollar-neutrality, since one is relying on the orders being filled completely and at exactly the anticipated (i.e. forecast) prices).  Under the constraints of the <a href="https://www.quantopian.com/posts/a-new-contest-is-coming-more-winners-and-a-new-scoring-system">new contest</a> (mirroring requirements for a hedge-fund-suitable algo), it appears to be reasonable.  The expectation is that algos will be holding 100-150 stocks from the <code>QTradableStocksUS</code> at an point in time, with equal weights long and short.  The beta-neutral constraint is an overlay on top of the dollar-neutral one, which says that point-in-time, the trailing beta with respect to SPY needs to be low (ideally beta ~ 0, but |beta| ~ 0.3 is acceptable).  It is independent of the dollar-neutral constraint.  For example, one could go long on the high-beta stocks in the <code>QTradableStocksUS</code> and go short on the low-beta ones, inducing a skew.  Both dollar neutrality and beta-neutrality are considered &quot;risks&quot; that need to be managed; Quantopian has provided constraints within the Optimize API to manage the risks point-in-time.<br></li>
<li>Managing the dollar-neutrality and beta-neutrality risks both require seeing into the future.  For the former, one only needs to see a small <code>delta_t</code> into the future, and on a portfolio of 100-150 stocks, the discrepancies average out.  The baseline approach to managing beta-neutrality is to use a 1-year historical measure of beta for each stock, and constrain orders under the assumption that the trailing beta measure will persist (&quot;the calculation is now simply the 6 month rolling beta&quot;).  It would seem that achieving beta-neutrality is quite a different ballgame from that of dollar-neutrality, at least as it is implemented on Quantopian.<br></li>
<li>It is worth noting that there is no hard contest requirement to use the Optimize API in all of its glory; one just needs to use <code>order_optimal_portfolio</code> for all orders.  So, for a given strategy, the recommended risk-management tools need not be applied; &quot;roll your own&quot; if you want (open-sourcing the Optimize API and risk model would help in this regard...still waiting for a response from Quantopian on this topic).<br></li>
<li>As illustrated on a different <a href="https://www.quantopian.com/posts/beta-constraint-study">thread</a>, the Optimize API standard beta-constraint approach can be used in a kludgey way to achieve beta neutrality, when it cannot be achieved with lower and upper beta constraints centered about beta = 0.  Assuming that there is no actual &quot;bug&quot; in either in the Optimize API implementation or the computation of the beta in the algo returns, then the example I provided highlights some room for improvement in the Quantopian tools for managing the beta risk.  I do think that Quantopian should dig into this phenomenon (particularly if it really need beta ~ 0 algos).<br></li>
<li>A separate, apparent argument on Quantopian is whether beta (at least in small doses) is a risk at all.  The guidance I&#39;ve gotten from Quantopian is that they and their potential customers value alpha not beta.  The payout to algo authors might look something like:</li>
</ol>

<pre><code>(payout) = (percentage)(algo return)(1-|beta|)
</code></pre>

<p>If the payout relation above is at least roughly qualitatively correct, then trying to achieve beta ~ 0 is worthwhile for Quantopian quants (although perhaps if the algo return is a lot higher with |beta| &gt; 0, then maybe beta ~ 0 would not be optimal for the quant).</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a64c1ea746872000e06f8f0' id='5a64c1ea746872000e06f8f0'>
<a href='#5a64c1ea746872000e06f8f0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516552682000' class='quanto-date posted-at response-posted-at' href='#5a64c1ea746872000e06f8f0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Grant, yes there are several dimensions to the problem. Let&#39;s take it up point by point.  </p>

<ol>
<li><p>Beta neutral and dollar neutral constraints are two seperate and distinct means to achieve a similar objective of uncorrelated returns vis a vis the market returns (SPY) which are designed to mitigate/hedge against  market risk exposures.  In the context of the new contest rules above, the beta constraint is given a leeway of +-0.3, pretty much industry standard for this type of strategy and net dollar exposure of &lt;= 0. 10. The operation of these constraints are hidden under the hood of Optimize API. We can not see it, at least not yet, so it is hard to tell if (a) it is programmatically accurate and does its purpose which is to constraint to its set configurations that are in line or inbounds of its desired thresholds to meet contest compliance, (b) we do not know if there is precedence between these two constraints inside the operation of Optimize, (c) we do not know exactly what the net effect of the interaction of these two variables with very similar objective is and (d) probably other things.  Fortunately, even without the benefit of seeing what is under the hood of Optimize, we can test the efficacy of the algorithm by asking a simple question of does it work as intended? In my many years of trading systems development, I often subscribe to the Occam&#39;s razor principle which states that among competing hypotheses, the one with the fewest assumptions should be selected. The preference for simplicity in the scientific method is based on the falsifiability criterion. So I attack this problem with some knowledge of empirical facts and this being that the stock universe generally moves with the market as measured by beta to SPY which almost always gives a positive correlation and on the average significant correlation.  On the other hand, dollar neutral assures that one has a fairly equal amount of longs and shorts to neutralize the exposures to market risks . And this is the important part of my hypothesis, since there is significant correlation between individual stock&#39;s movement to that of the market, the dollar neutral operation may have already achieved beta neutrality ( at least within the context of acceptable contest thresholds) as an unintentional side effect because the betas of long cancels the betas of the shorts if the correlation persists and hold. While it is not 100% guarantee considering above two sigma or black swan scenarios, beta can be considered redundant if the effect of dollar neutral alone satisfies both threshold conditions of beta and dollar neutral in one operation giving it algorithmic efficiency.  This is how Occam&#39;s razor is applied, &quot;shaving off&quot; that,  that is unnecessary. We&#39;ve both tested this by commented out all references to beta and at least for my own algos I even get a favorable effect in terms of increased returns and improved drawdowns.  The other thing to note is even if you comment out all references to beta in exposed code, beta is still calculated internally in Optimize API and this could well be where the implementation bug resides. One beta code exposed to the user that is configurable and another beta code hidden in Optimize API, how they interact with each other may be where the problem is.   To me, this operation is broken.  </p></li>
<li><p>Beta or dollar neutrality are not risks per se but rather the means to manage the risks of market exposures which is the style of this strategy.  </p></li>
<li><p>Don&#39;t know about this. But isn&#39;t order_optimal_portfolio dependent on Optimize API?</p></li>
<li><p>I think the results you are getting are more of the effects of the broken system which tests shows the following symptoms, among others : (1) beta constraint in Optimize does not do a good job constraining beta to configurable set levels, (2) implementation bug, exposing beta calculation to become user configurable lead to inconsistencies and vulnerabilities and (3) doing away with beta totally has positive effects in terms of increased returns and improved drawdowns and (4) effects of interplay between exposed beta calculation and hidden beta calculation is unknown. </p></li>
<li><p>No comment.  </p></li>
</ol>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a64c859746872000e06f968' id='5a64c859746872000e06f968'>
<a href='#5a64c859746872000e06f968'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1516554329000' class='quanto-date posted-at response-posted-at' href='#5a64c859746872000e06f968'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks James -</p>

<p>Regarding transparency (i.e. open-sourced code), I&#39;m not sure what&#39;s going on with Quantopian these days.  To my knowledge, none of these critical modules have been open-sourced:</p>

<ol>
<li>Optimize API<br></li>
<li>Risk model pipeline factor<br></li>
<li>SimpleBeta pipeline factor</li>
</ol>

<p>Maybe they are still catching up with sorting out how to publish the code?  Or it won&#39;t be published?  In any case, I agree that there is some unnecessary black-box code we are dealing with.</p>

<p>Along these lines, frankly I&#39;m not exactly sure what goes on inside 
<code>order_optimal_portfolio</code>.  I <em>think</em> that this should be kinda-sorta equivalent to <code>order_target_percent</code>:</p>

<pre><code>objective = opt.TargetWeights(weights)

order_optimal_portfolio(  
        objective=objective,  
        constraints=[],  
        )  
</code></pre>

<p>where <code>weights</code> is a Pandas series (or Python dict) of the stocks and their weights.  I think it still engages the optimization apparatus; it doesn&#39;t bypass it, passing through to <code>order_target_percent</code> (or whatever is there in its place).  I suppose one could set up a test.  Frankly, however, it is kinda silly trying to reserve-engineer what might be going on under the hood, when the code could simply be published.</p>

<p>Regarding controlling beta with the Optimize API, your Occam&#39;s Razor approach is probably spot on.  Generally, if the optimizer is doing a lot of shuffling around, one probably isn&#39;t close enough to a solution in the first place and should sort out how to input an alpha factor (set of weights) that is closer to the desired output, across the various dimensions of contest/fund requirements.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a64cd93a1159d0021cc1d26' id='5a64cd93a1159d0021cc1d26'>
<a href='#5a64cd93a1159d0021cc1d26'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/50842732cb5e1a02000000d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f86535a7fafab6b7d903fc1461362f0a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/50842732cb5e1a02000000d1'>James Villa</a>
<span class='badge medal'></span>
</div>
<a UTCms='1516555667000' class='quanto-date posted-at response-posted-at' href='#5a64cd93a1159d0021cc1d26'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant, IMHO and on the bigger picture perspective, I think in Quantopian&#39;s quest to find their true alpha under this long/short market neutral strategy framework, they have loaded it with too many constraints without or remiss of thoroughly understanding the effects of these different constraints to their ultimate objective/s.  Here is where Occam&#39;s Razor can come in handy, eliminate what is unnecessary. Less is more even only on the basis that it is more testable and verifiable.  In real term applications of actual hedge funds by major players for this type strategies, most I know of, limit constraint to 2 or 3 to achieved their desired objective.  Simply put, there is too much overkill.  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/possible-implementation-bug-with-beta'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/possible-implementation-bug-with-beta'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#d4b2b1b1b0b6b5b7bf94a5a1b5baa0bba4bdb5bafab7bbb9">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
