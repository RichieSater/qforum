<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Faster Fundamental Data
</title>
<meta content='Today, we launched an improved version of Morningstar fundamental data in Pipeline. The new implementation is faster and corrects many data issues that existed in the old system. Fundamental queries in Pipeline are 2-20x faster. The biggest improvements will be noticed in fields that update less often (monthly, quarterly, etc.) and in queries that use many different fields.  Queries will also be more memory efficient and more consistent in how long they take to complete. There are some...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="+sLRLeUwM4AsoyOwbtOMqv9wFyDQKNNrLm3Y52/kmQmGpKdgR8bhY5W+eoEhPCTex/40SarkxnCsYgONxaH7sg==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=true;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/faster-fundamental-data' property='og:url'>
<meta content='Faster Fundamental Data' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/faster-fundamental-data' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Faster Fundamental Data' property='og:title'>
<meta content='Today, we launched an improved version of Morningstar fundamental data in Pipeline. The new implementation is faster and corrects many data issues that existed in the old system. Fundamental queries in Pipeline are 2-20x faster. The biggest improvements will be noticed in fields that update less often (monthly, quarterly, etc.) and in queries that use many different fields.  Queries will also be more memory efficient and more consistent in how long they take to complete. There are some...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/faster-fundamental-data">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='59a0a57fee6647000ff77725'>
<div class='post-container' data-post-id='59a0a57fee6647000ff77725' id='59a0a57fee6647000ff77725'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Faster Fundamental Data</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<span class='posted-at'>posted </span>
<span UTCms='1503700351000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Faster Fundamental Data&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Ffaster-fundamental-data%3Futm_source%3Dwebsite_share%26utm_campaign%3Dfaster-fundamental-data%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Ffaster-fundamental-data%3Futm_source%3Dwebsite_share%26utm_campaign%3Dfaster-fundamental-data%26utm_medium%3Dlinkedin&amp;title=Faster+Fundamental+Data+%28Jamie+McCorriston%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class='tags tag-row'>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Using Data' data-tag-id='55c50e7d8d4710ec6e000008' href='/posts/tag/Using-Data/newest'>Using Data</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Q Updates' data-tag-id='55c50e7d8d4710ec6e000012' href='/posts/tag/Q-Updates/newest'>Q Updates</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Pipeline' data-tag-id='561525bcf252a59171000001' href='/posts/tag/Pipeline/newest'>Pipeline</a>
</div>
<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/faster-fundamental-data?utm_source=website_share&amp;utm_campaign=faster-fundamental-data&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Jamie McCorriston" />
<div class='body-text'>
<div class='body-text-container post-body'><p>Today, we launched an improved version of Morningstar fundamental data in Pipeline. The new implementation is faster and corrects many data issues that existed in the old system.</p>

<p>Fundamental queries in Pipeline are 2-20x faster. The biggest improvements will be noticed in fields that update less often (monthly, quarterly, etc.) and in queries that use many different fields. </p>

<p><img title="Performance Table" src="https://image-proxy.quantopian.com/57e6dcbd68d96bb036dc818d53c9bcf4d534ab64/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f7175616e746f7069616e5f7374617469635f6173736574732f7075626c69632f6e65775f66756e64616d656e74616c735f737065656475705f7461626c652e706e67" /></p>

<p>Queries will also be more memory efficient and more consistent in how long they take to complete. There are some queries that are not faster yet, but we are actively working on improving these. Most notably, the Q1500 and Q500 are slower in the new implementation; these should be much faster soon.</p>

<p>In addition to performance improvements, there are changes to the underlying data. The new implementation includes a large number of corrections across many assets and many fields.</p>

<p><strong>How can you use the new implementation?</strong></p>

<p>The new version is accessible in Pipeline via a new namespace. The following example demonstrates how to get the <code>operating_income</code> field in both the new and old formats:</p>

<pre><code># New way: Fundamentals.my_field:  
from quantopian.pipeline.data import Fundamentals  
operating_income = Fundamentals.operating_income.latest

# Old way: morningstar.category.my_field  
from quantopian.pipeline.data import morningstar  
operating_income = morningstar.income_statement.operating_income.latest  
</code></pre>

<p>Built-in pipeline terms that use fundamental data also have a new module:</p>

<pre><code># New way: classifiers.fundamentals  
from quantopian.pipeline.classifiers.fundamentals import Sector  
sector = Sector()

# Old way: classifiers.morningstar  
from quantopian.pipeline.classifiers.morningstar import Sector  
sector = Sector()  
</code></pre>

<p>The attached notebook has more examples that use the new namespace. The notebook also includes examples of the performance and data correctness improvements that come with the new system.</p>

<p><strong>What does this mean for you?</strong></p>

<p>Until the end of September, both the new and old implementations of Morningstar fundamental data will be available in Pipeline. Over the next month, you should compare the old and new data. Try running your research notebooks and algorithms on the new data to understand the impact that any changes in the data might have on your work. </p>

<p>At the end of September, the old namespace will be deprecated and redirected to point at the new data. If you don’t manually update your notebooks or algorithms to use the new namespace, they will automatically start to use the new data. Of course, it is advisable to test the impact ahead of time.  </p>
</div>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>125 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='59a0b24c58e612000d86f7c0' id='59a0b24c58e612000d86f7c0'>
<a href='#59a0b24c58e612000d86f7c0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1503703628000' class='quanto-date posted-at response-posted-at' href='#59a0b24c58e612000d86f7c0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Jamie, </p>

<p>With regard to &quot;The new implementation includes a large number of corrections across many assets and many fields.&quot;, is there a change log that can be made public or included in this thread.  Some morningstar fundamental data (for instance: peg_ratio) weren&#39;t available all the way back to 2003. Have those missing data been corrected. </p>

<p>I am very impressed with the speedup numbers that you reported.</p>

<p>Best Regards,<br>
Leo  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a0b9cee782de00106b3d70' id='59a0b9cee782de00106b3d70'>
<a href='#59a0b9cee782de00106b3d70'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1503705550000' class='quanto-date posted-at response-posted-at' href='#59a0b9cee782de00106b3d70'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for the NB Jamie, very neat. 2 questions for you :)</p>

<p>1 -  Is it safe to mix old Q1500US and new fundamentals to have the best performance?</p>

<p>2 - out of curiosity, why did you change the hierarchy inside the fundamentals ( i.e. Fundamentals.operating_income vs morningstar.income_statement.operating_income ) ? It&#39;s now nicer to type, but it&#39;s harder to switch between old and new version. If you kept the same hierarchy one could simply change the import statement to switch between old/new way  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a12b9831568f000d81f723' id='59a12b9831568f000d81f723'>
<a href='#59a12b9831568f000d81f723'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1503734680000' class='quanto-date posted-at response-posted-at' href='#59a12b9831568f000d81f723'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks a lot for the faster API, Jamie!<br>
And thanks also for having already migrated my Piotosky score implementation.</p>

<p>I&#39;ve some questions:</p>

<ol>
<li><p>Now that the API is faster, it&#39;s possible to use a longer windows_lenght without incurring in timeout. Will it remain the only method to use fundamentals for past quarters or different timeframe?</p></li>
<li><p>I&#39;ll already posted the following two questions per E-Mail but I think it&#39;s relevant for all.<br>
Do the data corrections regard also the old get_fundamentals() API? </p></li>
<li><p>What about the future of this old API? It&#39;s confirmed, it will be deprecated?</p></li>
</ol>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a1f4273cdcc8000dca608f' id='59a1f4273cdcc8000dca608f'>
<a href='#59a1f4273cdcc8000dca608f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52a39e367a47d8ef77000021'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73359b86eca53c2fb1a4c76201591078?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52a39e367a47d8ef77000021'>Joe Jevnik</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1503786023000' class='quanto-date posted-at response-posted-at' href='#59a1f4273cdcc8000dca608f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thank you all for the positive feedback! I am going to try to answer your questions as they appear in this thread.</p>

<h3>Leo M.</h3>

<blockquote>
<p>Some morningstar fundamental data (for instance: peg_ratio) weren&#39;t available all the way back to 2003. Have those missing data been corrected.</p>
</blockquote>

<p>Unfortunately we still do not have a long history for <code>peg_ratio</code>. We have only changed how we process the data that Morningstar provides, and they do not provide the history for this field.</p>

<h3>Luca</h3>

<blockquote>
<p>Is it safe to mix old Q1500US and new fundamentals to have the best performance?</p>
</blockquote>

<p>It is safe to mix any of the terms from the old API with the new API. For now, using the old <code>Q1500US</code> will be faster but you may want to test that your algorithm behaves okay with the new data. We should have the cache ready for the new <code>Q1500US</code> soon which will make it just as fast as before.</p>

<blockquote>
<p>why did you change the hierarchy inside the fundamentals?</p>
</blockquote>

<p>We discussed this change a lot, but we decided that it made it easier for new users to find fields or for experienced users to find less commonly used fields. When you are in the notebook and type <code>morningstar.</code>, you only see the sub-namespaces, not the names of the fields you are looking for. Now, you no longer need to search all 13 sub-namespaces to find the one field you are looking for. I hadn&#39;t considered that it makes it much more tedious to port your algorithms to the new API. If you have Python installed locally, you can automatically change all of your: <code>morningstar.subnamespace.field</code>s into <code>Fundamentals.field</code> by copying your algorithm locally to a file and running this on the command-line:</p>

<pre><code>python -c &quot;import re, sys;print(re.sub(r&#39;morningstar\..*\.([_a-zA-Z0-9]*)&#39;, r&#39;Fundamentals.\1&#39;, open(sys.argv[1]).read()))&quot; path/to/algorithm/file  
</code></pre>

<p>Be sure to replace <code>path/to/algorithm/file</code> with the actual path to your algorithm file. This command uses a regular expression to replace all of the occurrences of <code>morningstart.thing.field</code> with <code>Fundamentals.field</code> and then prints the result. I realize this is not an ideal situation but hopefully this makes it easier to switch over.</p>

<h3>Costantino</h3>

<blockquote>
<p>Now that the API is faster, it&#39;s possible to use a longer windows_length without incurring in timeout?</p>
</blockquote>

<p>This is correct, you should be able to use much larger windows across many fields in your backtests and in research.</p>

<blockquote>
<p>Will it remain the only method to use fundamentals for past quarters or different timeframe?</p>
</blockquote>

<p>For now have not planned any API changes around longer look backs, though it is something we have talked about. We would need to spend some more time thinking about what that API would look like.</p>

<blockquote>
<p>Do the data corrections regard also the old get_fundamentals() API?</p>
</blockquote>

<p>We have not updated the <code>get_fundamentals()</code> API. We will be removing this API in around a month. The main reason for keeping this after pipeline was introduced was that it was faster for some use cases. We believe that we have addressed that with this performance improvement to the pipeline API.</p>

<blockquote>
<p>What about the future of this old API? It&#39;s confirmed, it will be deprecated?</p>
</blockquote>

<p>As I mentioned above, the <code>get_fundamentals()</code> function will be removed. The old <code>morningstar.namespace.field</code> API will switch over to the new system which will inherit the new performance improvements and data corrections. The reason we have made this &quot;opt-in&quot; for now was to give the community time to evaluate the new data and help us find any issues before we made the switch for  everyone.</p>

<p>Thanks again, I am happy to answer any more questions regarding this change!  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59a28ee038306b001091d1a4' id='59a28ee038306b001091d1a4'>
<a href='#59a28ee038306b001091d1a4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1503825632000' class='quanto-date posted-at response-posted-at' href='#59a28ee038306b001091d1a4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Joe Jevnik, thank you for the detailed reply. One more question, if you don&#39;t mind. Do 
<code>default_us_equity_universe_mask</code> or <code>make_us_equity_universe</code> have some internal caching implemented the same way as <code>Q500US/Q1500US</code> have? I usually like to set a variable universe size via <code>make_us_equity_universe</code>, but if <code>Q500US/Q1500US</code> are much faster then I will try to stick to them.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a29af2a89105000da4426f' id='59a29af2a89105000da4426f'>
<a href='#59a29af2a89105000da4426f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52a39e367a47d8ef77000021'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73359b86eca53c2fb1a4c76201591078?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52a39e367a47d8ef77000021'>Joe Jevnik</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1503828722000' class='quanto-date posted-at response-posted-at' href='#59a29af2a89105000da4426f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The three currently cached terms are: <code>Q500US()</code>, <code>Q1500US()</code>, and <code>default_us_equity_mask()</code>. If any of these terms get used in a pipeline, the results will be read from a pre-computed file instead of computed on the fly. The reason we can&#39;t cache <code>make_us_equity_universe</code> is that each invocation returns a new term. We would need to pre-compute the results for all possible inputs which is not possible. I should also note that the caching does not work if you pass a custom minimum market cap to any of the cached terms because we have only pre-computed the results for the default values.</p>

<p>This isn&#39;t to say that <code>make_us_equity_universe</code> cannot be used, in fact, it is now much faster than before. The same is true of <code>Q(1)500US</code> and <code>default_us_equity_mask</code> with non-default minimum market cap values. Hopefully this helped explain how the cache works!  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59a29d9af6a63f00101c21ac' id='59a29d9af6a63f00101c21ac'>
<a href='#59a29d9af6a63f00101c21ac'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1503829402000' class='quanto-date posted-at response-posted-at' href='#59a29d9af6a63f00101c21ac'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks a lot, it makes sense.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a2ee2fee8ad500108aa988' id='59a2ee2fee8ad500108aa988'>
<a href='#59a2ee2fee8ad500108aa988'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1503850031000' class='quanto-date posted-at response-posted-at' href='#59a2ee2fee8ad500108aa988'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I guess this is the easiest  way to switch between old and new implementation then:</p>

<pre><code># Right at the top of your algo/NB  
new_way = True

if new_way:  
    # New way: Fundamentals.my_field:  
    from quantopian.pipeline.data import Fundamentals as income_statement  
    from quantopian.pipeline.data import Fundamentals as balance_sheet  
    from quantopian.pipeline.data import Fundamentals as valuation_ratios  
    from quantopian.pipeline.data import Fundamentals as operation_ratios  
    from quantopian.pipeline.data import Fundamentals as valuation  
    from quantopian.pipeline.classifiers.fundamentals import Sector  
    #from quantopian.pipeline.filters.fundamentals import Q1500US, Q500US //not cached yet  
    from quantopian.pipeline.filters.morningstar import Q1500US, Q500US  
else:  
    # Old way: morningstar.category.my_field  
    from quantopian.pipeline.data.morningstar import income_statement  
    from quantopian.pipeline.data.morningstar import balance_sheet  
    from quantopian.pipeline.data.morningstar import valuation_ratios  
    from quantopian.pipeline.data.morningstar import operation_ratios  
    from quantopian.pipeline.data.morningstar import valuation  
    from quantopian.pipeline.classifiers.morningstar import Sector  
    from quantopian.pipeline.filters.morningstar import Q1500US, Q500US

</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a2f4a2b8231c000d654fb9' id='59a2f4a2b8231c000d654fb9'>
<a href='#59a2f4a2b8231c000d654fb9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597cd044ca02410010e280cb'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0901dbcf1ed57d7c12ffc9e0af682983?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597cd044ca02410010e280cb'>Jim Obreen</a>
</div>
<a UTCms='1503851682000' class='quanto-date posted-at response-posted-at' href='#59a2f4a2b8231c000d654fb9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Joe and Jamie,</p>

<p>I&#39;m unable to import some of Morningstar&#39;s grade data when using the new query syntax-- check out the examples below.</p>

<p>Please let me know how I should be adjusting my code or if there&#39;s something wrong on the backend.</p>

<p>Thanks!</p>

<p>James  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a429c2675043000da06ac3' id='59a429c2675043000da06ac3'>
<a href='#59a429c2675043000da06ac3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5519c8182a2c3ca3b200017b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/9ee64c9625188bf8fa39bbf358dfcbde?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5519c8182a2c3ca3b200017b'>Kevin Stevens</a>
</div>
<a UTCms='1503930818000' class='quanto-date posted-at response-posted-at' href='#59a429c2675043000da06ac3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This is wonderful! I found that many algorithm ideas I had attempted could not run due to memory and execution time timeouts.</p>

<p>Question though- is there anything in the works to make it a bit less awkward to work with quarterly and other infrequently updating data? Right now the best method I know of is creating a huge window length, then essentially looking back 252/4+1  days to get the last quarterly update. A massive data structure is created, when I just need 1/64th of those values. I had an idea to do the lookbacks in chunks upfront that wouldn&#39;t violate limits, then populate them down into my own much smaller structure stored in the context, but I never got around to it, though it seems like a problem that anyone looking to implement a fundamentals-based algorithm with lookbacks is going to encounter (I have commented on a few posts to help when users first try to figure out how to do this).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a4672c6750431986a05f87' id='59a4672c6750431986a05f87'>
<a href='#59a4672c6750431986a05f87'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1503946540000' class='quanto-date posted-at response-posted-at' href='#59a4672c6750431986a05f87'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>First of all my compliments to Jamie and Joe and the other Q developer for this big improvement. I get no timeout error more, even in algo that load 2 or more years of data, like the one described here:<br>
<a href="https://www.quantopian.com/posts/error-in-fundamental-data#56fbfe939426be39440000a4">https://www.quantopian.com/posts/error-in-fundamental-data#56fbfe939426be39440000a4</a></p>

<p>Nevertheless I completely agree with Kevin&#39;s comment. It&#39;s exactly the reason, why I posted the question above &quot;Will it remain the only method to use fundamentals for past quarters or different timeframe?&quot;.... and at least for the moment, the answer is yes.</p>

<p>Sometime ago I proposed to add the possibility to pass only the needed data indexes instead of the complete windows length:<br>
<a href="https://www.quantopian.com/posts/pipeline-api-feature-request-retrive-single-data-points-instead-of-a-full-array-of-data-window-length">https://www.quantopian.com/posts/pipeline-api-feature-request-retrive-single-data-points-instead-of-a-full-array-of-data-window-length</a></p>

<p>Fundamental data are now much faster, but if you have to load two years or more of data in a backtest, it still takes a while: maybe a similar change could make fundamental or other quarterly or infrequently updating data even faster!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a4bbbcb3523906f7f3c5ac' id='59a4bbbcb3523906f7f3c5ac'>
<a href='#59a4bbbcb3523906f7f3c5ac'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/590159d926a03f00107ee416'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c5e9fa96bbd2dc1e9a027cc2d277a0da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/590159d926a03f00107ee416'>Ian Worthington</a>
</div>
<a UTCms='1503968188000' class='quanto-date posted-at response-posted-at' href='#59a4bbbcb3523906f7f3c5ac'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>basic_eps and dividend_rate just for starters are missing.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a4ce9c6a803b087f7e1271' id='59a4ce9c6a803b087f7e1271'>
<a href='#59a4ce9c6a803b087f7e1271'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/590159d926a03f00107ee416'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/c5e9fa96bbd2dc1e9a027cc2d277a0da?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/590159d926a03f00107ee416'>Ian Worthington</a>
</div>
<a UTCms='1503973020000' class='quanto-date posted-at response-posted-at' href='#59a4ce9c6a803b087f7e1271'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Can we please get access to Sklearn.neural_network and/or update sklearn.<br>
I noticed you guys <strong>downgraded</strong> it from 18 -&gt; 16 for whatever reason.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a5b319cd58cd5ca821169e' id='59a5b319cd58cd5ca821169e'>
<a href='#59a5b319cd58cd5ca821169e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1504031513000' class='quanto-date posted-at response-posted-at' href='#59a5b319cd58cd5ca821169e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Jamie, Joe, big thank you for the new API!</p>

<p>The improvement in speed is hugh! Something that took 170 seconds in research now only takes 6 seconds!</p>

<p>But I noticed something weird:</p>

<p>To get quarterly data, I used lookbacks with lengths of 1, 65, 130 and 195 days.<br>
With the new API these lengths gave me some duplicate values for the quarters.<br>
I had to change them to something like 1, 90, 160 and 230 to get the same data as with the old API. Why is that?</p>

<p>Anyone else experiencing the same? Be warned I should say!</p>

<p>Up until this moment, I noticed some small changes in Enterprise Value. Those changes decreased my best return with a third :-(.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a5c0e96a803b300d7e102f' id='59a5c0e96a803b300d7e102f'>
<a href='#59a5c0e96a803b300d7e102f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1504035049000' class='quanto-date posted-at response-posted-at' href='#59a5c0e96a803b300d7e102f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, I have to concur with Donny that backtest results are not identical when pure text switching from (old format) morningstar.* to (new format) Fundamentals.* likely because of the same reason as Donny pointed out that maybe the offsets are different now. Could you please  run some data consistency checks for past values when pulling with old and new format. I can provide logs if necessary, please let me know. </p>

<p>Regards,<br>
Leo  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a5cf0b91bfdd6b16b0e833' id='59a5cf0b91bfdd6b16b0e833'>
<a href='#59a5cf0b91bfdd6b16b0e833'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1504038667000' class='quanto-date posted-at response-posted-at' href='#59a5cf0b91bfdd6b16b0e833'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Leo M The backtest results are different because the new system has many data corrections. In my case  the returns decreased roughly an half.<br>
It would be interesting to know, what was exactly the nature of the corrections and if other users experienced an increase in performance.</p>

<p>@Donny I use also the indexes [  -1,  -65, -130, -195] for TTM data. I tested some symbols for operating_income but got no duplicate (see the attached notebook). Could you please make some examples?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a5d12db352393900f3c64f' id='59a5d12db352393900f3c64f'>
<a href='#59a5d12db352393900f3c64f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1504039213000' class='quanto-date posted-at response-posted-at' href='#59a5d12db352393900f3c64f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>To simplify the use of TTM (Trailing Twelve Months) data I create the following utility classes:  </p>

<pre><code>def make_pipeline(context):  
    quarter_length = 65  


    class TTM(CustomFactor):  
        &quot;&quot;&quot;  
        Trailing Twelve Months (TTM) current year  
        &quot;&quot;&quot;  
        window_length = 3 * quarter_length + 1  
        def compute(self, today, assets, out, data):  
            ttm = np.array([-1, -quarter_length, -2 * quarter_length, -3 * quarter_length])  
            out[:] = np.nansum(data[ttm], axis=0)


    class TTM_PY(CustomFactor):  
        &quot;&quot;&quot;  
        Trailing Twelve Months (TTM) previous_year (PY)  
        &quot;&quot;&quot;  
        window_length = 7 * quarter_length + 1  
        def compute(self, today, assets, out, data):  
            ttm_py = np.array([-4 * quarter_length, -5 * quarter_length, -6 * quarter_length, -7 * quarter_length])  
            out[:] = np.nansum(data[ttm_py], axis=0)  


    return Pipeline(  
        columns = {  
            &#39;ps_ratio_ttm&#39;: Fundamentals.market_cap.latest / TTM(inputs=[Fundamentals.total_revenue]),  
            &#39;ps_ratio_ttm_py&#39;: Fundamentals.market_cap.latest / TTM_PY(inputs=[Fundamentals.total_revenue])  
        },  
        screen = Q1500US()  
    )  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a5d12ea14faa449942930e' id='59a5d12ea14faa449942930e'>
<a href='#59a5d12ea14faa449942930e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1504039214000' class='quanto-date posted-at response-posted-at' href='#59a5d12ea14faa449942930e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I&#39;d recommend  we follow an exhaustive testing procedure  of pulling each fundamental at various intervals using old and new format and make sure they are same. If we correct data and change the data retrieval in the same release, it will be difficult to debug why performance is different and cause large scale disruptions to algos across the board. Hence I recommend releasing it in phases. Phase 1: change method, Phase 2: correct data.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a5d867b352393900f3c71c' id='59a5d867b352393900f3c71c'>
<a href='#59a5d867b352393900f3c71c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1504041063000' class='quanto-date posted-at response-posted-at' href='#59a5d867b352393900f3c71c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>If performance of algos change then it will be a difficult proposition as we will have to change the algo and lose the X months of out of sample with the old format, hence I recommend we don&#39;t switch morningstar.* to Fundamentals.*.  </p>

<p>Instead if users want to make use of the new format in Fundamentals.* it will be better to start from scratch and write a new algo (thus preserving the performance and out of sample record of the old algo with the existing data (and format morningstar.*). </p>

<p>Redirecting morningstar.* to Fundamentals.* when there will be performance change to existing algos will be difficult to deal with, as opposed to a change that only increases speed but gives back the same data and preserves algo performance.</p>

<p>I think there is a larger issue with the evaluation process : if you allocated capital using performance and tearsheets with morningstar* assuming performance X and then redirect morningstar* to Fundamentals* where the performance is actually Y (and maybe not worthy of allocation) or might produce unexpected results after allocation than what was predicted during evaluation (X from morningstar*).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a692b35b20590010fa8cbf' id='59a692b35b20590010fa8cbf'>
<a href='#59a692b35b20590010fa8cbf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1504088755000' class='quanto-date posted-at response-posted-at' href='#59a692b35b20590010fa8cbf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Costantino</p>

<p>I have added an example of calculations with EBIT.</p>

<p>Am I overlooking or missed something here?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a6aeced7d84d00108a3c51' id='59a6aeced7d84d00108a3c51'>
<a href='#59a6aeced7d84d00108a3c51'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1504095950000' class='quanto-date posted-at response-posted-at' href='#59a6aeced7d84d00108a3c51'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Donny,</p>

<p>I think, the problem is the date &#39;2003-01-01&#39;.  There are no data before and instead of returning NAs the missing data are filled with the only available.<br>
Try with  &#39;2016-01-01&#39; and there are no duplicates.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a6bbaeebb51c1dccebb383' id='59a6bbaeebb51c1dccebb383'>
<a href='#59a6bbaeebb51c1dccebb383'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1504099246000' class='quanto-date posted-at response-posted-at' href='#59a6bbaeebb51c1dccebb383'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Anyway there is a problem when the window_length is long.<br>
I added the quarters in the previous year:  </p>

<pre><code>EBIT_Q1_PY = Previous(inputs = [Fundamentals.total_revenue], window_length = 260)  
EBIT_Q2_PY = Previous(inputs = [Fundamentals.total_revenue], window_length = 325)  
EBIT_Q3_PY = Previous(inputs = [Fundamentals.total_revenue], window_length = 390)  
EBIT_Q4_PY = Previous(inputs = [Fundamentals.total_revenue], window_length = 455)  
</code></pre>

<p>and confronted the values of AAPL with Gurufocus (also using Morningstar as source).<br>
All values are the same, excepted for window_length = 455 (EBIT_Q4_PY):</p>

<p><strong>Total Revenue</strong></p>

<p><em>Gurufocus:</em><br>
Sep15   Dec15   Mar16   Jun16   Sep16   Dec16   Mar17   Jun17<br>
51501   75872   50557   42358   46852   78351   52896   45408</p>

<p><em>Quantopian:</em><br>
6789    75872   50557   42358   46852   78351   52896   45408</p>

<p>6789 vs 51501 must be an error. The same problem occurs for the operating revenue.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a6bbf7ebb51c6c76ebada7' id='59a6bbf7ebb51c6c76ebada7'>
<a href='#59a6bbf7ebb51c6c76ebada7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1504099319000' class='quanto-date posted-at response-posted-at' href='#59a6bbf7ebb51c6c76ebada7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Notebook with the computation described above attached.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a6be61d7d84d000d8a3e22' id='59a6be61d7d84d000d8a3e22'>
<a href='#59a6be61d7d84d000d8a3e22'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1504099937000' class='quanto-date posted-at response-posted-at' href='#59a6be61d7d84d000d8a3e22'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Added window_length =520, and the result is surprising: window_length = 455 is now correctly 51501 but window_length =520 is 6789!<br>
There is something weird with the new data retrieval mechanism... at least in research, I don&#39;t in the algo backtesting.</p>

<p>@Jamie, Joe could you take please a look at this, it seems to be a major issue.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a6c15612cbfc2173cf39b2' id='59a6c15612cbfc2173cf39b2'>
<a href='#59a6c15612cbfc2173cf39b2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1504100694000' class='quanto-date posted-at response-posted-at' href='#59a6c15612cbfc2173cf39b2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi @Costantino, thanks for posting an example highlighting the discrepancy. Hoping the backtest difference in performance can be explained by the offset issue that you and Donny have encountered and fixing that will bring the backtest performance to what it was before. Then we can isolate the effect of data corrections on our algorithms.</p>

<p>-Leo  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a6d516c4a4ab7ef1a9d71a' id='59a6d516c4a4ab7ef1a9d71a'>
<a href='#59a6d516c4a4ab7ef1a9d71a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1504105750000' class='quanto-date posted-at response-posted-at' href='#59a6d516c4a4ab7ef1a9d71a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I investigate the issue further and the problem is once again the date interval.!<br>
If you run the pipeline with 
<code>result = run_pipeline(pipe,&#39;2014-08-29&#39;,&#39;2017-08-29&#39;)</code> insted of  <code>result = run_pipeline(pipe,&#39;2017-08-29&#39;,&#39;2017-08-29&#39;)</code> is everything fine! See the new attached notebook:<br>
I think the algorithm backtesting is not affected by this behaviour.</p>

<p><strong>Conclusion:</strong> There are no discrepancies in the data and the indexes [  -1,  -65, -130, -195] or [-260, -325, -390, -455] are okay for TTM or TTM previous year data. </p>

<p>Anyway this confusion demonstrates again that we need a <strong>better method to access past quarterly data</strong> as pointed out by Kevin 2 days ago (<a href="https://www.quantopian.com/posts/faster-fundamental-data#59a429c2675043000da06ac3">https://www.quantopian.com/posts/faster-fundamental-data#59a429c2675043000da06ac3</a>)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a71570fa574c6b106e1ec8' id='59a71570fa574c6b106e1ec8'>
<a href='#59a71570fa574c6b106e1ec8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52a39e367a47d8ef77000021'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73359b86eca53c2fb1a4c76201591078?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52a39e367a47d8ef77000021'>Joe Jevnik</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1504122224000' class='quanto-date posted-at response-posted-at' href='#59a71570fa574c6b106e1ec8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@James O&#39;Brien: Thanks for finding this! There is currently a problem with a set of categorical fields, including profitability grade. The full list of affected fields is:</p>

<ul>
<li><code>financial_health_grade</code><br></li>
<li><code>financial_growth_grade</code><br></li>
<li><code>profitability_grade</code><br></li>
<li><code>company_status</code><br></li>
<li><code>industry_template_code</code><br></li>
<li><code>share_class_status</code></li>
</ul>

<p>For now, please continue fetching these fields through the old API. I will post an update when the fix has been deployed.</p>

<p>@Costantino: I agree that the current API makes it cumbersome to work with quarterly or lower frequency data. While it may seem like the current API is inefficient, due to the way pipeline is implemented this is not the case.</p>

<p>In algorithms, pipelines are computed in 6 month chunks. This means that every 6 months we fetch all data and perform all of the computations needed to produce the next 6 months of output values. One of the biggest costs in Pipeline is retrieving the input data so we try to read data in large batches. Querying for data in large batches reduces the number of times we need to go to the disk or database, which has a high constant cost regardless of the amount of data being read.</p>

<p>Imagine that we had an API that presented the user with the current value and the trailing quarter&#39;s value for some field. On the first day of the computation, when <code>today = 2016-03-01</code>, we would need to have read exactly two rows: the current day&#39;s value (<code>2016-03-01</code>) and one quarter ago&#39;s value (<code>2016-01-01</code>). The table on the left shows the raw source data, and the table on the right shows the slice of data that is presented in a custom factor.</p>

<p><img title="day 1" src="https://image-proxy.quantopian.com/5fe246b7785dbf5d837d69a380f243c1847eeb0f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f7175616e746f7069616e5f7374617469635f6173736574732f7075626c69632f6a6f655f666f72756d5f706f73745f706970656c696e655f77696e646f77696e675f312e6a7067" /></p>

<p>On the second day of computation, when <code>today = 2016-03-02</code>, we would need to read two more rows. This means we have read four rows in total: <code>2016-01-01</code> and <code>2016-03-01</code> from the previous computation and <code>2016-01-02</code> and <code>2016-03-02</code> from the current day&#39;s computation. Again, the table on the left shows the raw source data and the table on the right shows the slice of data that is presented in a custom factor.</p>

<p><img title="day 2" src="https://image-proxy.quantopian.com/fa1f6a803cb0ddb149570a531f697584746114e6/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f7175616e746f7069616e5f7374617469635f6173736574732f7075626c69632f6a6f655f666f72756d5f706f73745f706970656c696e655f77696e646f77696e675f322e6a7067" /></p>

<p>If you repeat this process for at least one quarter, we will have read every row from <code>2016-01-01</code> to <code>2016-03-01</code>. Because we know that all of these values will be used eventually, it is more efficient to query for them as one dense block. In theory, we could hold only the two rows in memory at a time; however, the time cost of reading the data a few rows at a time would make this infeasible.</p>

<p>In research, users may choose to run smaller windows which would not require every value from <code>2016-01-01</code> to <code>2016-03-01</code>. The optimization of querying in a dense block still holds because it is more efficient to read a contiguous block of data than to do random access. We would spend more time determining which rows to filter than we would just reading all of the rows. Even if we could build an indexing scheme to more efficiently read these non-contiguous regions, the absolute time saved when querying for less than one quarter of data would be fractions of a second, and the ram cost of a few rows is negligible.</p>

<p>Hopefully this helps explain why using a long lookback window may be as efficient as querying for trailing quarters.</p>

<p>@Ian Worthington: I apologize for the inconvenience, a few of the fields have been renamed slightly:</p>

<pre><code>manual_renames = {  
    &#39;dividend_yield&#39;: &#39;trailing_dividend_yield&#39;,  
    &#39;dividend_rate&#39;: &#39;forward_dividend&#39;,  
    &#39;diluted_eps&#39;: &#39;diluted_eps_earnings_reports&#39;,  
    &#39;basic_eps&#39;: &#39;basic_eps_earnings_reports&#39;,  
    &#39;basic_eps_other_gains_losses&#39;: (  
        &#39;basic_eps_other_gains_losses_earnings_reports&#39;  
    ),  
    &#39;diluted_eps_other_gains_losses&#39;: (  
        &#39;diluted_eps_other_gains_losses_earnings_reports&#39;  
    ),  
    &#39;basic_average_shares&#39;: &#39;basic_average_shares_earnings_reports&#39;,  
    &#39;diluted_average_shares&#39;: &#39;diluted_average_shares_earnings_reports&#39;,  
    &#39;average_dilution_earn&#39;: &#39;average_dilution_earnings&#39;,  
    &#39;basic_extraordinary&#39;: &#39;basic_extraordinary_earnings_reports&#39;,  
    &#39;normalized_basic_eps&#39;: &#39;normalized_basic_eps_earnings_reports&#39;,  
    &#39;diluted_discontinuous_operations&#39;: (  
        &#39;diluted_discontinuous_operations_earnings_reports&#39;  
    ),  
    &#39;diluted_continuous_operations&#39;: (  
        &#39;diluted_continuous_operations_earnings_reports&#39;  
    ),  
    &#39;basic_accounting_change&#39;: (  
        &#39;basic_accounting_change_earnings_reports&#39;  
    ),  
    &#39;continuing_and_discontinued_basic_eps&#39;: (  
        &#39;continuing_and_discontinued_basic_eps_earnings_reports&#39;  
    ),  
    &#39;diluted_extraordinary&#39;: &#39;diluted_extraordinary_earnings_reports&#39;,  
    &#39;tax_loss_carryforward_diluted_eps&#39;: (  
        &#39;tax_loss_carryforward_diluted_eps_earnings_reports&#39;  
    ),  
    &#39;tax_loss_carryforward_basic_eps&#39;: (  
        &#39;tax_loss_carryforward_basic_eps_earnings_reports&#39;  
    ),  
    &#39;basic_discontinuous_operations&#39;: (  
        &#39;basic_discontinuous_operations_earnings_reports&#39;  
    ),  
    &#39;continuing_and_discontinued_diluted_eps&#39;: (  
        &#39;continuing_and_discontinued_diluted_eps_earnings_reports&#39;  
    ),  
    &#39;basic_continuous_operations&#39;: (  
        &#39;basic_continuous_operations_earnings_reports&#39;  
    ),  
    &#39;normalized_diluted_eps&#39;: &#39;normalized_diluted_eps_earnings_reports&#39;,  
    &#39;dividend_per_share&#39;: &#39;dividend_per_share_earnings_reports&#39;,  
    &#39;diluted_accounting_change&#39;: &#39;diluted_accounting_change_earnings_reports&#39;,  
}
</code></pre>

<p>The <code>_earnings_report</code> suffix denotes this attribute is about an entire company, and we may have an attribute of the same name for each share class.</p>

<p>The other renames are to clarify which direction a field is looking, for example: <code>&#39;dividend_yield&#39;: &#39;trailing_dividend_yield&#39;</code>. We also have <code>forward_dividend_yield</code> so we wanted to clarify what these fields meant.</p>

<p>I am currently looking into the other issues posted in this thread. Thank you all for the great feedback and testing!  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59a71aa6b2d6e955cf659ce7' id='59a71aa6b2d6e955cf659ce7'>
<a href='#59a71aa6b2d6e955cf659ce7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1504123558000' class='quanto-date posted-at response-posted-at' href='#59a71aa6b2d6e955cf659ce7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Costantino</p>

<p>2016-01-01 (the actual date is 2016-01-04, 2016-01-01 is a friday) gives me duplicates...</p>

<p>I tried with dates 2003-01-01, 2004-01-01, 2005-01-01 and each time I get duplicate values.<br>
2006, 2007 are fine. 2008-2011 again duplicates.<br>
2012-2013 is fine. 2014-2016 again duplicates (all tested on 01-01)<br>
2017-01-01 is fine again.<br>
What is going on here??</p>

<p>EDIT: changing windows to 1, <strong>70</strong>, 130 and 195 seems to solve it for now.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a726935b20590872fa8073' id='59a726935b20590872fa8073'>
<a href='#59a726935b20590872fa8073'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1504126611000' class='quanto-date posted-at response-posted-at' href='#59a726935b20590872fa8073'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Joe, there could be more morningstar data that has offset or data changes. I will do some debugging on my end to narrow down why one of my algos performance changed when switching to the new format. The returns have actually gone up, but my concern is with a drawdown in one period that spiked in the new format. I will spend some cycles this weekend and email you some datapoints. Was hoping it was a generic offset issue, but apparently not.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a730b5724c083ecf191dc0' id='59a730b5724c083ecf191dc0'>
<a href='#59a730b5724c083ecf191dc0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1504129205000' class='quanto-date posted-at response-posted-at' href='#59a730b5724c083ecf191dc0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>To everyone on this thread, thank you for all of the bug reports. These are extremely helpful to us.</p>

<p>@Costantino: The issue that you reported with the pipeline results changing based on the lookback window length is indeed a bug. Joe has identified the problem and is working on a fix. Thanks for digging it up! We can post more detail on  the issue once the fix is up.</p>

<p>@Leo: As you suggested, the changes to the data might not be systematic. It&#39;s more likely that there are changes that don&#39;t span an entire field or date. If you find a pattern, or simply report a collection of changes that you noticed between algos that you think might be incorrect, we can certainly take a look.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59a74362d7d84d51ba8a3de6' id='59a74362d7d84d51ba8a3de6'>
<a href='#59a74362d7d84d51ba8a3de6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1504133986000' class='quanto-date posted-at response-posted-at' href='#59a74362d7d84d51ba8a3de6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, I have been able to narrow down the problem (why simple text substitution of morningstar.* to Fundamentals.<em>) was giving me different performance and also able to figure out how to change my algo using Fundamentals.</em> to get back my original performance (from morningstar*), all I had to do to fix the problem was expand the windowlength and negate the effects of expanded window with a matching start offset to access the original offsets that I was using in the algo. I don&#39;t want to give out my algo here, but I will produce a different algo that will illustrate the issue quite convincingly and I will send that algo over the weekend.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a75c21b6bc61000deebbde' id='59a75c21b6bc61000deebbde'>
<a href='#59a75c21b6bc61000deebbde'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1504140321000' class='quanto-date posted-at response-posted-at' href='#59a75c21b6bc61000deebbde'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, I sent you two algos whose performances are different after switching from morningstar.* to Fundamentals.* in the custom factor. Hope that helps.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a7f2b9b6bc610010eec5ce' id='59a7f2b9b6bc610010eec5ce'>
<a href='#59a7f2b9b6bc610010eec5ce'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1504178873000' class='quanto-date posted-at response-posted-at' href='#59a7f2b9b6bc610010eec5ce'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Joe, I sent you two algorithms as well. Morningstar-operation_margin and Fundamentals-operation_margin. They are identical algorithms except for the morningstar* changed to Fundamentals*<br>
I ran each algo with the following settings. The performances are different as listed below. I have tried different morningstar variables in this algo (about 3 or 4 and everytime the performance is different even though the only change I have done is morningstar* to corresponding Fundamentals.*). Please let me know if the algos I sent (along with the ones I sent to Jamie) can be used for debugging or if you need something in research that is easier to debug please let me know and I can try to get that as well.<br>
Settings:<br>
From 2003-10-01 to 2017-07-01 with $10,000,000 initial capital</p>

<p>Morningstar-operations_margin::</p>

<p>Total Returns<br>
-16.61%  </p>

<p>Benchmark Returns<br>
217.1%  </p>

<p>Alpha<br>
-0.01  </p>

<p>Beta<br>
-0.01  </p>

<p>Sharpe<br>
-0.25  </p>

<p>Sortino<br>
-0.35  </p>

<p>Volatility<br>
0.05  </p>

<p>Max Drawdown<br>
-26.12%</p>

<p>Fundamentals-operation_margin:: </p>

<p>Total Returns<br>
-7.75%  </p>

<p>Benchmark Returns<br>
217.1%  </p>

<p>Alpha<br>
-0.00  </p>

<p>Beta<br>
-0.02  </p>

<p>Sharpe<br>
-0.09  </p>

<p>Sortino<br>
-0.13  </p>

<p>Volatility<br>
0.05  </p>

<p>Max Drawdown<br>
-22.19%  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a872da4e048b681c0681f4' id='59a872da4e048b681c0681f4'>
<a href='#59a872da4e048b681c0681f4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1504211674000' class='quanto-date posted-at response-posted-at' href='#59a872da4e048b681c0681f4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie and Joe,</p>

<p>The attached notebook shows the difference in quarterly data between the old and new API with window lengths of 1, 65, 130 and 195.</p>

<p>You should also try it with dates 2014-01-05 and 2014-01-15!<br>
3 different differences between the API&#39;s...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a879c1db67d24c5a13e071' id='59a879c1db67d24c5a13e071'>
<a href='#59a879c1db67d24c5a13e071'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1504213441000' class='quanto-date posted-at response-posted-at' href='#59a879c1db67d24c5a13e071'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Joe,  Thanks for your full explanation, I&#39;m quite impressed!<br>
I understand, there will be no performance gain, but the thing I don&#39;t like is using offsets like 1, 65, 130 and 195. What if the company filed later? the risk of duplicates is high... a way to avoid this problem, could be to pass a timeframe for window_lenght. For example 
<code>window_lenght=4 and timeframe=quarterly</code> to get the last four quarters, instead of window_lenght=196 and then the indexes above.</p>

<p>I&#39;ve another question, that could maybe further speed up the performances, at least in backtesting.<br>
The Pipeline data are always updated every day, isn&#39;t it? At least it was so with the previous mechanism.<br>
What if an algorithm trades less frequently, for example quarterly. Wouldn&#39;t be better for the performance, if the data are update only when <code>
pipeline_output(.)</code> is invoked?</p>

<p>Thanks<br>
Costantino  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59a9657d5c1f0263a733ffcf' id='59a9657d5c1f0263a733ffcf'>
<a href='#59a9657d5c1f0263a733ffcf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1504273789000' class='quanto-date posted-at response-posted-at' href='#59a9657d5c1f0263a733ffcf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Leo,</p>

<p>Thanks for sending over those strategies. Once we have finished fixing the bug related to the lookback window length, we can run them again and see if the differences persist.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59a996b73c8fcd27d8c72e76' id='59a996b73c8fcd27d8c72e76'>
<a href='#59a996b73c8fcd27d8c72e76'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52670e6a2763c5cfb70002c7'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/da33ec858011a8fad211c7e0ae68160c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52670e6a2763c5cfb70002c7'>Alan Coppola</a>
</div>
<a UTCms='1504286391000' class='quanto-date posted-at response-posted-at' href='#59a996b73c8fcd27d8c72e76'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Just so I&#39;m clear about this:  (modulo the outstanding bugs)</p>

<p><strong>General  conversion rule from morningstar fundamentals to Q Fundamentals:</strong><br>
-Replace morningstar by Fundamentals.<br>
-Remove all intermediate hierarchy in the name<br>
    e.g.  </p>

<pre><code>operating_income = morningstar.income_statement.operating_income.latest

</code></pre>

<p>transforms to</p>

<pre><code>operating_income = Fundamentals.operating_income.latest  
</code></pre>

<p>I used this conversion rule with my algos and it works, yet I can&#39;t find this stated anywhere except by example.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59ab2646bf2c210010bba17a' id='59ab2646bf2c210010bba17a'>
<a href='#59ab2646bf2c210010bba17a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/550b44b6f59e69e9390005d0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2308bfc8862358fd6cba70fce02cde1c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/550b44b6f59e69e9390005d0'>Marc Johnson</a>
</div>
<a UTCms='1504388678000' class='quanto-date posted-at response-posted-at' href='#59ab2646bf2c210010bba17a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie says above &quot;At the end of September, the old namespace will be deprecated and redirected to point at the new data.  If you don’t manually update your notebooks or algorithms to use the new namespace, they will automatically start to use the new data.&quot;   </p>

<p>How does this impact algos currently running in a contest?  E.g. if they were entered months ago and are mid-way through the six month contest ... what happens?   I am not able to update them since they are locked for the contest.  Or will existing contest entries continue to function in the contextual namespace they were started within?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59adba93832e2a2cb66234a8' id='59adba93832e2a2cb66234a8'>
<a href='#59adba93832e2a2cb66234a8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1504557715000' class='quanto-date posted-at response-posted-at' href='#59adba93832e2a2cb66234a8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Alan: I&#39;m glad that you got the new version to work - you got the general conversion rule correct. The purpose of this post was to announce the upcoming change and demonstrate how to convert to the faster namespace. We&#39;re in the process of updating the documentation to the new namespace, but we&#39;re also working out a few bugs that have been reported further up in this thread.</p>

<p>@Marc: You shouldn&#39;t need to update your contest algos. At the end of September, the <code>quantopian.pipeline.data.morningstar</code> module will start pointing to the <code>quantopian.pipeline.data.Fundamentals</code> dataset. This will be treated like other data corrections in the contest. Your paper trading track record up to the end of the September will not be affected, but going forward, the algorithm will warm up and act on the new version of the dataset. No code action should be required, but we advise you to backtest a version of your contest algorithm with the new namespace. If you uncover any issues with the new version, let us know and we will work to fix them before the cutover date. Does this help to clarify things?  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59aeb05c2895760010b1e402' id='59aeb05c2895760010b1e402'>
<a href='#59aeb05c2895760010b1e402'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5972298e9577dc4f9f91d13d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2327604f1621afde8ef7665a42ae7bf6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5972298e9577dc4f9f91d13d'>Christopher Osborn</a>
</div>
<a UTCms='1504620636000' class='quanto-date posted-at response-posted-at' href='#59aeb05c2895760010b1e402'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Joe and Jamie,</p>

<p>I&#39;m having trouble migrating my algorithms over to use the new fundamental data. Some of the new fields values don&#39;t look correct:</p>

<ul>
<li>new trailing_dividend_yield is always NaN (does not match the old valuation_ratios.dividend_yield field)<br></li>
<li>new file_date does not always have up to date earnings filing date e.g. Autodesk on 2017-09-01 new filing date is 2017-05-31 but old field (financial_statement_filing.file_date) is (correctly) 2017-08-24<br></li>
<li>BusinessDaysSincePreviousEvent() factor returns a large negative number if passed the new file_date, but works ok if passed the old field</li>
</ul>

<p>The attached notebook shows the problems. I&#39;m a Python and Quantopian newbie so it&#39;s possible that my code is incorrect.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59aeb10c395729000d011975' id='59aeb10c395729000d011975'>
<a href='#59aeb10c395729000d011975'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5972298e9577dc4f9f91d13d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2327604f1621afde8ef7665a42ae7bf6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5972298e9577dc4f9f91d13d'>Christopher Osborn</a>
</div>
<a UTCms='1504620812000' class='quanto-date posted-at response-posted-at' href='#59aeb10c395729000d011975'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Forgot to attach the notebook, so here its is!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59b15f30f0f5aa000d7318ad' id='59b15f30f0f5aa000d7318ad'>
<a href='#59b15f30f0f5aa000d7318ad'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1504796464000' class='quanto-date posted-at response-posted-at' href='#59b15f30f0f5aa000d7318ad'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie/@Joe, I plan to test this feature/enhancements  (with various fundamentals and window lengths quite a bit) after you announce the fixes. </p>

<p>I realized that the time spent now in QA/testing of this feature will potentially save 10-100x time that could be wasted in dealing with issues involving bugs in fundamental retrieval (later on if those issues are not found and addressed now).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59b2d8465f51a2515d38b3ad' id='59b2d8465f51a2515d38b3ad'>
<a href='#59b2d8465f51a2515d38b3ad'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56a8196e384d0519150000cf'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fc260316ff51383a8eb95a56353cf504?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56a8196e384d0519150000cf'>kamran sokhanvari</a>
</div>
<a UTCms='1504892998000' class='quanto-date posted-at response-posted-at' href='#59b2d8465f51a2515d38b3ad'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I have a long/short algo that I run live (until the end of the month that is). I updated the algo with the new Fundamental code and as of live trading yesterday the portfolio symbol set that was traded is significantly different from the one produced by the backtest code. Is there a reason for this?</p>

<p>Can someone at Q help. </p>

<p>Thanks  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59b2db417fef0335c9f3ea9a' id='59b2db417fef0335c9f3ea9a'>
<a href='#59b2db417fef0335c9f3ea9a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1504893761000' class='quanto-date posted-at response-posted-at' href='#59b2db417fef0335c9f3ea9a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Christopher: Thanks for reporting that issue. We&#39;re investigating the cause of the NaNs.</p>

<p>@Leo: We&#39;ll post back here as soon as the fixes are made. We&#39;re hoping to have an update on Monday with the majority of the bugs fixed.</p>

<p>@Kamran: Did you compare a backtest of your strategy with the two versions? I&#39;m curious if you only saw a problem in live trading or if you saw the same change in backtesting. There were several data corrections so it&#39;s possible that if you&#39;re using dynamic universe selection that the names coming out of the pipeline have changed. If you&#39;d prefer to respond privately, feel free to email in to <a href="/cdn-cgi/l/email-protection#75131010111714161e350400141b011a051c141b5b161a18"><span class="__cf_email__" data-cfemail="4f292a2a2b2d2e2c240f3e3a2e213b203f262e21612c2022">[email&#160;protected]</span></a>.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59b2dce65fa04004fdc8475c' id='59b2dce65fa04004fdc8475c'>
<a href='#59b2dce65fa04004fdc8475c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56a8196e384d0519150000cf'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fc260316ff51383a8eb95a56353cf504?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56a8196e384d0519150000cf'>kamran sokhanvari</a>
</div>
<a UTCms='1504894182000' class='quanto-date posted-at response-posted-at' href='#59b2dce65fa04004fdc8475c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Jamie, I did compared with the backtest. I printed out the symbols and the difference was for some reason significant (60  delta for a 100 position port). The live protfolio traded yesterday. So I was running the backtest today to compare the symbols and found the delta. This makes no sense as the code running live is identical. I am confused !  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59b2e42bdbe3203aeb9fe19f' id='59b2e42bdbe3203aeb9fe19f'>
<a href='#59b2e42bdbe3203aeb9fe19f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56a8196e384d0519150000cf'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fc260316ff51383a8eb95a56353cf504?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56a8196e384d0519150000cf'>kamran sokhanvari</a>
</div>
<a UTCms='1504896043000' class='quanto-date posted-at response-posted-at' href='#59b2e42bdbe3203aeb9fe19f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>BTW, one more test. If I start the the backtest from only two weeks ago then the backtest symbols match the live in the updated Fundamentals version. If I start the algo from earlier times the portfolio symbols no longer match.  I usually run the backtest  from beginning of the year. This should not mater as the list of the symbols is generated from the fundamentals factors at the beginning of the day. So the start of the backtest should not impact the ending portfolio symbol set.</p>

<p>This is strange ...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59b2e7e9dbe3203aeb9fe202' id='59b2e7e9dbe3203aeb9fe202'>
<a href='#59b2e7e9dbe3203aeb9fe202'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1504897001000' class='quanto-date posted-at response-posted-at' href='#59b2e7e9dbe3203aeb9fe202'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Kamran,</p>

<p>It sounds like you&#39;re running into a bug that was reported earlier in this thread. We&#39;re working on the fix and hope to have it updated some time next week. Sorry for the confusion.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59b2f8c07f9ae8173eb34b2c' id='59b2f8c07f9ae8173eb34b2c'>
<a href='#59b2f8c07f9ae8173eb34b2c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56a8196e384d0519150000cf'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fc260316ff51383a8eb95a56353cf504?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56a8196e384d0519150000cf'>kamran sokhanvari</a>
</div>
<a UTCms='1504901312000' class='quanto-date posted-at response-posted-at' href='#59b2f8c07f9ae8173eb34b2c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Jamie, Yeah this was a bit confusing and created some unnecessary trades. </p>

<p>Can we assume then that we really don&#39;t need to change anything as far as the code is concerned since these name spaces will be merged. That way I can leave the old code as is and wait for the back-ends to switch over.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59b2fc75dbe3203aeb9fe46b' id='59b2fc75dbe3203aeb9fe46b'>
<a href='#59b2fc75dbe3203aeb9fe46b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1504902261000' class='quanto-date posted-at response-posted-at' href='#59b2fc75dbe3203aeb9fe46b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yes, you can leave the old version and it will switch over at the end of the month. However, I recommend that you try out the new version again next week after we&#39;ve posted the update to make sure that the odd behavior that you experienced goes away.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59b34fa88c942b00108e3c17' id='59b34fa88c942b00108e3c17'>
<a href='#59b34fa88c942b00108e3c17'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5900bf5a8324844ffe752ac0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e006f66626423f6e3a20275bfa634e45?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5900bf5a8324844ffe752ac0'>Andy</a>
</div>
<a UTCms='1504923560000' class='quanto-date posted-at response-posted-at' href='#59b34fa88c942b00108e3c17'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Ran into the same issue when using Q3000US() from quantopian.pipeline.filters.fundamentals instead of from quantopian.pipeline.filters.<br>
Both in live trading and in backtests the returned universe is way too small after mid July 2017 (showing only some 100 equities instead of 3000).</p>

<p>Question: For affected live trading contest entries, do we have a hope of rerunning those for the affected dates after the bugfixes are applied? That change created quite some weird effects in the live trading.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59ba906abf1db922d721018a' id='59ba906abf1db922d721018a'>
<a href='#59ba906abf1db922d721018a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58e64827a30033210199b088'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/714c699c5d8f567057fec5e600ba7482?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58e64827a30033210199b088'>Yiran Huang</a>
</div>
<a UTCms='1505398890000' class='quanto-date posted-at response-posted-at' href='#59ba906abf1db922d721018a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thank you for the work on this optimization.  Could you also post a list which includes all the available fundamental data in the new implementation?  A few metrics I would like to use do not seem to appear in the new implementation.<br>
Something like <a href="https://www.quantopian.com/help/fundamentals">https://www.quantopian.com/help/fundamentals</a> would be great.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59bbe452a8cf684577852152' id='59bbe452a8cf684577852152'>
<a href='#59bbe452a8cf684577852152'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/599fe5caf99c3f594d96222c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d2838e2f42451ed30df3676eef151dc0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/599fe5caf99c3f594d96222c'>Otto Dandenell</a>
</div>
<a UTCms='1505485906000' class='quanto-date posted-at response-posted-at' href='#59bbe452a8cf684577852152'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>When I am trying the new fundamentals API out today (Sept 15), the Sector values are -1 for most companies.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59bbeee029bc3a44292e4029' id='59bbeee029bc3a44292e4029'>
<a href='#59bbeee029bc3a44292e4029'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/599fe5caf99c3f594d96222c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d2838e2f42451ed30df3676eef151dc0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/599fe5caf99c3f594d96222c'>Otto Dandenell</a>
</div>
<a UTCms='1505488608000' class='quanto-date posted-at response-posted-at' href='#59bbeee029bc3a44292e4029'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Furthermore, the country codes don&#39;t always match between morningstar data and new Fundamental data.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59bbf49df9a0ed3224e36b16' id='59bbf49df9a0ed3224e36b16'>
<a href='#59bbf49df9a0ed3224e36b16'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/599fe5caf99c3f594d96222c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d2838e2f42451ed30df3676eef151dc0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/599fe5caf99c3f594d96222c'>Otto Dandenell</a>
</div>
<a UTCms='1505490077000' class='quanto-date posted-at response-posted-at' href='#59bbf49df9a0ed3224e36b16'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Furthermore, the shares outstanding number are different and often lacking altogether in the new Fundamental data.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59bbf6544f88d10010246a3a' id='59bbf6544f88d10010246a3a'>
<a href='#59bbf6544f88d10010246a3a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/599fe5caf99c3f594d96222c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d2838e2f42451ed30df3676eef151dc0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/599fe5caf99c3f594d96222c'>Otto Dandenell</a>
</div>
<a UTCms='1505490516000' class='quanto-date posted-at response-posted-at' href='#59bbf6544f88d10010246a3a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Whoa! The free cash flow figures are even more off, sometimes on the opposite side of the positive - negative scale. Which numbers can we trust!?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59bc253c14ddda001039c806' id='59bc253c14ddda001039c806'>
<a href='#59bc253c14ddda001039c806'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54487203dc843663f2000123'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/439ba1adf33b808f2d50e3a31c3c7e28?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54487203dc843663f2000123'>Josh Payne</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1505502524000' class='quanto-date posted-at response-posted-at' href='#59bc253c14ddda001039c806'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Otto,</p>

<p>Thanks for your help! We strongly suspect these problems you&#39;ve identified and those previously identified in this thread have a common root cause. We&#39;re in the process of testing out our solution and hope to have it pushed out next week for the community.</p>

<p>Josh  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59bc268914ddda001039c819' id='59bc268914ddda001039c819'>
<a href='#59bc268914ddda001039c819'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5900bf5a8324844ffe752ac0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e006f66626423f6e3a20275bfa634e45?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5900bf5a8324844ffe752ac0'>Andy</a>
</div>
<a UTCms='1505502857000' class='quanto-date posted-at response-posted-at' href='#59bc268914ddda001039c819'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for the great investigative work Otto! Great stuff.</p>

<p>Josh - any thoughts on if/how you&#39;re planning to handle affected contest entries yet?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59bc38cae74ee427c0a75f49' id='59bc38cae74ee427c0a75f49'>
<a href='#59bc38cae74ee427c0a75f49'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1505507530000' class='quanto-date posted-at response-posted-at' href='#59bc38cae74ee427c0a75f49'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Andy: Did you submit a new contest entry with the new <code>Fundamentals</code> API? Contest entries that were submitted with the old API won&#39;t start reading from the new data for a couple more weeks. We&#39;re expecting to have the various bugs and issues, including the one impacting the Q3000/Q1500 resolved before then.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59bdc13b207a94000dec714a' id='59bdc13b207a94000dec714a'>
<a href='#59bdc13b207a94000dec714a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5900bf5a8324844ffe752ac0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e006f66626423f6e3a20275bfa634e45?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5900bf5a8324844ffe752ac0'>Andy</a>
</div>
<a UTCms='1505607995000' class='quanto-date posted-at response-posted-at' href='#59bdc13b207a94000dec714a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yes, that&#39;s exactly what i did, Jamie. Backtests looked fine and so I converted them directly, but then more recent data seems to have issue.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59be72f18d5f9227e6105d01' id='59be72f18d5f9227e6105d01'>
<a href='#59be72f18d5f9227e6105d01'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1505653489000' class='quanto-date posted-at response-posted-at' href='#59be72f18d5f9227e6105d01'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for clarifying, Andy. Your best bet is probably to withdraw your submission (stop the algorithm) and resubmit with the old <code>morningstar</code> Pipeline API before the 9:30AM ET deadline on Oct. 2. Alternatively, you can wait until we publish the bug fixes and resubmit with the new API, but the old API will be redirected to the new system at the end of the month anyway, so there shouldn&#39;t be much difference between the two options. Unfortunately, we won&#39;t be able to re-run the affected dates of entries that have already been submitted with the new namespace. Sorry for the inconvenience.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59be9cca753fc0000d5ebe87' id='59be9cca753fc0000d5ebe87'>
<a href='#59be9cca753fc0000d5ebe87'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5900bf5a8324844ffe752ac0'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e006f66626423f6e3a20275bfa634e45?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5900bf5a8324844ffe752ac0'>Andy</a>
</div>
<a UTCms='1505664202000' class='quanto-date posted-at response-posted-at' href='#59be9cca753fc0000d5ebe87'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Bummer. Thanks for clarifying Jamie. Appreciate your help.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59c19f9e39e481000d828c57' id='59c19f9e39e481000d828c57'>
<a href='#59c19f9e39e481000d828c57'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1505861534000' class='quanto-date posted-at response-posted-at' href='#59c19f9e39e481000d828c57'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hey everyone, we released fixes in both research and algorithms for several of the problems that were reported in this thread:<br>
- Data should no longer be changing with different window lengths. This issue was actually the root cause of many of the problems described in this thread. We believe the problem is fixed with all fields except for the <code>file_date</code> field, which we are still working to solve.<br>
- The Q Universe should now return the appropriate number of securities for any window.<br>
- Classifiers such as the profitability grade are now working.</p>

<p>We are still working on a couple of issues:<br>
- As mentioned above, the <code>file_date</code> still changes in a couple of cases with the window length, so we are working to fix this.<br>
- The <code>trailing_dividend_yield</code> still returns <code>NaN</code>. This is also on our list to fix.</p>

<p>If you are still having issues with fields other than <code>file_date</code> or <code>trailing_dividend_yield</code>, please let us know. An thank you for all your continued hard work uncovering these problems!  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59c1a0565dda400010c2a953' id='59c1a0565dda400010c2a953'>
<a href='#59c1a0565dda400010c2a953'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1505861718000' class='quanto-date posted-at response-posted-at' href='#59c1a0565dda400010c2a953'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is a notebook demonstrating the fixes.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59c26fd8e64f29000d11014e' id='59c26fd8e64f29000d11014e'>
<a href='#59c26fd8e64f29000d11014e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1505914840000' class='quanto-date posted-at response-posted-at' href='#59c26fd8e64f29000d11014e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie, still seeing a difference in total returns and max drawdown in one QA algorithm that I created for this. I have emailed it to you. Will QA some more with different window_lengths and fundamentals.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59c2b1531ef799265b1a056f' id='59c2b1531ef799265b1a056f'>
<a href='#59c2b1531ef799265b1a056f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56a8196e384d0519150000cf'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fc260316ff51383a8eb95a56353cf504?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56a8196e384d0519150000cf'>kamran sokhanvari</a>
</div>
<a UTCms='1505931603000' class='quanto-date posted-at response-posted-at' href='#59c2b1531ef799265b1a056f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Jamie, I rand my old test and the symbol list issue that I had reported seems to have been fixed in this version.<br>
Thanks  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59c2b3eafb1f66000df53a16' id='59c2b3eafb1f66000df53a16'>
<a href='#59c2b3eafb1f66000df53a16'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56a8196e384d0519150000cf'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fc260316ff51383a8eb95a56353cf504?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56a8196e384d0519150000cf'>kamran sokhanvari</a>
</div>
<a UTCms='1505932266000' class='quanto-date posted-at response-posted-at' href='#59c2b3eafb1f66000df53a16'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>BTW on a separate note, SPLS symbol gets selected for trading eventhough data.can_trade is checking for it. This symbol is not tradable as of last month. Is there a reason for it still being selected as tradable ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59c2b4dfc43fae2befeeb6d9' id='59c2b4dfc43fae2befeeb6d9'>
<a href='#59c2b4dfc43fae2befeeb6d9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1505932511000' class='quanto-date posted-at response-posted-at' href='#59c2b4dfc43fae2befeeb6d9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Kamran, I&#39;m glad that the issue with the symbol list has been resolved. Regarding the <code>data.can_trade</code> question, it&#39;s tough to say what the issue is without seeing the code. Would you be able to open a ticket with support and grant the permission to look?</p>

<p>Thanks,<br>
Jamie  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59c563fe72f9cc0010ebcc4c' id='59c563fe72f9cc0010ebcc4c'>
<a href='#59c563fe72f9cc0010ebcc4c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5820a4c921b85e0015000176'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d5eebf68a80ed9f3ec0fbf048595f99e?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5820a4c921b85e0015000176'>Tyler Bandy</a>
</div>
<a UTCms='1506108414000' class='quanto-date posted-at response-posted-at' href='#59c563fe72f9cc0010ebcc4c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I’m still having problems with the Morningstar sector code (formerly [morningstar.asset_classification.morningstar_sector_code], now [Fundamentals.morningstar_sector_code]).</p>

<p>While most stocks have the appropriate sector code, many financials that were formerly classified as 103 are now -1. Let me know if you need any logs. Good luck with the fix!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59c7a6338dbd700010ab6cfc' id='59c7a6338dbd700010ab6cfc'>
<a href='#59c7a6338dbd700010ab6cfc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1506256435000' class='quanto-date posted-at response-posted-at' href='#59c7a6338dbd700010ab6cfc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie,</p>

<p>When changing the date, it seems the window length still has some bugs.. </p>

<p>Thanks for all the hard work!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59cbd6d8be622d602aad325a' id='59cbd6d8be622d602aad325a'>
<a href='#59cbd6d8be622d602aad325a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1506531032000' class='quanto-date posted-at response-posted-at' href='#59cbd6d8be622d602aad325a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Donny, do you think you could point me to the particular numbers that I should be looking at in the notebook?  Is there a difference between the old and new fundamentals that you were looking at, or should I be changing the window length of one of the terms?  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59ce467d8dda810691edd850' id='59ce467d8dda810691edd850'>
<a href='#59ce467d8dda810691edd850'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1506690685000' class='quanto-date posted-at response-posted-at' href='#59ce467d8dda810691edd850'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Everyone,</p>

<p>We are pushing back the date on which the old fundamentals namespace will start pointing to the new data. There are still some open issues with the new system that we would like to solve before switching over. We still expect the redirection to occur within a couple of weeks, and I&#39;ll post back here when we decide on a target date.</p>

<p>Thanks again for all of your continued help improving the new system.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59d0bed9338ae80010f9a08f' id='59d0bed9338ae80010f9a08f'>
<a href='#59d0bed9338ae80010f9a08f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1506852569000' class='quanto-date posted-at response-posted-at' href='#59d0bed9338ae80010f9a08f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Jamie,</p>

<p>I&#39;m not completely sure I understand your question.</p>

<p>I have made some changes in the notebook that I posted on Aug 31, 2017.<br>
Now I use pipe for the new fundamentals and pipe2 for the old morningstar to avoid any mistakes while loading the data.</p>

<p>I still use 1, 65, 130 and 195 as window length (same as in the notebook)</p>

<p>For example (as you should see in the notebook?) the first Equity in the list &#39;ARNC&#39; (and many others):</p>

<p>NEW Fundamentals:<br>
2004-01-12 00:00:00+00:00<br>
Equity(2 [ARNC])<br>
EBIT_Q1 NEW    EBIT_Q2 NEW    <strong>EBIT_Q3 NEW</strong>    EBIT_Q4 NEW<br>
506000000.0      506000000.0      <strong>473000000.0</strong>       4.500000e+08 </p>

<p>OLD Morningstar<br>
2004-01-12 00:00:00+00:00<br>
Equity(2 [ARNC])<br>
EBIT_Q1 OLD    <strong>EBIT_Q2 OLD</strong>    EBIT_Q3 OLD     EBIT_Q4 OLD<br>
506000000.0    <strong>473000000.0</strong>      4.500000e+08   -8.900000e+07 </p>

<p>Q1 and Q2 with NEW fundamentals are the same (=Q1 OLD)<br>
Q3 NEW = Q2 OLD<br>
Q4 NEW = Q3 OLD</p>

<p>I hope this answers your questions.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59dafe6e384c92000d4f3a82' id='59dafe6e384c92000d4f3a82'>
<a href='#59dafe6e384c92000d4f3a82'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58f0b8bfee81920a57e492e3'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/cdc4403cde3588700bffcacdce8608e0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58f0b8bfee81920a57e492e3'>Stanley Yang</a>
</div>
<a UTCms='1507524206000' class='quanto-date posted-at response-posted-at' href='#59dafe6e384c92000d4f3a82'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I found many valuation ratio are different in new and old fundamental Data!<br>
For example : New and Old system in PB ratio are different!<br>
One of my value strategy picks different stocks in portfolio result big different return in back-testing.<br>
So my Question is which one is correct?<br>
thanks!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59dbc07d4273ed000d68ebbc' id='59dbc07d4273ed000d68ebbc'>
<a href='#59dbc07d4273ed000d68ebbc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1507573885000' class='quanto-date posted-at response-posted-at' href='#59dbc07d4273ed000d68ebbc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Stanley,</p>

<p>As posted by Jamie in his first post:</p>

<p><em>In addition to performance improvements, there are changes to the underlying data. The new implementation includes a large number of corrections across many assets and many fields.</em>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59dc65100d4c5d0f57307e8d' id='59dc65100d4c5d0f57307e8d'>
<a href='#59dc65100d4c5d0f57307e8d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58f0b8bfee81920a57e492e3'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/cdc4403cde3588700bffcacdce8608e0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58f0b8bfee81920a57e492e3'>Stanley Yang</a>
</div>
<a UTCms='1507616016000' class='quanto-date posted-at response-posted-at' href='#59dc65100d4c5d0f57307e8d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for reply; I know they change some underlying data. I just want to confirm the new fundamental data is more accurate from Q&#39;s people because of the recent problems in new fundamental data. Besides, my back-testing result using the old data consistently beats the results with new data, especially the concentrate portfolio strategies (maybe it’s just coincidence!). I hope the change in new data should be accurate and reliable for Q&#39;s users. In my opinion, in a really great research environment should have abundant data and clean data, some important data for many user to back-testing like valuation ratios or some basic ratios should always be the same overtime no matter what the system improvement.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59dce2d340002b0ac1f01b74' id='59dce2d340002b0ac1f01b74'>
<a href='#59dce2d340002b0ac1f01b74'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1507648211000' class='quanto-date posted-at response-posted-at' href='#59dce2d340002b0ac1f01b74'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Stanley,</p>

<p>Thanks for reporting the differences. Donny is right about the fact that there are several data points that are being corrected in the new system, but it&#39;s still helpful to hear about major differences in backtest results. We are working on updating new fundamentals with another round of bug fixes in the next few days. These fixes are already available in research and will soon be available in algorithms and paper trading. I&#39;ll post back here when we push the update.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59dd14175fae150010bf65e6' id='59dd14175fae150010bf65e6'>
<a href='#59dd14175fae150010bf65e6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1507660823000' class='quanto-date posted-at response-posted-at' href='#59dd14175fae150010bf65e6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Stanley,</p>

<p>I noticed corrections in Enterprise value.<br>
Those corrections also reduced my returns. Constantino posted a while ago that he also had a drop in returns with the new Fundamentals.<br>
Seems like it&#39;s not coincidence. Let&#39;s hope the bug fixes improve our returns ;-)..</p>

<p>@Jamie,</p>

<p>Maybe it&#39;s a bit off topic but from the introduction of the new Fundamentals up until a week ago I was only working in research.<br>
I made a stupid mistake to not run a full backtest on my best performing algo with morningstar.<br>
I think I remember the settings I used but I&#39;m unable to replicate those returns now. I&#39;ve been wondering for allmost a week if there also have been changes in the old morningstar?<br>
My algo&#39;s with a yearly rebalancing frequency perform the same. Those with a higher rebalancing frequency not.<br>
Am I losing my mind here or has something changed with morningstar or something else?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59dd15ef5fae150010bf661d' id='59dd15ef5fae150010bf661d'>
<a href='#59dd15ef5fae150010bf661d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1507661295000' class='quanto-date posted-at response-posted-at' href='#59dd15ef5fae150010bf661d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Donny, nothing was intentionally changed with the old fundamentals API, and we haven&#39;t had any other reports of changes in algos that use the old API. Unfortunately without the full backtest, I don&#39;t have a good way to compare the results. If you happen to find a full backtest that achieves the same results that you are remembering, please let me know so that we can compare it to the new result.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59df85a3f817ea000dc9556e' id='59df85a3f817ea000dc9556e'>
<a href='#59df85a3f817ea000dc9556e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1507820963000' class='quanto-date posted-at response-posted-at' href='#59df85a3f817ea000dc9556e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>We pushed out fixes for all the remaining known issues with the new fundamentals API. We still expect differences to exist between the old and new systems. When looking at differences between the old and new API, it can be helpful to look at the &#39;asof dates&#39; of the field in question. For example, I&#39;ve attached a modified version of Stanley&#39;s notebook from earlier in this thread which displays the &#39;asof dates&#39; for PB ratio. You can see that the differences in values are due to the fact that the new system is picking up more recent data points that were missed in the old system.</p>

<p>Another source of differences for fields coming from earnings reports is that preliminary reports were sometimes being picked up in the old system. This is no longer the case in the new system, so the values you see in the new system will be as reported (picks up restatements when they occur).</p>

<p>If anyone still sees differences that they don&#39;t believe are explained by either of the changes I mentioned above, please let me know. Barring any other major bugs being discovered, we plan to redirect the old API to start pointing at the new system on <strong>Wednesday, Nov. 1</strong>.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59dfd75164765a000dc3a752' id='59dfd75164765a000dc3a752'>
<a href='#59dfd75164765a000dc3a752'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1507841873000' class='quanto-date posted-at response-posted-at' href='#59dfd75164765a000dc3a752'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Jamie,</p>

<p>Bad news!<br>
 Those bugs with the window length still exist.</p>

<p>I&#39;ve assembled a notebook that shows the problem.</p>

<p>The new API changes data on 2003-11-14.<br>
 The old API changes data on 2003-11-17. (Nothing weird so far)</p>

<p>But:<br>
 If I use window length = 34 on 2003-11-17 with the new API, I get the same data as with window length = 1. (This is wrong)<br>
 Changing window length to 35 gives me the correct data.</p>

<p>Using window length 1 and 2 with the old API on 2003-11-17 gives the correct data.</p>

<p>How can I get &#39;asof_date&#39; through a custom factor? It returns numbers instead of dates.<br>
 Adding .latest gives an error..  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e0dd78f82a89000dfd0252' id='59e0dd78f82a89000dfd0252'>
<a href='#59e0dd78f82a89000dfd0252'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1507908984000' class='quanto-date posted-at response-posted-at' href='#59e0dd78f82a89000dfd0252'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Donny,</p>

<p>Thanks for sharing that notebook. I took a look, and the results from the pipeline are what I expect them to be with window length 35 (as well as lengths 1 and 34). The asof date for AAPL&#39;s EBIT suggests that it was updated on 2003-09-30. When the <code>window_length</code> is changed from 34 to 35 on 2003-11-17, the custom factor is now reaching back past the last update and instead returns the previously known value, published on 2003-06-30.  I&#39;ve attached a modified version of your notebook that demonstrates this a little more clearly.</p>

<p><strong>Edit - The below statement is incorrect, see <a href="https://www.quantopian.com/posts/faster-fundamental-data?utm_campaign=faster-fundamental-data&utm_medium=email&utm_source=forums#59e0e869f82a897eebfce690">later post</a> for correct version.</strong><br>
~When using the &#39;asof_date&#39; in a custom factor, the date is converted to a floating point value (<a href="https://www.epochconverter.com/">epoch time</a>), since <code>Factors</code> in pipeline <a href="https://www.quantopian.com/tutorials/pipeline#lesson3">have numerical outputs by definition</a>. If you actually print out the values inside the <code>CustomFactor</code>&#39;s <code>compute</code> function, you can see that it&#39;s a datetime. I <em>think</em> you can create a <code>CustomClassifier</code>to get the latest <code>asof_date</code>(see the code in <a href="https://github.com/quantopian/zipline/blob/d3e03144656ff92bab8b24ad0c5f48f1ce88f119/zipline/pipeline/classifiers/classifier.py#L459">Zipline</a>), but it&#39;s not an officially supported function on Quantopian so my preference is to convert it to a timestamp outside of Pipeline for now. You can see how I did this in the attached notebook.~</p>

<p>Let me know if this example answers your questions or if you there&#39;s anything that I missed.</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59e0ddcbaf2034000d98407c' id='59e0ddcbaf2034000d98407c'>
<a href='#59e0ddcbaf2034000d98407c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1507909067000' class='quanto-date posted-at response-posted-at' href='#59e0ddcbaf2034000d98407c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Karl,</p>

<p>Can you share the algorithm or notebook that you ran which raised that Runtime Error? Attaching the code in this thread or sending it in via our support channel if you want to keep it private would be very helpful. Without more context, like the particular datasets/fields that are being used, it&#39;s difficult to help debug the issue.</p>

<p>Thanks,<br>
Jamie  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59e0e1e7ae92d50010439cfd' id='59e0e1e7ae92d50010439cfd'>
<a href='#59e0e1e7ae92d50010439cfd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1507910119000' class='quanto-date posted-at response-posted-at' href='#59e0e1e7ae92d50010439cfd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Karl, sending the code in <code>def myPipeline()</code> might be enough. If you post it here, or send it to <a href="/cdn-cgi/l/email-protection#98fefdfdfcfaf9fbf3d8e9edf9f6ecf7e8f1f9f6b6fbf7f5"><span class="__cf_email__" data-cfemail="e38586868781828088a39296828d978c938a828dcd808c8e">[email&#160;protected]</span></a>, I can take a look. Thanks!  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59e0e869f82a897eebfce690' id='59e0e869f82a897eebfce690'>
<a href='#59e0e869f82a897eebfce690'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1507911785000' class='quanto-date posted-at response-posted-at' href='#59e0e869f82a897eebfce690'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Donny, One of our engineers pointed out to me that there&#39;s a mistake in the last notebook I shared with regards to using datetimes in Pipeline. Factors in pipeline should output numerical values or <code>datetime</code>. That being said, the default output type of a factor is <code>float</code>, so you need to specify the <code>dtype</code> of the factor if you want it to output a <code>datetime</code>. Attached is a corrected version of the notebook that I posted earlier.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59e1bd7bbe85dd032f9eb15c' id='59e1bd7bbe85dd032f9eb15c'>
<a href='#59e1bd7bbe85dd032f9eb15c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58f0b8bfee81920a57e492e3'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/cdc4403cde3588700bffcacdce8608e0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58f0b8bfee81920a57e492e3'>Stanley Yang</a>
</div>
<a UTCms='1507966331000' class='quanto-date posted-at response-posted-at' href='#59e1bd7bbe85dd032f9eb15c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for replies and interpret the difference of data.<br>
I have question about  how to get the latest update PB ratio data. As this notebook I post, I like to remove the securities which newpb_date didn&#39;t update before the day I run pipeline. So in this case I used pbtimerank&gt;100 to filter out, but I still see some securities like Equity(3735 [HPQ]) update on 2016-03-03 not update on 2016-12-01.<br>
I am a beginner in python , so I still can&#39;t think a good way to solve it .<br>
Is there any way I can remove it more precisely in pipeline other than this strange method to adjust the number in pbtimerank?<br>
Thanks!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e26723818cd7000da9cbda' id='59e26723818cd7000da9cbda'>
<a href='#59e26723818cd7000da9cbda'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1508009763000' class='quanto-date posted-at response-posted-at' href='#59e26723818cd7000da9cbda'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Jamie,</p>

<p>About the asof dates, thanks for the PreviousAsOf CustomFactor!</p>

<p>But about the data for Q1, Q2 and so on. I don&#39;t understand your example.<br>
The asof date for EBIT suggests that it was updated on 2003-09-30 when in fact it only updated on 2003-11-14!</p>

<p>So up until 2003-11-14 using window length 1, 34 and 35 gives 9000000. Nothing fancy here.<br>
On 2003-11-14 window length 1 gives the new value 132000000. Window lengths 34 and 35 the old value 9000000.</p>

<p>Now it&#39;s getting weird for me.<br>
On 2003-11-17 window length 1 gives 132000000 as it should.<br>
But now all of a sudden window length 34 also gives 132000000! I just don&#39;t get that.</p>

<p>As clearly seen in &#39;EBIT Q1 NEW&#39;, the update happened on 2003-11-14<br>
So 34 trading days ago starting from 2003-11-17 is way past 2003-11-14.<br>
I think that window length 34 should still give a value of 9000000.</p>

<p>If not, then I would like to know how we can get the 4 most recent different values for the quarterly data?<br>
At this moment window lengths 1, 65, 130 and 195 don&#39;t do the job anymore..  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e4be1d7239a900101290ba' id='59e4be1d7239a900101290ba'>
<a href='#59e4be1d7239a900101290ba'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1508163101000' class='quanto-date posted-at response-posted-at' href='#59e4be1d7239a900101290ba'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Ah, I think I understand where the confusion is coming from now, Donny. Quarterly earnings data is generally only available some time after the end of the quarter. </p>

<p>What&#39;s happening here is that we learned about the 2003-09-30 data point (EBIT = 132000000) on 11-14. On 11-14, the term with <code>window_length=1</code> in the pipeline asks for the &#39;most recently known EBIT for AAPL&#39;, which is now 132000000. Also on 11-14, the term with <code>window_length=34</code> is asking for the value from 34 trading days ago (34 trading days ago was 9-29). Even though a more recent data point exists, the pipeline explicitly asks for the value from 34 trading days ago, which is 9000000.</p>

<p>On 11-17, the next trading day, the pipeline term with <code>window_length=34</code> is now asking for the data from 9-30, which is 132000000. The <code>window_length=35</code> term is still asking for data from 9-29, which is 9000000. The next day, the <code>window_length=35</code> term picks up the 132000000 data point from 9-30.</p>

<p>The important thing to take away from this is that the asof date does not represent when we learned about a data point. Internally, we keep track of what we call a &#39;timestamp&#39; or knowledge datetime of when we learn about a particular data point from Morningstar. The &#39;timestamp&#39; determines when a data point is known by pipeline, while the asof date is the date for which the data point applies. I made a <a href="https://www.quantopian.com/posts/quantopian-partner-data-how-is-it-collected-processed-and-surfaced">post</a> earlier this year that discussed the concept of asof dates and timestamps and how we use them with our partner datasets. The exact implementation is a little bit different for fundamental data (we don&#39;t store publicly available base tables and delta tables), but the concepts are the same. One of our data engineers also ran a webinar last week that discusses similar concepts. The webinar was recorded and should be made available some time this week. I&#39;ll post a link to it here once it&#39;s up. I&#39;d recommend watching it if you&#39;re interested in this topic.</p>

<p>Let me know if this explanation helps.</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59e4bf84598ad70010d3a1e0' id='59e4bf84598ad70010d3a1e0'>
<a href='#59e4bf84598ad70010d3a1e0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1508163460000' class='quanto-date posted-at response-posted-at' href='#59e4bf84598ad70010d3a1e0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Actually, I should add a bit to my explanation. As you know, Quantopian didn&#39;t exist yet in 2003, so we didn&#39;t actually learn about the 2003-09-30 data point on 2003-11-14. However, because we don&#39;t always learn about quarterly earnings report data the day after the end of the quarter, there&#39;s an artificial lag placed on quarterly earning fundamental data prior to when we actually started collecting the data live in 2013. Essentially, &#39;timestamps&#39;/knowledge datetimes are simulated until we started actually collecting them in 2013.</p>

<p>I hope this helps.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59e4c1aaff5597000dd39536' id='59e4c1aaff5597000dd39536'>
<a href='#59e4c1aaff5597000dd39536'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1508164010000' class='quanto-date posted-at response-posted-at' href='#59e4c1aaff5597000dd39536'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Stanley, the best way to filter out securities with an asof_date older than the previous trading day in a pipeline is with the <code>BusinessDaysSincePreviousEvent</code> factor. I&#39;ve attached a modified version of your notebook that demonstrates how to use it.</p>

<p>Let me know if this is what you were looking for.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59e4cfb3ff55976147d37f03' id='59e4cfb3ff55976147d37f03'>
<a href='#59e4cfb3ff55976147d37f03'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1508167603000' class='quanto-date posted-at response-posted-at' href='#59e4cfb3ff55976147d37f03'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Donny: <a href="https://www.youtube.com/watch?v=uVE5z5xq1DQ&feature=youtu.be">Here is the recording of the webinar</a> discussing knowledge dates and asof_dates by Kathryn, one of Quantopian&#39;s data engineers.</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59e63d4056f25f0008f8757e' id='59e63d4056f25f0008f8757e'>
<a href='#59e63d4056f25f0008f8757e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58f0b8bfee81920a57e492e3'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/cdc4403cde3588700bffcacdce8608e0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58f0b8bfee81920a57e492e3'>Stanley Yang</a>
</div>
<a UTCms='1508261184000' class='quanto-date posted-at response-posted-at' href='#59e63d4056f25f0008f8757e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie:  This is exactly I want,Thanks!<br>
I tested different dates at the notebook you posted,It&#39;s look like PB ratio and  some other ratios updated at the end of month before 2015 and updated more often after 2015 ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59e6472f29108800060f6500' id='59e6472f29108800060f6500'>
<a href='#59e6472f29108800060f6500'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1508263727000' class='quanto-date posted-at response-posted-at' href='#59e6472f29108800060f6500'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Stanley,</p>

<p>Thanks for pointing that out. Our Morningstar fundamental data integration began in June 2014. In order to backfill data prior to 2014, Morningstar sent us historical data going as far back as 2002. The data that we got for daily updating fields like <code>pb_ratio</code>is only updated monthly in these historical files. If you run a pipeline that crosses over the end of a month (see attached notebook), you can see that you get a new value at the end of each month for <code>pb_ratio</code>. Starting mid-2014, we started collecting the data live and building our own collection of historical data where daily fields are updated daily. If you are using a filter that requires these fields to have been updated the previous day (good practice!), you should consider the difference before and after June 2014. In fact, you might want to restrict your backtesting to start after June 2014 so that the update pattern reflects what you can expect in live trading.</p>

<p>Let me know if this explanation helps and sorry for the confusion.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59e73a6c4dfdab0009cee577' id='59e73a6c4dfdab0009cee577'>
<a href='#59e73a6c4dfdab0009cee577'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58f0b8bfee81920a57e492e3'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/cdc4403cde3588700bffcacdce8608e0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58f0b8bfee81920a57e492e3'>Stanley Yang</a>
</div>
<a UTCms='1508325996000' class='quanto-date posted-at response-posted-at' href='#59e73a6c4dfdab0009cee577'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie:<br>
Thanks!  It&#39;s very helpful.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f4742dd56ecd1a224b96a4' id='59f4742dd56ecd1a224b96a4'>
<a href='#59f4742dd56ecd1a224b96a4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1509192749000' class='quanto-date posted-at response-posted-at' href='#59f4742dd56ecd1a224b96a4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Jamie,</p>

<p>Thank you for the link to the webinar. I&#39;ve watched it and I think I understand most of it.</p>

<p>But I&#39;m still stuck on how to get the 4 most recent, different values for the quarterly data?<br>
With the old morningstar you could use 1, 65, 130 and 195 as window length.</p>

<p>With the new Fundamentals I guess you have to calculate the trading days between &#39;today&#39; (= Q1) and the most recent &#39;asof date&#39; (-1 = Q2).<br>
Then you have to add 65 tradings days (with some margin ) to get Q3 and so on?</p>

<p>Is this the correct way to get Q1, Q2, Q3 and Q4?<br>
And how do you implement that in research and backtesting?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f74f948a72640006e4b5af' id='59f74f948a72640006e4b5af'>
<a href='#59f74f948a72640006e4b5af'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1509379988000' class='quanto-date posted-at response-posted-at' href='#59f74f948a72640006e4b5af'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Donny,</p>

<p>The system that you used with old fundamentals should work to the same degree of success for determining the last 4 quarter&#39;s values in the new system. In general, this should get you the last 4 quarterly data points. I can imagine cases where this heuristic fails, like if the most recent quarterly report is late, which could cause the most recent two data points to be the same. As you mentioned, a better way of doing this might be to use the &#39;asof date&#39; of the field in question. I haven&#39;t implemented this before, so i don&#39;t have one to share, but if you want to try the solution that you suggested where you pick the most recent asof date, and then add 65 trading days to the lookback to get each previous quarter, you might want to use the <code>BusinessDaysSincePreviousEvent</code> factor that I used in <a href="https://www.quantopian.com/posts/faster-fundamental-data?utm_campaign=faster-fundamental-data&utm_medium=email&utm_source=forums#59e6472f29108800060f6500">my response</a> to Stanley just above. </p>

<p>The 1/65/130/195 lookbacks should be a good heuristic. A more accurate solution will certainly be more involved and take some work.</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59f8ecd6f52d1d0006d9f9e5' id='59f8ecd6f52d1d0006d9f9e5'>
<a href='#59f8ecd6f52d1d0006d9f9e5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1509485782000' class='quanto-date posted-at response-posted-at' href='#59f8ecd6f52d1d0006d9f9e5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Why using 
<code>BusinessDaysSincePreviousEvent</code> with a <code>window_length</code> different from zero, for example:</p>

<pre><code>&#39;sales_t_0065_update&#39;: BusinessDaysSincePreviousEvent(inputs = [Fundamentals.total_revenue_asof_date], window_length = 65),
</code></pre>

<p>the following error occurs:</p>

<pre><code>/build/src/qexec_repo/zipline_repo/zipline/pipeline/factors/events.pyc in _compute(self, arrays, dates, assets, mask)
     35  
     36         # Coerce from [ns] to [D] for numpy busday_count.  
---&gt; 37         announce_dates = arrays[0].astype(datetime64D_dtype)  
     38  
     39         # Set masked values to NaT.

AttributeError: &#39;zipline.lib._int64window.AdjustedArrayWindow&#39; object has no attribute &#39;astype&#39;  
</code></pre>

<p>Is it a bug or a misuse of <code>BusinessDaysSincePreviousEvent</code>?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f8f1dea2a56e0783c1354a' id='59f8f1dea2a56e0783c1354a'>
<a href='#59f8f1dea2a56e0783c1354a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1509487070000' class='quanto-date posted-at response-posted-at' href='#59f8f1dea2a56e0783c1354a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I computed the median of BusinessDaysSincePreviousEvent results in the Q3000 universe and it was 68.<br>
Therefore the 1/70/140/210 lookbacks are a better than 1/65/130/195 in order to reduce the risk of duplicate datapoint.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59f8fb1a7c6d233db754c69b' id='59f8fb1a7c6d233db754c69b'>
<a href='#59f8fb1a7c6d233db754c69b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1509489434000' class='quanto-date posted-at response-posted-at' href='#59f8fb1a7c6d233db754c69b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Costa,</p>

<p>The <code>BusinessDaysSincePreviousEvent</code> factor does not work with the <code>window_length</code> being set. It will always return the number of business days from today since the previous event in the <code>inputs</code> term. The factor should raise an error if you specify a <code>window_length</code>, sorry about that.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='59f9c1425e19184a19e68d7b' id='59f9c1425e19184a19e68d7b'>
<a href='#59f9c1425e19184a19e68d7b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1509540162000' class='quanto-date posted-at response-posted-at' href='#59f9c1425e19184a19e68d7b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Jamie,</p>

<p>The 1/65/130/195  lookbacks don&#39;t perform with the same degree of success in the new system (at all). They perform way less.<br>
I&#39;ve demonstrated this in the attached notebook. I&#39;ve tried to show you this before.</p>

<p>The reason, as I understand it, is that the old system picked up new data at each new data point or timestamp (not the asof date), no matter what lookback you used.<br>
So the gap between two consecutive data points (or quarterly values) was always more or less 65 (or 68 as Constantino calculated).</p>

<p>With the new system, window length 1 picks up new data at a new data point (like in the old system) but all the other lookbacks start to change data on the asof dates. You demonstrated this <a href="https://www.quantopian.com/posts/faster-fundamental-data?utm_campaign=faster-fundamental-data&utm_medium=email&utm_source=forums#59e4be1d7239a900101290ba">here</a>.</p>

<p>That new behaviour increases the gap between Q1 (lookback 1) and Q2 (lookback 65 + (&#39;current&#39; date - asof date) ).<br>
Thus frequently resulting in wrong values for Q2, Q3 and Q4 with lookbacks 65/130/195.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59fb4dad689e11132b4b85e3' id='59fb4dad689e11132b4b85e3'>
<a href='#59fb4dad689e11132b4b85e3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5972298e9577dc4f9f91d13d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2327604f1621afde8ef7665a42ae7bf6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5972298e9577dc4f9f91d13d'>Christopher Osborn</a>
</div>
<a UTCms='1509641645000' class='quanto-date posted-at response-posted-at' href='#59fb4dad689e11132b4b85e3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Jamie,<br>
Has the trailing_dividend_yield NaN problem been fixed? After reading through the replies on this thread I&#39;m not sure whether it&#39;s something that you think has been fixed or not. My notebook, attached, still gives NaNs. (The file_date and business_days events now look correct - thanks.)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59fd3bcc5efb363c71d00a83' id='59fd3bcc5efb363c71d00a83'>
<a href='#59fd3bcc5efb363c71d00a83'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1509768140000' class='quanto-date posted-at response-posted-at' href='#59fd3bcc5efb363c71d00a83'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Everyone: The old API should be redirected to point at the new data by Monday morning. <code>get_fundamentals</code> will also no longer be available as of Monday.</p>

<p>@Christopher: The <code>NaN</code> problem with <code>trailing_dividend_yield</code> has been fixed and tested on our staging environment, but has not yet made it out to our production environment. The fix should be up on Monday.</p>

<p>@Donny: Thanks for staying patient with me. Your most recent comments helped me to understand the root of what&#39;s giving you a hard time. In the old system, fundamentals would just start appearing in a pipeline lookback window at the <code>timestamp</code>. In the new system, the <code>timestamp</code> determines when the data becomes available, but the <code>asof_date</code>determines where it appears along the lookback window. The new version is consistent with how other datasets are loaded in lookback windows in Pipeline, which is why we changed the behavior. I&#39;ve attached a modified version of your notebook with a <code>CustomFactor</code> called <code>LastFourQuarters</code> which should get the last 4 values of a fundamentals field in the new system more reliably. I re-ran the test periods to confirm that it works and it seems to retrieve the correct values. Let me know if this helps.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a0054883cbfca0006093804' id='5a0054883cbfca0006093804'>
<a href='#5a0054883cbfca0006093804'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1509971080000' class='quanto-date posted-at response-posted-at' href='#5a0054883cbfca0006093804'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I guess the new API have replaced the old ones, the Research environment is so incredibly memory efficient now. Well done, thank you!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a00688f3cbfca0009093889' id='5a00688f3cbfca0009093889'>
<a href='#5a00688f3cbfca0009093889'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1509976207000' class='quanto-date posted-at response-posted-at' href='#5a00688f3cbfca0009093889'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Which is the new name for 
<code>income_statement.depreciation_amortization_depletion</code>?</p>

<p>With <code>Fundamentals.depreciation_amortization_depletion</code> the following error occurs:</p>

<pre><code>AttributeError: type object &#39;Fundamentals&#39; has no attribute &#39;depreciation_amortization_depletion&#39;  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a006a7a6ea28b0006516502' id='5a006a7a6ea28b0006516502'>
<a href='#5a006a7a6ea28b0006516502'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1509976698000' class='quanto-date posted-at response-posted-at' href='#5a006a7a6ea28b0006516502'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Luca: That&#39;s correct, the old API is now using the new system. I&#39;m glad to hear that this helps reduce memory usage in Research for you!</p>

<p>@Costantino: This weekend, we shipped a change that disambiguates some field names which we learned are being used to represent multiple data points by our fundamental data provider. The <code>depreciation_amortization_depletion</code> is one such field. In this case, we get a <code>depreciation_amortization_depletion</code> from two different reports: <code>income_statment</code> and <code>cash_flow_statement</code>. Sometimes, the data points differ depending on which report they come from. The two versions of <code>depreciation_amortization_depletion</code> can be referenced with <code>depreciation_amortization_depletion_income_statement</code> and <code>depreciation_amortization_depletion_cash_flow_statement, respectively</code>. I apologize for the confusion.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a006bc5f0048b0006a6460f' id='5a006bc5f0048b0006a6460f'>
<a href='#5a006bc5f0048b0006a6460f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1509977029000' class='quanto-date posted-at response-posted-at' href='#5a006bc5f0048b0006a6460f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie Thanks a lot for the fast reply!<br>
For sure, you&#39;re going to update the Fundamental Data Reference on <a href="https://www.quantopian.com/help/fundamentals">https://www.quantopian.com/help/fundamentals</a>.<br>
Let us know, when you&#39;ve finished.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a006c3e30023c417bca0eba' id='5a006c3e30023c417bca0eba'>
<a href='#5a006c3e30023c417bca0eba'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1509977150000' class='quanto-date posted-at response-posted-at' href='#5a006c3e30023c417bca0eba'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I my opinion 
<code>depreciation_amortization_depletion</code> should be always the same, maybe you should report the inconsistency to Morningstar  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a006e1df0048b0009a645ba' id='5a006e1df0048b0009a645ba'>
<a href='#5a006e1df0048b0009a645ba'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1509977629000' class='quanto-date posted-at response-posted-at' href='#5a006e1df0048b0009a645ba'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Costantino,</p>

<p>Yes, we&#39;ll have to update the Fundamental Data Reference. In the meantime, I recommend using the autocomplete tool. If you import the new <code>Fundamentals</code> namespace and then type <code>Fundamentals.</code> in research or the IDE, you should be able to see all the fields that exist. This isn&#39;t a replacement for the reference page, but should help you until it is updated.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a006e73e34bd80006411caa' id='5a006e73e34bd80006411caa'>
<a href='#5a006e73e34bd80006411caa'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5118dbf1a4d447e2a6000050'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ce323165e919dbc2ce95c864939caf12?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5118dbf1a4d447e2a6000050'>Costantino</a>
</div>
<a UTCms='1509977715000' class='quanto-date posted-at response-posted-at' href='#5a006e73e34bd80006411caa'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The same for 
<code>Fundamentals.net_income</code> (*_income_statement or *_cash_flow_statement).<br>
In this case, I&#39;m sure they have to be the same. If not, there is a problem in the data.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a00760e62f19650a2639de1' id='5a00760e62f19650a2639de1'>
<a href='#5a00760e62f19650a2639de1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1509979662000' class='quanto-date posted-at response-posted-at' href='#5a00760e62f19650a2639de1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie was the change intended to improve memory other than speed? I cannot believe pipeline in Research  is now using a quarter of memory that it was using  before the change.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a00a9034b4bef0009e9c0a1' id='5a00a9034b4bef0009e9c0a1'>
<a href='#5a00a9034b4bef0009e9c0a1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52a39e367a47d8ef77000021'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/73359b86eca53c2fb1a4c76201591078?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52a39e367a47d8ef77000021'>Joe Jevnik</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1509992707000' class='quanto-date posted-at response-posted-at' href='#5a00a9034b4bef0009e9c0a1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Luca The primary goal of this change was to improve the time it takes to query fundamentals data in pipeline. We were not specifically optimizing the memory usage but allocation is often a very slow operation. One of the ways you can speed up a task is to avoid allocation of objects, or batch up allocations into a dense block, both of these will lower the total memory used. The old fundamentals pipeline loader used a lot of memory and didn&#39;t scale very well as the query windows grew so the new system is a big improvement.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a00c566a06d5600067631c6' id='5a00c566a06d5600067631c6'>
<a href='#5a00c566a06d5600067631c6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/59f1326b32ccd50006975d2e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2582d048309afffea9449aec1b51d051?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/59f1326b32ccd50006975d2e'>Doug Baldwin</a>
</div>
<a UTCms='1509999974000' class='quanto-date posted-at response-posted-at' href='#5a00c566a06d5600067631c6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>What is the data timeliness policy for the improved Fundamentals data? I apologize in advance if this question is off topic.</p>

<p>Morningstar posts 10-K/Q at midnight of the SEC filing date, but Fundamentals seems to lag by many weeks.</p>

<p>Also, Morningstar posts preliminary Rev, OI, NI, EPS, etc. at midnight of the press release date, which may occur weeks before the SEC filing date. Can these preliminary numbers be provided by Fundamentals?</p>

<p>I found timeliness gaps compared to Fundamentals by sampling <a href="http://finra-markets.morningstar.com/MarketData/EquityOptions/default.jsp">http://finra-markets.morningstar.com/MarketData/EquityOptions/default.jsp</a> at its Financials -&gt;Quote tab for tickers that have issued a quarterly press release, and at Financials -&gt; Balance Sheet tab for recent SEC 10-K/Q filings.</p>

<p>Thank you.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a00db36e36b6100090cb9c8' id='5a00db36e36b6100090cb9c8'>
<a href='#5a00db36e36b6100090cb9c8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5929c5f4a76c22000d329d92'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5ec18483d35ccb497ca800f820998851?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5929c5f4a76c22000d329d92'>Leo M</a>
<span class='badge medal'></span>
</div>
<a UTCms='1510005558000' class='quanto-date posted-at response-posted-at' href='#5a00db36e36b6100090cb9c8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Very fast indeed using fundamentals now. Thanks a lot for making these enhancements!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a0212e12785ab40bec6ba63' id='5a0212e12785ab40bec6ba63'>
<a href='#5a0212e12785ab40bec6ba63'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/597e675643cc87000d81a2dc'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4c185c20f4461141dbd0ad1fbc8159f5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/597e675643cc87000d81a2dc'>Donny Van Acker</a>
</div>
<a UTCms='1510085345000' class='quanto-date posted-at response-posted-at' href='#5a0212e12785ab40bec6ba63'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie,</p>

<p>Thank you very much for your 
<code>
CustomFactor  
</code>s! This helps a lot.
I&#39;ve no idea what the code does but I&#39;ll try to examine it.</p>

<p>One last thing, when using your code in research or backtesting I get the following warning:</p>

<pre><code>WARN numpy/lib/arraysetops.py:200: FutureWarning: In the future, NAT != NAT will be True rather than False.

</code></pre>

<p>Something I should ignore?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a031f8da972ec380cabcb16' id='5a031f8da972ec380cabcb16'>
<a href='#5a031f8da972ec380cabcb16'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/573da216fda833664d000aad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a79e317c4782ce0fb09a383cc60e7def?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/573da216fda833664d000aad'>Lionel Ouaknin</a>
</div>
<a UTCms='1510154125000' class='quanto-date posted-at response-posted-at' href='#5a031f8da972ec380cabcb16'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Well the rename to trailing_dividend_yield should be seamless, right ?</p>

<p>This morning the Dividend Yield call i had been using started to fail.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a044b4865f48d4c9104ee68' id='5a044b4865f48d4c9104ee68'>
<a href='#5a044b4865f48d4c9104ee68'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1510230856000' class='quanto-date posted-at response-posted-at' href='#5a044b4865f48d4c9104ee68'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I so happy now that the memory usage is damn low and I can run many NBs in parallel :)</p>

<p>There is only one little issue, the one reported by Lionel: the fields that were renamed are not working anymore.<br>
e.g.<br>
    &#39;dividend_yield&#39;: &#39;trailing_dividend_yield&#39;,<br>
    &#39;dividend_rate&#39;: &#39;forward_dividend&#39;,  </p>

<p>If you use the new name &#39;morningstar.valuation_ratios.trailing_dividend_yield&#39;, that is not found:  </p>

<pre><code>AttributeError: type object &#39;valuation_ratios&#39; has no attribute &#39;trailing_dividend_yield&#39;

</code></pre>

<p>If you use the old name &#39;morningstar.valuation_ratios.dividend_yield&#39;, this error happens:</p>

<pre><code>ValueError: Names [&#39;asof_date&#39;, &#39;sid&#39;, &#39;timestamp&#39;, &#39;trailing_dividend_yield&#39;] not consistent with known names [u&#39;asof_date&#39;, u&#39;sid&#39;, u&#39;timestamp&#39;, u&#39;dividend_yield&#39;]  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a04a28875c1a500063069d9' id='5a04a28875c1a500063069d9'>
<a href='#5a04a28875c1a500063069d9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1510253192000' class='quanto-date posted-at response-posted-at' href='#5a04a28875c1a500063069d9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Lionel &amp; Luca: We have a fix for the <code>trailing_dividend_yield</code> problem on our staging environment. I will post back here when it makes it out to production. Sorry for the trouble.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a144d3b837b9429678855d5' id='5a144d3b837b9429678855d5'>
<a href='#5a144d3b837b9429678855d5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55eefc2af269c592d80008a9'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8985b490c95e135c2bbcd7d1a0dce16b?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55eefc2af269c592d80008a9'>Jamie McCorriston</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1511279931000' class='quanto-date posted-at response-posted-at' href='#5a144d3b837b9429678855d5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Lionel &amp; Luca: <code>trailing_dividend_yield</code> should now be working properly in backtesting and research.</p>

<p>@Costantino: The fundamentals docs have been updated with the new field names on our staging environment and should make it out to production soon.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5a16c721837b9464d36baecc' id='5a16c721837b9464d36baecc'>
<a href='#5a16c721837b9464d36baecc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1511442209000' class='quanto-date posted-at response-posted-at' href='#5a16c721837b9464d36baecc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Every time I now use Pipeline in Research I am amazed how fast it is and how low memory impact it has. We can now explore ideas that were impossible before, due to memory and speed limits. Great job, really.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ae6904b9601170044ac13a4' id='5ae6904b9601170044ac13a4'>
<a href='#5ae6904b9601170044ac13a4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5ad34344305aaa0021e2e1e1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8038842a9b1bd83d8219e36fd66ee9ca?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5ad34344305aaa0021e2e1e1'>Paul Blair</a>
</div>
<a UTCms='1525059659000' class='quanto-date posted-at response-posted-at' href='#5ae6904b9601170044ac13a4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I am noticing in using the 
<code>financial_health_grade</code> field that I get no data before July 20, 2008. Is that supposed to be the start date of that data series?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ae723d59601170048ac24c8' id='5ae723d59601170048ac24c8'>
<a href='#5ae723d59601170048ac24c8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54487203dc843663f2000123'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/439ba1adf33b808f2d50e3a31c3c7e28?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54487203dc843663f2000123'>Josh Payne</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1525097429000' class='quanto-date posted-at response-posted-at' href='#5ae723d59601170048ac24c8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I believe that is by design -- Morningstar does not generate back further for that particular field.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5c0a3e6747e8cc0040fe0ce7' id='5c0a3e6747e8cc0040fe0ce7'>
<a href='#5c0a3e6747e8cc0040fe0ce7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5b2d8244b188bc4cde23885e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/16e6f8b2713c159aaeb78237d65ec957?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5b2d8244b188bc4cde23885e'>Alessio Brini</a>
</div>
<a UTCms='1544175207000' class='quanto-date posted-at response-posted-at' href='#5c0a3e6747e8cc0040fe0ce7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Why does a 24-factor Pipeline queried for 4 years take more than 20 minutes? Is it normal?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5c5a9b3e99fa0500415ef843' id='5c5a9b3e99fa0500415ef843'>
<a href='#5c5a9b3e99fa0500415ef843'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5abde6a00e7bd0001211b204'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/83749f7e225dda399980568be48fb832?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5abde6a00e7bd0001211b204'>Sebastian Koch</a>
</div>
<a UTCms='1549441854000' class='quanto-date posted-at response-posted-at' href='#5c5a9b3e99fa0500415ef843'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Jamie<br>
and @AnyOtherPersonWhoIsSmarterThanMe :-)</p>

<pre><code>class LastFourQuartersAsOfDates(CustomFactor):  
    # Get the last 4 unique values of a given asof_date.  
    outputs = [&#39;q1_asof&#39;, &#39;q2_asof&#39;, &#39;q3_asof&#39;, &#39;q4_asof&#39;]  
    window_length = 195 + 65  
    dtype = np.dtype(&#39;datetime64[ns]&#39;)

    def compute(self, today, assets, out, asof_date):  
        for column_ix in range(asof_date.shape[1]):  
            unique_dates, _ = np.unique(asof_date[:, column_ix], return_index=True)  
            if len(unique_dates) &lt; 4:  
                unique_dates = np.hstack([  
                    np.repeat([np.datetime64(&#39;NaT&#39;)], 4 - len(unique_dates)),  
                    unique_dates,  
                ])  
            unique_dates = unique_dates[-4:]  
            out[column_ix] = unique_dates  
</code></pre>

<p>I love Jamie&#39;s custom factor for calculating trailing 4 quarter fundamentals.<br>
Now I try to build something that should theoretically be easier but I just can&#39;t get it right.</p>

<p>Instead of an array with index Q1_asof, Q2_asof, etc. with the corresponding filing dates for a Fundamental like Net_Income,<br>
I just want to return an integer with the number of unique filing dates for that Fundamental within a given time window<br>
(for example 5 years). </p>

<p>Basically I want to find out if a company had for example 19 unique filing dates in the last 5 years or just 3.</p>

<p>Any idea how it can be done?</p>

<p>Best regards,<br>
Sebastian  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5c5b176aa86cf928d9130029' id='5c5b176aa86cf928d9130029'>
<a href='#5c5b176aa86cf928d9130029'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5ae9fc7db16b9339bf0d4997'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/96d136f0830e9bd9d16be17119689cc0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5ae9fc7db16b9339bf0d4997'>Leo c</a>
<span class='badge medal'></span>
</div>
<a UTCms='1549473642000' class='quanto-date posted-at response-posted-at' href='#5c5b176aa86cf928d9130029'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Sebastian,</p>

<p>Do you get pipeline timeout using LastFourQuartersAsOfDates or LastFourQuarters class?</p>

<p>tks  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5ea7cf3eee07a1003d7af530' id='5ea7cf3eee07a1003d7af530'>
<a href='#5ea7cf3eee07a1003d7af530'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5db24b35daf860003e1faf76'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a40f10cb1848f7fae58b0a98e129b238?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5db24b35daf860003e1faf76'>Sudarshan Iyer</a>
</div>
<a UTCms='1588055870000' class='quanto-date posted-at response-posted-at' href='#5ea7cf3eee07a1003d7af530'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I am getting the following error when running the LastFourQuartersAsOfDates factor in a pipeline: ValueError: cannot include dtype &#39;M&#39; in a buffer. Think it has something to do with outputting in datetime64[ns] format. Any idea what could be causing this issue?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5eb6d2e1f2202b00416125ae' id='5eb6d2e1f2202b00416125ae'>
<a href='#5eb6d2e1f2202b00416125ae'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a1f249687162a2ce0d7ea84'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/be3d2fcaa18afe49ff316150d6855eeb?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a1f249687162a2ce0d7ea84'>Carlo G.</a>
</div>
<a UTCms='1589039841000' class='quanto-date posted-at response-posted-at' href='#5eb6d2e1f2202b00416125ae'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Yes i get the same error. Something must have changed. ValueError: cannot include dtype &#39;M&#39; in a buffer.  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/faster-fundamental-data'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/faster-fundamental-data'>join Quantopian</a> to
post a reply.
</div>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#35535050515754565e754440545b415a455c545b1b565a58">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
