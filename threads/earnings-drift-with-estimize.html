<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Earnings drift with Estimize
</title>
<meta content='UPDATE 08/25/2016: We&#39;ve recently found a technical issue with the Estimize Consensus Estimates data feed through Pipeline and are working to resolve it. A similar strategy using the Street&#39;s Earnings Consensus by Zacks can be found here and the strategy below has been updated with that backtest until a solution is fully implemented.UPDATE 02/16/2016: This algorithm now uses the Estimize Consensus Estimates found through the Pipeline API and a new backtest is attached.Earnings estimates...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="ou6o1L2U83uuNdW7mmfR3Lhbuj7yU6zMAOFJTjkwWw3eiN6ZH2IhmBcojIrViHmogNWZV4ifudeC7pIkk3U5tg==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=false;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/earnings-drift-with-estimize' property='og:url'>
<meta content='Earnings drift with Estimize' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/earnings-drift-with-estimize' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Earnings drift with Estimize' property='og:title'>
<meta content='UPDATE 08/25/2016: We&#39;ve recently found a technical issue with the Estimize Consensus Estimates data feed through Pipeline and are working to resolve it. A similar strategy using the Street&#39;s Earnings Consensus by Zacks can be found here and the strategy below has been updated with that backtest until a solution is fully implemented.UPDATE 02/16/2016: This algorithm now uses the Estimize Consensus Estimates found through the Pipeline API and a new backtest is attached.Earnings estimates...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/earnings-drift-with-estimize">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='54515bd819bf59f004000406'>
<div class='post-container' data-post-id='54515bd819bf59f004000406' id='54515bd819bf59f004000406'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Earnings drift with Estimize</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<span class='posted-at'>edited </span>
<span UTCms='1473253594000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Earnings drift with Estimize&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fearnings-drift-with-estimize%3Futm_source%3Dwebsite_share%26utm_campaign%3Dpead-strategy-with-crowdsourced-earnings-from-estimize%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fearnings-drift-with-estimize%3Futm_source%3Dwebsite_share%26utm_campaign%3Dpead-strategy-with-crowdsourced-earnings-from-estimize%26utm_medium%3Dlinkedin&amp;title=Earnings+drift+with+Estimize+%28Seong+Lee%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class='tags tag-row'>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Finance Theory' data-tag-id='55c50e7d8d4710ec6e000002' href='/posts/tag/Finance-Theory/newest'>Finance Theory</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Using Data' data-tag-id='55c50e7d8d4710ec6e000008' href='/posts/tag/Using-Data/newest'>Using Data</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Sentiment' data-tag-id='55c50e7d8d4710ec6e00000f' href='/posts/tag/Sentiment/newest'>Sentiment</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Show Q' data-tag-id='55c50e7d8d4710ec6e000010' href='/posts/tag/Show-Q/newest'>Show Q</a>
</div>
<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/earnings-drift-with-estimize?utm_source=website_share&amp;utm_campaign=pead-strategy-with-crowdsourced-earnings-from-estimize&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Seong Lee" />
<div class='body-text'>
<div class='body-text-container post-body'><p><strong>UPDATE 08/25/2016: We&#39;ve recently found a technical issue with the Estimize Consensus Estimates data feed through Pipeline and are working to resolve it. A similar strategy using the <a href="https://www.quantopian.com/posts/long-slash-short-pead-with-news-sentiment-and-the-streets-consensus">Street&#39;s Earnings Consensus by Zacks can be found here</a> and the strategy below has been updated with that backtest until a solution is fully implemented.</strong></p>

<p><strong>UPDATE 02/16/2016: This algorithm now uses the Estimize Consensus Estimates found through the Pipeline API and a new backtest is attached.</strong></p>

<p>Earnings estimates (earnings per share or EPS) and revenue estimates are heavily used in both quant and fundamental stock analysis as forward-looking indicators of stock performance and sources of alpha. Traditionally, estimates are given by sell-side analysts on Wall Street and are then aggregated and averaged into what&#39;s commonly referred to as &quot;the Wall Street Consensus&quot; or simple &quot;the street&#39;s&quot; expectations. Starting in 2011 however, the fintech startup <a href="http://www.estimize.com/">Estimize</a> launched a new platform allowing anyone on the web to share their own earnings and revenue estimates. Website visitors and contributors can browse the estimates submitted by other users. </p>

<p>At our <a href="http://www.meetup.com/NYC-Algorithmic-Trading/events/213216052/">NYC meetup</a>, I presented some validation work on claims made in a recent Estimize <a href="http://com.estimize.public.s3.amazonaws.com/papers/Estimize%20Whitepaper%20Executive%20Summary.pdf">whitepaper</a> with the goal of replicating results in the new <a href="https://www.quantopian.com/research">Quantopian Research Platform</a> and providing a basis for future work.  You can find slides from the event on <a href="http://www.slideshare.net/Quantopian/quantopian-estimize">this slideshare</a>.</p>

<p>I confirmed the finding that there is potential for crowdsourced earnings data to be an interesting new source of alpha, especially given that current earnings surprise strategies are almost exclusively based off the Wall Street Consensus.</p>

<p><strong>Sample Trading Strategy</strong></p>

<p>Here I&#39;m sharing a basic <a href="http://quantpedia.com/screener/details/33">PEAD (Post Earnings Announcement Drift) Strategy</a>  which goes long (short) companies whose actual earnings announcements beat (miss) expectations, also knows as a positive (negative) earnings &quot;surprise&quot;.</p>

<p>I&#39;ve tried to make the code easy to read and modify, almost everything you might want to change can be done by fiddling with the values in initialize(context). Below are some notes on the strategy so have fun and post here with any questions or insights you&#39;d like to share!</p>

<p><strong>Strategy Notes</strong></p>

<ul>
<li><strong>Data set</strong>: The full dataset used is Estimize&#39;s Consensus Estimates and <a href="https://www.quantopian.com/data/eventvestor/earnings_calendar">EventVestor&#39;s Earnings Calendar dataset</a>.<br></li>
<li><strong>Weights</strong>: The weight for each security is determined by the total number of longs and shorts we have in that current day. So if we have 2 longs and 2 shorts, the weight for each long will be 50% (1.0/number of securities) and the weight for each short will be -50%. This is a rolling rebalance at the beginning of each day according to the number of securities currently held and to order.<br></li>
<li><strong>Long/Short</strong>: The current algorithm goes both long/short.<br></li>
<li><strong>Hedging</strong>: [OPTIONAL] You have the ability to turn on net dollar exposure hedging with the SPY<br></li>
<li><strong>Days held</strong>: Positions are currently held for 3 days but are easily changeable by modifying &#39;context.days_to_hold&#39;<br></li>
<li><strong>Percent threshold</strong>: Only surprises between 0% and 4% in absolute magnitude will be considered as a trading signal. These are adjustable using the minimum and maximum threshold variables in context.<br></li>
<li><strong>Earnings dates</strong>: All trades are made 1 business day AFTER an earnings announcement regardless of whether it was a <code>Before Market Open</code> or <code>After Market</code> announcement<br></li>
<li>Jess released a similar algo about a year back which <a href="https://www.quantopian.com/posts/trading-earnings-surprises-with-estimize-data">is now outdated</a>. Please use this algorithm and format instead! </li>
</ul>

<p>Thanks,<br>
Seong</p>

<p><a href="https://attendee.gotowebinar.com/register/4270306722363417603">Join our webinar on March 1st, 2016 at 6PM EST with Leigh Drogen, CEO of Estimize, and Vinesh Jha, CEO of ExtractAlpha, as we discuss how to use Crowdsourced Estimates in your algorithms.</a> </p>
</div>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>39 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='5452fb09515e768282000164' id='5452fb09515e768282000164'>
<a href='#5452fb09515e768282000164'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53e443a5f37d244e1200016f'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/962272a55ea6d95dbe47123754ceeaff?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53e443a5f37d244e1200016f'>JB C</a>
</div>
<a UTCms='1414724363000' class='quanto-date posted-at response-posted-at' href='#5452fb09515e768282000164'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for sharing Seong, interesting stuff. I am trying to understand the data fetching part. I understand that you got a snapshot from Estimize and preprocessed it.</p>

<p>But I can&#39;t see how this code can run without an implementation for <strong>fetch_estimize()</strong> ?</p>

<p>I am actually able to clone the algo and run it but I have no clue how that is even possible, or what the data format might look like...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54539976ae8e577da2000389' id='54539976ae8e577da2000389'>
<a href='#54539976ae8e577da2000389'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1414764921000' class='quanto-date posted-at response-posted-at' href='#54539976ae8e577da2000389'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi JB,</p>

<p>Great questions! <strong>fetch_estimize</strong> is a custom method we&#39;ve implemented because although we cannot give you the data itself, we still wanted to share the algorithm and allow users to gain some potential strategy ideas off of this post. As for what the data looks like, I can give you a few ways to see it for yourself.</p>

<p>The best way is to include a &quot;preview&quot; in your &quot;pre_func&quot; method which in this case is defined as &quot;def pre_func(df):&quot;. In that line you can add &quot;log.info(&#39; %s &#39; % df.head())&quot; in order to see the columns of the dataframe and the first few rows of what the data looks like. This is what it looks like in code:</p>

<pre><code>def pre_func(df):  
    log.info(&#39; %s &#39; % df.head())  
    #: The rest of what I have in the code  
</code></pre>

<p>From this point on you can see which columns are there, what the data looks like (because the data is consistent for the rest of the rows) and how to change your algorithm to match it. For example, you&#39;ll notice that when you add the line I have above, you&#39;ll see that there&#39;s also a &quot;wallstreet_eps&quot; column present. So now you can change &quot;context.which_eps&quot; to the string &quot;wallstreet_eps&quot; in order to base the strategy off of the Street&#39;s earning&#39;s estimates instead of the Estimize estimates.</p>

<p>This is generally the best way to clone/preview an algorithm where someone is fetching an inaccessible CSV file. </p>

<p>Give it a try and let me know what you think! </p>

<p>Seong  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5458356eea07cd7ede0001a0' id='5458356eea07cd7ede0001a0'>
<a href='#5458356eea07cd7ede0001a0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53e443a5f37d244e1200016f'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/962272a55ea6d95dbe47123754ceeaff?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53e443a5f37d244e1200016f'>JB C</a>
</div>
<a UTCms='1415066992000' class='quanto-date posted-at response-posted-at' href='#5458356eea07cd7ede0001a0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Seong, got it. So the CSV file is inaccessible but the data is cached somewhere on the quantopian servers. If anyone else is wondering, the format looks like this:</p>

<pre><code>id  sector  industry    ticker  fiscal_year     fiscal_quarter  actual_eps  actual_rev  wallstreet_eps  wallstreet_rev date     date    estimize_eps    estimize_rev    num_participants  
4e671c877cb02d7af700002c    Information Technology  Software    SWI     2011    4   0.29    55.61   0.25    53.87   2/7/12 6:00 0.29    54.2    1  
</code></pre>

<p>It seems API access to Estimize requires a license but the rest of the platform is free. Will check it out.</p>

<p>Cheers!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5458eb0fea07cd7ede0003e1' id='5458eb0fea07cd7ede0003e1'>
<a href='#5458eb0fea07cd7ede0003e1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9883fb2eb00020001d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1f2085562321d4a7b8e98090582a869c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9883fb2eb00020001d1'>Leigh  Drogen</a>
</div>
<a UTCms='1415113489000' class='quanto-date posted-at response-posted-at' href='#5458eb0fea07cd7ede0003e1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>JB C, I&#39;m the founder at Estimize, glad to answer any questions regarding the API. </p>

<p>We do license the full data set in real time through a JSON REST API.</p>

<p>For Individuals: We provide a 1 month trial of the full real time API for $1,000. After that the cost for accessing the API is $1,000/month on a yearly contract. </p>

<p>For Firms: We provide the same 1 month $1,000 trial, but the cost of the API is between $5,000-$10,000 roughly based on assets under management. </p>

<p>All of our historical data is available to backtest for free via Quantopian. </p>

<p>You can get a trial started by contacting us through this form.</p>

<p><a href="http://www.estimize.com/api">http://www.estimize.com/api</a></p>

<p>On another note, it&#39;s great to see everyone working with the data on Quantopian, we&#39;re hugely fans of the Quanoptian founder Fawce and his team, and love seeing all the innovative algorithms built by the community here. Please reach out if you have any questions!</p>

<p>Leigh  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='545b552b6942f08dff000398' id='545b552b6942f08dff000398'>
<a href='#545b552b6942f08dff000398'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1415271725000' class='quanto-date posted-at response-posted-at' href='#545b552b6942f08dff000398'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Seong,</p>

<p>How can one tell if the algorithm performance is actually due to post-earnings-announcement drift, or other factors?  It seems that you need to formulate a baseline for comparison.  For example, maybe there is some sort of Monte Carlo simulation you could run to show that by buying/selling the same securities over the same period but without the Estimize information, the return would have been statistically worse.</p>

<p>Would there be any way to replace SPY with a suitable benchmark that captures the basket of securities you are trading?</p>

<p>Or maybe the Estimize data provide no advantage, and you could just detect gaps up/down in price overnight and get the same result?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='545bcec96ed845172d00000b' id='545bcec96ed845172d00000b'>
<a href='#545bcec96ed845172d00000b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5445095923fba7c7730002ec'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/bff7bb2005dfba5cba38b364b1033bd5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5445095923fba7c7730002ec'>Gregory Milne</a>
</div>
<a UTCms='1415302859000' class='quanto-date posted-at response-posted-at' href='#545bcec96ed845172d00000b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant Kiehne -- I think you make a great point.  Wouldn&#39;t the following provide a similar result:</p>

<p>1) Detect the first trading day after earnings and;<br>
2) If stock &gt; by MAVG20 buy or stock &lt; MVAG20 short</p>

<p>Since you would start trading the day after earnings it is implied that the movement is correlated to the announcement, regardless if earnings beat the street/consensus.  Food for thought.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='545cfe6aedb13d6a580003fc' id='545cfe6aedb13d6a580003fc'>
<a href='#545cfe6aedb13d6a580003fc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1415380588000' class='quanto-date posted-at response-posted-at' href='#545cfe6aedb13d6a580003fc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant </p>

<p>You bring up some really interesting points. The original whitepaper that this algo (<a href="http://com.estimize.public.s3.amazonaws.com/papers/Estimize%20Whitepaper%20Executive%20Summary.pdf">http://com.estimize.public.s3.amazonaws.com/papers/Estimize%20Whitepaper%20Executive%20Summary.pdf</a>)<br>
was based off of compared Estimize against the Street&#39;s consensus (and the strategy based off Estimize did fare better) but that doesn&#39;t rule out the possibility that perhaps both strategies had returns that were affected by factors other than earnings drift. Although, I think that&#39;s a possibility present in any algorithm (e.g. randomness as Nassim Taleb says very often). I would think you would be able to take the basket of securities as a universe and go long (equal weights) and see if that works as a benchmark? I&#39;m not too sure on this one. Thoughts?</p>

<p>@Greg </p>

<p>That sounds like it would make a very interesting strategy. Maybe a challenge would be to write it up and share it? :)  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='545d0137edb13da6b1000426' id='545d0137edb13da6b1000426'>
<a href='#545d0137edb13da6b1000426'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9883fb2eb00020001d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1f2085562321d4a7b8e98090582a869c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9883fb2eb00020001d1'>Leigh  Drogen</a>
</div>
<a UTCms='1415381305000' class='quanto-date posted-at response-posted-at' href='#545d0137edb13da6b1000426'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Grant The white paper written by Vinesh and I does account for various different potentially correlated factors such as momentum, value, growth, etc. The returns shown in the paper are residual to any other factors, not just market neutral, but residual and uncorrelated.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='545e217b5cb7a722f200028f' id='545e217b5cb7a722f200028f'>
<a href='#545e217b5cb7a722f200028f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1415455103000' class='quanto-date posted-at response-posted-at' href='#545e217b5cb7a722f200028f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Seong,</p>

<p>I ain&#39;t no expert, but I think that the point here is that the <strong>drift</strong> is the potential arbitrage opportunity.  There&#39;s a long-term relaxation phenomenon that has to be separated from other deterministic factors and noise.  Perhaps your algorithm is taking advantage of the effect, but I just can&#39;t tell from what you&#39;ve presented.  My intuition is that the effect will be relatively small, given that it is well-known and the market is incredibly efficient.</p>

<p>@Leigh,</p>

<p>Am I thinking about this correctly?  Is there a prescribed method that could be applied to sort out if Seong&#39;s example is taking advantage of the effect?  And to what extent his use of Estimize data was helpful?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='545e31d65cb7a70ba900028b' id='545e31d65cb7a70ba900028b'>
<a href='#545e31d65cb7a70ba900028b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5459a53137d77c8d2300030a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/9058e11be790fd750e55fa8c367a5fd2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5459a53137d77c8d2300030a'>Christian Schwalbach</a>
</div>
<a UTCms='1415459288000' class='quanto-date posted-at response-posted-at' href='#545e31d65cb7a70ba900028b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I looked at the slide show, and either I missed something, or what, but wasn&#39;t there a direct correlation between participant number and accuracy rate? If so then why throw out the above 20 particpiant data set for Co&#39;s? Is it something to do with the increased participant number creating too much noise? simple stat analysis would tell you that few particpants=inaccuracy, yet I did not see a filter throwing out co&#39;s that had a small number of particpants.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='545e4c02ac3e5145ee000292' id='545e4c02ac3e5145ee000292'>
<a href='#545e4c02ac3e5145ee000292'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5459a53137d77c8d2300030a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/9058e11be790fd750e55fa8c367a5fd2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5459a53137d77c8d2300030a'>Christian Schwalbach</a>
</div>
<a UTCms='1415465988000' class='quanto-date posted-at response-posted-at' href='#545e4c02ac3e5145ee000292'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Looking at the backtest, I noticed that most of the increase in performance for the algo was in April 2013, while the benchmark stayed steady in its growth. The performance from April 2013 onwards was much more confined to a range in growth. I&#39;m less curious about the recent performance than the aforementioned April increase. Any logical reason for the timing on that? Or just the way it played out?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5460fff5a474f7c5510002f6' id='5460fff5a474f7c5510002f6'>
<a href='#5460fff5a474f7c5510002f6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1415643127000' class='quanto-date posted-at response-posted-at' href='#5460fff5a474f7c5510002f6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Christian,</p>

<p>In this case, we kept every instance where number of participants were greater than or equal to 20 and we threw away anytime it was less than that. The pre_func method keeps data where num_participants are &gt; 20 and throws out all the rest. </p>

<pre><code>df = df[(df[&#39;num_participants&#39;] &gt; 19)]  
</code></pre>

<p>But you&#39;re right, I did find a correlation between number of participants and the accuracy rate. I don&#39;t know if I have a solid answer for you about the increased performance in April 2013, it may have just been that the earnings drift for surprises based off the Estimize data was larger than the other instances that they&#39;ve occurred so maybe it was the way it played out in this case. </p>

<p>Seong  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='546267c1f6f1309c3700011b' id='546267c1f6f1309c3700011b'>
<a href='#546267c1f6f1309c3700011b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5459a53137d77c8d2300030a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/9058e11be790fd750e55fa8c367a5fd2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5459a53137d77c8d2300030a'>Christian Schwalbach</a>
</div>
<a UTCms='1415735245000' class='quanto-date posted-at response-posted-at' href='#546267c1f6f1309c3700011b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>OK, I must have misread that first programming bit. What you wrote makes more sense. thanks  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5464b67c0deccadd830004ca' id='5464b67c0deccadd830004ca'>
<a href='#5464b67c0deccadd830004ca'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1415886462000' class='quanto-date posted-at response-posted-at' href='#5464b67c0deccadd830004ca'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hey all,</p>

<p>The cut of data has been updated to the end of October 2014 so feel free to update your backtests to a more recent date. </p>

<p>Thanks!  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5464e718cf0f8a932d000018' id='5464e718cf0f8a932d000018'>
<a href='#5464e718cf0f8a932d000018'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9883fb2eb00020001d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1f2085562321d4a7b8e98090582a869c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9883fb2eb00020001d1'>Leigh  Drogen</a>
</div>
<a UTCms='1415898907000' class='quanto-date posted-at response-posted-at' href='#5464e718cf0f8a932d000018'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Really interesting to see the dip in performance of the algorithm during the months early in the year when many high beta names melted down and the market went through a little volatility. But in October when the market went through a ton of volatility and everything melted down there wasn&#39;t much if any poor performance in the algo, and more recently it&#39;s done very well. This would make sense, as many of the names where there are going to be a ton of estimates and companies which beat/miss their consensus by a wide margin are going to be high growth companies, they all got crushed together early in the year, basically correlations went way up, and the algo stopped working. In other words, the market didn&#39;t care for a short time what the fundamentals of the stocks where, everything got crushed together in the high beta growth space. </p>

<p>I wonder whether there is a benefit to creating a switch to turn off the algo for stocks within a sector that experiencing abnormal volatility above a certain level. The performance of this strategy very much depends on companies being rewarded/punished for beating/missing expectations, but at times when market correlations get higher due to volatility that isn&#39;t going to happen as much and the algo will suffer. </p>

<p>Overall obviously great performance out of the strategy, but more fine tuning can be done I believe, without curve fitting, an in and out of sample test here for volatility could make sense.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5465e1a0551e40c01b000399' id='5465e1a0551e40c01b000399'>
<a href='#5465e1a0551e40c01b000399'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1415963042000' class='quanto-date posted-at response-posted-at' href='#5465e1a0551e40c01b000399'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Seong &amp; Leigh,</p>

<p>Maybe I&#39;m just a cranky skeptic, but I&#39;d like to reiterate the need to be more analytical here with respect to performance and assigning cause-and-effect relationships.  I&#39;m no financial expert, but my impression is that we&#39;re dealing with a complex system with lots of noise, so it&#39;s gonna be tricky to tease out what&#39;s actually going on.  For example, if the algo is based on high growth companies, and we&#39;ve been in a bull market, then the fact that the algo beats the broad market could just be due to the securities that were selected, right?  How do we know that the PEAD effect is at play here?  If it gets washed out by volatility, then maybe there are other underlying factors that wash it out completely, and we aren&#39;t seeing it at all in the backtest.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5466115c3fae9d72d600039a' id='5466115c3fae9d72d600039a'>
<a href='#5466115c3fae9d72d600039a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1415975262000' class='quanto-date posted-at response-posted-at' href='#5466115c3fae9d72d600039a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant,</p>

<p>Your points are extremely legitimate and to be frank, I don&#39;t think I&#39;m the most knowledgable person to answer your questions. Although I&#39;d like to say that I wasn&#39;t trying to assign any cause-and-effect relationship but that perhaps there was some correlation. </p>

<ul>
<li>For example, if the algo is based on high growth companies, and we&#39;ve been in a bull market, then the fact that the algo beats the broad market could just be due to the securities that were selected, right?<br></li>
<li>How do we know that the PEAD effect is at play here?<br></li>
<li>If it gets washed out by volatility, then maybe there are other underlying factors that wash it out completely, and we aren&#39;t seeing it at all in the backtest.</li>
</ul>

<p>I think these questions need to be answered and the right place to do that would be in Research. I&#39;m extremely interested in collaborating on a project with you on this and I think it would be a ton of fun for the both of us, shoot me a line if you&#39;re interested. If not, that&#39;s okay too :) </p>

<p>Seong  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='54662b45551e40dc89000437' id='54662b45551e40dc89000437'>
<a href='#54662b45551e40dc89000437'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9883fb2eb00020001d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1f2085562321d4a7b8e98090582a869c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9883fb2eb00020001d1'>Leigh  Drogen</a>
</div>
<a UTCms='1415981895000' class='quanto-date posted-at response-posted-at' href='#54662b45551e40dc89000437'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant,</p>

<p>I don&#39;t think you&#39;re quite grasping the idea of market neutral and residual returns. The bull vs bear market thing doesn&#39;t effect this algorithm in any way what so ever. Residual returns means residual to a slew of different factors, growth and momentum being two of them. While this example on Quantopian only uses the SPY to produce the &quot;market neutral&quot; returns, the paper written by the Deutsche Bank Quant Research team, as well as our white paper, which look at this strategy, both go into far more depth. </p>

<p>As well, the idea of causality is irrelevant. Good quant research is not about causality, it&#39;s about finding an inefficiency in the market that can be repeatably arbitraged. We&#39;re not attempting to explain why the post earnings drift takes place, just that by using the Estimize data set we can capture it. Good quant research is achieve by looking at these strategies both in, and out of sample, which has been done. Now, one can make an argument that our sample size is not large enough, or the length of history in the data set is not long enough, but based on the fact that a number of large quant funds pay for and trade on our data, I&#39;d say that&#39;s not an issue at this point. </p>

<p>My point regarding market volatility has nothing to do with bull vs bear markets, I would bet that it works the same way for volatility on the upside as well.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54672a00df599e45740002cc' id='54672a00df599e45740002cc'>
<a href='#54672a00df599e45740002cc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1416047106000' class='quanto-date posted-at response-posted-at' href='#54672a00df599e45740002cc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Leigh,</p>

<p>My main point is that there is an assumed predictive model being applied, but the data presented here on this thread are insufficient to validate the model (at least for me, with my limited background in this field).</p>

<p>Given that you sell your dataset to large quant funds, do you think that Quantopian members will still be able to use it to their advantage?  Or will all of the benefit be &quot;arbitraged away&quot; (I guess this is the lingo)?  If the strategy truly works and it is public knowledge, then it shouldn&#39;t work for long, correct?</p>

<p>Also, is there any evidence that the &quot;Wall Street estimates&quot; are coming into line with the more accurate ones of Estimize?</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='546794643ac4f7cd5d0004d4' id='546794643ac4f7cd5d0004d4'>
<a href='#546794643ac4f7cd5d0004d4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1416074343000' class='quanto-date posted-at response-posted-at' href='#546794643ac4f7cd5d0004d4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s Seong&#39;s backtest from above, but with Anony Mole&#39;s custom slippage model (<a href="https://www.quantopian.com/posts/trade-at-the-open-slippage-model">https://www.quantopian.com/posts/trade-at-the-open-slippage-model</a>).  It simulates orders closer to the opening bell.  My understanding is that Quantopian doesn&#39;t yet support orders at the true open (since all open orders are cancelled at the daily market close).  This may be a use case to sort out how to make it work, since the return is appreciably higher.  --Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5467963bdf599e350e0004fa' id='5467963bdf599e350e0004fa'>
<a href='#5467963bdf599e350e0004fa'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5033e9883fb2eb00020001d1'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1f2085562321d4a7b8e98090582a869c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5033e9883fb2eb00020001d1'>Leigh  Drogen</a>
</div>
<a UTCms='1416074813000' class='quanto-date posted-at response-posted-at' href='#5467963bdf599e350e0004fa'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Grant,</p>

<p>The post earnings drift strategy using Estimize data shows strong alpha generation in and out of sample, so I&#39;m not sure what you mean by the data presented being insufficient. </p>

<p>Regarding the arbitrage of this advantage, yes, over time some of the alpha generating capability of this strategy will go away as the Estimize data set is utilized by more and more quants. But given that the Estimize Consensus is much closer to the true representation of expectations than the Wall Street consensus, there should always be some post earnings drift alpha to be captured, I doubt the market will ever be that efficient as to arbitrage it within minutes. It took 20 years to arbitrage the post earnings drift agains the Wall Street numbers. </p>

<p>No, there is no evidence that wall street numbers are coming into line with Estimize, that is due to the systematic bias under which wall street estimates are created by those analysts.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5467983c98fc474c510004fd' id='5467983c98fc474c510004fd'>
<a href='#5467983c98fc474c510004fd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1416075326000' class='quanto-date posted-at response-posted-at' href='#5467983c98fc474c510004fd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Leigh,</p>

<p>I definitely have some reading to do.  Also, the backtest I posted above suggests more of a monotonic upward trend in return, which is encouraging.  Glad you are able to show Wall Street bias!</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='546c774c5cb4f654cc0002ca' id='546c774c5cb4f654cc0002ca'>
<a href='#546c774c5cb4f654cc0002ca'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1416394574000' class='quanto-date posted-at response-posted-at' href='#546c774c5cb4f654cc0002ca'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Seong,</p>

<p>Should your backtest include the $1000/month cost for access to the Estimize data?  Also, what would be the comparable cost for a feed of the Wall Street consensus estimates, via fetcher?  I&#39;m just wondering if a strategy like this is anywhere within reach of a typical individual retail investor who most likely won&#39;t be shelling out $12K/year for the data.</p>

<p>Regarding the Wall Street estimates, one interesting analysis we could do with the data would be to see if the actual earnings can be predicted via the Wall Street estimates.  Then, if the Wall Street estimates were cheaper or free, then one could just use those.  Basically, if there is a consistent systematic bias by Wall Street, then maybe one can back out a model to correct for the bias.</p>

<p>What is the game plan by Quantopian for being able to set up an algo for executing orders closer to the open?  I can see that one could load fresh data via fetcher overnight, but then the algo can&#39;t access the market until just after 9:31, right?</p>

<p>Another thought is that there might be an advantage to timing a series of orders over the ~50 second window allowed by handle_data, so rather than putting in a single order essentially right at the whole minute, put in several orders over the minute, at different sub-minute times.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54ee468976644ef265000020' id='54ee468976644ef265000020'>
<a href='#54ee468976644ef265000020'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1424901772000' class='quanto-date posted-at response-posted-at' href='#54ee468976644ef265000020'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The notebook that this algorithm was based off of has just been released here: <a href="https://www.quantopian.com/posts/research-stepping-through-crowdsourced-earnings-data-with-estimize">https://www.quantopian.com/posts/research-stepping-through-crowdsourced-earnings-data-with-estimize</a>. Feel free to take a look!  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='55896d3333c91648600000ea' id='55896d3333c91648600000ea'>
<a href='#55896d3333c91648600000ea'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1435069751000' class='quanto-date posted-at response-posted-at' href='#55896d3333c91648600000ea'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>For those looking to backtest this, please use this latest code!</p>

<pre><code>&quot;&quot;&quot;
    This is a PEAD strategy based off Estimize&#39;s earnings estimates. Estimize (estimize.com) is a service that aggregate financial estimates from independent, buy-side, sell-side analysts as well as students and professors. The data that we&#39;re using here will be called from our custom &#39;fetch_estimize&#39; method and contains the following columns:  
    - date: the date that the company announced it&#39;s earnings  
    - actual_eps: the actual earnings announcement on that date  
    - wallstreet_eps: the Wall Street consensus&#39; estimates for that earnings announcement  
    - estimize_eps: the Estimize estimates for that earnings announcement  
    - ticker: the stock ticker

    Much of the variables are meant for you to be able to play around with them:  
        1. context.algo_type: defines whether you want a long/short strategy  
        2. context.days_to_hold: defines the number of days you want to hold before exiting a position  
        3. context.min/max_surprise: defines the min/max % surprise you want before trading on a signal  
        4. context.which_eps: defines that you&#39;re using the &#39;estimize_eps&#39; rather than the &#39;wallstreet_eps&#39; as your benchmark. Change it to &#39;wallstreet_eps&#39; if you&#39;d rather use that.  
&quot;&quot;&quot;

from pytz import timezone  
from datetime import datetime, timedelta

import numpy as np

def initialize(context):  
    #: Declares whether we&#39;re doing a short/long/both strategy  
    context.algo_type = &#39;both&#39;  
    #: Declaring the days to hold, change this to what you want)))  
    context.days_to_hold = 3  
    #: Declares which stocks we currently held and how many days we&#39;ve held them dict[stock:days_held]  
    context.stocks_held = {}  
    #: Declares which eps estimate to benchmark against  
    context.which_eps = &#39;estimize_eps&#39;  
    #: Declares the minimum magnitude of percent surprise  
    context.min_surprise = .01  
    context.max_surprise = .06  
    #: Declares the number of ticks that we&#39;ve used in the current day  
    context.ticks = 0  
    #: Boolean holding the memory whether or not we&#39;ve already ordered for the current day  
    context.ordered = False  
    #: Boolean holding the memory whether or not we need to retry closing out our positions  
    context.retry = False  
    #: Initialize our Hedge  
    context.spy = sid(8554)  
    #: Get our tickers and set them as our data  
    fetch_estimize(  
              pre_func=pre_func,  
              symbol_column=&#39;ticker&#39;)  
    #: Get the same tickers and set them as our universe  
    fetch_estimize(  
              pre_func=pre_func,  
              symbol_column=&#39;ticker&#39;,  
              universe_func=my_universe)

def handle_data(context, data):  
    #: Converting the time in to the Eastern Timezone  
    #: This will be made obsolete with the `schedule_function` method. Coming out soon!  
    current_time = get_datetime().astimezone(timezone(&#39;US/Eastern&#39;))  
    &quot;&quot;&quot;  
        Setting starting positions  
    &quot;&quot;&quot;  
    if current_time.hour == 9 and current_time.minute == 31:  
        context.ticks = 0  
    &quot;&quot;&quot;  
        Log current positions at 10:00 AM  
    &quot;&quot;&quot;  
    if current_time.hour == 10 and current_time.minute == 0 and context.ordered == True:  
        #: Get all positions  
        all_positions = &quot;Current positions for %s : &quot; % (str(get_datetime()))  
        for pos in context.portfolio.positions:  
            all_positions += &quot;%s at %s shares, &quot; % (pos.symbol, context.portfolio.positions[pos].amount)  
        log.info(all_positions)  
    &quot;&quot;&quot;  
        Main ordering conditions  
    &quot;&quot;&quot;  
    if context.ticks &lt;= 30 and context.ordered == False:  
        #: Create a dict of stocks to buy/sell and the position (long/short)  
        stocks_to_order = {}  
        for stock in data:  
            #: First check if data exists and we&#39;re using &#39;all&#39; because it&#39;s easier to read but  
            #: it&#39;s the same as &#39;and&#39;  
            if all([context.which_eps in data[stock],  
                  &#39;reports_at_2&#39; in data[stock],  
                  stock in data]):  
                date_format = &quot;%Y-%m-%d&quot;  
                trade_date = datetime.strptime(data[stock][&#39;reports_at_2&#39;], date_format)  
                #: Next check if it&#39;s the correct date to trade  
                if all([trade_date.year == get_datetime().year,  
                       trade_date.month == get_datetime().month,  
                       trade_date.day == get_datetime().day]):  
                    estimize_eps = data[stock][context.which_eps]  
                    actual_eps = data[stock][&#39;actual_eps&#39;]  
                    #: Getting the percent surprise needed before we trade on that signal  
                    percent_surprise = (actual_eps - estimize_eps)/(estimize_eps + 0.0)  
                    #: Positive Surprise  
                    if (percent_surprise &gt;= context.min_surprise and percent_surprise &lt;= context.max_surprise) and (context.algo_type == &#39;both&#39; or context.algo_type == &#39;long&#39;) :  
                        stocks_to_order[stock] = &#39;long&#39;  
                    #: Negative Surprise  
                    if (percent_surprise &lt;= -context.min_surprise and percent_surprise &gt;= -context.max_surprise) and (context.algo_type == &#39;both&#39; or context.algo_type == &#39;short&#39;):  
                        stocks_to_order[stock] = &#39;short&#39;  
                    #: If neither positive nor negative surprise, do nothing  
                    else:  
                        pass  
        #: Create weights for each of our long and short positions based on the number of longs/shorts we have  
        if len(stocks_to_order) != 0:  
            #: Get total number of stocks and divide by 1.0  
            total_long = len([s for s in stocks_to_order if stocks_to_order[s] == &#39;long&#39;])  
            total_short = len([s for s in stocks_to_order if stocks_to_order[s] == &#39;short&#39;])  
            long_weight = 1.0/total_long if total_long != 0 else 0  
            short_weight = -1.0/total_short if total_short != 0 else 0  
        #: Go through our stocks to order and order them  
        for stock in stocks_to_order:  
            #: Check if we have data for the stock  
            if stock in data:  
                #: Check whether it&#39;s a long or a short  
                if stocks_to_order[stock] == &#39;long&#39;:  
                    weight = long_weight  
                elif stocks_to_order[stock] == &#39;short&#39;:  
                    weight = short_weight  
                log.info(&quot;Entering position on %s at %s&quot; % (stock.symbol, str(get_datetime())))  
                order_target_percent(stock, weight)  
                #: Set the number of days held = 0  
                context.stocks_held[stock] = 0  
                context.ordered = True  
        #: Finally, we hedge our positions by getting the net dollar ordered and matching that to 0  
        if context.ordered == True:  
            #: Get the total amount ordered for the day  
            amount_ordered = 0  
            for order in get_open_orders():  
                for oo in get_open_orders()[order]:  
                    amount_ordered += oo.amount * data[oo.sid].price

            #: Order our hedge  
            order_target_value(context.spy, -amount_ordered)  
            context.stocks_held[context.spy] = 0  
            log.info(&quot;We currently have a net order of $%0.2f and will hedge with SPY by ordering $%0.2f&quot; % (amount_ordered, -amount_ordered))  

    &quot;&quot;&quot;  
        Exit position/days held update logic  
    &quot;&quot;&quot;  
    #: Go through each held stock and update the number of days held and close out any positions  
    #: that have been held past context.days_to_hold  
    if (current_time.hour == 15 and current_time.minute == 45) or context.retry == True:  
        for stock in context.portfolio.positions:  
            #: Get the number of days that we&#39;ve currently held this stock  
            days = context.stocks_held.get(stock)  
            #: None is the condition for a security that we don&#39;t currently hold  
            if days == None:  
                continue  
            #: If days_to_hold is set to 1, close out any position at the end of the day  
            if context.days_to_hold == 1:  
                #: If we don&#39;t have data for the stock, break and retry  
                if stock not in data:  
                    context.retry = True  
                    break  
                #: If we just placed an order for the stock, don&#39;t bother ordering again  
                if stock not in get_open_orders():  
                    log.info(&quot;Exiting position on %s at %s&quot; % (stock.symbol, str(get_datetime())))  
                    order_target_percent(stock, 0)  
                    #: Refresh all variables  
                    context.retry = False  
                    context.ordered = False  
            #: Same order logic but for when context.days_to_hold != 1  
            elif context.days_to_hold &gt; 1:  
                if days &gt;= context.days_to_hold:  
                    if stock not in data:  
                        context.retry = True  
                        break  
                    elif stock not in get_open_orders():  
                        log.info(&quot;Exiting position on %s at %s&quot; % (stock.symbol, str(get_datetime())))  
                        order_target_percent(stock, 0)  
                        context.retry = False  
                        context.ordered = False  
                        context.stocks_held[stock] = None  
                else:  
                    context.stocks_held[stock] += 1  

    context.ticks += 1  

&quot;&quot;&quot;
    Fetcher helper methods  
&quot;&quot;&quot;

def pre_func(df):  
    &quot;&quot;&quot;  
        This takes in our dataframe, cleans up the dates in it because I want to just buy it the day after the earnings are released  
    &quot;&quot;&quot;  
    #: We&#39;re going to shift the dates according to when we should be trading the ticker  
    df[&#39;date&#39;] = df[&#39;date&#39;].apply(lambda x: shift_dates(x))  
    #: We&#39;re going to make a copy of the date column to make sure we know when to trade at the appropriate date  
    df[&#39;reports_at_2&#39;] = df[&#39;date&#39;]  
    df = df[(df[&#39;num_participants&#39;] &gt; 19)]  
    df = df[(df[&#39;ticker&#39;] != 0)]  
    df = df.drop([&quot;Unnamed: 0&quot;], axis=1)  
    return df

def shift_dates(row):  
    &quot;&quot;&quot;  
        This function is going to take all the dates in the dataframe, test whether it&#39;s before market or after market close, and shift the dates appropriately.  
        1. If it&#39;s before market open, keep the date the same  
        2. If it&#39;s after market open, shift the date by 1 day  
    &quot;&quot;&quot;  
    row_date = datetime.strptime(row, &quot;%Y-%m-%d %H:%M:%S&quot;)  
    if row_date.hour &gt; 9:  
        row_date = row_date + timedelta(days=1)  
    elif row_date.hour == 9 and row_date.minute &gt;= 30:  
        row_date = row_date + timedelta(days=1)  
    else:  
        row_date = row_date  
    row = row_date.strftime(&quot;%Y-%m-%d&quot;)  
    return row

def my_universe(context, fetcher_data):  
    &quot;&quot;&quot;  
        Method for setting our universe of stocks which we will use to determine  
        our weights for each security as well  
    &quot;&quot;&quot;  
    #: Setting our universe of stocks  
    sids = set(fetcher_data[&#39;sid&#39;])  
    sids = [s for s in sids if s != 0]  
    symbols = [s.symbol for s in sids]  
    log.info(&quot;Our daily universe size is %s sids&quot; % len(symbols))  
    return sids  
</code></pre>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='558a26bd4e416ea53b000571' id='558a26bd4e416ea53b000571'>
<a href='#558a26bd4e416ea53b000571'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51d125a71144e60865000044'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b7dd86784deedc047d5ad0fb30378bdd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51d125a71144e60865000044'>Peter Bakker</a>
</div>
<a UTCms='1435117248000' class='quanto-date posted-at response-posted-at' href='#558a26bd4e416ea53b000571'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>and if you want a long only version one has to cancel the hedging part as it shorts the spy (could be replaced by buying the SH)</p>

<pre><code>&quot;&quot;&quot;
    This is a PEAD strategy based off Estimize&#39;s earnings estimates. Estimize (estimize.com) is a service that aggregate financial estimates from independent, buy-side, sell-side analysts as well as students and professors. The data that we&#39;re using here will be called from our custom &#39;fetch_estimize&#39; method and contains the following columns:  
    - date: the date that the company announced it&#39;s earnings  
    - actual_eps: the actual earnings announcement on that date  
    - wallstreet_eps: the Wall Street consensus&#39; estimates for that earnings announcement  
    - estimize_eps: the Estimize estimates for that earnings announcement  
    - ticker: the stock ticker

    Much of the variables are meant for you to be able to play around with them:  
        1. context.algo_type: defines whether you want a long/short strategy  
        2. context.days_to_hold: defines the number of days you want to hold before exiting a position  
        3. context.min/max_surprise: defines the min/max % surprise you want before trading on a signal  
        4. context.which_eps: defines that you&#39;re using the &#39;estimize_eps&#39; rather than the &#39;wallstreet_eps&#39; as your benchmark. Change it to &#39;wallstreet_eps&#39; if you&#39;d rather use that.  
&quot;&quot;&quot;

from pytz import timezone  
from datetime import datetime, timedelta

import numpy as np

def initialize(context):  
    #: Declares whether we&#39;re doing a short/long/both strategy  
    context.algo_type = &#39;long&#39;  
    #: Declaring the days to hold, change this to what you want)))  
    context.days_to_hold = 3  
    #: Declares which stocks we currently held and how many days we&#39;ve held them dict[stock:days_held]  
    context.stocks_held = {}  
    #: Declares which eps estimate to benchmark against  
    context.which_eps = &#39;estimize_eps&#39;  
    #: Declares the minimum magnitude of percent surprise  
    context.min_surprise = .01  
    context.max_surprise = .06  
    #: Declares the number of ticks that we&#39;ve used in the current day  
    context.ticks = 0  
    #: Boolean holding the memory whether or not we&#39;ve already ordered for the current day  
    context.ordered = False  
    #: Boolean holding the memory whether or not we need to retry closing out our positions  
    context.retry = False  
    #: Initialize our Hedge  
    context.spy = sid(8554)  
    #: Get our tickers and set them as our data  
    fetch_estimize(  
              pre_func=pre_func,  
              symbol_column=&#39;ticker&#39;)  
    #: Get the same tickers and set them as our universe  
    fetch_estimize(  
              pre_func=pre_func,  
              symbol_column=&#39;ticker&#39;,  
              universe_func=my_universe)

def handle_data(context, data):  
    #: Converting the time in to the Eastern Timezone  
    #: This will be made obsolete with the `schedule_function` method. Coming out soon!  
    current_time = get_datetime().astimezone(timezone(&#39;US/Eastern&#39;))  
    &quot;&quot;&quot;  
        Setting starting positions  
    &quot;&quot;&quot;  
    if current_time.hour == 9 and current_time.minute == 31:  
        context.ticks = 0  
    &quot;&quot;&quot;  
        Log current positions at 10:00 AM  
    &quot;&quot;&quot;  
    if current_time.hour == 10 and current_time.minute == 0 and context.ordered == True:  
        #: Get all positions  
        all_positions = &quot;Current positions for %s : &quot; % (str(get_datetime()))  
        for pos in context.portfolio.positions:  
            all_positions += &quot;%s at %s shares, &quot; % (pos.symbol, context.portfolio.positions[pos].amount)  
        log.info(all_positions)  
    &quot;&quot;&quot;  
        Main ordering conditions  
    &quot;&quot;&quot;  
    if context.ticks &lt;= 30 and context.ordered == False:  
        #: Create a dict of stocks to buy/sell and the position (long/short)  
        stocks_to_order = {}  
        for stock in data:  
            #: First check if data exists and we&#39;re using &#39;all&#39; because it&#39;s easier to read but  
            #: it&#39;s the same as &#39;and&#39;  
            if all([context.which_eps in data[stock],  
                  &#39;reports_at_2&#39; in data[stock],  
                  stock in data]):  
                date_format = &quot;%Y-%m-%d&quot;  
                trade_date = datetime.strptime(data[stock][&#39;reports_at_2&#39;], date_format)  
                #: Next check if it&#39;s the correct date to trade  
                if all([trade_date.year == get_datetime().year,  
                       trade_date.month == get_datetime().month,  
                       trade_date.day == get_datetime().day]):  
                    estimize_eps = data[stock][context.which_eps]  
                    actual_eps = data[stock][&#39;actual_eps&#39;]  
                    #: Getting the percent surprise needed before we trade on that signal  
                    percent_surprise = (actual_eps - estimize_eps)/(estimize_eps + 0.0)  
                    #: Positive Surprise  
                    if (percent_surprise &gt;= context.min_surprise and percent_surprise &lt;= context.max_surprise) and (context.algo_type == &#39;both&#39; or context.algo_type == &#39;long&#39;) :  
                        stocks_to_order[stock] = &#39;long&#39;  
                    #: Negative Surprise  
                    if (percent_surprise &lt;= -context.min_surprise and percent_surprise &gt;= -context.max_surprise) and (context.algo_type == &#39;both&#39; or context.algo_type == &#39;short&#39;):  
                        stocks_to_order[stock] = &#39;short&#39;  
                    #: If neither positive nor negative surprise, do nothing  
                    else:  
                        pass  
        #: Create weights for each of our long and short positions based on the number of longs/shorts we have  
        if len(stocks_to_order) != 0:  
            #: Get total number of stocks and divide by 1.0  
            total_long = len([s for s in stocks_to_order if stocks_to_order[s] == &#39;long&#39;])  
            total_short = len([s for s in stocks_to_order if stocks_to_order[s] == &#39;short&#39;])  
            long_weight = 1.0/total_long if total_long != 0 else 0  
            short_weight = -1.0/total_short if total_short != 0 else 0  
        #: Go through our stocks to order and order them  
        for stock in stocks_to_order:  
            #: Check if we have data for the stock  
            if stock in data:  
                #: Check whether it&#39;s a long or a short  
                if stocks_to_order[stock] == &#39;long&#39;:  
                    weight = long_weight  
                elif stocks_to_order[stock] == &#39;short&#39;:  
                    weight = short_weight  
                log.info(&quot;Entering position on %s at %s&quot; % (stock.symbol, str(get_datetime())))  
                order_target_percent(stock, weight)  
                #: Set the number of days held = 0  
                context.stocks_held[stock] = 0  
                context.ordered = True  
        #: Finally, we hedge our positions by getting the net dollar ordered and matching that to 0  
        if context.ordered == True and (context.algo_type == &#39;both&#39; or context.algo_type == &#39;short&#39;):  
            #: Get the total amount ordered for the day  
            amount_ordered = 0  
            for order in get_open_orders():  
                for oo in get_open_orders()[order]:  
                    amount_ordered += oo.amount * data[oo.sid].price

            #: Order our hedge  
            order_target_value(context.spy, -amount_ordered)  
            context.stocks_held[context.spy] = 0  
            log.info(&quot;We currently have a net order of $%0.2f and will hedge with SPY by ordering $%0.2f&quot; % (amount_ordered, -amount_ordered))  

    &quot;&quot;&quot;  
        Exit position/days held update logic  
    &quot;&quot;&quot;  
    #: Go through each held stock and update the number of days held and close out any positions  
    #: that have been held past context.days_to_hold  
    if (current_time.hour == 15 and current_time.minute == 45) or context.retry == True:  
        for stock in context.portfolio.positions:  
            #: Get the number of days that we&#39;ve currently held this stock  
            days = context.stocks_held.get(stock)  
            #: None is the condition for a security that we don&#39;t currently hold  
            if days == None:  
                continue  
            #: If days_to_hold is set to 1, close out any position at the end of the day  
            if context.days_to_hold == 1:  
                #: If we don&#39;t have data for the stock, break and retry  
                if stock not in data:  
                    context.retry = True  
                    break  
                #: If we just placed an order for the stock, don&#39;t bother ordering again  
                if stock not in get_open_orders():  
                    log.info(&quot;Exiting position on %s at %s&quot; % (stock.symbol, str(get_datetime())))  
                    order_target_percent(stock, 0)  
                    #: Refresh all variables  
                    context.retry = False  
                    context.ordered = False  
            #: Same order logic but for when context.days_to_hold != 1  
            elif context.days_to_hold &gt; 1:  
                if days &gt;= context.days_to_hold:  
                    if stock not in data:  
                        context.retry = True  
                        break  
                    elif stock not in get_open_orders():  
                        log.info(&quot;Exiting position on %s at %s&quot; % (stock.symbol, str(get_datetime())))  
                        order_target_percent(stock, 0)  
                        context.retry = False  
                        context.ordered = False  
                        context.stocks_held[stock] = None  
                else:  
                    context.stocks_held[stock] += 1  

    context.ticks += 1  

&quot;&quot;&quot;
    Fetcher helper methods  
&quot;&quot;&quot;

def pre_func(df):  
    &quot;&quot;&quot;  
        This takes in our dataframe, cleans up the dates in it because I want to just buy it the day after the earnings are released  
    &quot;&quot;&quot;  
    #: We&#39;re going to shift the dates according to when we should be trading the ticker  
    df[&#39;date&#39;] = df[&#39;date&#39;].apply(lambda x: shift_dates(x))  
    #: We&#39;re going to make a copy of the date column to make sure we know when to trade at the appropriate date  
    df[&#39;reports_at_2&#39;] = df[&#39;date&#39;]  
    df = df[(df[&#39;num_participants&#39;] &gt; 19)]  
    df = df[(df[&#39;ticker&#39;] != 0)]  
    df = df.drop([&quot;Unnamed: 0&quot;], axis=1)  
    return df

def shift_dates(row):  
    &quot;&quot;&quot;  
        This function is going to take all the dates in the dataframe, test whether it&#39;s before market or after market close, and shift the dates appropriately.  
        1. If it&#39;s before market open, keep the date the same  
        2. If it&#39;s after market open, shift the date by 1 day  
    &quot;&quot;&quot;  
    row_date = datetime.strptime(row, &quot;%Y-%m-%d %H:%M:%S&quot;)  
    if row_date.hour &gt; 9:  
        row_date = row_date + timedelta(days=1)  
    elif row_date.hour == 9 and row_date.minute &gt;= 30:  
        row_date = row_date + timedelta(days=1)  
    else:  
        row_date = row_date  
    row = row_date.strftime(&quot;%Y-%m-%d&quot;)  
    return row

def my_universe(context, fetcher_data):  
    &quot;&quot;&quot;  
        Method for setting our universe of stocks which we will use to determine  
        our weights for each security as well  
    &quot;&quot;&quot;  
    #: Setting our universe of stocks  
    sids = set(fetcher_data[&#39;sid&#39;])  
    sids = [s for s in sids if s != 0]  
    symbols = [s.symbol for s in sids]  
    log.info(&quot;Our daily universe size is %s sids&quot; % len(symbols))  
    return sids  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5617c09745f0f58231000577' id='5617c09745f0f58231000577'>
<a href='#5617c09745f0f58231000577'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54487203dc843663f2000123'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/439ba1adf33b808f2d50e3a31c3c7e28?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54487203dc843663f2000123'>Josh Payne</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1444397210000' class='quanto-date posted-at response-posted-at' href='#5617c09745f0f58231000577'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>For folks interested in the strategies discussed here (and the underlying estimate data in general), <a href="http://quantopian.com/store">data from Estimize</a> is now available built-into Quantopian via the <a href="http://quantopian.com/store">Quantopian Store</a>. The data is updated daily -- check it out!</p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='565702e8f95a1867d6000428' id='565702e8f95a1867d6000428'>
<a href='#565702e8f95a1867d6000428'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/556f1d2514f22512d20005d3'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1dc7f336d73f49fe37b5842420493b79?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/556f1d2514f22512d20005d3'>Pierre-Luc Corriveau</a>
</div>
<a UTCms='1448542957000' class='quanto-date posted-at response-posted-at' href='#565702e8f95a1867d6000428'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The backtest stops trading on Nov 16th 2014...Is it because the data &#39;&#39;fetched&#39;&#39; on estimize are not available for free and that&#39;s why nothing is happening? </p>

<p>I actually don&#39;t get how are the data about the estimize&#39;s eps and wallstreet&#39;s eps are added to the algo... can&#39;t anybody point this out in the algo?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='565c72298a57aebf800005e3' id='565c72298a57aebf800005e3'>
<a href='#565c72298a57aebf800005e3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54487203dc843663f2000123'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/439ba1adf33b808f2d50e3a31c3c7e28?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54487203dc843663f2000123'>Josh Payne</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1448899120000' class='quanto-date posted-at response-posted-at' href='#565c72298a57aebf800005e3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>That&#39;s correct. This post was originally completed with a static sample of data from Estimize last year. We have integrated fuller versions of Estimize&#39;s data into the platform - both consensus numbers and <a href="http://www.quantopian.com/data/estimize/estimates">analyst-by-analyst estimates</a>. These data sets update frequently and won&#39;t have the same problem this static data set has.</p>

<p>Today, these data sets are available for use in Research. We are actively working on integrating data from Estimize (and other partner data sources) into our API for use in algorithms.</p>

<p>Thanks<br>
Josh</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='56c3432647c98a0f8a00057a' id='56c3432647c98a0f8a00057a'>
<a href='#56c3432647c98a0f8a00057a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1455637293000' class='quanto-date posted-at response-posted-at' href='#56c3432647c98a0f8a00057a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hey guys,</p>

<p>I&#39;ve implemented a similar algorithm using the native Pipeline API and the Estimize Consensus Estimates . The basics are essentially the same, except that in this case, I&#39;m waiting a <strong>full business day after an earnings announcement</strong> before making a trade. </p>

<ul>
<li>Long/Short securities with an Earnings Surprise of absolute magnitude between <code>0 and 4%</code><br></li>
<li>Keep leverage under 2<br></li>
<li>Optional code included if you want to hedge out your positions with the SPY. </li>
</ul>

<p>*Note: The timespan reflects the sample dataset dates available for both the Earnings Calendar and Estimize Consensus datasets. I&#39;ll follow up with the most recent version as well. </p>

<p>This strategy is still in a rough draft mode so would love to get your thoughts on this algorithm and how I could improve it. </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='56c37e7f0d0b401963000067' id='56c37e7f0d0b401963000067'>
<a href='#56c37e7f0d0b401963000067'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5394bbbdeee25762d2000102'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0af1296044050e221f0e9a9593dee746?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5394bbbdeee25762d2000102'>Daniel C. Place</a>
</div>
<a UTCms='1455652489000' class='quanto-date posted-at response-posted-at' href='#56c37e7f0d0b401963000067'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Seong - I am curious why the Beta Coefficient is a steady 0 with this algo? That implies there is no vol or risk...which would mean that Estimize is nearly always accurate...is this look ahead bias or am i missing something? Maybe Im just an idiot and have no idea what I&#39;m talking about hah..  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56c38ec7e3b003ccb3000162' id='56c38ec7e3b003ccb3000162'>
<a href='#56c38ec7e3b003ccb3000162'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54487203dc843663f2000123'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/439ba1adf33b808f2d50e3a31c3c7e28?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54487203dc843663f2000123'>Josh Payne</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1455656653000' class='quanto-date posted-at response-posted-at' href='#56c38ec7e3b003ccb3000162'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Daniel,</p>

<p>Check out the <a href="http://www.investopedia.com/terms/b/beta.asp">Investopedia definition for beta</a>. The phrase that helped me the most (and I&#39;m no expert) is &quot;you can think of beta as the tendency of a security&#39;s returns to respond to swings in the market&quot;</p>

<p>In this case, an algo whose beta is approximately 0 is an algo whose returns tend not to change with the overall change in the market. There is relative independence between the market and the algorithm.</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='56c39380e3b003ccb30001a1' id='56c39380e3b003ccb30001a1'>
<a href='#56c39380e3b003ccb30001a1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1455657863000' class='quanto-date posted-at response-posted-at' href='#56c39380e3b003ccb30001a1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Daniel,</p>

<p>Going off of what Josh said, the algorithm is able to have a near 0 beta because it is market neutral. It&#39;s able to be market neutral by holding both long and short positions rather than just long or just short. If it were the case of just having long or short positions, you&#39;d expect the beta to be closer to 1 or -1. </p>

<p>Beta of 0 doesn&#39;t mean that the algorithm is perfect or that there is no volatility. In fact, if you look at the volatility of the backtest, it&#39;s .24 for the course of the backtest. A beta close to zero simply means that systematic risk (market risk) isn&#39;t present but other types of risk like idiosyncratic risk are present (ie. AAPL has a terrible earnings announcement) where as in a strategy with a beta of 1, you&#39;d have both market and idiosyncratic risk.</p>

<p>I&#39;d suggest checking out our beta hedging lecture on the lecture series tutorial page for more information (<a href="http://www.investopedia.com/terms/i/idiosyncraticrisk.asp">http://www.investopedia.com/terms/i/idiosyncraticrisk.asp</a>)</p>

<p>As for the lookahead bias, this algorithm actually waits a <strong>full business day</strong> before trying to trade on an earnings announcement. So if anything, it&#39;s a day late in making a decision. </p>

<p>Happy to answer any other questions,<br>
Seong  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='570a08c5d33b51d725000071' id='570a08c5d33b51d725000071'>
<a href='#570a08c5d33b51d725000071'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/560dc5085dd610335a00026b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/aaa480744fffd5e1166c5f63e95ce701?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/560dc5085dd610335a00026b'>Bob Newo</a>
</div>
<a UTCms='1460275403000' class='quanto-date posted-at response-posted-at' href='#570a08c5d33b51d725000071'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Seong,</p>

<p>I noticed that the algorithm is incredibly sensitive to the surprise cut.  For instance, if I choose 0.0 and 0.1 I see a loss of ~ 100% on the timescale of the simulation.  </p>

<p>Was this parameter hand tuned to make the simulation work?  Or is there some kind of reason why one would expect 0.0-0.04% to be a good range?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='570a13eb61073a8e1f00007f' id='570a13eb61073a8e1f00007f'>
<a href='#570a13eb61073a8e1f00007f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1460278255000' class='quanto-date posted-at response-posted-at' href='#570a13eb61073a8e1f00007f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I would have thought a &quot;surprise&quot; of &lt;1% is pretty immaterial, probably just noise. You are therefore going long and short on a broad range of stocks that probably in aggregate look like the market. While I wouldn&#39;t expect it to crash to 0% equity in a short sim, I would expect lots of trading costs and no real performance. The other way to think about it is the size of the trading costs relative to the upside (presumably well less than 1%, given that many trades will not work out).</p>

<p>Personally, I don&#39;t like these hard coded thresholds, as I suspect they will depend on market conditions. Another technique would be to rank the current surprise with ALL the surprises for ANY stock in the last year, and treat it as a tradeable surprise if it&#39;s in the top half. In other words, is the surprise level above the mean of the last year? Granted, I&#39;ve introduced two more parameters here (lookback and threshold), but they feel less &quot;hand picked&quot; to me. They would probably cope better with non-stationarity. You could also run simulations of  different slices of the ranking, and be fairly sure that each slice has a similar number of trades. </p>

<p><a href="https://en.wikipedia.org/wiki/Data_transformation_(statistics)#Transforming_to_a_uniform_distribution">https://en.wikipedia.org/wiki/Data_transformation_(statistics)#Transforming_to_a_uniform_distribution</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='570a6843fca68c42f500028c' id='570a6843fca68c42f500028c'>
<a href='#570a6843fca68c42f500028c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57090876269e5cb1e1000234'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d233c07c97108b4e45c75ef905dfe7ce?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57090876269e5cb1e1000234'>Denny T</a>
</div>
<a UTCms='1460299848000' class='quanto-date posted-at response-posted-at' href='#570a6843fca68c42f500028c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>How do you guys at Estimize get buy-side analysts to contribute estimates? Aren&#39;t they not supposed to share that type of information even if you were paying them enough to make it worth their while? My understanding is that it&#39;s difficult for non-professionals to compete in this type of estimates situation because professionals generally have a big information advantage in obtaining some of these estimates through access to management, but I&#39;d be curious to hear if that perception is incorrect and/or how Estimize solves that issue.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57392f1c39bf45f07700004c' id='57392f1c39bf45f07700004c'>
<a href='#57392f1c39bf45f07700004c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56a28cc56f45bbbcee0000c8'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fd701e62e1f694b1ae1425a4206ce61a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56a28cc56f45bbbcee0000c8'>Peyman Pejman</a>
</div>
<a UTCms='1463365409000' class='quanto-date posted-at response-posted-at' href='#57392f1c39bf45f07700004c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Seong Lee</p>

<p><strong>Bug in your latest implementation</strong> </p>

<p>The latest algorithm you have written to filter out estimates with less than 20 analysts has a minor bug in it. You have used <strong>num_estimates</strong> to filter out while the column is actually <strong>num_estimates.latest</strong>. If you look at the pipeline graph you will see that <strong>num_estimates &gt;= 20 is an always TRUE statement</strong>. You can try something like num_estimates &gt;= 1000 and see it is still an always TRUE statement which probably means that value represents the total number of estimates.  </p>

<p>Possible fix:<br>
use num_estimates.latest in the pipeline screening  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57b8bba7a5b448d7de000a90' id='57b8bba7a5b448d7de000a90'>
<a href='#57b8bba7a5b448d7de000a90'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57a3aea10dd1caacb7000233'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/9efc8b4c1e9e0b0522b41d4bc907e805?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57a3aea10dd1caacb7000233'>matt pease</a>
</div>
<a UTCms='1471724464000' class='quanto-date posted-at response-posted-at' href='#57b8bba7a5b448d7de000a90'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@SeongLee</p>

<p>I&#39;m just getting started with algorithmic investing.  One that I wonder about.  Why do you compare a strategy against SPY, a US broad index?  Why not against a balanced portfolio of US / european / emerging market / bonds?</p>

<p>I suppose you want to see if you &quot;beat the market&quot;.  If the algorithm can do better in the US vs the broad US market.  I wonder how SPY compares to such a balanced portfolio.</p>

<p>Thank you!<br>
Matt  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57bdd785a41a4b50c8000af9' id='57bdd785a41a4b50c8000af9'>
<a href='#57bdd785a41a4b50c8000af9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54487203dc843663f2000123'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/439ba1adf33b808f2d50e3a31c3c7e28?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54487203dc843663f2000123'>Josh Payne</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1472059278000' class='quanto-date posted-at response-posted-at' href='#57bdd785a41a4b50c8000af9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Matt, the SPY is simply our default for benchmarking in the backtester. You can actually set it to other stocks or ETF in your algo code, if you like. Alternatively, you can also analyze the performance in more detail with pyfolio in our research environment.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/earnings-drift-with-estimize'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/earnings-drift-with-estimize'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#05636060616764666e457470646b716a756c646b2b666a68">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
