<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
ETF market rotation strategy
</title>
<meta content='ETF market rotation strategy provides steady positive results and small drawdown' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="EEM8SFuNx9y1g25kBVlFUahk4SRmnhxynvbFMJV+3ndsJUoF+XsVPwyeN1VKtu0lkOrCTRxSCWkc+R5aPzu8zA==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=false;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/etf-market-rotation-strategy' property='og:url'>
<meta content='ETF market rotation strategy' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/etf-market-rotation-strategy' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='ETF market rotation strategy' property='og:title'>
<meta content='ETF market rotation strategy provides steady positive results and small drawdown' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/etf-market-rotation-strategy">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='54ab05a6a9e4c8f9dc000104'>
<div class='post-container' data-post-id='54ab05a6a9e4c8f9dc000104' id='54ab05a6a9e4c8f9dc000104'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>ETF market rotation strategy</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54a3196f4ec27a914c0002ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f8d7c9fe2c702b1e7174fe8be6a10b51?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54a3196f4ec27a914c0002ad'>dave macpherson</a>
</div>
<span class='posted-at'>posted </span>
<span UTCms='1420494246000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=ETF market rotation strategy&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fetf-market-rotation-strategy%3Futm_source%3Dwebsite_share%26utm_campaign%3Detf-market-rotation-strategy%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fetf-market-rotation-strategy%3Futm_source%3Dwebsite_share%26utm_campaign%3Detf-market-rotation-strategy%26utm_medium%3Dlinkedin&amp;title=ETF+market+rotation+strategy+%28dave+macpherson%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class='tags tag-row'>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Show Q' data-tag-id='55c50e7d8d4710ec6e000010' href='/posts/tag/Show-Q/newest'>Show Q</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='ETFs' data-tag-id='55d33f633f6ba10065000001' href='/posts/tag/ETFs/newest'>ETFs</a>
</div>
<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/etf-market-rotation-strategy?utm_source=website_share&amp;utm_campaign=etf-market-rotation-strategy&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="dave macpherson" />
<div class='body-text'>
<div class='body-text-container post-body'><p>ETF market rotation strategy provides steady positive results and small drawdown  </p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>37 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='54ab53be1c547ca2b6000085' id='54ab53be1c547ca2b6000085'>
<a href='#54ab53be1c547ca2b6000085'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51d125a71144e60865000044'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b7dd86784deedc047d5ad0fb30378bdd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51d125a71144e60865000044'>Peter Bakker</a>
</div>
<a UTCms='1420514241000' class='quanto-date posted-at response-posted-at' href='#54ab53be1c547ca2b6000085'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Very interesting, particularly because you pick a best one and not a group of etf&#39;s. One question as I look for curve fitting when I look at an algo and I see  </p>

<pre><code> rank = p * 0.7 + v * 0.3  
</code></pre>

<p>Why this ratio and did you test other ratio&#39;s?        </p>

<p>Best, Peter  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54ab6d591c547c591b0000f1' id='54ab6d591c547c591b0000f1'>
<a href='#54ab6d591c547c591b0000f1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/549cf0135ed2413b280001b5'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/97aa436744edd58f961990ea084bbdf3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/549cf0135ed2413b280001b5'>Adam Roder</a>
</div>
<a UTCms='1420520796000' class='quanto-date posted-at response-posted-at' href='#54ab6d591c547c591b0000f1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Good job!  Also excellent to have largely avoided some of the remarkable downturns during that period.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54abd845c908560ac50002a6' id='54abd845c908560ac50002a6'>
<a href='#54abd845c908560ac50002a6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/530006e439185472f8000032'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d244c2261df57fa9c6229c306eb91fb7?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/530006e439185472f8000032'>Novice TAI</a>
</div>
<a UTCms='1420548168000' class='quanto-date posted-at response-posted-at' href='#54abd845c908560ac50002a6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>sir,<br>
Why not using history function?</p>

<pre><code>@batch_transform(window_length=83)  
def accumulateData(data):  
    # return price_history = history(bar_count=20, frequency=&#39;1d&#39;, field=&#39;price&#39;)  
    return data  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54ac0da81c547ca2b60003e2' id='54ac0da81c547ca2b60003e2'>
<a href='#54ac0da81c547ca2b60003e2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53d46cdb75f57a2832005a6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/62b39881ee19f936224017339779d9d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53d46cdb75f57a2832005a6b'>Market Tech</a>
</div>
<a UTCms='1420561835000' class='quanto-date posted-at response-posted-at' href='#54ac0da81c547ca2b60003e2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I may have munged it a bit... Here&#39;s a compact, version. Doesn&#39;t get the same results, so your entry/exit technique must impart spin of some sort...</p>

<p>[Edit: Updated the whole ranking mechanism. getting consistent results now.]</p>

<pre><code>import math  
import numpy

lookbackPeriods = 63  
historicPeriods = 83  
volatilityPeriods = 20

def initialize(context):  
    set_symbol_lookup_date(&#39;2007-12-31&#39;)  
    #context.stocks = symbols(&quot;EDV&quot;,&quot;VGT&quot;,&quot;VCR&quot;,&quot;VB&quot;,&quot;VAW&quot;,&quot;VHT&quot;,&quot;IBB&quot;)  
    context.stocks = symbols(&quot;VAW&quot;,&quot;VHT&quot;,&quot;IBB&quot;,&quot;EDV&quot;,&quot;VGT&quot;,&quot;VCR&quot;,&quot;VB&quot;)  
    context.stockMetrics = {}  
    for stock in context.stocks:  
        context.stockMetrics[stock] = Metric(0,0,0)  
    context.currentMonth = 0  
def handle_data(context, data):  
    date = get_datetime()  
    month = date.month  
    if context.currentMonth == month:  
        return  
    context.currentMonth = month

    historic = history(historicPeriods, &quot;1d&quot;, &quot;close_price&quot;)  
    historic = historic.dropna(axis=1)  
    for stock in context.stocks:  
        if (stock in historic):  
            context.stockMetrics[stock] = GetStockMetrics(historic[stock], lookbackPeriods)  
        else:  
            context.stockMetrics[stock] = Metric(0,0,0)  
    best = GetBestRanked(context.stockMetrics)  
    if (best == None):  
        print(&quot;All securities ranked 0.0&quot;)  
    for stock in context.stocks:  
        if (stock == best):  
            order_target_percent(stock, 1)  
            print(stock.symbol, context.stockMetrics[stock].ToString())  
        else:  
            order_target_percent(stock, 0)  
def GetBestRanked(stockMetrics):  
    list = [metric.Performance for metric in stockMetrics.values()]  
    minP, maxP = GetMinMax(list)  
    list = [metric.Volatility for metric in stockMetrics.values()]  
    minV, maxV = GetMinMax(list)  
    isValid = False  
    for stock in stockMetrics:  
        p = stockMetrics[stock].Performance  
        v = stockMetrics[stock].Volatility  
        if (p != 0.0 and v != 0.0):  
            p = .7 * (p - minP) / (maxP - minP)  
            v = .3 * (v - minV) / (maxV - minV)  
            rank = p - v  
            stockMetrics[stock].Performance = p  
            stockMetrics[stock].Volatility = v  
            stockMetrics[stock].Rank = rank  
            isValid = True  
    if (isValid):  
        keyValuesList = sorted(stockMetrics.items(), key=lambda x: x[1].Rank)  
        if (keyValuesList[-1][1].Rank != 0.0):  
            return keyValuesList[-1][0]  
        else:  
            return None  
    else:  
        return None  
def GetStockMetrics(prices, period):  
    volatilities = []  
    x = 0  
    volatilityWindow = volatilityPeriods + 1  
    for i in xrange(-period, 0):  
        volatilities.append(GetHistoricalVolatility(prices[i - volatilityWindow : volatilityWindow + x], volatilityPeriods))  
        x += 1  
    meanVolatility = sum(volatilities) / period  
    performance = (prices[-1] - prices[-period]) / prices[-period]  
    return Metric(0, performance, meanVolatility)

def GetHistoricalVolatility(prices, period):  
    normalizedPrices = numpy.asarray(prices) / prices[0]  
    volatility = numpy.std(normalizedPrices)  
    return volatility

def GetMinMax(arr):  
   return min(arr), max(arr) 

class Metric(object):  
    def __init__(this, r, p, v):  
        this.Rank = r  
        this.Performance = p  
        this.Volatility = v  
    def ToString(this):  
        toString = &quot;Rank:{0:&lt;7.5f} performance:{1:&lt;7.5f} volatility:{2:&lt;7.5f}&quot;.format(this.Rank, this.Performance, this.Volatility)  
        return toString     

</code></pre>

<p>Print log:</p>

<pre><code>2014-07-01 PRINT(&#39;EDV&#39;, &#39;Rank:0.45876 performance:0.51824 volatility:0.05949&#39;)  
2014-08-01 PRINT(&#39;VGT&#39;, &#39;Rank:0.46813 performance:0.62635 volatility:0.15823&#39;)  
2014-09-02 PRINT(&#39;IBB&#39;, &#39;Rank:0.40000 performance:0.70000 volatility:0.30000&#39;)  
2014-10-01 PRINT(&#39;VHT&#39;, &#39;Rank:0.51983 performance:0.69815 volatility:0.17832&#39;)  
2014-11-03 PRINT(&#39;IBB&#39;, &#39;Rank:0.40000 performance:0.70000 volatility:0.30000&#39;)  
2014-12-01 PRINT(&#39;VHT&#39;, &#39;Rank:0.58249 performance:0.66101 volatility:0.07853&#39;)  
2015-01-02 PRINT(&#39;EDV&#39;, &#39;Rank:0.64355 performance:0.70000 volatility:0.05645&#39;)  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54ac825617d5c21a1c000054' id='54ac825617d5c21a1c000054'>
<a href='#54ac825617d5c21a1c000054'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51d125a71144e60865000044'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b7dd86784deedc047d5ad0fb30378bdd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51d125a71144e60865000044'>Peter Bakker</a>
</div>
<a UTCms='1420591706000' class='quanto-date posted-at response-posted-at' href='#54ac825617d5c21a1c000054'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>the differnce might be explained by 
<code>
p * 0.5 + v * 0.5  
</code>   vs <code>
p * 0.7 + v * 0.3  
</code>
?</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54accc1416685a96d400013c' id='54accc1416685a96d400013c'>
<a href='#54accc1416685a96d400013c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53d46cdb75f57a2832005a6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/62b39881ee19f936224017339779d9d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53d46cdb75f57a2832005a6b'>Market Tech</a>
</div>
<a UTCms='1420610583000' class='quanto-date posted-at response-posted-at' href='#54accc1416685a96d400013c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Dave M.&#39;s use of volatility + return performance is good to know about and study. I thank ye kindly for your efforts and sharing.</p>

<p>I did swap out the flip-flopped min/max @Dave M. had going and simply subtracted the volatility instead. Plus, when used with .7 and .3, the numbers still don&#39;t come out like his. I used all of his securities too, but even when duplicated exactly, the entry/exit change alters things. I&#39;d have to guess the extra delay in the exit first then enter one period later (which ends up being 2 periods) of @Dave&#39;s code may have made the difference.</p>

<p>Reworking other quant&#39;s code is good practice for learning this sometimes tricksy language. That&#39;s the only reason I even attempted it (and others). Python&#39;ers will no doubt be able to eliminate many of the loops with embedded matrix algebra -- a thing I continue to struggle with.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54addd6a945a5e6947000028' id='54addd6a945a5e6947000028'>
<a href='#54addd6a945a5e6947000028'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5312f7e2efc731bbf20000fe'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/905bb5da397380a6c3fecf3f60c71544?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5312f7e2efc731bbf20000fe'>Paul Perry</a>
</div>
<a UTCms='1420680557000' class='quanto-date posted-at response-posted-at' href='#54addd6a945a5e6947000028'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Do any portfolios model tax consequences? The question is not specific to this strategy, but this one looks interesting enough to continue refining the model.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54ae00c648f880dca500002c' id='54ae00c648f880dca500002c'>
<a href='#54ae00c648f880dca500002c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51d125a71144e60865000044'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/b7dd86784deedc047d5ad0fb30378bdd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51d125a71144e60865000044'>Peter Bakker</a>
</div>
<a UTCms='1420689608000' class='quanto-date posted-at response-posted-at' href='#54ae00c648f880dca500002c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>not automatically, its always possible to do via extending the Run Summary or a custom logging function. IB has a tax report buyt thats very US oriented.  As this is country dependent and personal circumstances dependent it&#39;s hard to model this in a more general fashion, however Quantopian could create a configurable module that allows a user to state the tax on transactions (UK), tax on profits (AUS,US, UK), compensation of losses (AUS,US), tax on total average holding (NL), tax on holding at 31st Dec... etc etc  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54aeba3ca7dfef0d1f000132' id='54aeba3ca7dfef0d1f000132'>
<a href='#54aeba3ca7dfef0d1f000132'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5234e8b0a01bd00128000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3010da75d1c2fde2acd962897a31af58?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5234e8b0a01bd00128000001'>Kris Gadge</a>
</div>
<a UTCms='1420737087000' class='quanto-date posted-at response-posted-at' href='#54aeba3ca7dfef0d1f000132'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Return for the last 2 years (period 1/1/2013 to end of 2014) is all along below SPY.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54aed1fea202b842550001fc' id='54aed1fea202b842550001fc'>
<a href='#54aed1fea202b842550001fc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51014001ad49b9d605000718'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6cd1e9bb219e57c97132fef7ddea43d0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51014001ad49b9d605000718'>Alan Baer</a>
</div>
<a UTCms='1420743169000' class='quanto-date posted-at response-posted-at' href='#54aed1fea202b842550001fc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>How did you pick the ETFs? Some sector ETFs are commented out.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54aed6f0a202b85046000247' id='54aed6f0a202b85046000247'>
<a href='#54aed6f0a202b85046000247'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4ec777fc345f20000e000008'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d1c340e13d187142fc34a5cff3a5eed5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4ec777fc345f20000e000008'>James Jack</a>
</div>
<a UTCms='1420744434000' class='quanto-date posted-at response-posted-at' href='#54aed6f0a202b85046000247'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Just for reference, this is Dave&#39;s backtest with the financial ETF plugged back in. The return is a little lower but the drawdown is the same. (I had wondered if the drawdown would be increased)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54af1331a1064b28550001b2' id='54af1331a1064b28550001b2'>
<a href='#54af1331a1064b28550001b2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51014001ad49b9d605000718'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/6cd1e9bb219e57c97132fef7ddea43d0?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51014001ad49b9d605000718'>Alan Baer</a>
</div>
<a UTCms='1420759860000' class='quanto-date posted-at response-posted-at' href='#54af1331a1064b28550001b2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Looking at Market Tech&#39;s re-factoring of this algorithm, if you replace this context.stocks line  </p>

<blockquote>
<p>context.stocks = symbols(&#39;VHT&#39;,&#39;VGT&#39;,&#39;VCR&#39;,&#39;IBB&#39;,&#39;EDV&#39;,&#39;VB&#39;,&#39;VAW&#39;)</p>
</blockquote>

<p>with this:</p>

<blockquote>
<p>context.stocks = { sid(25906), sid(25905), sid(25902), sid(22445), sid(22887), sid(25899), sid(25898)}</p>
</blockquote>

<p>Then the performance is in line with Dave&#39;s original one. But I&#39;m not sure why this makes such a big change. Originally, I thought maybe the symbols weren&#39;t resolving to the correct ETFs, but that doesn&#39;t seem it. Anyone know why this makes such a difference? A set vs. a list? Oddly (because the first two should be identical) all of the below give wildly different results:</p>

<blockquote>
<p>context.stocks = symbols(&#39;VHT&#39;,&#39;VGT&#39;,&#39;VCR&#39;,&#39;IBB&#39;,&#39;EDV&#39;,&#39;VB&#39;,&#39;VAW&#39;)<br>
context.stocks = [ sid(25906), sid(25905), sid(25902), sid(22445), sid(22887), sid(25899), sid(25898) ]<br>
context.stocks = { sid(25906), sid(25905), sid(25902), sid(22445), sid(22887), sid(25899), sid(25898) }  </p>
</blockquote>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54af3d01df3a153474000268' id='54af3d01df3a153474000268'>
<a href='#54af3d01df3a153474000268'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53d46cdb75f57a2832005a6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/62b39881ee19f936224017339779d9d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53d46cdb75f57a2832005a6b'>Market Tech</a>
</div>
<a UTCms='1420770563000' class='quanto-date posted-at response-posted-at' href='#54af3d01df3a153474000268'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Alan B. I tell ya what, I&#39;m gonna use dictionaries from now on &#39;cuz they give much better results!</p>

<p>It looks like the first two in your list are equivalent; the both are &quot;list&quot;s.<br>
That last one though, the dictionary object {} yeah, I like that one much better. It&#39;s a &quot;set&quot;.<br>
Set, Game, Match!</p>

<p>Apparently the treatment for the &quot;set&quot; and the sids/symbols therein must be selecting something differently than the &quot;symbols()&quot; method returns. That would seem to require some explanation from those in the Q&#39;Know.</p>

<p>[EDIT: 
Try this list:  </p>

<pre><code>context.stocks = symbols(&#39;EDV&#39;,&#39;VB&#39;,&#39;VAW&#39;, &#39;VHT&#39;,&#39;VGT&#39;,&#39;VCR&#39;,&#39;IBB&#39;)  
</code></pre>

<p>And you&#39;ll find that it matches the &quot;set&quot; version above.<br>
Which means that ORDER now has something to do with the logic in this strategy. It&#39;s not all rose smelling in Denmark me thinks.<br>
]</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54afabb41ee8df1042000235' id='54afabb41ee8df1042000235'>
<a href='#54afabb41ee8df1042000235'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/4f005d1b5e32ee000b000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03ce2b05f15809a7239dc5910a54abf5?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/4f005d1b5e32ee000b000001'>Grant Kiehne</a>
</div>
<a UTCms='1420798902000' class='quanto-date posted-at response-posted-at' href='#54afabb41ee8df1042000235'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello Dave &amp; all,</p>

<p>Skimming over the original algo posted above, I gather that in a nutshell, it is a matter of applying this, and finding the top-ranked ETF:</p>

<pre><code> Normalize the performance and volatility values to a range  
    # between [0..1] then rank them based on a 70/30 weighting.  
    for s in stocks:  
        p = (performances[s.sid] - minP) / (maxP - minP)  
        v = (volatilities[s.sid] - minV) / (maxV - minV)  
        rank = p * 0.7 + v * 0.3  
</code></pre>

<p>If I understand correctly, the performance is simply the overall relative gain/loss over the trailing window:</p>

<pre><code>performance = (end - start) / start  
</code></pre>

<p>Correct?</p>

<p>The volatility calculation is more involved, though:</p>

<pre><code>    # Calculate 20-day volatility for the given period  
    v = []  
    x = 0  
    for i in xrange(-period, 0):  
        v.append(historicalVolatility(20, prices[i-21:21+x]))  
        x += 1  
    volatility = sum(v) / period

</code></pre>

<p>with historicalVolatility using the log of the day-to-day returns, etc.  Is there a justification for this approach?  A quick google search provides <a href="http://quantivity.wordpress.com/2011/02/21/why-log-returns/">http://quantivity.wordpress.com/2011/02/21/why-log-returns/</a>, which concludes with some references discussing the use of logarithmic versus linear returns.  Also, I&#39;ve wondered if a proper volatility calculation should somehow incorporate all of the OHLCV values contained within a bar (be it daily or minutely), rather than just the closing price value.</p>

<p>Grant  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54afea2791a6c0a8af000612' id='54afea2791a6c0a8af000612'>
<a href='#54afea2791a6c0a8af000612'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54a3196f4ec27a914c0002ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f8d7c9fe2c702b1e7174fe8be6a10b51?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54a3196f4ec27a914c0002ad'>dave macpherson</a>
</div>
<a UTCms='1420814889000' class='quanto-date posted-at response-posted-at' href='#54afea2791a6c0a8af000612'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Dear Quants,</p>

<p>For even better performance, perhaps the use of leveraged ETFs could be considered.<br>
When a 3X small cap fund is substituted for all non-Treasury EFTs, the performance increased to over 600% over the same period.</p>

<p>The obvious drawback is a larger draw down (51%). and high volatility.</p>

<p>Is this progress in the desired direction?</p>

<p>Dave  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54afefba1ee8df1042000353' id='54afefba1ee8df1042000353'>
<a href='#54afefba1ee8df1042000353'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5234e8b0a01bd00128000001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3010da75d1c2fde2acd962897a31af58?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5234e8b0a01bd00128000001'>Kris Gadge</a>
</div>
<a UTCms='1420816317000' class='quanto-date posted-at response-posted-at' href='#54afefba1ee8df1042000353'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@dave macpherson: definitely better one, but it outperforms SPY significantly in the last two years only in the last year.<br>
The problem is when market is steadily going up, a lot of strategies perform well as well.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54affd6f91a6c05d490005ba' id='54affd6f91a6c05d490005ba'>
<a href='#54affd6f91a6c05d490005ba'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/542989bd6c1fca067e000004'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1a141564bef4b5f653db8cc19e677260?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/542989bd6c1fca067e000004'>Michael Bachmann</a>
</div>
<a UTCms='1420819825000' class='quanto-date posted-at response-posted-at' href='#54affd6f91a6c05d490005ba'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Also there are many strategies that could have avoided the 2008-2009 downturn and once you stop including 2008-2009 the strategies fall apart. It&#39;s not necessarily a bad thing that it performs better in a massive downturn, but it always feels a little bit like data mining.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b0093f91a6c05d490005ec' id='54b0093f91a6c05d490005ec'>
<a href='#54b0093f91a6c05d490005ec'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53d46cdb75f57a2832005a6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/62b39881ee19f936224017339779d9d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53d46cdb75f57a2832005a6b'>Market Tech</a>
</div>
<a UTCms='1420822849000' class='quanto-date posted-at response-posted-at' href='#54b0093f91a6c05d490005ec'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>There&#39;s still some unanswered questions about this algo. See Alan Baer&#39;s post above.</p>

<p>Take @Dave M. original strat, Swap out only his stocks collection mechanism and retest. Yeah you have to make some minor changes to the iterations within the body of code but this does not change logic in anyway.</p>

<p>You can try a &quot;set&quot; {} or a &quot;list&quot; [] but either should work no? The code just iterates the collection right? Then change the order of the list version... Different results???</p>

<p>This,<br>
context.stocks = [sid(22887),sid(25905),sid(25902),sid(25899),sid(25898),sid(25906),sid(22445)]</p>

<p>gives different results than this: (just rearranged in order)<br>
context.stocks = [sid(25898),sid(25906),sid(22445),sid(22887),sid(25905),sid(25902),sid(25899)]</p>

<p>Which may give different results than (using a set not a list)<br>
context.stocks = {sid(25898),sid(25906),sid(22445),sid(22887),sid(25905),sid(25902),sid(25899)}<br>
(note the use of [] vs {})</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b0120c91a6c0a8af0006dc' id='54b0120c91a6c0a8af0006dc'>
<a href='#54b0120c91a6c0a8af0006dc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54a3196f4ec27a914c0002ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f8d7c9fe2c702b1e7174fe8be6a10b51?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54a3196f4ec27a914c0002ad'>dave macpherson</a>
</div>
<a UTCms='1420825103000' class='quanto-date posted-at response-posted-at' href='#54b0120c91a6c0a8af0006dc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for your question:</p>

<p>Q. You can try a &quot;set&quot; {} or a &quot;list&quot; [] but either should work no?<br>
A. algorithm works with &quot;set&quot; {} only. What is the advantage of switching to the list data structure?</p>

<p>Q. The code just iterates the collection right?<br>
A. Yes. Picks best ETF based on simple performance criteria.</p>

<p>Q.Then change the order of the list version... Different results???<br>
A. Not when using the original code with set notation. Still investigating the &quot;rearranged order&quot; differences. I DON&#39;T THINK the order of the ETFs within the set should matter.</p>

<p>I always express the ETFs using the sid number as follows: </p>

<p>def initialize(context):<br>
    context.stocks = {<br>
        22887: sid(22887), # EDV VANGUARD treasury<br>
        25906: sid(25906), # VHT (Vanguard Health Care ETF)<br>
        25905: sid(25905), # VGT (Vanguard Information Technology ETF)<br>
        25902: sid(25902), # VCR (Vanguard Consumer Discretionary ETF)<br>
        22445: sid(22445), # IBB (iShares Nasdaq Biotechnology Index Fund)<br>
        37515: sid(37515), # TNA (Direxion Small Cap Bull 3X Shares (ETF))<br>
        25899: sid(25899), # VB = Vanguard small cap<br>
        25898: sid(25898)  # VAW (Vanguard Materials ETF)<br>
    } </p>

<p>================================== experimental results changing ETF order within the set ===============
these experiments (using the set {} notation) all produced the same performance results with ETFs listed in different order as expected.<br>
start date: 11/05/2008, end date: 01/06/2015, returns <strong>400.7%</strong> running daily using EFTs in this order: VHT, VGT, VCR, IBB, TNA, EDV, VB, VAW<br>
start date: 11/05/2008, end date: 01/06/2015, returns <strong>400.7%</strong> running daily using EFTs in this order: VB, VHT, VGT, VCR, IBB, TNA, EDV, VAW<br>
start date: 11/05/2008, end date: 01/06/2015, returns <strong>400.7%</strong> running daily using EFTs in this order: EDV, VHT, VGT, VCR, IBB, TNA, VB, VAW<br>
start date: 11/05/2008, end date: 01/06/2015, returns <strong>400.7%</strong> running daily using EFTs in this order: VHT, VGT, IBB, TNA, EDV, VB, VAW, VCR </p>

<p>....</p>

<p>Dave M  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b0159fc72ec06b9a0006bb' id='54b0159fc72ec06b9a0006bb'>
<a href='#54b0159fc72ec06b9a0006bb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53d46cdb75f57a2832005a6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/62b39881ee19f936224017339779d9d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53d46cdb75f57a2832005a6b'>Market Tech</a>
</div>
<a UTCms='1420826020000' class='quanto-date posted-at response-posted-at' href='#54b0159fc72ec06b9a0006bb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The reason to use a list &quot;[]&quot; is to use the easier to understand implementation of context.stocks = symbols()</p>

<p>Here&#39;s two differently ordered lists of your ETFs that produce different results. Still trying to figure out why.  </p>

<pre><code>    context.stocks = symbols(&quot;EDV&quot;,&quot;VGT&quot;,&quot;VCR&quot;,&quot;VB&quot;,&quot;VAW&quot;,&quot;VHT&quot;,&quot;IBB&quot;) # returns: 287.6%  
    context.stocks = symbols(&quot;VAW&quot;,&quot;VHT&quot;,&quot;IBB&quot;,&quot;EDV&quot;,&quot;VGT&quot;,&quot;VCR&quot;,&quot;VB&quot;) # returns: 87.1%  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b0385e1fd82edbdd0000a4' id='54b0385e1fd82edbdd0000a4'>
<a href='#54b0385e1fd82edbdd0000a4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53b1a6c838fadbdf23000081'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/de41c663f12b137baf3564f302545162?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53b1a6c838fadbdf23000081'>Randy Terbush</a>
</div>
<a UTCms='1420834913000' class='quanto-date posted-at response-posted-at' href='#54b0385e1fd82edbdd0000a4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Greetings, first post to Quantopian forums...</p>

<p>This algo caught my eye and I got sucked into figuring out what is going on with the rest of you.</p>

<p>Seems this variable result is somewhat due to the EDV instrument and perhaps the fact that there is no data for EDV until sometime in 2013. If you remove EDV from the list, the performance is consistent regardless of order.</p>

<p>I&#39;m not yet up to speed enough with the platform to figure out how to ignore an instrument in the list that does not have valid data. Found this after putting the following check in around line 53 since GetStockMetrics was returning NaN values:</p>

<pre><code>if math.isnan(p) or math.isnan(v):  
            continue  
</code></pre>

<p>Without EDV, the algo is returning 80% for me with 42.9%DD.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b047951fd82edbdd0000ff' id='54b047951fd82edbdd0000ff'>
<a href='#54b047951fd82edbdd0000ff'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54a3196f4ec27a914c0002ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f8d7c9fe2c702b1e7174fe8be6a10b51?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54a3196f4ec27a914c0002ad'>dave macpherson</a>
</div>
<a UTCms='1420838807000' class='quanto-date posted-at response-posted-at' href='#54b047951fd82edbdd0000ff'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Randy,</p>

<p>Thanks -- Very interesting discovery. Nice method provided for detecting NaNs. A more rigorous approach [for trading real money] could test all ETF data for NaN.</p>

<p>The inception date for the EDV ETF is 6 Dec 2007 [ <a href="https://institutional.vanguard.com/iippdf/pdfs/FS930R.pdf">https://institutional.vanguard.com/iippdf/pdfs/FS930R.pdf</a> ] , so perhaps some of the Quantopian data is missing?<br>
We also expected the Quantopian wrapper to adjust / report when EDV&#39;s data was not available.</p>

<p>I guess Quantopian is using us to beta test stuff like this???</p>

<p>Dave  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b07cad4d03d4fe140001a0' id='54b07cad4d03d4fe140001a0'>
<a href='#54b07cad4d03d4fe140001a0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/53d46cdb75f57a2832005a6b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/62b39881ee19f936224017339779d9d4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/53d46cdb75f57a2832005a6b'>Market Tech</a>
</div>
<a UTCms='1420852400000' class='quanto-date posted-at response-posted-at' href='#54b07cad4d03d4fe140001a0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Sets and Lists behave differently when it comes to internal order.</p>

<p>Given this code:  </p>

<pre><code>def handle_data(context, data):  
    set = {&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;}  
    list = [&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;]  
    print(&#39;test1&#39;)  
    print(set)  
    print(list)

    set = {&#39;c&#39;,&#39;d&#39;,&#39;a&#39;,&#39;b&#39;}  
    list = [&#39;c&#39;,&#39;d&#39;,&#39;a&#39;,&#39;b&#39;]  
    print(&#39;test2&#39;)  
    print(set)  
    print(list)  
</code></pre>

<p>You&#39;ll get this print result:</p>

<pre><code>2011-01-04 PRINT test1  
2011-01-04 PRINT set([&#39;a&#39;, &#39;c&#39;, &#39;b&#39;, &#39;d&#39;])  
2011-01-04 PRINT [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;]  
2011-01-04 PRINT test2  
2011-01-04 PRINT set([&#39;a&#39;, &#39;c&#39;, &#39;b&#39;, &#39;d&#39;])  
2011-01-04 PRINT [&#39;c&#39;, &#39;d&#39;, &#39;a&#39;, &#39;b&#39;]  
</code></pre>

<p>The sets do not change their order based on their constructors. The lists do.<br>
This means @Dave M. that your algo for applying performance and volatility during ranking appears to be imperfect. You get the same order of securities no matter what by using a set. But using a list changes the order which <em>should</em> not change the results -- but it does.</p>

<p>The above code block of the refactoring effort has been updated to reflect this issue.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b968c517fa7666a6000065' id='54b968c517fa7666a6000065'>
<a href='#54b968c517fa7666a6000065'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54b8d280f44758bf5c000d77'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fa932916ca1361286821861ae09ebd19?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54b8d280f44758bf5c000d77'>Noah</a>
</div>
<a UTCms='1421437129000' class='quanto-date posted-at response-posted-at' href='#54b968c517fa7666a6000065'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Fails for Minute data; index out of bounds error on 230.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54b97eb2e7491d07d100006b' id='54b97eb2e7491d07d100006b'>
<a href='#54b97eb2e7491d07d100006b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1421442742000' class='quanto-date posted-at response-posted-at' href='#54b97eb2e7491d07d100006b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hey Noah,</p>

<p>There are a couple version of the algorithm posted on this thread, do you mind sharing the one you&#39;re working with so we can help debug?</p>

<p>Thanks,<br>
Seong  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='54b9d86b1686043354000147' id='54b9d86b1686043354000147'>
<a href='#54b9d86b1686043354000147'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54b8d280f44758bf5c000d77'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/fa932916ca1361286821861ae09ebd19?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54b8d280f44758bf5c000d77'>Noah</a>
</div>
<a UTCms='1421465710000' class='quanto-date posted-at response-posted-at' href='#54b9d86b1686043354000147'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The main one at the very top.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='54bbc45d46a1f27a280002b5' id='54bbc45d46a1f27a280002b5'>
<a href='#54bbc45d46a1f27a280002b5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1421591648000' class='quanto-date posted-at response-posted-at' href='#54bbc45d46a1f27a280002b5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Noah,</p>

<p>Take a look at the code below, I think a part of the error was coming from the batch_transform use so the algo here has been converted into history()  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='55834d87d4ea838e2300000b' id='55834d87d4ea838e2300000b'>
<a href='#55834d87d4ea838e2300000b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55424671ec76e332e40003ed'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d39ce197694d4c3485ffc3a38bf9ec09?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55424671ec76e332e40003ed'>Johnny Wu</a>
</div>
<a UTCms='1434668425000' class='quanto-date posted-at response-posted-at' href='#55834d87d4ea838e2300000b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Sorry for digging up an old thread, but I don&#39;t understand the concept of this code. It seems to take the best performance per volatility ETF, but what is the theory and math behind it? Can anyone point to a paper or tutorial that could explain this to me?</p>

<p>Thanks  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='55835123af7958f13200005f' id='55835123af7958f13200005f'>
<a href='#55835123af7958f13200005f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5282b9cc798d6e0f4100003e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/50a22ab893cc44de6ebd1afc2ffd00b4?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5282b9cc798d6e0f4100003e'>Reed D</a>
</div>
<a UTCms='1434669350000' class='quanto-date posted-at response-posted-at' href='#55835123af7958f13200005f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Johnny,<br>
The theory is based on empirical evidence that stocks and ETFs which have performed well in the past, tend to outperform.  This is an empirically observed break from the efficient markets hypothesis which assumes stock returns are independently and identically distributed (i.e. today&#39;s return can tell you nothing about tomorrow&#39;s return).  The profitability of this and similar strategies is based on the idea that past returns do contain information about future returns.<br>
There has been much written about this in the literature.  Feel fee to browse some of the articles on Google Scholar:<br>
<a href="https://scholar.google.com/scholar?as_vis=1&amp;q=finance+momentum&amp;hl=en&amp;as_sdt=1,9">https://scholar.google.com/scholar?as_vis=1&amp;q=finance+momentum&amp;hl=en&amp;as_sdt=1,9</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='55835a32d4ea838e23000068' id='55835a32d4ea838e23000068'>
<a href='#55835a32d4ea838e23000068'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55424671ec76e332e40003ed'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d39ce197694d4c3485ffc3a38bf9ec09?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55424671ec76e332e40003ed'>Johnny Wu</a>
</div>
<a UTCms='1434671668000' class='quanto-date posted-at response-posted-at' href='#55835a32d4ea838e23000068'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks for your reply, Reed.<br>
There is something other than momentum at play here because momentum is simple to calculate while Dave&#39;s code is rather complex. My simple momentum algo fares a lot worse than Dave&#39;s code. There is something else at play here other than comparing x month return.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='55873c72da97e9d0bb0001cd' id='55873c72da97e9d0bb0001cd'>
<a href='#55873c72da97e9d0bb0001cd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55424671ec76e332e40003ed'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d39ce197694d4c3485ffc3a38bf9ec09?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55424671ec76e332e40003ed'>Johnny Wu</a>
</div>
<a UTCms='1434926196000' class='quanto-date posted-at response-posted-at' href='#55873c72da97e9d0bb0001cd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I don&#39;t understand the code so it has an almost magical quality to it. I was hoping that the technique (or magic!) was sufficiently robust to apply to other rotation strategies such as asset rotation.</p>

<p>It&#39;s quite impressive until about 2009...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='55954775e277c782d4000024' id='55954775e277c782d4000024'>
<a href='#55954775e277c782d4000024'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/555f388571df4d90c4000031'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/8513bc3899628e95e1fbcaa48ef31014?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/555f388571df4d90c4000031'>Stian Andreassen</a>
</div>
<a UTCms='1435846522000' class='quanto-date posted-at response-posted-at' href='#55954775e277c782d4000024'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The order magic likely comes from the rank being equal. Then the first listed ETF is picked.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='55ab6f1f260674f988000330' id='55ab6f1f260674f988000330'>
<a href='#55ab6f1f260674f988000330'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/554695a91206d6826a000126'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/88c2459a8c19a403e42b92acae2efb43?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/554695a91206d6826a000126'>JOHN CHAN</a>
</div>
<a UTCms='1437298472000' class='quanto-date posted-at response-posted-at' href='#55ab6f1f260674f988000330'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ maket tech how were you able... to quantify ... those results   <strong>context.stocks = symbols(&quot;EDV&quot;,&quot;VGT&quot;,&quot;VCR&quot;,&quot;VB&quot;,&quot;VAW&quot;,&quot;VHT&quot;,&quot;IBB&quot;) # returns: 287.6%   context.stocks = symbols(&quot;VAW&quot;,&quot;VHT&quot;,&quot;IBB&quot;,&quot;EDV&quot;,&quot;VGT&quot;,&quot;VCR&quot;,&quot;VB&quot;) # returns: 87.1%</strong>   can you show us the code... we will check on how it is computed...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56a5178cdcb4521ed9000220' id='56a5178cdcb4521ed9000220'>
<a href='#56a5178cdcb4521ed9000220'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5673f0630a6bfa534b00000d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/147dbb7c6d5789fd351a368486558c2a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5673f0630a6bfa534b00000d'>Giuseppe Moriconi</a>
</div>
<a UTCms='1453660053000' class='quanto-date posted-at response-posted-at' href='#56a5178cdcb4521ed9000220'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi,<br>
Is there a reason why this algorithm works on equity sectors, but not all 13 of them like for example the standard  morningstar sector classification?<br>
I mean, is there some logic behind?<br>
Plus, In the original list of stocks IBB and EDV have not enough data, you can tell buy adding a check like:</p>

<pre><code>backtest_start = &#39;2006-1-1&#39;  
context.no_data = [sec for sec in context.stocks.itervalues() if sec.start_date.replace(tzinfo=None) &gt; context.backtest_start]  
if len(context.no_data) &gt; 0:  
    context.enough_history= False  
</code></pre>

<p>By the way, unfortunately adding all sectors cause the equity line to be very poor  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56a554f1dcb452d4d5000064' id='56a554f1dcb452d4d5000064'>
<a href='#56a554f1dcb452d4d5000064'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1453675767000' class='quanto-date posted-at response-posted-at' href='#56a554f1dcb452d4d5000064'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Backtest  in minute mode of the  same algo  utilizing the history function to accumulate  data is for now 29% in drowdown.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='56a61e19c4fa5bd7ca000558' id='56a61e19c4fa5bd7ca000558'>
<a href='#56a61e19c4fa5bd7ca000558'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/52b0e0e0271a27fc88000049'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e5451406e743420c700eb2b054b2fc57?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/52b0e0e0271a27fc88000049'>Blue Seahawk</a>
</div>
<a UTCms='1453727263000' class='quanto-date posted-at response-posted-at' href='#56a61e19c4fa5bd7ca000558'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Over 850% at one point. How on earth to address DD. Quite a few changes here ...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57364d6109880f4ab50002b4' id='57364d6109880f4ab50002b4'>
<a href='#57364d6109880f4ab50002b4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51c8b19c7d2c8a88f200000a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/03dd341c0d09ef08434e30fa9894fccd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51c8b19c7d2c8a88f200000a'>valapet Badri</a>
</div>
<a UTCms='1463176555000' class='quanto-date posted-at response-posted-at' href='#57364d6109880f4ab50002b4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Only change to previous test  here about  Backtest for last 2 years. The results below Show the difficulty of picking of a &quot; ETF universe&quot;  to trade and how returns changes over a different market behavior(what type of news is driving the market now VS 5 years ago). eg- 2015 Jan down market is now clear retrospective , however difficult to read the market message with a live systematic traded strategy or in hindsight<br>
1,Although we are doing systematic trading.. its constant tuning effort by using a lot common sense read  the market.<br>
 2, picking a &#39;universe of instrument&#39; to trade changes for the same strategy over different market  will be very different (essentially  the news drives the market and our algo/instrument should reflect the view )<br>
3, Never trade live with real money until you perform your due diligence and have some money to loose.<br>
4, Never think you or your algo are the  smartest thing created by us (academic or Geek or .. ) ; the random nature of the market will humble you (it at the end , same as going playing in a casino, at the end of day )</p>

<p>play safe , smart and self-aware even if we are the smartest dudes on the planet !<br>
cheers  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/etf-market-rotation-strategy'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/etf-market-rotation-strategy'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#47212222232526242c07363226293328372e26296924282a">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
