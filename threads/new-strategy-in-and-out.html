<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
New Strategy — “In &amp; Out”
</title>
<meta content='Intuitively, it might be possible to generate excess returns via cleverly timed entries and exits in and out of the equity market. This algo may be a first step toward developing a strategy that derives optimal moves in an out of the market on the basis of early indicators of equity market downturns. At the very least, the algo could start an interesting discussion regarding the sense and nonsense of trying to time market entry and exit in this way. Either way, your contribution is highly...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="kbSmNjAE60djptqxcfw+R3KIS4RiE8AerH34Hvuvfz/t0tB7kvI5pNq7g4A+E5YzSgZo7Rjf1QUuciN0UeodhA==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=true;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/new-strategy-in-and-out' property='og:url'>
<meta content='New Strategy — “In &amp; Out”' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/new-strategy-in-and-out' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='New Strategy — “In &amp; Out”' property='og:title'>
<meta content='Intuitively, it might be possible to generate excess returns via cleverly timed entries and exits in and out of the equity market. This algo may be a first step toward developing a strategy that derives optimal moves in an out of the market on the basis of early indicators of equity market downturns. At the very least, the algo could start an interesting discussion regarding the sense and nonsense of trying to time market entry and exit in this way. Either way, your contribution is highly...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/new-strategy-in-and-out">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='5f79b891427b450010c8ea5f'>
<div class='post-container' data-post-id='5f79b891427b450010c8ea5f' id='5f79b891427b450010c8ea5f'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>New Strategy — “In &amp; Out”</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<span class='posted-at'>posted </span>
<span UTCms='1601812625000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=New Strategy — “In &amp; Out”&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fnew-strategy-in-and-out%3Futm_source%3Dwebsite_share%26utm_campaign%3Dnew-strategy-in-and-out%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fnew-strategy-in-and-out%3Futm_source%3Dwebsite_share%26utm_campaign%3Dnew-strategy-in-and-out%26utm_medium%3Dlinkedin&amp;title=New+Strategy+%E2%80%94+%E2%80%9CIn+%26+Out%E2%80%9D+%28Peter+Guenther%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<div class='tags tag-row'>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Collaboration Request' data-tag-id='55c50e7d8d4710ec6e000016' href='/posts/tag/Collaboration-Request/newest'>Collaboration Request</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Portfolio Optimization' data-tag-id='55d33f293f6ba10061000000' href='/posts/tag/Portfolio-Optimization/newest'>Portfolio Optimization</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Asset Allocation' data-tag-id='55d33f4f3f6ba10061000001' href='/posts/tag/Asset-Allocation/newest'>Asset Allocation</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='ETFs' data-tag-id='55d33f633f6ba10065000001' href='/posts/tag/ETFs/newest'>ETFs</a>
<a class='tag mixpanel-button' data-event='tag click' data-mixpanel='Pipeline' data-tag-id='561525bcf252a59171000001' href='/posts/tag/Pipeline/newest'>Pipeline</a>
</div>
<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/new-strategy-in-and-out?utm_source=website_share&amp;utm_campaign=new-strategy-in-and-out&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Peter Guenther" />
<div class='body-text'>
<div class='body-text-container post-body'><p>Intuitively, it might be possible to generate excess returns via cleverly timed entries and exits in and out of the equity market. This algo may be a first step toward developing a strategy that derives optimal moves in an out of the market on the basis of early indicators of equity market downturns. At the very least, the algo could start an interesting discussion regarding the sense and nonsense of trying to time market entry and exit in this way. Either way, your contribution is highly appreciated.</p>

<p><strong><em>Backdrop for the initial code</em></strong>:<br>
 - Resources and industrial products are early in the value chain and<br>
   market value drops in corresponding firms are early indicators of<br>
   growth worries that ultimately affect other sectors and the broader<br>
   market<br>
 - Equity market value growth benefits substantially from cheap debt,<br>
   such that increases in bond yields (i.e., drops in bond prices)<br>
   should be an early indicator of a slowdown in growth<br>
 - Yet, no matter what these signals say, if the market drops by 30%<br>
   (‘once in a decade opportunity’), we want to be in  </p>

<p><strong><em>Measures used in the initial code</em></strong>:<br>
 - Resources: The DBB ETF (Invesco DB Base Metals Fund) provides the<br>
   signal. DBB tracks the prices of three key industrial metals:<br>
   aluminum, copper and zinc. A 7% drop over an approx. 3-month trading<br>
   period is considered a substantial drop.<br>
 - Industrials: The XLI ETF (Industrial Select Sector SPDR Fund)<br>
   provides the signal. XLI tracks the broad US industrial sector. A 7%<br>
   drop over an approx. 3-month trading period is considered a<br>
   substantial drop.<br>
 - Cost of debt: The SHY ETF (iShares 1-3 Year Treasury Bond) provides<br>
   the signal. SHY tracks short-term US Treasury debt (1-3 years) and<br>
   changes in this debt’s ‘risk-free’ interest yield should be<br>
   indicative of changes in firms’ cost of debt which is based on the<br>
   risk-free rate (risk-free rate + risk premium). A 60 basis points<br>
   increase (i.e., drop in the bond price) over an approx. 3-month<br>
   trading period is considered substantial.</p>

<p><strong><em>Rules of the algo</em></strong>:<br>
 - In terms of equity, only the market (SPY) is traded<br>
 - If out of the market, the money is invested in bonds (IEF and TLT)<br>
 - If any of the indicators drops substantially, we go out of the<br>
   market and into bonds. We wait for 3 trading weeks for the dust to<br>
   settle, unless the market drops by 30% during the waiting period in<br>
   which case we enter immediately<br>
 - Notes: this algo’s focus is only on the market ‘entry vs exit’<br>
   decision, i.e. not on the ‘what equities do I select’ decision. The<br>
   assumption is that you will be able to plug your equity selection<br>
   logic into this algo and get an additional boost in terms of your<br>
   strategy’s returns. However, finding an optimal equity selection is<br>
   not the focus here (if you are interested in equity selection, see<br>
   other community forum contributions such as “Quality Companies in an<br>
   Uptrend” or “Uncovering Momentum”, among others). Scheduling<br>
   functions: Whether we ‘go out’ is checked daily since equity prices<br>
   usually drop quickly when things deteriorate and hence speed seems<br>
   paramount. In contrast, whether we ‘go back in’ is checked weekly and<br>
   this is a personal preference so that complex equity purchases only<br>
   have to be executed once a week, at the end of the week. This is so<br>
   that a ‘lazy’ trader who does not have the time to execute complex<br>
   reshuffles (other than doing a ‘sell all’ and going into bonds) of<br>
   the portfolio on a daily basis can combine the algo with a more<br>
   sophisticated equity selection strategy.</p>

<p><strong><em>Outcomes for the initial algo</em></strong>:<br>
 - from 1 Jan 2008 to 2 Oct 2020, the total return is approx. 860% vs<br>
   190% for the SPY (= being always in)<br>
 - the backtest indicates a beta of 0.34 and the tear sheet shows an<br>
   alpha of 20%<br>
 - Note: regarding the backtest period, consider the launch dates of<br>
   the different ETFs. All of them should be available from 1 Jan 2008<br>
   onwards but some may be unavailable in earlier periods, creating a<br>
   limit regarding testing the algo in earlier time periods</p>

<p><strong><em>Brainstorming regarding improvement opportunities</em></strong>:<br>
 - different ETFs/ways to measure prices of resources (e.g.,<br>
   additional key resources such as oil), industrial goods (e.g., a<br>
   stronger focus on industrial capital goods), and bonds (e.g.,<br>
   corporate bonds instead of government bonds)<br>
 - additional aspects—other than resources, industrial goods, and bond<br>
   yields—that could provide early indicators of equity downturns<br>
 - improvement of settings (e.g., waiting period, %-points indicating<br>
   ‘substantial’ drops)<br>
 - code improvements (errors/unintended outcomes, efficiency)  </p>
</div>
</div>
</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>114 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='5f7b05837fedf21f33f9f26d' id='5f7b05837fedf21f33f9f26d'>
<a href='#5f7b05837fedf21f33f9f26d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1601897859000' class='quanto-date posted-at response-posted-at' href='#5f7b05837fedf21f33f9f26d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><pre><code>context.out = context.in_out==0 &amp; context.spy_in==0  
</code></pre>

<p>This line does not what you expect, context.out is true allthough context.spy_in is 1 during 2009. See the attached backtest which records context.spy_in, context.out and the current weight for each asset. Either put parentheses around each condition or use &#39;and&#39; instead of &#39;&amp;&#39;. It lowers the performance quite a bit however.</p>

<p>May I ask why you count the days when spy_in is 1? Btw. the count gets reset everyday the condition is true, is that on purpose?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f7b29319e60420011b9a3f5' id='5f7b29319e60420011b9a3f5'>
<a href='#5f7b29319e60420011b9a3f5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1601906993000' class='quanto-date posted-at response-posted-at' href='#5f7b29319e60420011b9a3f5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s my contribution. Allthough the code might look totally different, it basically does the same as the original.</p>

<p>My only addition is UUP, an ETF on the USD Index. Assuming that a stronger US-Dollar preceeds a market decline I added the condition that if it&#39;s up 7 % (in the same time span as the other ETFs) we also drop SPY.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f7b57fe427b450013c8f19d' id='5f7b57fe427b450013c8f19d'>
<a href='#5f7b57fe427b450013c8f19d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1601918974000' class='quanto-date posted-at response-posted-at' href='#5f7b57fe427b450013c8f19d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Tentor, well spotted there regarding the code issue in the original and nice contribution, bringing in UUP and creating a more efficient/correct code!<br>
The logic USD up -&gt; equity under pressure makes a lot of sense = a flight into a safe haven currency. Nice!</p>

<p>Since my coding skills are still &quot;under development&quot;, I hope you don&#39;t mind me asking: I understand that the code<br>
context.out = context.in_out==0 &amp; context.spy_in==0<br>
is incorrect. Is there any valid interpretation for what this code snippet does? I am just trying to get my head around why there might be excess returns linked to writing the condition in this way. However, maybe there is no valid interpretation.</p>

<p>If I am reading your code update correctly, you found greater returns by dropping the spy_in condition all together (i.e. the &#39;once in a decade opportunity&#39; idea). So, we can conclude that this is not a beneficial condition, or it would need to be brought back in in a different way.</p>

<p>Great stuff!</p>

<p>(Regarding your question concerning the spy_in condition and updating the daycount whenever the condition is true: For both conditions, concerning the in_out indicator and the spy_in indicator, I wanted to wait the full waitdays after the conditions have been true for the last time to change the course of action. That is, even when the out conditions are no longer met, the code stays out for three trading weeks. On the other hand, when a &#39;once in a decade opportunity&#39; comes along (SPY -30% drop), I wanted to stay in for the full waitdays even though the in_out indicator might say &#39;out&#39; (since the equity market often rebounds quickly in the first few weeks, which we don&#39;t want to miss). However, I reckon your tests have indicated that the returns are better without this &#39;once in a decade&#39; market entry logic so that it&#39;s better left out of the algo.)</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f7b66717fedf2000ef9f94a' id='5f7b66717fedf2000ef9f94a'>
<a href='#5f7b66717fedf2000ef9f94a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1601922673000' class='quanto-date posted-at response-posted-at' href='#5f7b66717fedf2000ef9f94a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>To be honest I also don&#39;t know exactly what the logic of that line does, I think the &#39;&amp;&#39; only looks at the value directly after it. Usually I only use it for boolean arrays / data frames and try to alwas remember the parentheses. The reason why I dropped the spy_in was that the test with only</p>

<pre><code>context.out = context.in_out==0  
</code></pre>

<p>had pretty much the same result, just slightly better. Oh, and with parantheses (buying into the pullback) it was way worse, drawdown over 30 % and returns 700 something %.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f7c7fe59e6042000cb9aa6c' id='5f7c7fe59e6042000cb9aa6c'>
<a href='#5f7c7fe59e6042000cb9aa6c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1601994725000' class='quanto-date posted-at response-posted-at' href='#5f7c7fe59e6042000cb9aa6c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I would say this is a very good algo. Low vola, low dd, high sharpe ratio, the return increases steadily. well done!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f7cf8401072a600173bce16' id='5f7cf8401072a600173bce16'>
<a href='#5f7cf8401072a600173bce16'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a4ae56a28d3c60010e1f6c2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a19b015e43b318b1c735847ab21e7120?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a4ae56a28d3c60010e1f6c2'>frank giardina</a>
</div>
<a UTCms='1602025536000' class='quanto-date posted-at response-posted-at' href='#5f7cf8401072a600173bce16'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Very nice thanks for sharing  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f7dc168427b45000ec8fc73' id='5f7dc168427b45000ec8fc73'>
<a href='#5f7dc168427b45000ec8fc73'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1602077032000' class='quanto-date posted-at response-posted-at' href='#5f7dc168427b45000ec8fc73'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I replace the order_optimal_portfolio() with the &quot;old timer&quot; order_target_percent(). The result is almost the same. But the trades are much much less. The original algo has 1448 trades (buy and sell, 2005 - 2020). By using the order_target_percent() there are only 173 trades. Is it better or not? :-)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f7dfb8a427b450017c8fdb0' id='5f7dfb8a427b450017c8fdb0'>
<a href='#5f7dfb8a427b450017c8fdb0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1602091914000' class='quanto-date posted-at response-posted-at' href='#5f7dfb8a427b450017c8fdb0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I would say perfect for the &#39;lazy trader&#39; mentioned in the intro text :) That&#39;s about one trade per month. I reckon there are substantial savings in terms of commissions which leaves more money in terms of total equity return, which is nice!<br>
People integrating into the algo their own stock selection strategy that may require more frequent portfolio reshuffling can easily alter the trading frequency to suit their needs, so that&#39;s all good.</p>

<p>Not sure whether you had a chance to check: were all the ETF prices available from 2005 onwards -- I reckon the system would have complained otherwise (?).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f7e2d841072a600123bd405' id='5f7e2d841072a600123bd405'>
<a href='#5f7e2d841072a600123bd405'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1602104708000' class='quanto-date posted-at response-posted-at' href='#5f7e2d841072a600123bd405'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>As an additional possible indicator, I have tested the oil price using the ETF USO (United States Oil Fund).<br>
It tends to reduce the total return significantly if used at the drop size set for materials and industrial goods (-7%) . This may be due to a higher typical volatility of the oil price. I found that only when the drop is set at a very high percentage level (-25% over the three month window), additional returns can be realized, see the attached backtest. It is likely that these returns are due to a singular event period for which it has been better to be out of instead of in the market. The returns are also small relative to the length of the assessment period.<br>
Overall, the oil price seems to provide little additional information for a superior entry/exit decision.</p>

<p>I have worked with my earlier copy of Tentor&#39;s code above. For possible additional savings (and less hassle) from fewer trades, see Thomas&#39;s code version.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f7f00ed427b450017c90336' id='5f7f00ed427b450017c90336'>
<a href='#5f7f00ed427b450017c90336'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1602158829000' class='quanto-date posted-at response-posted-at' href='#5f7f00ed427b450017c90336'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter:<br>
1.  </p>

<blockquote>
<blockquote>
<p>...Not sure whether you had a change to check: were all the ETF prices available from 2005 onwards...<br>
you are right. I should begin from 2008. But this doesn&#39;t change the fact that the trades are much much less by using the order_target_percent() than that of order_optimal_portfolio(). This strangers me a little bit since I thought the order_optimal_portfolio() should be better since it is optimized.</p>
</blockquote>
</blockquote>

<ol>
<li> 
I do some backtesting on your algo and find, if I change the values of some parameters a little bit such as the waitdays (use 14 or 16) and the &quot;58&quot; (use 57 or 59), the result will be reduced quite a lot. I wonder how much time you have spent to figure out the value of 15 and 58? :-) </li>
</ol>

<p>If you use this for live trading, I am not sure you can get what you want. :-)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f7f3d69a77d39001151d272' id='5f7f3d69a77d39001151d272'>
<a href='#5f7f3d69a77d39001151d272'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/598899bcc936fe0010f74c99'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/f73d54368c6baf2d409e06446b1573e2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/598899bcc936fe0010f74c99'>Dmitry Sarnachev</a>
</div>
<a UTCms='1602174313000' class='quanto-date posted-at response-posted-at' href='#5f7f3d69a77d39001151d272'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas, hivemind, I&#39;ve done the same to check for overfitting.<br>
Just used steps of 5 days to use whole number of weeks (e.g. 53 is a quarter which seems less engineered than 58, the same applies for 20/22 vs 15)<br>
Noticed a drastic drop in returns.</p>

<p>Will rewrite in alphalense-digestible form to check for the consistency of returns.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f7f832cbae892000f473ddd' id='5f7f832cbae892000f473ddd'>
<a href='#5f7f832cbae892000f473ddd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1602192172000' class='quanto-date posted-at response-posted-at' href='#5f7f832cbae892000f473ddd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Thomas Chang </p>

<p>I totally agree with <a href="https://www.quantopian.com/posts/new-strategy-in-and-out#5f7c7fe59e6042000cb9aa6c" rel="nofollow">your first post</a> in this thread, not completely with the last one.<br>
Nobody now asking question why J. Welles Wilder chose default period for RSI 14 or<br>
Gerald Appel choose default parameters for MACD 12-26-9.<br>
We have been using these magic numbers for many many years.<br>
Just take <strong>MOM = 57</strong> and <strong>WAIT_DAYS = 15</strong> as magic numbers for this strategy.<br>
Backtest it on dozens of different US equity ETFs at different times in the market cycle.<br>
I am sure you will get similar or better results.<br>
<em>Past performance is the best predictor of success.</em><br>
There are millions of ways to improve the strategy without changing the magic numbers.</p>

<p>I was not wrong. </p>

<pre><code>mom = hist.iloc[-1] / hist.iloc[-58] - 1  
</code></pre>

<p>is actually 57 day momentum </p>

<p>Correct me, if not.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f8043d598c558000d203924' id='5f8043d598c558000d203924'>
<a href='#5f8043d598c558000d203924'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1602241493000' class='quanto-date posted-at response-posted-at' href='#5f8043d598c558000d203924'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Vladimir  </p>

<blockquote>
<blockquote>
<p>Nobody now asking question why J. Welles Wilder chose default period for RSI 14 or<br>
Gerald Appel choose default parameters for MACD 12-26-9.</p>
</blockquote>
</blockquote>

<p>The reason hy now body asks is because the RSI14 is for half month. The number by MACD have certenlly their meanings. This could be googled. I don&#39;t think they are magic numbers.</p>

<p>Besides, the RSI and MACD are indicators, not backtesting optimation. This is the big difference. </p>

<p>If you use the RSI14 in your algo,  I don&#39;t think the RETURN will have a  drastic change if you chose 13 or 12. The similar by MACD.</p>

<p>Surely this is a very interessting algo.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f80b574b5245b0010e29ae5' id='5f80b574b5245b0010e29ae5'>
<a href='#5f80b574b5245b0010e29ae5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb4fc8571ef9572db85c0af'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a8d078cb83e513809bab0e31eabfa4fc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb4fc8571ef9572db85c0af'>Dan Whitnable</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1602270580000' class='quanto-date posted-at response-posted-at' href='#5f80b574b5245b0010e29ae5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter Guenther Kudos! Very Interesting algo. I like the way it&#39;s founded in underlying economics. I&#39;ve reworked it a bit to use entirely pipeline with a single factor/signal for being in or out of the market. The original thought was, that way, it could then be analyzed using Alphalens. Not sure that&#39;s feasible but that was the intent. I also added recording for the four signals. It&#39;s interesting how often the signals come into play but rarely is there more than one or two.  </p>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5f80be9298c5580018203be5' id='5f80be9298c5580018203be5'>
<a href='#5f80be9298c5580018203be5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb4fc8571ef9572db85c0af'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a8d078cb83e513809bab0e31eabfa4fc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb4fc8571ef9572db85c0af'>Dan Whitnable</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1602272914000' class='quanto-date posted-at response-posted-at' href='#5f80be9298c5580018203be5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is the same algo as above but, instead of going &#39;out&#39; of the market and into bonds, it goes short SPY using SH. Returns are not nearly the same, but moreover, volatility and drawdown are much higher. If the signals were finding when to get &#39;out&#39; of the market, one would expect better performance? Just musing, but it almost seems the signals are really just finding when to get into bonds?  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5f80ebe7bae89200144746c4' id='5f80ebe7bae89200144746c4'>
<a href='#5f80ebe7bae89200144746c4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1602284519000' class='quanto-date posted-at response-posted-at' href='#5f80ebe7bae89200144746c4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I feel that I am falling behind a bit. These are all great comments :)</p>

<p>@Dan: very nice work on the algo code and much appreciated regarding uncovering the surprising finding regarding taking a short position in the SPY. A great new puzzle! Regarding the point you raise, intuitively, I was expecting that there is hardly any money in bonds, i.e. a bit like holding cash (= zero return) and then a bit. So, this will definitely be interesting to tease out, i.e. what is the contribution of bonds in all of this. I have to do more thinking/testing on that.<br>
One speculation though: what we might have done by swapping in the short SPY is to increase the ‘cost of being wrong’. My assumption is that the algo is moving out of the market often, and often it is wrong (the few times it’s right really pay off and that’s why we are happy to be nervous and often go out unnecessarily). When holding bonds, the cost of being wrong may be negligible (if they hardly move); when holding the short SPY these costs may be much more material and reduce the total return substantially.</p>

<p>@Thomas, Dmitry and Vladimir: Great comments regarding sensitivity, and I agree, this will also be a big issue to investigate. Intuitively, I reckon this strategy will turn out to be quite sensitive, since it tries to ‘time’ market entry/exit and, particularly, it tries to get out when things go pear shaped and then usually deteriorate quickly. So, I reckon individual days will matter a lot.<br>
I have created a table regarding what Thomas was referring to, changing the wait days to 16 or 14 (from 15) and the shift days to 57 or 59 (from 58):</p>

<p>parameter Δ | % tot | &quot;missing&quot; factor | Δ% p.a.<br>
default (incl. oil)  | 942%<br>
wait = 16 days | 814% | 1.16 | 1.2%<br>
wait = 14 days | 858% | 1.10 | 0.7%<br>
shift = 57 days | 676% | 1.39 | 2.6%<br>
shift = 59 days | 712% | 1.32 | 2.2%<br>
SPY | 194%      </p>

<p><strong><em>The sensitivities may tell us something about which ‘timing’ (in or out) matters most</em></strong><br>
I was trying to quantify the changes somehow and was thinking along the lines of what is the ‘missing factor’ i.e. what would I need to multiply the returns with to get to the total return of the default strategy. Looking at these numbers, I thought that one aspect to also consider is the very long timeframe (almost 13 years) we are looking at, meaning that small yearly percentage differences can build up to very substantial differences in the end. Looking at these number, these may be some conclusions:<br>
1. the wait days sensitivity may be OK, judging on the basis of the 0.7%-1.2% p.a. drop (although a wider range could be checked)<br>
2. the shift days sensitivity is comparably much more substantial<br>
3. hence, a well-timed ‘going out’ (related to shift days) seems to matter much more than a well-timed ‘going in’ (related to wait days)</p>

<p><strong><em>Are we looking at the right benchmark?</em></strong><br>
The 942% look nice and I think it can be worthwhile trying to push that further up—based on indicators that economically make sense, as Dan put it nicely in his post. The assumption would be that even if the future does not play out exactly like the past, with a strategy that has proven more successful in the past, we may have a better chance to get through it all in the best possible shape. Of course, nobody knows for sure.<br>
However, I was recalling for myself that this algo is trying to beat the market by ... trading the market. No long hours to research the best possible stocks, no sophisticated algo to select stocks, no intricate company fundamentals etc. 942% may be a shameless return against this background :)<br>
Against this backdrop, my thoughts were, maybe the correct benchmark is the market; SPY 194%. That is, using the sledge hammer on sensitivities, how often does the return drop below 194%, i.e. what is the risk that we have all this strategy going, the trades, the commissions, the time and then end up worse than if we just would have stayed in the market and not tried to time it.</p>

<p><strong><em>Thoughts on testing parameter sensitivities</em></strong><br>
I reckon that we somehow have to consider that the parameters are not independent. E.g., a 7% drop over 58 days (the shift days) is not equivalent to a 7% over 40 days (the latter would be a much more dramatic drop and thus may occur less often). An idea might be to use a proportional % drop. Yet, if we reduce the shift days, we go out earlier and then the wait days may not be sufficient to sit it out when things really go pear shaped.<br>
Also, seeing that the shift days are so sensitive in the table above, maybe the parameter operationalization could be improved to make it less sensitive? At the moment, it compares the current observation with the one that occurred exactly 58 (or 57) days earlier. This might not be ideal. Not sure whether this would change anything, but might a max function with a rolling window help here?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f81f5e82e7763000f72f904' id='5f81f5e82e7763000f72f904'>
<a href='#5f81f5e82e7763000f72f904'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1602352616000' class='quanto-date posted-at response-posted-at' href='#5f81f5e82e7763000f72f904'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter Guenther </p>

<p>I have backtested this algorithm several times using Dan Whitnable code and found that performance<br>
is highly dependent on the &#39;DBB&#39; momentum.<br>
Performance will drop significantly if you replace &#39;DBB&#39; with &#39;XME&#39;  20 times more active base metals ETF  ($ 40M per day).<br>
I think it inappropriate to depend heavily on this very thinly traded &#39;DBB&#39; ($ 2M / day with only 3 positions)<br>
and its market maker, so I downgraded my rating on current version “In &amp; Out” from Gold to Silver.</p>

<p><a href="https://finance.yahoo.com/quote/DBB/profile?p=DBB" rel="nofollow">https://finance.yahoo.com/quote/DBB/profile?p=DBB</a><br>
<a href="https://finance.yahoo.com/quote/DBB/holdings?p=DBB" rel="nofollow">https://finance.yahoo.com/quote/DBB/holdings?p=DBB</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f81ff109886aa0011bc18b6' id='5f81ff109886aa0011bc18b6'>
<a href='#5f81ff109886aa0011bc18b6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1602354960000' class='quanto-date posted-at response-posted-at' href='#5f81ff109886aa0011bc18b6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Vladimir: Nice one there regarding sensitivity and good point about liquidity of the ETF with regard to providing a timely and accurate price signal!</p>

<p>Open for discussion: What I like about the DBB is that it trades key industrial metals (aluminum, copper and zinc) directly via future contracts. So the ETFs price is very much a function of these commodity prices and potentially can give a very direct signal of anticipated changes in demand.<br>
If I understand it correctly, the XME trades companies--metals and mining. It could be diluted since it also includes, for instance, coal mining companies (= energy instead of metal). Since the underlying are companies, the signal could be slightly more lagged (I am thinking: translation of commodity prices into firm performance). The typical fluctuation might be different (e.g. using a 7% drop may be too small/large for the ETF that trades companies vs commodities directly).<br>
ETF.com notes: &quot;XME is the only fund that tracks the US metals and mining segment. That&#39;s also its major issue: it winds up being a poor representation of the metals and mining industry. First, it includes coal companies, which we believe belong in energy ...&quot;</p>

<p>Maybe we could try it with a different ETF that is more liquid than DBB but also trades metals directly?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f8208efa77d39001251e2cb' id='5f8208efa77d39001251e2cb'>
<a href='#5f8208efa77d39001251e2cb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1602357487000' class='quanto-date posted-at response-posted-at' href='#5f8208efa77d39001251e2cb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Peter, Vladimir<br>
Since we don&#39;t want to trade DBB, why should we care about the volume?<br>
It&#39;s an ETF which tracks an index that consists of copper, zink and aluminum in equal parts. I don&#39;t think you can get more direct signals for these metals another way. JJM would be an alternative but was incepted 2018.<br>
Again, why replace it at all?<br>
We don&#39;t want exposure to the commodities, just to know the price differences.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f821574a77d39001251e301' id='5f821574a77d39001251e301'>
<a href='#5f821574a77d39001251e301'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1602360692000' class='quanto-date posted-at response-posted-at' href='#5f821574a77d39001251e301'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><a href="https://www.invesco.com/us/financial-products/etfs/product-detail?audienceType=Ria&ticker=DBB" rel="nofollow">Product Details</a></p>

<p><em>The Invesco DB Base Metals (Fund) seeks to track changes, whether positive or negative, in the level of the DBIQ Optimum Yield Industrial Metals Index Excess Return™ (DBIQ Opt Yield Industrial Metals Index ER or Index) plus the interest income from the Fund&#39;s holdings of primarily US Treasury securities and money market income less the Fund&#39;s expenses. The Fund is designed for investors who want a cost-effective and convenient way to invest in commodity futures. The Index is a rules-based index composed of futures contracts on some of the most liquid and widely used base metals — aluminum, zinc and copper (grade A). You cannot invest directly in the Index. The Fund and the Index are rebalanced and reconstituted annually in November.<br>
This Fund is not suitable for all investors due to the speculative nature of an investment based upon the Fund&#39;s trading which takes place in very volatile markets. Because an investment in futures contracts is volatile, such frequency in the movement in market prices of the underlying futures contracts could cause large losses. Please see &quot;Risk and Other Information&quot; and the Prospectus for additional risk disclosures.</em></p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f832739a77d39001551e99f' id='5f832739a77d39001551e99f'>
<a href='#5f832739a77d39001551e99f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1602430777000' class='quanto-date posted-at response-posted-at' href='#5f832739a77d39001551e99f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Tentor: good point!; @Vladimiar: thanks for the details, that&#39;s great!</p>

<p>Against the background of the discussion, I am wondering whether we might be able to offer the following preliminary conclusions:</p>

<p><strong><em>DBB provides a timely and precise signal of important industrial metal prices</em></strong><br>
The ETF tracks the metals prices directly (via future contracts), which is an advantage vs tracking companies. We are currently not aware of an equally precise alternative that has a long enough price history for proper backtesting. The JJM ETF could eventually become an alternative but currently only has a short price history since it has just been started in 2018.</p>

<p><strong><em>For our ETFs providing the price signals, precision beats liquidity/volume</em></strong><br>
Of course, the ETFs should provide a signal that can be justified on economic grounds, e.g. see Tentor&#39;s UUP signal (&#39;flight to safe haven&#39;) and other signals discussed earlier. Moreover, the signal should be as precise/clean as possible. The minimum requirement is that an ETF provides a price update on a daily basis, i.e. liquidity/trading volume has to allow for this minimum requirement to be met but, beyond this, is of no critical concern since the algo does not aim to trade the price signal ETF.<br>
This means that the algo can use price signals from a very broad universe of available ETFs, providing rich opportunities to identify and add additional signals that improve and/or stabilize the algo&#39;s performance.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f834ba298c5580013204957' id='5f834ba298c5580013204957'>
<a href='#5f834ba298c5580013204957'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1602440098000' class='quanto-date posted-at response-posted-at' href='#5f834ba298c5580013204957'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter Guenther </p>

<p>DBB is not pure Industrial Metals Index ETF.<br>
It holds  aluminum, zinc and copper futures contracts 50% - 60%,<br>
money market funds and T-Bill ETFs 30% - 40%,<br>
US Treasury securities 10% - 20%.</p>

<p>It collateralize its futures positions primarily with US Treasuries,<br>
money market funds and T- Bill ETFs.</p>

<p>Read carefully product details:</p>

<p><em>The Invesco DB Base Metals (Fund) seeks to track changes, whether positive or negative, in the level of<br>
the DBIQ Optimum Yield Industrial Metals Index Excess Return™ (DBIQ Opt Yield Industrial Metals Index<br>
ER or Index) plus the interest income from the Fund&#39;s holdings of primarily US Treasury securities<br>
and money market income less the Fund&#39;s expenses.</em></p>

<p>I disagree with both of yours <a href="https://www.quantopian.com/posts/new-strategy-in-and-out#5f832739a77d39001551e99f" rel="nofollow">preliminary conclusions</a> until you prove in a notebook at least 98%<br>
daily return correlation between DBB and <a href="https://www.spglobal.com/spdji/en/indices/commodities/sp-gsci-industrial-metals/#overview" rel="nofollow">S&amp;P GSCI Industrial Metals Index</a> for last 10 years.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f83666f9886aa0018bc21cc' id='5f83666f9886aa0018bc21cc'>
<a href='#5f83666f9886aa0018bc21cc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1602446959000' class='quanto-date posted-at response-posted-at' href='#5f83666f9886aa0018bc21cc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Vladimir: Oh I see now, sorry I was misreading your point. For the money market instruments and Treasury bills, I always impute &#39;zero return plus a bit&#39; = &#39;not much going on&#39;, but this may not be correct and, indeed, they do seem to constitute a substantial fraction of the DBB. Agreed, correlations would provide a clearer picture here.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f83672a2e7763000f730279' id='5f83672a2e7763000f730279'>
<a href='#5f83672a2e7763000f730279'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1602447146000' class='quanto-date posted-at response-posted-at' href='#5f83672a2e7763000f730279'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>That&#39;s impossible because the S&amp;P index also has nickel and lead in it ;)<br>
Also, I&#39;m too lazy to search for historical data for the index, prepare it and upload it to Q.</p>

<p>But here&#39;s a notebook with correlations for several ETFs and futures (for the timespan prices are available for every asset). The only industrial metal future available in Q seems to be copper, so I included palladium and platinum since their main usage is in the industry sector. I compared the correlations for DDB and XME with the other symbols.<br>
It seems to confirm my claim that DBB is higher correlated to industrial metals than XME.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f837257bae89200124755e5' id='5f837257bae89200124755e5'>
<a href='#5f837257bae89200124755e5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1602450007000' class='quanto-date posted-at response-posted-at' href='#5f837257bae89200124755e5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Another theme that I wanted to discuss; it may have some fit with the question listed earlier &quot;Are we looking at the right benchmark?&quot;:<br>
&quot;In &amp; out&quot;-type of strategies are not unknown to us, indeed they are often an element (sometimes a bit &#39;hidden&#39;) in our algos. One of the key points of this thread and the discussions here might be that there can be value in disentangling an algo&#39;s &quot;in &amp; out&quot; component from the &quot;stock selection&quot; component to understand what each of these components are contributing. It can be worthwhile to assess and optimize each component individually.</p>

<p><strong><em>Benchmark: The death cross</em></strong><br>
It won&#39;t be news for many here: the fantastic “Quality Companies in an Uptrend” strategy has an integrated &quot;in &amp; out&quot;-type component in it, which is the death cross, i.e. a drop of the S&amp;P 500 (SPY) &#39;s short-term moving average below the long-term moving average.<br>
I hope that my coding skills did not let me down and that I am working with the latest version of the algo. However, if everything worked out, the attached backtest should show the returns related to only the &quot;in &amp; out&quot; component (acknowledging that this component is actually more interwoven in the algo since momentum stocks are held beyond &#39;out&#39; conditions).</p>

<p><strong><em>Implications for our discussion here</em></strong><br>
In addition to critically assessing sensitivity and the precision of price signals (see earlier posts), it may be worthwhile to benchmark performance against other popular &quot;in &amp; out&quot; tactics to see whether we add any value at all and, if so, how much.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f837292b5245b0015e2aa5f' id='5f837292b5245b0015e2aa5f'>
<a href='#5f837292b5245b0015e2aa5f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1602450066000' class='quanto-date posted-at response-posted-at' href='#5f837292b5245b0015e2aa5f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>By imposssible I meant the 98 % correlation. Didn&#39;t see Peters post yet, now it seems out of context. I can also imagine that 2 ETFs tracking one and the same index can have a lower correlation because of fees and whatnot.</p>

<p>To be honest I don&#39;t really understand that part of the DBB fact sheet about collateral. However, the correlations I just posted seem to indicate that it&#39;s not the case that half of the performance stems from Tbills and the like. If it were, how can there be a 89 % correlation to copper while the correlations to bond ETFs and futures range from -30 % to -14 %?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f837c0f98c5580013204ba7' id='5f837c0f98c5580013204ba7'>
<a href='#5f837c0f98c5580013204ba7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1602452495000' class='quanto-date posted-at response-posted-at' href='#5f837c0f98c5580013204ba7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter:<br>
MA crosses are always and necessarily lagging, that means when the signal comes to get out you already suffered a drawdown and you might as well have just placed a stop loss instead. In my opinion that&#39;s the value of your approach: most of the time we get out <em>before</em> the drawdown.</p>

<p>A note on the concerns about the sensitivity (I had them too):<br>
I&#39;m working on a strategy trading only futures with only futures and a few stocks as signals (what&#39;s available on the quantiacs platform).<br>
I had to change A LOT of the original algo but the ideas behind the indicators are exactly the same. Of course I did a little tweaking, for instance I got rid of the magic 58: the lookback period for the momentum is determined entirely by SPY&#39;s 126-day volatility (like many changes that one did&#39;t work so well on the stock version). My point is, that allthough there appears to be some sensitivity, the main idea behind the signals looks stable. My best result so far (tested 2008-01-01 to now, slippage+commission = 5 %):</p>

<p>Total Returns:  1083.75 %<br>
Sharpe Ratio:   1.76<br>
Volatility: 0.12<br>
Max Drawdown:   9 %</p>

<p>You can imagine that I&#39;m not that concerned about the sensitivity any more :)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f837f059886aa000ebc2254' id='5f837f059886aa000ebc2254'>
<a href='#5f837f059886aa000ebc2254'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1602453253000' class='quanto-date posted-at response-posted-at' href='#5f837f059886aa000ebc2254'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Tentor Testivis,</p>

<p>You can download S&amp;P GSCI Industrial Metals Index <a href="https://www.spglobal.com/spdji/en/indices/commodities/sp-gsci-industrial-metals/#overview" rel="nofollow">here</a> just choose 10 years then export.</p>

<p>Deutsche Bank DBIQ Optimum Yield Industrial Metals Index Total Return symbol DBCMYTIM</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f838864bae89200114756e8' id='5f838864bae89200114756e8'>
<a href='#5f838864bae89200114756e8'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1602455652000' class='quanto-date posted-at response-posted-at' href='#5f838864bae89200114756e8'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Vladimir:<br>
The correlation is .93  - if you add a 1 to it ;)<br>
But XME&#39;s correlation is even less existent...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f838a320662ef2cc1d612e9' id='5f838a320662ef2cc1d612e9'>
<a href='#5f838a320662ef2cc1d612e9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1602456114000' class='quanto-date posted-at response-posted-at' href='#5f838a320662ef2cc1d612e9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Fascinating, this index is correlated to nothing, what&#39;s supposed to be in it again?<br>
Look at those p-values...<br>
Wait, what&#39;s the null hypothisis again? &quot;There is no correlation&quot; or &quot;This test for correlation has no meaning&quot;?<br>
If it&#39;s the latter, is there another one? The results for Spearman correlation look very similar...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f838fafb5245b000de2acd9' id='5f838fafb5245b000de2acd9'>
<a href='#5f838fafb5245b000de2acd9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1602457519000' class='quanto-date posted-at response-posted-at' href='#5f838fafb5245b000de2acd9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Ok, scipy says:</p>

<blockquote>
<p>The p-value roughly indicates the probability of an uncorrelated system<br>
    producing datasets that have a Pearson correlation at least as extreme<br>
    as the one computed from these datasets.</p>
</blockquote>

<p>So basically, the S&amp;P GSCI Industrial Metals Index is not correlated to copper, palladium, platinum or any of the 2 metal ETFs.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f83acf398c5580013204c6d' id='5f83acf398c5580013204c6d'>
<a href='#5f83acf398c5580013204c6d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1602465011000' class='quanto-date posted-at response-posted-at' href='#5f83acf398c5580013204c6d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Tentor Testivis,</p>

<p>Isn&#39;t -0.067893 weird?<br>
There may be a problem with the date synchronization.<br>
Try S&amp;P GSCI Industrial Metals Index from <a href="https://www.spglobal.com/spdji/en/indices/commodities/sp-gsci-industrial-metals/#overview" rel="nofollow">www.spglobal.com</a>.<br>
Found another metals ETN <a href="https://www.elementsetn.com/ElementsETNUI/RICI-Metals-ETN.aspx" rel="nofollow">&#39;RJZ&#39;.</a><br>
Yahoo symbol for S&amp;P GSCI Industrial Metals Index:<a href="https://finance.yahoo.com/quote/%5ESPGSINTR/chart?p=%5ESPGSINTR#eyJpbnRlcnZhbCI6NSwicGVyaW9kaWNpdHkiOjEsInRpbWVVbml0IjoibWludXRlIiwiY2FuZGxlV2lkdGgiOjEsInZvbHVtZVVuZGVybGF5Ijp0cnVlLCJhZGoiOnRydWUsImNyb3NzaGFpciI6dHJ1ZSwiY2hhcnRUeXBlIjoiaG9sbG93X2NhbmRsZSIsImV4dGVuZGVkIjpmYWxzZSwibWFya2V0U2Vzc2lvbnMiOnt9LCJhZ2dyZWdhdGlvblR5cGUiOiJvaGxjIiwiY2hhcnRTY2FsZSI6InBlcmNlbnQiLCJwYW5lbHMiOnsiY2hhcnQiOnsicGVyY2VudCI6MSwiZGlzcGxheSI6Il5TUEdTSU5UUiIsImNoYXJ0TmFtZSI6ImNoYXJ0IiwiaW5kZXgiOjAsInlBeGlzIjp7Im5hbWUiOiJjaGFydCIsInBvc2l0aW9uIjpudWxsfSwieWF4aXNMSFMiOltdLCJ5YXhpc1JIUyI6WyJjaGFydCIsInZvbCB1bmRyIiwi4oCMdm9sIHVuZHLigIwiXX19LCJzZXRTcGFuIjpudWxsLCJsaW5lV2lkdGgiOjIsInN0cmlwZWRCYWNrZ3JvdW5kIjp0cnVlLCJldmVudHMiOnRydWUsImNvbG9yIjoiIzAwODFmMiIsInN0cmlwZWRCYWNrZ3JvdWQiOnRydWUsInJhbmdlIjpudWxsLCJldmVudE1hcCI6eyJjb3Jwb3JhdGUiOnsiZGl2cyI6dHJ1ZSwic3BsaXRzIjp0cnVlfSwic2lnRGV2Ijp7fX0sImN1c3RvbVJhbmdlIjpudWxsLCJzeW1ib2xzIjpbeyJzeW1ib2wiOiJeU1BHU0lOVFIiLCJzeW1ib2xPYmplY3QiOnsic3ltYm9sIjoiXlNQR1NJTlRSIiwicXVvdGVUeXBlIjoiSU5ERVgiLCJleGNoYW5nZVRpbWVab25lIjoiQW1lcmljYS9OZXdfWW9yayJ9LCJwZXJpb2RpY2l0eSI6MSwiaW50ZXJ2YWwiOjUsInRpbWVVbml0IjoibWludXRlIiwic2V0U3BhbiI6bnVsbH0seyJzeW1ib2wiOiJEQkIiLCJzeW1ib2xPYmplY3QiOnsic3ltYm9sIjoiREJCIn0sInBlcmlvZGljaXR5IjoxLCJpbnRlcnZhbCI6NSwidGltZVVuaXQiOiJtaW51dGUiLCJzZXRTcGFuIjpudWxsLCJpZCI6IkRCQiIsInBhcmFtZXRlcnMiOnsiY29sb3IiOiIjNzJkM2ZmIiwid2lkdGgiOjIsImlzQ29tcGFyaXNvbiI6dHJ1ZSwic2hhcmVZQXhpcyI6dHJ1ZSwiY2hhcnROYW1lIjoiY2hhcnQiLCJzeW1ib2xPYmplY3QiOnsic3ltYm9sIjoiREJCIn0sInBhbmVsIjoiY2hhcnQiLCJmaWxsR2FwcyI6ZmFsc2UsImFjdGlvbiI6ImFkZC1zZXJpZXMiLCJzeW1ib2wiOiJEQkIiLCJnYXBEaXNwbGF5U3R5bGUiOiJ0cmFuc3BhcmVudCIsIm5hbWUiOiJEQkIiLCJvdmVyQ2hhcnQiOnRydWUsInVzZUNoYXJ0TGVnZW5kIjp0cnVlLCJoZWlnaHRQZXJjZW50YWdlIjowLjcsIm9wYWNpdHkiOjEsImhpZ2hsaWdodGFibGUiOnRydWUsInR5cGUiOiJsaW5lIiwic3R5bGUiOiJzdHhfbGluZV9jaGFydCIsImhpZ2hsaWdodCI6ZmFsc2V9fV0sInN0dWRpZXMiOnsidm9sIHVuZHIiOnsidHlwZSI6InZvbCB1bmRyIiwiaW5wdXRzIjp7ImlkIjoidm9sIHVuZHIiLCJkaXNwbGF5Ijoidm9sIHVuZHIifSwib3V0cHV0cyI6eyJVcCBWb2x1bWUiOiIjMDBiMDYxIiwiRG93biBWb2x1bWUiOiIjRkYzMzNBIn0sInBhbmVsIjoiY2hhcnQiLCJwYXJhbWV0ZXJzIjp7IndpZHRoRmFjdG9yIjowLjQ1LCJjaGFydE5hbWUiOiJjaGFydCIsInBhbmVsTmFtZSI6ImNoYXJ0In19LCLigIx2b2wgdW5kcuKAjCI6eyJ0eXBlIjoidm9sIHVuZHIiLCJpbnB1dHMiOnsiaWQiOiLigIx2b2wgdW5kcuKAjCIsImRpc3BsYXkiOiLigIx2b2wgdW5kcuKAjCJ9LCJvdXRwdXRzIjp7IlVwIFZvbHVtZSI6IiMwMGIwNjEiLCJEb3duIFZvbHVtZSI6IiNmZjMzM2EifSwicGFuZWwiOiJjaGFydCIsInBhcmFtZXRlcnMiOnsid2lkdGhGYWN0b3IiOjAuNDUsImNoYXJ0TmFtZSI6ImNoYXJ0IiwicGFuZWxOYW1lIjoiY2hhcnQifX19fQ--" rel="nofollow">^SPGSINTR</a></p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f83b3b1bae8920010475761' id='5f83b3b1bae8920010475761'>
<a href='#5f83b3b1bae8920010475761'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1602466737000' class='quanto-date posted-at response-posted-at' href='#5f83b3b1bae8920010475761'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I think I&#39;m done with the correlating for now. But I also think I got it how the thing with the collateral works. It&#39;s the same as when you want to short a stock: you ask your broker if you can borrow it from him. He says &quot;sure, but I want some collateral in case your position goes bust and you can&#39;t buy it back.&quot; Then you give him money, get the stock and sell it. When you want to close the position you buy the stock, give it back to your broker and get your collateral money back. The only difference to DBB is, that they offer T-Bills as collateral and when they get it back they earned some interest. That&#39;s also why when you look at the weighting on their homepage the weights add up to 200 %. So bonds dont&#39;t have anything to do with the performance of DBB except for a tiny amount of interests added.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f842a4d0662ef0013d631e1' id='5f842a4d0662ef0013d631e1'>
<a href='#5f842a4d0662ef0013d631e1'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1602497101000' class='quanto-date posted-at response-posted-at' href='#5f842a4d0662ef0013d631e1'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Tentor: Excellent work there on multiple fronts!<br>
Also, great hints and comments regarding your revised strategy &quot;In &amp; out -- the back to the futures edition&quot; :)<br>
Amazing returns and nice takeaways, regarding:<br>
 - cleaner price signals are available via futures (e.g., for copper)<br>
 - the cut-off values can be determined empirically (e.g., your point concerning SPY volatility)</p>

<p>I particularly like the clean copper signal. I think that&#39;s how I ended up with the DBB in the first place, since it includes a substantial fraction in copper futures. I think that copper is in high demand, particularly in China, so the futures can be an early signal regarding industrial production there, which usually has global consequences for other countries&#39; economic growth. So, it might be worth a try to increase the reliance on (weight of) the copper signal and see whether it creates additional returns.<br>
Also, great recommendations there regarding adding platinum and palladium.<br>
In the DBB, I was always missing an iron or iron ore price signal. Not sure whether this would add anything, though.</p>

<p><strong><em>Determining critical price drops empirically</em></strong><br>
Regarding the cut-off values and determining them empirically: If I remember correctly, I was determining the 7% drop in the DBB (and XLI) empirically (and then tweaked it a bit) via analyzing percentiles of historic 58-day returns in Excel. I think that the 10% bottom percentile gave me something like an 8.X% drop and this was what I started off with. So this approach might be a way to also empirically determine these cut-off values related to our price signals. I will definitely give it a shot and see what comes out.</p>

<p><strong><em>Improvement opportunity: &#39;In&#39; signals</em></strong><br>
This is a whole different construction site and we do not have to get into this right now, but I was always a bit unhappy that we have these great &#39;out&#39; signals but then the &#39;in&#39; action is based on wait days. So one additional opportunity for improvement may be the quest regarding finding precise signals that tell us when it&#39;s safe to get back into the market. I guess the &#39;death cross&#39; provides this signal via the short-term moving average breaking above the long-term moving average, but Tentor (see an earlier comment) is absolutely right that the death cross&#39;s &#39;out&#39; signal is not particularly useful since it comes too late and then also the &#39;in&#39; signal is probably similarly lagged.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f846bedbae892000d475c0d' id='5f846bedbae892000d475c0d'>
<a href='#5f846bedbae892000d475c0d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1602513901000' class='quanto-date posted-at response-posted-at' href='#5f846bedbae892000d475c0d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter:<br>
Great idea about copper! In my futures version I used the mean of the returns for the Bloomberg Commodity index and for copper. Just now I ran it with only copper and got a Sharpe of 1.81 with 1125 % returns, same DD and vola. So, yes I think copper gives a cleaner signal. But my disclaimer is again: many things that worked on the futures version had an opposite effect on the stocks version.</p>

<p>@Vladimir:<br>
There&#39;s definitely something weird going on. I just plotted the relative prices for DBCMYTIM and copper, they look and move very similar. The prices have a correlation of 98.3 %. So it looks like there is no problem with the date synchronization. I have no idea why the correlation of the returns is so low, I also tried log-returns but it looks similar.<br>
So I downloaded the data for DBB, XME, DBCMYTIM and copper from Yahoo and uploaded it to Q. Here&#39;s the correlation table for the returns, looks more realistic ;)</p>

<p>@Dan:<br>
Perhaps you have an idea what the problem with the custom data and correlations to Q prices might be?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f8480532e776376f772ed31' id='5f8480532e776376f772ed31'>
<a href='#5f8480532e776376f772ed31'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1602519123000' class='quanto-date posted-at response-posted-at' href='#5f8480532e776376f772ed31'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>About the changes I made in my futures algo that didn&#39;t work on equities. My main focus at that time was to improve the futures algo, so I didn&#39;t spend any time on tweaking the same ideas in the equity algo but simply copy-pasted the code there. In case someone wants to try and tweak them, here&#39;s what I did:</p>

<p>Using SPY&#39;s volatility to replace the magic numbers:</p>

<pre><code>
    # assuming you&#39;ve added SPY to the history request  
    vola = hist[SPY].iloc[-126:].pct_change().std() * np.sqrt(252)

    # lose the magic 15 for the waitdays. Basically the higher the vola, the longer we wait to get in.  
    # The idea: high market vola --&gt; dangerous to get in, wait longer!  
    waitdays = int(vola * 100 / 3)

    # replacing the magic 58 as lookback period. The higher SPY&#39;s volatility, the shorter our lookback period.  
    # The idea: high market vola --&gt; prices move faster, so there might be bigger moves in shorter periods.  
    per = int((1 - vola) * 50)  
    mom = hist.iloc[-1] / hist.iloc[-per] - 1


</code></pre>

<p>The multiplication by 100/3 and  by 50 are just the result of running some tests with different values and seeing what worked best. However, they are less sensitive than the 58. Changing them slightly doesn&#39;t result in drastic changes of the returns.</p>

<p>The idea about oil was, that falling oil prices can indicate a market decline - less production, less demand for oil. I thought that this also can work the other way round: Sometimes oil prices rise for political or other reasons like burning oil fields, disputes, wars or whatever. If the demand for oil in the industry remains the same, this means a higher cost for porduction and less earnings.<br>
Here&#39;s what it looks like in the futures algo:</p>

<pre><code>
        # ... &lt;-- here would be all the other conditions  
        or mom[OIL] &lt; -.28  
        or mom[OIL] &gt; .35

</code></pre>

<p>Again, the numbers are the result of what worked best.</p>

<p>One thing I haven&#39;t tried on equities yet is to add VIX to the alternatives. When I did the first run with equal weights, my returns tripled - but also DD and volatility went through the roof. So I ended up with a tiny fraction as weight for VIX and it gave the result a little boost both in Sharpe and returns without increasing vola or DD.</p>

<p>What could also be interesting to know is what I used to replace the ETFs:</p>

<p>DBB - since the last post just the future on copper (before that, the mean returns for copper and the Bloomberg Commodities Index)<br>
XLI - in the quantiacs toolbox you have prices for 500 something stocks, I use the mean returns for those that are in the sector &#39;Industrials&#39;<br>
BIL - future on the 2-year Treasury Note<br>
UUP - future on the USD index<br>
OIL - future on WTI crude oil  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f84c6839886aa0015bc2c7f' id='5f84c6839886aa0015bc2c7f'>
<a href='#5f84c6839886aa0015bc2c7f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb4fc8571ef9572db85c0af'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a8d078cb83e513809bab0e31eabfa4fc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb4fc8571ef9572db85c0af'>Dan Whitnable</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1602537091000' class='quanto-date posted-at response-posted-at' href='#5f84c6839886aa0015bc2c7f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Tentor Testivis  I looked at your notebook for correlations between the DJCI Industrial Metals index and other ETFs (most notably DBB). The problem is the alignment of the self-serve pipeline dates to the <code>get_pricing</code> dates. Remember the pipeline index dates are shifted from the actual &#39;asof dates&#39; and are the date one could have acted on the data. We want to compare the index values with the associated ETF prices on corresponding &#39;asof dates&#39;. So, simply set the pipeline dataframe index to the &#39;asof_date&#39;. </p>

<p>By aligning dates, the correlation between the DJCI Industrial Metals index and DBB is quite high, and closer to what was expected, at 0.87.</p>

<p>See the attached notebook.</p>

<p>BTW, keep up the good work! Great input from everyone here. A lot of very actionable stuff.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5f84df369886aa0015bc2e28' id='5f84df369886aa0015bc2e28'>
<a href='#5f84df369886aa0015bc2e28'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1602543414000' class='quanto-date posted-at response-posted-at' href='#5f84df369886aa0015bc2e28'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Dan:<br>
Thanks, good to know. So I basically did a shifted correlation then. I think I&#39;ll explore that further because such a definite non-correlation looks unexpected to me even for shifted returns. But who knows, perhaps I also messed up something with the data set. Anyway, if I find something interesting in terms of auto- and shifted correlations, I&#39;ll post it here.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f8affbf2e7763630f72fc0a' id='5f8affbf2e7763630f72fc0a'>
<a href='#5f8affbf2e7763630f72fc0a'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1602944959000' class='quanto-date posted-at response-posted-at' href='#5f8affbf2e7763630f72fc0a'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><strong><em>Digression: In &amp; Out with Silver Lining</em></strong><br>
It&#39;s a bit of a digression here but I thought I share it anyway; the plan was actually to experiment with silver and gold as additional signals. They don&#39;t really work or at least I didn&#39;t get them to. However, I discovered a pattern that is bringing the &#39;once in a decade opportunity&#39; (30% drop in SPY) back in, although in a different way.</p>

<p>The mechanics: After the SPY drops by 30%, then once our signals say &#39;in&#39; we invest in silver (via the SLV ETF) instead of the SPY and hold silver until the SPY recovers to its pre-drop level. It&#39;s a digression since the In &amp; Out strategy is actually a clean &#39;market vs bonds&#39; play.</p>

<p>Possible rationale: After a significant market drop, investors may expect that the recovery will take some time and that equities won&#39;t generate substantial or reliable returns over some time. However, at this point, investors are likely to be sitting on cash (pulled out of the market earlier) that they want to invest somehow. They then may turn to precious metals as an alternative investment.<br>
By the way, when large amounts of cash that was spread out over a wide universe of equities flows into a comparably small stock of a precious metal, such as silver, it may be like funnelling huge amounts of water from a very broad pipe into a relatively narrow pipe, with the resulting immense &#39;water pressure&#39; driving up the price/returns :)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f8b12969886aa6700bc3159' id='5f8b12969886aa6700bc3159'>
<a href='#5f8b12969886aa6700bc3159'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1602949782000' class='quanto-date posted-at response-posted-at' href='#5f8b12969886aa6700bc3159'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><strong><em>Earlier theme: Contribution of bonds</em></strong><br>
This is related to Dan&#39;s interesting question above (9 Oct 2020), noting: “Just musing, but it almost seems the signals are really just finding when to get into bonds?”</p>

<p>It looks like bonds are definitely part of the secret sauce that generates the total returns, see the attached backtest. The contribution is positive and at about 123% or 6.50% annually according to the tear sheet. This is much more than I would have intuitively guessed. Interesting!<br>
So, I think the total return of the full strategy was at about 915% (i.e., factor = 1+9.15 = 10.15), the bond factor is 2.23 (i.e., 1+1.23), meaning the factor measuring the contribution of holding the SPY is 4.55 (10.15 / 2.23) or 355%. So, if I am calculating this correctly, it is an approx. 1:3 ratio in terms of bond contribution versus market contribution, i.e. definitely an unexpectedly substantial contribution from bonds here.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f8b187ebae89200104790ab' id='5f8b187ebae89200104790ab'>
<a href='#5f8b187ebae89200104790ab'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1602951294000' class='quanto-date posted-at response-posted-at' href='#5f8b187ebae89200104790ab'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><strong><em>Earlier theme: The cost of being wrong</em></strong><br>
Related to the previous post, Dan (9 Oct 2020) then made an interesting test, swapping bonds with a short on the SPY and the total return came out much smaller. I speculated that this might be due to the &#39;cost of being wrong&#39;, i.e. that we go out of the market but were wrong in doing so and the market moves against us in all of its might.</p>

<p>The attached backtest shows that this speculation is incorrect. The &#39;cost of being wrong&#39; are relatively negligible (-13%) considering the length of the backtest period (12+ years). However, there is a bit of a negative trend, meaning that some cost of being wrong accumulate as we run this in &amp; out strategy over time.<br>
An additional insight is that the &#39;out&#39; signal does not have a large enough precision that we should specifically bet on it via a short on the market. The maximum return that we generate from this bet over the backtest period is at about 60%. Any gains are lost relatively quickly.</p>

<p><strong><em>Conclusion: &#39;out&#39; = signal for return opportunities in alternative assets and possibly investors&#39; crystal ball for market downturns, although these may not actually materialize</em></strong><br>
Open for discussion: Overall, taking this and the previous post together, I think that Dan&#39;s point is very true; the in &amp; out strategy appears to provide a great timing regarding when to take the money out of the market and invest it in alternative assets (bonds). It is not necessarily the case that immense downturns would have awaited us in our market investment since then the short on the SPY would have produced substantial positive total returns. It seems like we are banking in on capturing a psychology change (&#39;jitter&#39;) early that drives up the returns in the alternative assets. The algo appears to be riding this psychological jitter wave :) Greater returns seem to be possible via the jitter wave benefitting alternative assets than via an equity market investment which would only produce small returns during &#39;out&#39; periods.<br>
(In this regard, also see above the &#39;In &amp; Out with Silver Lining&#39; which is riding the jitter wave by investing in silver and for a more extensive period of time than the original In &amp; Out strategy would do.)</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f8b89370662ef0011d669ec' id='5f8b89370662ef0011d669ec'>
<a href='#5f8b89370662ef0011d669ec'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1602980151000' class='quanto-date posted-at response-posted-at' href='#5f8b89370662ef0011d669ec'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This is not a modification of Peter Guenther  “In &amp; Out” but another  algo using Peter Guenther&#39;s<br>
wait days approach.<br>
I am trying to not use seven hard coded variables: (DBB = symbol(&#39;DBB&#39;); context.WAIT_DAYS = 15;<br>
context.RET = 57; thresholds(-0.07, -0.07, -.006, .07)),<br>
because I was taught that <em>&quot;each undisclosed coefficient is the coefficient of our ignorance&quot;</em>.</p>

<p>The goal is to get similar results using as few variables as possible.<br>
I modified Tentor Testivis recommendation to use volatility adaptive calculation of WAIT_DAYS and RET.<br>
I find that union of four factors used in original algo is less reliable as the output is dependent on<br>
any single factor and there may be many of false exit signals.<br>
Therefore, I used price relative ratios for each two factors (bull and bear) and signal as intersection<br>
of them, where the results depend on all four factors (signal conformation).<br>
The factors and variables are not optimized as a strategy itself so you can get better results.<br>
You can also add another pairs of bull and bear factors.</p>

<p>Here is the &quot;Price relative ratios (intersection) with wait days&quot;.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f8ca5869886aa741abc4645' id='5f8ca5869886aa741abc4645'>
<a href='#5f8ca5869886aa741abc4645'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1603052934000' class='quanto-date posted-at response-posted-at' href='#5f8ca5869886aa741abc4645'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Vladimir:</p>

<p>Fantastic! This sounds much more reasonable and robust. This one can be used for live trade.</p>

<p>I will even replace the QQQ with QLD for live. :-)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f8d4dd79886aa6700bc3d42' id='5f8d4dd79886aa6700bc3d42'>
<a href='#5f8d4dd79886aa6700bc3d42'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5bf90591d55c3a004f10b642'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2dcf9a1d7ca1aa9d4a92fbbb59bba090?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5bf90591d55c3a004f10b642'>vidal boreal</a>
</div>
<a UTCms='1603096023000' class='quanto-date posted-at response-posted-at' href='#5f8d4dd79886aa6700bc3d42'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Vladimir:<br>
Great works. Efficient and tidy code. Any reason why the algo works better during 08-09 than 18-19?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f8d4dfe9886aa0015bc6bb6' id='5f8d4dfe9886aa0015bc6bb6'>
<a href='#5f8d4dfe9886aa0015bc6bb6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603096062000' class='quanto-date posted-at response-posted-at' href='#5f8d4dfe9886aa0015bc6bb6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Very cool stuff, this is a brand-new &quot;in &amp; out&quot;-type strategy! Thanks for sharing, Vladimir!</p>

<p>I have just swapped in the SPY as the market to cleanly isolate the in &amp; out returns vs returns related to the stock selection (i.e., QQQ = Nasdaq = tech selection). The algo does a good job in terms of generating excess returns, i.e. we are better placed going in and out of the market following the algo than being always in (465% vs 194%). So this looks very good.</p>

<p>Now, I understand from Thomas&#39;s post that the <strong><em>&#39;vital signs&#39;</em></strong> look good too (i.e., similar to a good heart rate, lung volume etc.). So that is great, thanks for sharing Thomas!</p>

<p>If you are happy to—and others may chip in too—could we also develop a bit of a narrative regarding the <strong><em>&#39;soul&#39;</em></strong> of the algo? What is the conceptual mechanism at work here? Why do these particular price signals/ratios work? For example, why does the ratio of silver returns versus gold returns tell us that we should go out of the market? I know that some traders look at the gold versus silver prices to understand which metal is relatively undervalued and then they go either long or short in gold or silver. Yet, what is the mechanism that translates this dynamic into what will be going on in the equity market?</p>

<p>Just to clarify, this is important: these are not at all meant to be probing questions, instead it&#39;s about discovery. We clearly see <em>that</em> the signals are working in the backtest, so there is no question about that (empirical robustness). Now, we also need a solid narrative regarding <em>why</em> the signals are working (conceptual robustness). That is, why are they early signals of equity downturns or underperformance? Any help developing this conceptual reasoning is greatly appreciated! I do think that this rationale exists, so it&#39;s possibly just a question of spelling it out explicitly.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f8dbd702e77633a8672e93d' id='5f8dbd702e77633a8672e93d'>
<a href='#5f8dbd702e77633a8672e93d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1603124592000' class='quanto-date posted-at response-posted-at' href='#5f8dbd702e77633a8672e93d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here a mini change just want to reduce a lot of &quot;unnecessary&quot; trades. :-)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f8fe0cf0662ef000fd680e0' id='5f8fe0cf0662ef000fd680e0'>
<a href='#5f8fe0cf0662ef000fd680e0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1603264719000' class='quanto-date posted-at response-posted-at' href='#5f8fe0cf0662ef000fd680e0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter Guenther,</p>

<p><em>Yet, what is the mechanism that translates this dynamic into what will be going on in the<br>
equity market?</em></p>

<p>The algorithm does not predict what will happen on the stock market,<br>
rather, it determines what stage of the market cycle we are at.</p>

<p>It is well known that gold is considered a safe-haven asset and many investors turn to it when<br>
the economy starts to struggle.<br>
Gold value usually increases when the market goes down.<br>
Whether it is futures, bullions, coins  etc., gold is the go-to asset in times of economic stress.  </p>

<p>Gold daily moves has slightly negative correlation to equity market daily moves especially in bear market.<br>
Silver daily moves has more than 80% correlation to Gold as they are in the same asset class.<br>
But silver daily moves has positive correlation to equity market daily moves.</p>

<p>When gold goes up and silver goes down their price relative ratio changing faster and may signal<br>
regime change earlier then momentum of any of them... </p>

<p>@Thomas Chang,</p>

<p>As I mention above: <em>The factors and variables are not optimized as a strategy itself so you can<br>
get better results.</em><br>
You made two additions that substantially improve performance.<br>
Thank you for sharing.</p>

<p>Many a little makes a mickle.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f91fcc1ab55ee0017e26064' id='5f91fcc1ab55ee0017e26064'>
<a href='#5f91fcc1ab55ee0017e26064'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb4fc8571ef9572db85c0af'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a8d078cb83e513809bab0e31eabfa4fc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb4fc8571ef9572db85c0af'>Dan Whitnable</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1603402945000' class='quanto-date posted-at response-posted-at' href='#5f91fcc1ab55ee0017e26064'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Everyone, again great work and truly appreciate the collaboration and sharing of ideas. Peter, you deserve a big thank you and &#39;well done&#39; getting it all started.</p>

<p>Here is another iteration which incorporates Tentor Testivis&#39;s market volatility to determine when to get back into the market. It also builds on Vladimir and Thomas Chang&#39;s ideas of ratio&#39;s to eliminate some of the constants. However, I made a simplification, and rather than ratios, I use a basic comparison. In the end it reduces to three simple rules:</p>

<pre><code>    bear_signal = (  
                   (gold_returns &gt; silver_returns) and  
                   (utility_sector_returns &gt; industrial_sector_returns) and  
                   (industrial_metals_returns &lt; dollar_returns)  
                   )

</code></pre>

<p>I think this is close to Peter&#39;s original intent just more distilled. It also aligns closely with conventional wisdom and includes both &#39;sentiment&#39; and &#39;economic&#39; indicators. Traders sentiment favors gold and utilities if the market isn&#39;t looking good. Industrial metal prices tend to go down with less demand which points to lower markets.</p>

<p>See attached.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5f921e02c441c4000e360927' id='5f921e02c441c4000e360927'>
<a href='#5f921e02c441c4000e360927'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/554e33a53173e6978f00024e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/97bc0ec83d1503d714350b3a67abc5a6?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/554e33a53173e6978f00024e'>Damiano Bolzoni</a>
</div>
<a UTCms='1603411458000' class='quanto-date posted-at response-posted-at' href='#5f921e02c441c4000e360927'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>All,<br>
great tweaking to this algorithm! It&#39;s a killer! I&#39;m still not &quot;sold&quot; on the DBB ETF though....it has almost no effect between 2015 and 2020 on returns...while during 2010-2015 one could double returns....</p>

<p>If one loved leveraged ETFs could have made a fortune with this :-)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9260e1fd8c020014df1416' id='5f9260e1fd8c020014df1416'>
<a href='#5f9260e1fd8c020014df1416'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1603428577000' class='quanto-date posted-at response-posted-at' href='#5f9260e1fd8c020014df1416'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here is &quot;Intersection of ROC comparison using OUT_DAY approach,<br>
Based on:<br>
Peter Guenther&#39;s OUT_DAY approach.<br>
Vladimir&#39;s <a href="https://www.quantopian.com/posts/new-strategy-in-and-out#5f8b89370662ef0011d669ec" rel="nofollow">&quot;Price relative ratios (intersection) with wait days&quot;.</a><br>
Thomas Chang changed BASE_RET parameter and reduced number of &quot;unnecessary&quot; trades.<br>
Dan Whitnable added another pair and changed Price relative ratios (intersection) with<br>
intersection of ROC comparison what removed one more constant.</p>

<p>@Dan, Thank you for sharing.</p>

<p>Many a little makes a mickle.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9440b1c441c400123614ab' id='5f9440b1c441c400123614ab'>
<a href='#5f9440b1c441c400123614ab'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603551409000' class='quanto-date posted-at response-posted-at' href='#5f9440b1c441c400123614ab'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I absolutely agree with what Dan said: great thinking, innovation, and collaboration in this thread. Very inspiring and dedicated, hard work toward the <em>let’s get rich together</em> objective, very nice! :)<br>
There are interesting schools of thought emerging and, I reckon, a lot of potential for others to join in and help develop these further.</p>

<p><strong><em>Vladimir’s relative price ratios</em></strong><br>
Intriguing idea to work with asset pairs that usually are highly correlated but have divergent correlation when things begin to go pear shaped in the equity market. See Vladimir’s gold/silver argument above and the industrials/utilities pairing. Very nice work, also in terms of developing the algo further!</p>

<p><strong><em>Dan’s comparative returns across price signals</em></strong><br>
Great point that the ratios come down to being returns comparisons and also intriguing idea regarding playing the signals directly by comparing their returns, and to distil signals. The total return of the algo is smashing and the max drawdown is small, very nice!</p>

<p><strong><em>In &amp; Out with sampled percentiles</em></strong><br>
Very much inspired by earlier contributions and comments from Tentor, Vladimir, Dan, Thomas, and others, I am also experimenting with reducing the number of fixed parameters in the original code. In the attached backtest, the focus basically is on getting rid of the price signal cut-off values (-7% or 60 basis points) and replacing them with empirically determined cut-off values via statistical percentiles.<br>
<strong>Mechanics</strong>: I hope that my coding skills did not let me down, but here is the intention; For the signals, the algo creates a sample of empirically observed returns over the past year (see returns_sample). The returns are determined via a price comparison of the current price and a shifted average price. The shift is about three months (5 trading days/week x 4 weeks/month x 3 months = 60 days) and the average is calculated using the prices in the +/- 5 day-window surrounding the shift (see hist_shift). The algo then checks whether a signal’s current return is an extreme return, which would provide us with an ‘out’ signal. Here we draw on statistics and science practice: Imagine the observed returns come from a distribution (e.g. a bell curve), then a typical cut-off value for a highly significant extreme observation is the 1% left-most tail of that distribution (often referred to as alpha = 1%). Therefore, the algo checks whether a signal’s current return falls into the 1% bottom percentile (see pctl_b and extreme_b). Note, dollar returns are reverse coded (line 62) so that extremely large returns (= flight to safe haven) fall into the bottom and not the top percentile.<br>
<strong>Additional notes</strong><br>
<em>Wait days</em>: I was also experimenting with updating the wait days empirically using a percentile logic. Extremely large and small returns may indicate ‘wild weather ahead’, so the algo works with the SPY returns’ absolute difference from the historic median returns (note that the median is equivalent to a percentile of 50; see spy_diff_from_median and the abs(percentile – 50) logic). This is only in the early stages, but the idea is to create a factor that then reduces (in the case of ‘calm weather’) or increases (‘wild weather’) the 15 base wait days (for a draft factor, see line 70), similar to Tentor’s volatility approach (also see Dan’s and Vladimir’s algos). I think that the current operationalization still stays very close to the initial 15 wait days. In fact, the returns currently may be better or not much worse if you hardwire the wait days to 15 days.<br>
<em>Lazy trader</em>: Since the In &amp; Out algo is intended to be a skeleton in which you can integrate your stock selection strategy (e.g., search for “Amazing returns = superior stock selection strategy + superior in &amp; out strategy” in the “Quality Companies in an Uptrend” thread), and because I am a lazy trader (once a week for the stock selection), I have kept the ‘in’ schedule function at ‘end of the week/Fridays’ (line 52). Setting it to daily may slightly improve the returns, which is then the fair reward for more switched on trading.</p>

<p>@Tentor: I have expanded the signals by prices for natural resources (ETF IGE) and this has helped the total returns a bit. When using fixed cut-offs, I think that it worked fine with the -7%. It may be worth a try to add the signal to your futures strategy.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f949832ab55ee34e2e26d60' id='5f949832ab55ee34e2e26d60'>
<a href='#5f949832ab55ee34e2e26d60'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5eec52dd8b9b6d0044373dbe'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d818372f42cb67c36faa6506d9e98148?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5eec52dd8b9b6d0044373dbe'>Radu Spineanu</a>
</div>
<a UTCms='1603573810000' class='quanto-date posted-at response-posted-at' href='#5f949832ab55ee34e2e26d60'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I implemented one of the momentum strategies from Quality Cos in uptrend and it performed worse than just holding SPY. Any ideas what&#39;s happening?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f94e216cb90f0000d05edaf' id='5f94e216cb90f0000d05edaf'>
<a href='#5f94e216cb90f0000d05edaf'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54f04b41a544aa8c34000289'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5a98c6e18424e6ac38702c35d5152669?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54f04b41a544aa8c34000289'>Chris Liu</a>
</div>
<a UTCms='1603592726000' class='quanto-date posted-at response-posted-at' href='#5f94e216cb90f0000d05edaf'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>6 indicators: XLI, DBB,  BIL,  UUP,  15 Days waiting, SPY Drop 30%.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f95292e99d0b900102eac31' id='5f95292e99d0b900102eac31'>
<a href='#5f95292e99d0b900102eac31'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1603610926000' class='quanto-date posted-at response-posted-at' href='#5f95292e99d0b900102eac31'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Why you use the 21 for Days waiting? It veries,  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f953e379b972e000f7cd1eb' id='5f953e379b972e000f7cd1eb'>
<a href='#5f953e379b972e000f7cd1eb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603616311000' class='quanto-date posted-at response-posted-at' href='#5f953e379b972e000f7cd1eb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Radu: Thanks for sharing this result! I reckon the stock selection component and in &amp; out component can have synergies or there can be dissonance (what we observe here). Using the original In &amp; Out code (beginning of the thread) pushes the &quot;Quality Co in an Uptrend&quot; strategy from 450% to 1060% (backtest to the post &quot;Amazing returns = superior stock selection strategy + superior in &amp; out strategy&quot;). Your code still pushes from 450% to 600%, but indeed some returns got lost. It may be worth a try without the new natural resources signal (context.NRES).<br>
What you also could try is to implement the &quot;Quality Co in an Uptrend&quot; strategy more fully: the original strategy holds stocks that continue to be in an uptrend even though the in &amp; out indicator says &#39;out&#39;. This might be an important secret sauce which a hard move &#39;out&#39; of the market interferes with.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f956989cb90f02acf05e1b9' id='5f956989cb90f02acf05e1b9'>
<a href='#5f956989cb90f02acf05e1b9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603627401000' class='quanto-date posted-at response-posted-at' href='#5f956989cb90f02acf05e1b9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Radu: One thing that&#39;s also true is that a tech stock selection would have generated superior returns in the past decade, see Vladimir&#39;s codes based on trading the QQQ. I ran three tests, all resulted in +1000% returns for the different in &amp; out-type strategies that we currently have on offer (backtest timeframe 1 Jan 2008 to 16 Oct 2020):<br>
Vladimir&#39;s ROC: +1258%<br>
In &amp; Out with sampled percentiles: +1333%<br>
Dan&#39;s smashing in &amp; out algo: + 1751%</p>

<p>One idea: could you focus the universe for the &quot;Quality Cos in an Uptrend&quot; population on the tech sector, e.g. by using the appropriate Morningstar sectors? Would be interesting to see the returns of this &quot;Quality Tech Cos in an Uptrend&quot; strategy.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f95740bab55ee000de274c3' id='5f95740bab55ee000de274c3'>
<a href='#5f95740bab55ee000de274c3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a2a62a2edcac200115be001'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4baf6920478822f7bb12a12b47abb235?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a2a62a2edcac200115be001'>Anton Flygare</a>
</div>
<a UTCms='1603630091000' class='quanto-date posted-at response-posted-at' href='#5f95740bab55ee000de274c3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Great work by Peter and other contributors! As I&#39;m new to Quantopian, take what I say with a grain of salt. With that said, I&#39;m curious in where the  determination of the lower percentile comes from @Peter Guenther. Would it be possible to plot the returns in a histogram without this filter and therefore determine appropriate precentile settings, or how did you get to this number of 1%? I&#39;m thinking in regards to drawdowns, if this number could be optimized to further decrease the drawdowns, hopefully dynamically to adjust to the market, as you mentioned.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f95ac5efb26c70013f23229' id='5f95ac5efb26c70013f23229'>
<a href='#5f95ac5efb26c70013f23229'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603644510000' class='quanto-date posted-at response-posted-at' href='#5f95ac5efb26c70013f23229'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Anton: thanks for joining in! The 1% comes from statistics and research practice regarding what is considered a <em>highly significant</em> observation or, in our case, an extremely negative return. Another popular threshold is 5% for a <em>significant</em> observation. <a href="https://statisticsbyjim.com/hypothesis-testing/hypothesis-tests-significance-levels-alpha-p-values/" rel="nofollow">Here</a> is a website that discusses alpha (in terms of the statistical significance level) and distributions in the context of hypotheses testing. The algo is similar to the logic of a one-tailed significance test, asking: is the current return so negative that it falls into the 1% extreme bottom of the sampled returns distribution (= is it an extreme observation)?</p>

<p>Since we only want to go ‘out’ when things are really going pear shaped, the algo looks for highly significant negative return observations. When we use a larger statistical alpha, we will be going ‘out’ more often and the returns may suffer (although this would needed to be tested). I reckon considering one-tailed and two-tailed tests, one could possibly justify the following increments for the statistical significance level, alpha: <em>0.5</em> (=1%, two-tailed test), <em>1</em> (=1%, one-tailed test), <em>2.5</em> (=5%, two-tailed test), and <em>5</em> (=5%, one-tailed test). I suppose it would be difficult to justify alpha values in-between these increments.</p>

<p>Absolutely, one could experiment with switching the alpha level dynamically (ideally using the fixed increment levels above), being stricter during certain times and being more lenient during other times. Actually, that would be quite interesting to see some results based on such a switching logic!</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f95e152cb90f01b6505ed67' id='5f95e152cb90f01b6505ed67'>
<a href='#5f95e152cb90f01b6505ed67'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5eec52dd8b9b6d0044373dbe'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d818372f42cb67c36faa6506d9e98148?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5eec52dd8b9b6d0044373dbe'>Radu Spineanu</a>
</div>
<a UTCms='1603658066000' class='quanto-date posted-at response-posted-at' href='#5f95e152cb90f01b6505ed67'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter, removing NRES lowered performance from 604% to 503% so it looks like a good signal.</p>

<p>I combined @Vladimir&#39;s algo with cos in uptrend and got 1500% returns with -18% max drawdown which is incredibly impressive.</p>

<p>Lastly, I created this frankestein of your approach, Vladimir&#39;s approach, and co in uptrend and managed to get -15% drawdown with 972% returns .</p>

<p>In your opinion, how important is 4% less drawdown, 0.33 lower beta, and a bit less volatility? Is it worth the tradeoff from 1500% to 972%?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f95ed46ab55ee0015e276a4' id='5f95ed46ab55ee0015e276a4'>
<a href='#5f95ed46ab55ee0015e276a4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603661126000' class='quanto-date posted-at response-posted-at' href='#5f95ed46ab55ee0015e276a4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Radu: Great, thanks for sharing these results! It sounds like Vladimir&#39;s algo perfectly combines with the Quality Co in Uptrend stock selection, producing amazing returns. I reckon for this difference in returns (1500% vs 972%) I would not worry too much about the drawdown difference. A lower beta is great, of course, since the algo is more resistant to market swings, but one seems to &#39;pay&#39; for this via a (substantially) lower return. So, it depends on your risk/return preference: a one third greater vulnerability to market swings for an additional 3.7% return reward per year ... may be worth the risk.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f95fddfab55ee000ce27734' id='5f95fddfab55ee000ce27734'>
<a href='#5f95fddfab55ee000ce27734'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5eec52dd8b9b6d0044373dbe'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d818372f42cb67c36faa6506d9e98148?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5eec52dd8b9b6d0044373dbe'>Radu Spineanu</a>
</div>
<a UTCms='1603665375000' class='quanto-date posted-at response-posted-at' href='#5f95fddfab55ee000ce27734'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Peter! Really appreciate your guidance.</p>

<p>I tried two more things, based on Dan&#39;s suggestions above. Removed bonds to see how much that affects returns and that yielded 615%. Then shorted SPY and that yielded 327%.</p>

<p>Increase in bonds seem to be a big part of the algo. Is it safe to ssume treasuries are going to act in a similar in the future, or are we living in a new world where bonds don&#39;t work anymore?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f968bfdfd8c02000edf2bb7' id='5f968bfdfd8c02000edf2bb7'>
<a href='#5f968bfdfd8c02000edf2bb7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5f8824d52e7763001773270e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/231097d8d87fd0ceed4beb086591296a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5f8824d52e7763001773270e'>Leandro Maia</a>
</div>
<a UTCms='1603701757000' class='quanto-date posted-at response-posted-at' href='#5f968bfdfd8c02000edf2bb7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi! I&#39;m new to Quantopian, and still trying to understand how things works. Just read through this whole thread.</p>

<p>@Radu: Your last results seem quite interesting. Great work. Would you mind sharing your combination of &quot;@Vladimir&#39;s algo with cos in uptrend&quot; (1500% return)? I&#39;m not yet confident to put them together by myself...  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f969379fb26c75775f2221d' id='5f969379fb26c75775f2221d'>
<a href='#5f969379fb26c75775f2221d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603703673000' class='quanto-date posted-at response-posted-at' href='#5f969379fb26c75775f2221d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Leandro: welcome on board!</p>

<p>@Radu: very valid question, I reckon for backtests that is <em>the</em> question: are we sufficiently confident that the future will look like the past? There can only be opinions about this since no one can predict the future, so here is my opinion: the past decade was characterized by cheap debt capital, which fuelled company growth and margin-based trading (trading with borrowed money). Due to the Covid crisis my assumption would be that the next, at least, half a decade will look very similar. So, it could be valid to say that the (near) future is likely to look like the past. Now, the bonds basket generated excess returns in the past despite it being the environment that is was (e.g., low interest). So, I would assume that this basket can also generate excess returns in the (near) future.<br>
In terms of testing to increase our confidence, you could look only at the recent past (e.g. 1-3 years) and see how the bonds basket is performing. This might give a more relevant indication regarding the likely near-term performance. Also, in the &quot;Quality Companies in an Uptrend&quot; thread Frank Sch indicates (his post on 17 Oct) that adding 10% gold to the basket improves performance, so there is definitely optimization potential regarding what alternative assets we hold when being &#39;out&#39; of the equity market.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f96976e9b972e00107cda37' id='5f96976e9b972e00107cda37'>
<a href='#5f96976e9b972e00107cda37'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58e7edff823f7e000d6ffc46'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/aedc677aa4d38ca8cc56d0f1d035afd3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58e7edff823f7e000d6ffc46'>Patrick Marum</a>
</div>
<a UTCms='1603704686000' class='quanto-date posted-at response-posted-at' href='#5f96976e9b972e00107cda37'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi all,</p>

<p>I have trouble understanding the following line of code:</p>

<pre><code>vola = data.history(MKT, &#39;price&#39;, VOLA + 1, &#39;1d&#39;).pct_change().std() * np.sqrt(252)  
</code></pre>

<p>where <em>np.sqrt(256)</em>  equals 16.</p>

<p>Why not multiply directly by the value 16.</p>

<p>What does this value of 16 mean?</p>

<p>thx  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f969c4cfd8c020013df2bb7' id='5f969c4cfd8c020013df2bb7'>
<a href='#5f969c4cfd8c020013df2bb7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1603705932000' class='quanto-date posted-at response-posted-at' href='#5f969c4cfd8c020013df2bb7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>252 != 256 :-/  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f969d3d99d0b900122eb48d' id='5f969d3d99d0b900122eb48d'>
<a href='#5f969d3d99d0b900122eb48d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/58e7edff823f7e000d6ffc46'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/aedc677aa4d38ca8cc56d0f1d035afd3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/58e7edff823f7e000d6ffc46'>Patrick Marum</a>
</div>
<a UTCms='1603706173000' class='quanto-date posted-at response-posted-at' href='#5f969d3d99d0b900122eb48d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>just Thomas Chang.<br>
sqrt(252) = 15.8745079</p>

<p>So, what mean to use the value 15.8745079<br>
What does this value mean ?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f96a3c9ab55ee0019e27b3b' id='5f96a3c9ab55ee0019e27b3b'>
<a href='#5f96a3c9ab55ee0019e27b3b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1603707849000' class='quanto-date posted-at response-posted-at' href='#5f96a3c9ab55ee0019e27b3b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I think the 15.8745079 has little meaning but the sqrt(252) does have meaning.</p>

<p>Maybe you could google somwhat like &quot;how to calculate the anual volatility&quot;? The trade days in a year is normally 252 days. You could use 250 or 260. But this makes little difference.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f974b4ffd8c020014df2fa2' id='5f974b4ffd8c020014df2fa2'>
<a href='#5f974b4ffd8c020014df2fa2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603750735000' class='quanto-date posted-at response-posted-at' href='#5f974b4ffd8c020014df2fa2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Attached is a backtest for the latest version of the In &amp; Out algo. You will notice that it&#39;s a real &#39;fusion kitchen&#39;, combining the percentiles, return comparisons, and relative ratios in one algo.</p>

<p><strong><em>In &amp; Out with sampled percentiles, return comparisons, and relative ratios</em></strong><br>
The new algo components are the return comparisons between the pairs gold vs silver and utilities vs industrials (lines 70-73), see Vladimir’s and Dan’s algos. These provide additional ‘out’ signals if the return difference of the pair is highly significant (1% percentile; the return differentials are reverse coded so that large excess returns end up in the bottom percentile).<br>
The flexibly defined wait days are now also determined by the pairs, specifically by the pairs’ return ratios which are multiplied with the initial 15 wait days (line 80). The maximum of 1, the gold/silver return ratio, and the utilities/industrials return ratio determine the multiplier. So that there is some ‘memory’ in the multiplier (i.e., to allow for some persistence when ratios have been elevated), 50% of the prior period’s multiplier is fed back in (see 0.50*context.adjwaitdays). This allows for a somewhat slower decay of elevated levels, since we may want to be cautious during such times and stay out of the market for that little bit longer.</p>

<p>For a tech stock selection strategy (QQQ), the algo yields 1383%.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f978936c441c400113628ba' id='5f978936c441c400113628ba'>
<a href='#5f978936c441c400113628ba'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54f04b41a544aa8c34000289'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5a98c6e18424e6ac38702c35d5152669?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54f04b41a544aa8c34000289'>Chris Liu</a>
</div>
<a UTCms='1603766582000' class='quanto-date posted-at response-posted-at' href='#5f978936c441c400113628ba'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi @Vladimir, your latest algorithm holds TLT and IEF from Feb to July in 2020.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f985d23c441c40011362f9c' id='5f985d23c441c40011362f9c'>
<a href='#5f985d23c441c40011362f9c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1603820835000' class='quanto-date posted-at response-posted-at' href='#5f985d23c441c40011362f9c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>One could easily push on this strategy. Its protective measure is built in its switching to safety procedure. By allowing some leverage (gross leverage: 1.48x), the strategy could end with 600x its original investment. Here is what I got starting with 1 million:</p>

<p>Settings:  From 2008-01-01 to 2020-10-16 with $1,000,000 initial capital</p>

<p>Total Returns<br>
61617.68%  </p>

<p>Benchmark Returns<br>
205.64%  </p>

<p>Alpha<br>
0.68  </p>

<p>Beta<br>
0.32  </p>

<p>Sharpe<br>
1.74  </p>

<p>Sortino<br>
2.80  </p>

<p>Volatility<br>
0.32  </p>

<p>Max Drawdown<br>
-26.89%</p>

<p>The added performance is more than enough to pay for the leveraging fees.</p>

<p>The average trade duration is about 7.2 months. </p>

<p>The higher return would come with the acceptance of a higher drawdown. However, higher drawdowns are relatively short-lived. Average drawdown is more in the vicinity of -10%.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9887c9ab55ee0012e2877d' id='5f9887c9ab55ee0012e2877d'>
<a href='#5f9887c9ab55ee0012e2877d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1603831753000' class='quanto-date posted-at response-posted-at' href='#5f9887c9ab55ee0012e2877d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Guy,</p>

<p>Welcome to the club.<br>
Which strategy (there are at least 5 versions) and which tradeable symbols did you use?<br>
I can see that your Sharpe ratio is 1.74, and it doesn&#39;t depend on leverage.<br>
What else did you do?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f988ec2ab55ee0019e2884c' id='5f988ec2ab55ee0019e2884c'>
<a href='#5f988ec2ab55ee0019e2884c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603833538000' class='quanto-date posted-at response-posted-at' href='#5f988ec2ab55ee0019e2884c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Guy: Fantastic, thanks for sharing these results. Also, great questions there from Vladimir!<br>
I agree that leverage can be an efficient way to boost returns. I suppose it depends on people&#39;s return/risk preference whether this is a suitable way forward for them. It also depends on how confident we are that the future will look like the past. Any breaks mean that leveraging could painfully backfire. Of course, then again, 1.5 leverage does not sound like going completely overboard.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f989671fd8c020010df3978' id='5f989671fd8c020010df3978'>
<a href='#5f989671fd8c020010df3978'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603835505000' class='quanto-date posted-at response-posted-at' href='#5f989671fd8c020010df3978'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><strong><em>Updated: In &amp; Out with sampled percentiles, return comparisons, and relative ratios</em></strong><br>
Today, I was trying a new pairing: safe-haven currency vs risk-on currency. The Swiss Franc (ETF FXF) / Australian Dollar (ETF FXA) pair produced some useful results, so I have added the pair to the returns comparison (line 75) as a separate possible &#39;out&#39; signal and as a ratio determining the wait days (line 83).<br>
The total returns have officially passed the 1,000% mark, see the attached backtest :)</p>

<p>Using a tech stock selection strategy (QQQ) yields 1,541%.</p>

<p>Note: with the strategy we are &#39;out&#39; of the market for quite a bit. It seems to be OK when our stock selection is solely to hold the market via the SPY. If you have a more sophisticated stock selection strategy, it now really comes down to testing regarding how the &#39;in&#39; and &#39;out&#39; moves interfere with, or complement, your selection strategy. In comparison, Dan&#39;s algo and Vladimir&#39;s algo(s) are &#39;in&#39; the market more extensively and this may in fact increase the returns of your stock selection strategy. For instance, see above, Radu reported returns of 1,500% from combining Vladimir&#39;s ROC, as the in &amp; out component, with the &quot;Quality Companies in an Uptrend&quot; stock selection strategy.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9896e99b972e00107ce756' id='5f9896e99b972e00107ce756'>
<a href='#5f9896e99b972e00107ce756'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5eec52dd8b9b6d0044373dbe'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d818372f42cb67c36faa6506d9e98148?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5eec52dd8b9b6d0044373dbe'>Radu Spineanu</a>
</div>
<a UTCms='1603835625000' class='quanto-date posted-at response-posted-at' href='#5f9896e99b972e00107ce756'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter tried your latest version with quality cos in uptrend and starting from 2012 and it seems to underperform. @Vladimir&#39;s algo&#39;s running right now starting from 2012 and it&#39;s outperforming. @Vladimir&#39;s version would be out of the market until July 2020 though.</p>

<p>Just some observations.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9897ddc441c4113d36210c' id='5f9897ddc441c4113d36210c'>
<a href='#5f9897ddc441c4113d36210c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5eec52dd8b9b6d0044373dbe'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d818372f42cb67c36faa6506d9e98148?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5eec52dd8b9b6d0044373dbe'>Radu Spineanu</a>
</div>
<a UTCms='1603835869000' class='quanto-date posted-at response-posted-at' href='#5f9897ddc441c4113d36210c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>What is interesting is that @Vladimir&#39;s version, which is supposed to be more aggressive, has less drawdown starting from 2012.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f98acd69b972e000d7ce89e' id='5f98acd69b972e000d7ce89e'>
<a href='#5f98acd69b972e000d7ce89e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1603841238000' class='quanto-date posted-at response-posted-at' href='#5f98acd69b972e000d7ce89e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter Guenther,</p>

<p><em>In &amp; Out with sampled percentiles, return comparisons, and relative ratios.</em></p>

<p>Very interesting way of calculating adaptive momentum.<br>
Very good performance metrics.<br>
In my opinion, the range of <em>context.adjwaitdays</em> is too wide (15-80000), is this by design?<br>
Look at Custom Data in attached backtest.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f98b131fb26c70010f245bb' id='5f98b131fb26c70010f245bb'>
<a href='#5f98b131fb26c70010f245bb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1603842353000' class='quanto-date posted-at response-posted-at' href='#5f98b131fb26c70010f245bb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Vladimir, I used your version (starting with the best). </p>

<p>I added stocks, part of QQQ, that I have traded prior to the simulation&#39;s start date making them in some way acceptable choices. As you know, QQQ is averaging stuff out. It is technology weighted (close to 70%) and includes highly liquid stocks (needed to get in and out on a dime), especially when the equity grows larger with time. I added 4 stocks and DIA to corroborate QQQ. You could add more. The expected impact was to add volatility to the overall portfolio.</p>

<p>I also added code to evaluate leveraging fees which were set at 4%. (IB charges 0.78%).</p>

<p>The strategy did not need a stop loss since it is technically built-in. It switches to bonds at the first hint of market turmoil. The reason why I used unbalanced leveraging.</p>

<p>Here is the outcome of my last version, also with 1 million initial capital.</p>

<p>Total Returns<br>
73212.77%  </p>

<p>Benchmark Returns<br>
205.64%  </p>

<p>Alpha<br>
0.70  </p>

<p>Beta<br>
0.35  </p>

<p>Sharpe<br>
1.76  </p>

<p>Sortino<br>
2.80  </p>

<p>Volatility<br>
0.32  </p>

<p>Max Drawdown<br>
-29.61%</p>

<p>This new version has a gross leverage of 1.43x with<br>
an average trade duration of 7.4 months. Notice the relatively low beta for such a high CAGR scenario.</p>

<p>Total profits came in at: $713,603,533. Therefore, the strategy ends with over 700x its original investment.</p>

<p>The estimated cost of leveraging was: $17,409,116 which is about 2.4% of the generated profits. As was said, there was more than sufficient profits to pay for the added leveraging costs. </p>

<p>One could do even better with little effort.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f98bfcfcb90f0000d06068e' id='5f98bfcfcb90f0000d06068e'>
<a href='#5f98bfcfcb90f0000d06068e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1603846095000' class='quanto-date posted-at response-posted-at' href='#5f98bfcfcb90f0000d06068e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Finished the last post saying: “<em>One could do even better with little effort</em>.”<br>
To corroborate this, here is the next test performed.</p>

<p>Total Returns<br>
82966.05%</p>

<p>Benchmark Returns<br>
205.64%</p>

<p>Alpha<br>
0.71</p>

<p>Beta<br>
0.38</p>

<p>Sharpe<br>
1.75</p>

<p>Sortino<br>
2.75</p>

<p>Volatility<br>
0.33</p>

<p>Max Drawdown<br>
-31.89%</p>

<p>This version also had a gross leverage of 1.43x with a slight increase in its average trade duration to 7.6 months.</p>

<p>Total profit came in at: $812,383,496. A $98,779,963 increase compared to the previous version.</p>

<p>The estimated cost of leveraging was: $17,539,744, an increase in fees of $130,628 to gain $98,779,963. More than an acceptable compromise.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f98d989ab55ee0017e28a1f' id='5f98d989ab55ee0017e28a1f'>
<a href='#5f98d989ab55ee0017e28a1f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5eec52dd8b9b6d0044373dbe'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d818372f42cb67c36faa6506d9e98148?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5eec52dd8b9b6d0044373dbe'>Radu Spineanu</a>
</div>
<a UTCms='1603852681000' class='quanto-date posted-at response-posted-at' href='#5f98d989ab55ee0017e28a1f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Guy: How did you pick those four stocks? The reason I added quality cos in uptrend was to avoid an assumption that QQQ will have similar returns for the next decade. Meaning, is there a belief that those four will continue to go up, or something else?</p>

<p>Vanilla QQQ vs quality cos in uptrend has super similar returns, and perhaps holding QQQ has partial long term tax benefits.</p>

<p>On a separate note, does anyone have any suggestions on how this strategy could be used on a long term portfolio? Was thinking that since financial advisors take 1% or similar would it be possible to use that 1% to perhaps buy options on TLT/IEF to avoid large drawdowns? Any suggestions in that direction?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f98feb4401251000ec175b0' id='5f98feb4401251000ec175b0'>
<a href='#5f98feb4401251000ec175b0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571cecf6a5c5baa9f500002e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/46041da1752043608f246f126bedb245?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571cecf6a5c5baa9f500002e'>Elsid Aliaj</a>
</div>
<a UTCms='1603862196000' class='quanto-date posted-at response-posted-at' href='#5f98feb4401251000ec175b0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>can somebody explain all these dumb single -2 +2 trades is it trying to rebalance? Seems kind of useless and annoying.... Also anybody thinking of porting this to QC and running this live?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9901c599d0b913db2ebf8b' id='5f9901c599d0b913db2ebf8b'>
<a href='#5f9901c599d0b913db2ebf8b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54f04b41a544aa8c34000289'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5a98c6e18424e6ac38702c35d5152669?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54f04b41a544aa8c34000289'>Chris Liu</a>
</div>
<a UTCms='1603862981000' class='quanto-date posted-at response-posted-at' href='#5f9901c599d0b913db2ebf8b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi @Guy,<br>
The extraordinary performance makes me doubt if the stock selection is falling into the forward looking bias pit.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f990b27ab55ee0012e28ad7' id='5f990b27ab55ee0012e28ad7'>
<a href='#5f990b27ab55ee0012e28ad7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571cecf6a5c5baa9f500002e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/46041da1752043608f246f126bedb245?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571cecf6a5c5baa9f500002e'>Elsid Aliaj</a>
</div>
<a UTCms='1603865383000' class='quanto-date posted-at response-posted-at' href='#5f990b27ab55ee0012e28ad7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>something seems mind boggling weird, when you change rebalancing for the bond funds when &quot;Out&quot; of market to weekly instead of daily, the returns YTD drop by 48%...... something seems off. How can daily rebalancing a few shares between TLT and IEF contribute to almost 99% of the returns?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f992651cb90f0000e06095f' id='5f992651cb90f0000e06095f'>
<a href='#5f992651cb90f0000e06095f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603872337000' class='quanto-date posted-at response-posted-at' href='#5f992651cb90f0000e06095f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@All: great tests and info here, thanks for sharing!</p>

<p>@Elsid: I am speculating, however I reckon that you have set the &#39;out&#39; scheduling function to weekly instead of daily and this does not only affect the rebalancing between the bonds. Instead it also determines when we go &#39;out&#39; of the market in the first place. With a weekly scheduling function for &#39;out&#39; this means that, in some cases, we might wait for <em>up to a week after</em> a signal has said &#39;out&#39; before we actually sell our equity holdings and go into bonds. Since, for the &#39;out&#39; part, time is of the essence because things often deteriorate quickly, I would not recommend to change this to a slower reaction time than daily. So, with this strategy, even the &#39;lazy trader&#39; (like myself) would need to check the signals daily and, when the signals say &#39;out&#39;, at least hit the &#39;sell all&#39; button and buy the two bond ETFs. In contrast, to execute a sophisticated stock selection strategy (= more time consuming), this can be done on a weekly basis.</p>

<p>@Vladimir: great observation. One could indeed work with an upper bound. However, what I came to realize is that these continuously updated wait days anyway have no lasting meaning since they are updated daily and then even very large realizations come back &#39;down to earth&#39; extremely quickly. So, in a way, the adjusted wait days could be seen as capturing an initial shock (&#39;safe havens suddenly begin to outperform similar other assets&#39;) in form of a spike, but this shock quickly becomes a new accepted reality and then also the adjusted wait days begin to relax again :) So, the variable does not really capture the days that we are truly planning to stay out of the market (unless we code it so that we commit to the wait days that were valid when we made the &#39;out&#39; decision; however, I have tested this &#39;commitment&#39; idea with other algo versions and found that it rather tends to underperform).  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f992d409b972e00107ceb19' id='5f992d409b972e00107ceb19'>
<a href='#5f992d409b972e00107ceb19'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1603874112000' class='quanto-date posted-at response-posted-at' href='#5f992d409b972e00107ceb19'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@ Aliaj<br>
Yes those -2 +2 trades is trying to keep the leverage always = 1. But one can filter them out. Look at the version of mein:</p>

<p>&quot;Here a mini change just want to reduce a lot of &quot;unnecessary&quot; trades. ...&quot;</p>

<p>But in this case the total return could be smaller.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f995634401251000fc17866' id='5f995634401251000fc17866'>
<a href='#5f995634401251000fc17866'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603884596000' class='quanto-date posted-at response-posted-at' href='#5f995634401251000fc17866'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Vladimir: Thanks for sharing the improved code, much appreciated!</p>

<p>In hindsight, I should probably have given an example regarding the smoothing and how it &#39;moves back down to earth&#39;. If the wait day indicator jumps to 2000 one day, then if no new spike occurs, the following values are fed back in:<br>
day1: 2000 -- day2: 1000 -- day3: 500 -- day4:  250 -- day5: 125 -- day6: 63 -- day7: 31 -- day8: 16 -- day9: 8<br>
It&#39;s basically 2000 x 0.5^(day# - 1) and the relatively quick move &#39;down to earth&#39; within 7-8 days is driven by the exponential-type of decay. So extreme values do not tend to last particularly long. Even a 20000 spike is reduced to 20 wait days at day 11.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f996225c441c40011363729' id='5f996225c441c40011363729'>
<a href='#5f996225c441c40011363729'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1603887653000' class='quanto-date posted-at response-posted-at' href='#5f996225c441c40011363729'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Just a small update (line 83-84) regarding adding an upper bound to the wait days (60 max, i.e. about 3 months) in the In &amp; Out. I know, it&#39;s just cosmetics but it may make for a better view on the wait days and what we are actually dealing with. One insight may be that the extreme spikes in the adjustment variable have no bearing on our &#39;in&#39; and &#39;out&#39; trades (due to the exponential decay), so the test may be useful to improve that confidence.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9974a1c441c40f1f3616a4' id='5f9974a1c441c40f1f3616a4'>
<a href='#5f9974a1c441c40f1f3616a4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1603892385000' class='quanto-date posted-at response-posted-at' href='#5f9974a1c441c40f1f3616a4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Peter Guenther,</p>

<p>I have manually calculated <em>context.adjvar</em> for GOLD and SILVER ratio of returns to show inconsistency of results with slight movement of SILVER price.</p>

<pre><code>context.INI_WAIT_DAYS * max(1,returns_sample[context.GOLD].iloc[-1] / returns_sample[context.SLVA].iloc[-1]  
</code></pre>

<p>returns_sample[context.GOLD].iloc[-1] =  10%</p>

<p>returns_sample[context.SLVA].iloc[-1] =  0.1%   --&gt; context.INI_WAIT_DAYS*  100 --&gt; 15*max(1,100) = 1500<br>
returns_sample[context.SLVA].iloc[-1] =  0.0%   --&gt; context.INI_WAIT_DAYS*  inf   - -&gt; 15*max(1,inf) = inf<br>
returns_sample[context.SLVA].iloc[-1] = -0.1%   --&gt; context.INI_WAIT_DAYS* -100 --&gt; 15*max(1,-100) = 15  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f999804fd8c020014df4250' id='5f999804fd8c020014df4250'>
<a href='#5f999804fd8c020014df4250'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571cecf6a5c5baa9f500002e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/46041da1752043608f246f126bedb245?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571cecf6a5c5baa9f500002e'>Elsid Aliaj</a>
</div>
<a UTCms='1603901444000' class='quanto-date posted-at response-posted-at' href='#5f999804fd8c020014df4250'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@thomas @Peter Thanks</p>

<p>Also I have a programmer that I have worked with in the past that can move this over to QuantConnect if anyone is interested cost would be around $250-$300, we can all share it whomever is interested, and we can run it automated or manually have it spit out data. </p>

<p>Let me know if anyone is interested.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f99998b9b972e00147cf0f3' id='5f99998b9b972e00147cf0f3'>
<a href='#5f99998b9b972e00147cf0f3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571cecf6a5c5baa9f500002e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/46041da1752043608f246f126bedb245?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571cecf6a5c5baa9f500002e'>Elsid Aliaj</a>
</div>
<a UTCms='1603901835000' class='quanto-date posted-at response-posted-at' href='#5f99998b9b972e00147cf0f3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Also guys I noticed last version of Peter&#39;s performs almost double of Vlads and Thomas, also Vlad&#39;s the code seems written completely different. for YTD 2020, Peter&#39;s is 50% vs Vlad&#39;s 25%.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f999e859b972e00107cf08b' id='5f999e859b972e00107cf08b'>
<a href='#5f999e859b972e00107cf08b'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1603903109000' class='quanto-date posted-at response-posted-at' href='#5f999e859b972e00107cf08b'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Radu, the stock selection can be as simple as picking stocks within QQQ that continuously outperform QQQ. Meaning those above market average since QQQ is a market average proxy. This is visible every day of the week over the simulation&#39;s duration, and it will also be visible daily going forward.</p>

<p>In the results shown, leveraging fees of 4% were applied and they only had a minimal impact on overall results. Nonetheless, it is a compounding game. Those fees will not look that big in the beginning, but as the portfolio grows they will still be a burden on final results. They ended up being 17 times larger than the initial capital.</p>

<p>I design long-term trading strategies with a retirement fund-like objective where you could periodically withdraw funds after having reached a future date milestone (like retirement date or some other reason). </p>

<p>If your portfolio is growing, on average, at 10% and you extract 5% per year, the portfolio is still improving at a 5% rate. \(F(t) = F_0 ∙ (1 + 0.10  - 0.05)^t\). It also means that your withdrawal is indexed to your portfolio performance: \(W(t + \tau) = F(t + \tau) ∙ (0.05)\).</p>

<p>The portfolio equation is: \(F(t) = F_0 ∙ (1 + r_m + α_t - exp_t)^t\) where \(r_m\) is QQQ&#39;s long-term return. Your alpha is above QQQ&#39;s returns and it can have multiple sources. You could say: \(F(t) = F_0 ∙ (1 + r_m + α_1 + \cdots +  α_n + op - fees_t - exp_t)^t\) where \(op\) is the return from your option&#39;s program. As you can see, this could produce much more than what I have presented on the condition that \(op\) be greater than the added fees: \(op &gt; |fees|\) and that the sum of alphas was greater than zero.</p>

<p>What I find interesting in this strategy is its BULL definition (making it a switcher to safety). It is not always right or at the right time, but it is where it counts. So, my next step is to look closer at that definition since I had no particular need to do so during my acid tests phase.</p>

<p>For those interested, the strategy does scale down. Here are the results using the same version as the last test with $100,000 as initial capital.</p>

<p>Total Returns<br>
159495.63%  </p>

<p>Benchmark Returns<br>
205.64%  </p>

<p>Alpha<br>
0.83  </p>

<p>Beta<br>
0.33  </p>

<p>Sharpe<br>
1.78  </p>

<p>Sortino<br>
2.79  </p>

<p>Volatility<br>
0.36  </p>

<p>Max Drawdown<br>
-31.71%</p>

<p>Leveraging fees were: $4,791,144.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f99c63bab55ee34e2e29074' id='5f99c63bab55ee34e2e29074'>
<a href='#5f99c63bab55ee34e2e29074'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1603913275000' class='quanto-date posted-at response-posted-at' href='#5f99c63bab55ee34e2e29074'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Tentor:</p>

<blockquote>
<p>To run the algorithm I would upload the script to PythonAnywhere and schedule it to be executed once a day, their free plan is sufficient for this.</p>
</blockquote>

<p>Quite interessting. It seems the PythonAnywhere  is a cloud? You can run your algo on the PythonAnywhere  and connect to a broker such as IB or Alpaca?</p>

<p>Have you ever tried the IBridgePy.com?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f99d5544012510011c17ea7' id='5f99d5544012510011c17ea7'>
<a href='#5f99d5544012510011c17ea7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5f8824d52e7763001773270e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/231097d8d87fd0ceed4beb086591296a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5f8824d52e7763001773270e'>Leandro Maia</a>
</div>
<a UTCms='1603917140000' class='quanto-date posted-at response-posted-at' href='#5f99d5544012510011c17ea7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Tentor<br>
Hi! Sorry for the basic question. You mentioned trading manually symply adding the print statement. Wouldn&#39;t that mean that we&#39;ll always be one day behind the algo in terms of execution? How can I extract what the algo will do today as soon as it gets the data from yesterday?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f99eaf5ab55ee0019e293f3' id='5f99eaf5ab55ee0019e293f3'>
<a href='#5f99eaf5ab55ee0019e293f3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5eec52dd8b9b6d0044373dbe'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/d818372f42cb67c36faa6506d9e98148?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5eec52dd8b9b6d0044373dbe'>Radu Spineanu</a>
</div>
<a UTCms='1603922677000' class='quanto-date posted-at response-posted-at' href='#5f99eaf5ab55ee0019e293f3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Guy Great explanation. I didn&#39;t understand all of it, but I really appreciate you writing it down. Would it be safe to say that I can check the Relative Strengh of all QQQ stocks vs QQQ and pick the top four, for instance?</p>

<p>On a separate note, should I assume that you don&#39;t care about taxes in your algos? You leverage up and that&#39;s what you keep track of.</p>

<p>@Elsid Vlad&#39;s algo stays out most of 2020, but it outperforms over a longer period of time. Attached backtest of Peter&#39;s algo from 2012 illustrates that. Really exciting reading the back and forth between @Peter and @Vladimir.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9a12cffb26c7307df23ce9' id='5f9a12cffb26c7307df23ce9'>
<a href='#5f9a12cffb26c7307df23ce9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571cecf6a5c5baa9f500002e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/46041da1752043608f246f126bedb245?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571cecf6a5c5baa9f500002e'>Elsid Aliaj</a>
</div>
<a UTCms='1603932879000' class='quanto-date posted-at response-posted-at' href='#5f9a12cffb26c7307df23ce9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Tentor</p>

<p>It seems way more annoying to set it up yourself and running your own server basically if you want it to run 24/7 and automated, then paying QC $10/ - $20/mo with the data included, I guess argument would be to avoid IB&#39;s commission fees. </p>

<p>Also QC has added some commission free brokers as well, seems like a pretty reasonable cost to host and run the algo with data, as opposed to like calling Yahoo&#39;s API or visiting yahoo everyday for data ect. </p>

<p>But I&#39;m open to implementing it live however, would be cool to learn the different python libraries had a buddy who ran something live on his own.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9a296342bd0e000c604552' id='5f9a296342bd0e000c604552'>
<a href='#5f9a296342bd0e000c604552'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571cecf6a5c5baa9f500002e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/46041da1752043608f246f126bedb245?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571cecf6a5c5baa9f500002e'>Elsid Aliaj</a>
</div>
<a UTCms='1603938659000' class='quanto-date posted-at response-posted-at' href='#5f9a296342bd0e000c604552'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Looked at IBridgePY can&#39;t sign up for an account but will try it out with IB, TD, or Robinhood if i Can. Says you can host on Amazon EC2 too, but there are enough cheap windows VPS out there also.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9a379b57da73000f654948' id='5f9a379b57da73000f654948'>
<a href='#5f9a379b57da73000f654948'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54e159f70f3369eb9200019b'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a53f34ae7e99886508adf2b4d76bff2?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54e159f70f3369eb9200019b'>Vladimir</a>
<span class='badge medal'></span>
</div>
<a UTCms='1603942299000' class='quanto-date posted-at response-posted-at' href='#5f9a379b57da73000f654948'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Elsid Aliaj, all</p>

<p>if you are interested in how and where to live trade Quantopian algorithms, please open<br>
a new thread and Tentor Testivis, Thomas Chang and others will be happy to answer your questions.<br>
Please help us keep this great thread from unrelated questions and answers.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9a38feb0bc6900134e83ab' id='5f9a38feb0bc6900134e83ab'>
<a href='#5f9a38feb0bc6900134e83ab'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1603942654000' class='quanto-date posted-at response-posted-at' href='#5f9a38feb0bc6900134e83ab'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Here&#39;s the thread for live trading, sorry for the off topic posts</p>

<p><a href="https://www.quantopian.com/posts/live-slash-paper-trade-the-in-out-stragegy" rel="nofollow">Live/Paper Trade the In_Out Stragegy</a></p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9ae8b1e8d38a000c792098' id='5f9ae8b1e8d38a000c792098'>
<a href='#5f9ae8b1e8d38a000c792098'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54f04b41a544aa8c34000289'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5a98c6e18424e6ac38702c35d5152669?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54f04b41a544aa8c34000289'>Chris Liu</a>
</div>
<a UTCms='1603987633000' class='quanto-date posted-at response-posted-at' href='#5f9ae8b1e8d38a000c792098'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello everybody, I created a slack for discussion this strategy:</p>

<p><a href="https://join.slack.com/t/quantopian-workspace/shared_invite/zt-imkqihmt-IkFhFhc6tEAGrc4mQjlgUA" rel="nofollow">https://join.slack.com/t/quantopian-workspace/shared_invite/zt-imkqihmt-IkFhFhc6tEAGrc4mQjlgUA</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9afcf81fcb3500080b26a0' id='5f9afcf81fcb3500080b26a0'>
<a href='#5f9afcf81fcb3500080b26a0'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/57ffffbd027294dc1300016d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/4865118f6f164b9d1c4f79146d6fad7d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/57ffffbd027294dc1300016d'>Kyle Oates</a>
</div>
<a UTCms='1603992824000' class='quanto-date posted-at response-posted-at' href='#5f9afcf81fcb3500080b26a0'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I don&#39;t post much but have really enjoyed following so many great algos over the years and reading the smart discussions among the contributors.  When the news broke today about Q giving up on the community my initial thought was where will the community go next.  I know nothing is owed to me because I haven&#39;t contributed much but if folks like:</p>

<p>@Tentor Testivis, @Dan Whitnable (Quantopian), @Vladimir, and @Thomas Chang</p>

<p>are willing to share their thoughts on where they are headed next and if their online handles are the same/different it would be extremely awesome.  I absolutely love following yalls discussions and will follow yall to the next platform.  The contributors like yourselves are the Q community leaders and so many of us that dont post much will follow yall to the next place.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9afd1c71fa4e000ff9f970' id='5f9afd1c71fa4e000ff9f970'>
<a href='#5f9afd1c71fa4e000ff9f970'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5420c95fdbad621be9000079'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/ee66334d0a7b6dcad241f2127237830c?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5420c95fdbad621be9000079'>Nathan</a>
</div>
<a UTCms='1603992860000' class='quanto-date posted-at response-posted-at' href='#5f9afd1c71fa4e000ff9f970'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@chris that link for the slack channel isn&#39;t working for me (asks for the url name of the channel). Can you share again?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9b0275d46cba0010569361' id='5f9b0275d46cba0010569361'>
<a href='#5f9b0275d46cba0010569361'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54f04b41a544aa8c34000289'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5a98c6e18424e6ac38702c35d5152669?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54f04b41a544aa8c34000289'>Chris Liu</a>
</div>
<a UTCms='1603994229000' class='quanto-date posted-at response-posted-at' href='#5f9b0275d46cba0010569361'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>sorry here is the link: <a href="https://join.slack.com/t/quantopian-workspace/shared_invite/zt-imkqihmt-IkFhFhc6tEAGrc4mQjlgUA" rel="nofollow">https://join.slack.com/t/quantopian-workspace/shared_invite/zt-imkqihmt-IkFhFhc6tEAGrc4mQjlgUA</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9b03e47c9e800007128930' id='5f9b03e47c9e800007128930'>
<a href='#5f9b03e47c9e800007128930'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5eac3453cd810d150986e5ea'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3f67eec5f3d899b7024f67c6ac2bc6dd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5eac3453cd810d150986e5ea'>Aleksei Dremov</a>
</div>
<a UTCms='1603994596000' class='quanto-date posted-at response-posted-at' href='#5f9b03e47c9e800007128930'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>deleted  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9b0d697c9e80000c128990' id='5f9b0d697c9e80000c128990'>
<a href='#5f9b0d697c9e80000c128990'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5db0c113e20c9153fc74621e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1039ed111bc94a10e52abca3eb22dc89?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5db0c113e20c9153fc74621e'>Lee YOyo</a>
</div>
<a UTCms='1603997033000' class='quanto-date posted-at response-posted-at' href='#5f9b0d697c9e80000c128990'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Please everyone migrate to Quantconnect. This is the best option where many are live trading on QC for years! QC has full L1 equity data and their backtesting is probably the most realistic. Plus their community is highly vibrant too with lots of strategies.</p>

<p>This IN&amp;OUT strategy will have great fun there.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9b0eee71f2ee0008173d7e' id='5f9b0eee71f2ee0008173d7e'>
<a href='#5f9b0eee71f2ee0008173d7e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5db0c113e20c9153fc74621e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1039ed111bc94a10e52abca3eb22dc89?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5db0c113e20c9153fc74621e'>Lee YOyo</a>
</div>
<a UTCms='1603997422000' class='quanto-date posted-at response-posted-at' href='#5f9b0eee71f2ee0008173d7e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Can anyone share the source codes of this strategy. Since the shuttingdown announcement, all codes are not in the pages anymore. Could you please share? Thanks.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9b15452bd2560008f46b9f' id='5f9b15452bd2560008f46b9f'>
<a href='#5f9b15452bd2560008f46b9f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5eac3453cd810d150986e5ea'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/3f67eec5f3d899b7024f67c6ac2bc6dd?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5eac3453cd810d150986e5ea'>Aleksei Dremov</a>
</div>
<a UTCms='1603999045000' class='quanto-date posted-at response-posted-at' href='#5f9b15452bd2560008f46b9f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Can anyone please explain this piece of the code that @Vladimir kindly shared with us?</p>

<pre><code>if exit: BULL = 0; OUT_DAY = COUNT;  
elif (COUNT &gt;= OUT_DAY + WAIT_DAYS): BULL = 1  
COUNT += 1  
</code></pre>

<p>I am a bad coder, trying to re-run his strategy in Excel, but it&#39;s clearly not working as intended without this piece.</p>

<p>This is the entire code if anyone is interested:  </p>

<pre><code>
# Price relative ratios (intersection) with wait days  
import numpy as np  
# -----------------------------------------------------------------------------------------------  
STOCKS = symbols(&#39;QQQ&#39;); BONDS = symbols(&#39;TLT&#39;,&#39;IEF&#39;); LEV = 1.00; wt = {};  
A = symbol(&#39;SLV&#39;); B = symbol(&#39;GLD&#39;); C = symbol(&#39;XLI&#39;); D = symbol(&#39;XLU&#39;);  
MKT = symbol(&#39;QQQ&#39;); VOLA = 126; LB = 1.00; BULL = 1; COUNT = 0; OUT_DAY = 0; RET_INITIAL = 80;  
# -----------------------------------------------------------------------------------------------  
def initialize(context):  
    schedule_function(daily_check, date_rules.every_day(), time_rules.market_open(minutes = 140))  
    schedule_function(record_vars, date_rules.every_day(), time_rules.market_close())  
def daily_check(context,data):  
    global BULL, COUNT, OUT_DAY  
    vola = data.history(MKT, &#39;price&#39;,  VOLA + 1, &#39;1d&#39;).pct_change().std() * np.sqrt(252)  
    WAIT_DAYS = int(vola * RET_INITIAL)  
    RET = int((1.0 - vola) * RET_INITIAL)  
    P = data.history([A,B,C,D], &#39;price&#39;,  RET + 2, &#39;1d&#39;).iloc[:-1].dropna()  
    ratio_ab = (P[A].iloc[-1] / P[A].iloc[0]) / (P[B].iloc[-1] / P[B].iloc[0])  
    ratio_cd = (P[C].iloc[-1] / P[C].iloc[0]) / (P[D].iloc[-1] / P[D].iloc[0])  
    exit = ratio_ab &lt; LB and ratio_cd &lt; LB  
    if exit: BULL = 0; OUT_DAY = COUNT;  
    elif (COUNT &gt;= OUT_DAY + WAIT_DAYS): BULL = 1  
    COUNT += 1  
    wt_stk = LEV if BULL else 0;  
    wt_bnd = 0 if BULL else LEV;  
    for sec in STOCKS: wt[sec] = wt_stk / len(STOCKS);  
    for sec in BONDS: wt[sec] = wt_bnd / len(BONDS)         

    for sec, weight in wt.items():  
        order_target_percent(sec, weight)  
    record( wt_bnd = wt_bnd, wt_stk = wt_stk )  

def record_vars(context, data):  
    record(leverage = context.account.leverage)  


</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9b343771f2ee0008173ea4' id='5f9b343771f2ee0008173ea4'>
<a href='#5f9b343771f2ee0008173ea4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54f04b41a544aa8c34000289'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/5a98c6e18424e6ac38702c35d5152669?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54f04b41a544aa8c34000289'>Chris Liu</a>
</div>
<a UTCms='1604006967000' class='quanto-date posted-at response-posted-at' href='#5f9b343771f2ee0008173ea4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hello everybody, I created a slack for discussion this strategy:<br>
here is the link: <a href="https://join.slack.com/t/quantopian-workspace/shared_invite/zt-imkqihmt-IkFhFhc6tEAGrc4mQjlgUA" rel="nofollow">https://join.slack.com/t/quantopian-workspace/shared_invite/zt-imkqihmt-IkFhFhc6tEAGrc4mQjlgUA</a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9bdf857c9e800008128f2f' id='5f9bdf857c9e800008128f2f'>
<a href='#5f9bdf857c9e800008128f2f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5a8b3f4e7006f539ce90d05d'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2a0d6416183cf99840fa6ad804300598?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5a8b3f4e7006f539ce90d05d'>Peter Guenther</a>
</div>
<a UTCms='1604050821000' class='quanto-date posted-at response-posted-at' href='#5f9bdf857c9e800008128f2f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@all: what a shocker, I was just about to write a note regarding this thread reaching the 100th reply (!) and congratulating @Tentor on his new thread (Live/Paper Trade the In_Out Stragegy) which I am sure would have gone through the roof in terms of interest! And now the place is closing :(</p>

<p>I would have loved for this thread to continue on Quantopian and really appreciated the opportunity for this discussion and the input from Dan!! Hope that the Quantopian team will be alright, but I reckon you guys have amazing, sought-after skills, so that there are many options.</p>

<p>So that the show might be able to go on, I would be happy to move this discussion to another place where backtesting is possible and further innovation and improvements can be assessed. QuantConnect is mentioned fairly often, so I just wanted to get a sense regarding whether people are thinking about migrating there and would be interested in continuing the discussion (e.g., @Tentor, @Dan, @Vladimir, @Thomas, @Radu, and others). I am sure that there are still plenty opportunities for improvement and innovation in the in &amp; out-type of strategies and then plenty opportunities in terms of combining them with great stock selection strategies.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9bf1e7595e57000a19db33' id='5f9bf1e7595e57000a19db33'>
<a href='#5f9bf1e7595e57000a19db33'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1604055528000' class='quanto-date posted-at response-posted-at' href='#5f9bf1e7595e57000a19db33'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Peter,</p>

<p>The game should be gon on. :-)</p>

<p>I was by QuantConnect about two years ago as QuantOpian close the live trading. But after I found the platform of QC quite differen tfrom that of QuantOpian, I gave up and do backtesting here by QuantOpian but live trade by using the IBridgePy.</p>

<p>If QC will migrate the QuantOpian to there platform, I will think about if I will comeback to QC.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9c053e1fcb3500120b2ee7' id='5f9c053e1fcb3500120b2ee7'>
<a href='#5f9c053e1fcb3500120b2ee7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1604060478000' class='quanto-date posted-at response-posted-at' href='#5f9c053e1fcb3500120b2ee7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I see this:</p>

<p><a href="https://factset.quantopian.com/" rel="nofollow">https://factset.quantopian.com/</a></p>

<p>Maybe we will use this later and meet again here in Quantopian? :-)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9c2a1feae527000f5c025d' id='5f9c2a1feae527000f5c025d'>
<a href='#5f9c2a1feae527000f5c025d'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/573c8cc840046c7b8700003a'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/374a694cabf9cbafb64b8152f6b498dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/573c8cc840046c7b8700003a'>alex zinny</a>
</div>
<a UTCms='1604069919000' class='quanto-date posted-at response-posted-at' href='#5f9c2a1feae527000f5c025d'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>check out <a href="http://www.cloudquant.com" rel="nofollow">www.cloudquant.com</a> or reach out to me to talk about our platform: <a href="/cdn-cgi/l/email-protection#e1809b888f8f98a1828d8e94859094808f95cf828e8c" rel="nofollow"><span class="__cf_email__" data-cfemail="15746f7c7b7b6c5576797a60716460747b613b767a78">[email&#160;protected]</span></a>  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9c3dced46cba0013569f62' id='5f9c3dced46cba0013569f62'>
<a href='#5f9c3dced46cba0013569f62'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/56406b03491ea6ba6400026e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/feb4cbf34749af2eb518ca1110c1a4e3?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/56406b03491ea6ba6400026e'>Thomas Chang</a>
</div>
<a UTCms='1604074958000' class='quanto-date posted-at response-posted-at' href='#5f9c3dced46cba0013569f62'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>if you cloudquant quantopian like or use zipline?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9c40b771f2ee000f1748ad' id='5f9c40b771f2ee000f1748ad'>
<a href='#5f9c40b771f2ee000f1748ad'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5cb05c81a1c4ac0040c7ae0c'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/2c03d939c8c879cddb1c770fadd01841?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5cb05c81a1c4ac0040c7ae0c'>Tentor Testivis</a>
</div>
<a UTCms='1604075703000' class='quanto-date posted-at response-posted-at' href='#5f9c40b771f2ee000f1748ad'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hey guys,<br>
when I saw that Vladimir was already working on an implementation for In &amp; Out on QC I created a thread there to continue this one:<br>
<a href="https://www.quantconnect.com/forum/discussion/9597/the-in-amp-out-strategy-continued-from-quantopian/p1" rel="nofollow">The In &amp; Out Strategy - Continued from Quantopian</a></p>

<p>Hope to see you all there!</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9cec125852df0009f776fd' id='5f9cec125852df0009f776fd'>
<a href='#5f9cec125852df0009f776fd'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/5db0c113e20c9153fc74621e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/1039ed111bc94a10e52abca3eb22dc89?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/5db0c113e20c9153fc74621e'>Lee YOyo</a>
</div>
<a UTCms='1604119570000' class='quanto-date posted-at response-posted-at' href='#5f9cec125852df0009f776fd'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Amazing post from Quantconnect, what a Perfect replication. And results from QC seem more realistic since it is based on minute resolution and L1 data, plus all the slippage modelled. Very real.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5f9d88b96f9700000a24df56' id='5f9d88b96f9700000a24df56'>
<a href='#5f9d88b96f9700000a24df56'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51318528831378d42a0001ad'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/af8a2fdb6b6e1c83933d4f7b647b235d?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51318528831378d42a0001ad'>Guy Fleury</a>
</div>
<a UTCms='1604159673000' class='quanto-date posted-at response-posted-at' href='#5f9d88b96f9700000a24df56'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p><em>I had this prepared answer for @Radu, so figured it would do no harm to provide it anyway before everything is erased. I will definitely miss all of you and would like to express my thanks to all participants for their comments and contributions. It forced me to go beyond and express what I had in mind.</em></p>

<p>@Radu, to your question, yes, why not? You are taking 5 stocks out of 100 possible choices. There are some 75,287,520 combinations. I used one out of those where the individual returns were above QQQ as the simulation progressed. I do not think my choice was optimal since I do not know the outcome of the other 75,287,519 possible choices, and I do not intend to even find out. However, common sense would dictate that selecting stocks performing above average would produce above-average returns.</p>

<p>I recently presented 4 test results in succession in this thread, see the link below for a summary. The gross leverage used was 1.5x or less and leveraging fees represented less than 3% of final CAGR outcomes. I consider those fees as an added cost of doing more business.</p>

<p><a href="https://alphapowertrading.com/quantopian/In_Out_New_Strat_PV.png" rel="nofollow">https://alphapowertrading.com/quantopian/In_Out_New_Strat_PV.png</a></p>

<p>The point is that our trading strategies have to generate all the profits from within. </p>

<p>Leveraging can be used to accelerate this process. </p>

<p>Some think that the above results are beyond belief when in fact I consider them just ordinary, a result of the applied math. It is all part of my search to find the merits, limits, strengths, weaknesses and potential of the trading procedures used. </p>

<p>It is the trading that enables the repeated reinvestment of the ongoing profits. This reinforcement feedback loop will compound results and increase overall returns. <em>I will not be able to continue improving this strategy for a while due to Quantopian&#39;s shutdown, but somehow, I will be able to do it somewhere to see how far it can go.</em></p>

<p>This reinforcement feedback loop concept is not new, it is not complicated, and is supported by math. We are playing a CAGR game, and therefore, leveraging will also be compounding. I presented the following equation many times in my posts:</p>

<p>$$F(t) = (1+ Lev) ∙ F_0 ∙ (1 + (1+ Lev) ∙ (r_m + α_t – exp_t) )^t$$</p>

<p>Use the equation in Excel and put in your own numbers. It will be easier to understand the high-performance level shown in the above chart due to minor changes in alpha and leverage. Evidently, if your alpha is negative, it will amplify that too, and could make it an “unreasonable” quest.  </p>

<p>The stuff we design is static for the duration of the simulations when in reality we need more dynamic and evolving structures which is why I like some outside control. But, even if we technically freeze our programs in a particular state for the duration, we can still show the merit of the underlying trading procedures. </p>

<p>The above equation does state that leveraging has the same effect as increasing your initial capital by the leveraging factor used: \((1+ Lev) ∙ F_0\). It also says that it will increase your trading expenses, but most importantly, it will also directly boost your market return and your generated alpha. It has for requirement that your alpha generates more than the added costs. Evidently.</p>

<p>It is as if we could determine the underlying trading philosophy and general objectives of such procedures. For instance, the program declares a BULL variable that dictates (at all times) what should be done. Its degree of accuracy will play a major role in the strategy&#39;s outcome. </p>

<p>It has another role which is to determine when you should switch out of risky assets for the safety of bonds and vice versa. It has many false positives and false negatives but nonetheless will be right where it counts the most. Another side effect, it also acts as a generalized and flexible stop-loss mechanism. Leveraging can be used when BULL has declared the market to be in an upswing, and that is not necessarily bad as shown in the above chart.  </p>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/new-strategy-in-and-out'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/new-strategy-in-and-out'>join Quantopian</a> to
post a reply.
</div>
</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#a2c4c7c7c6c0c3c1c9e2d3d7c3ccd6cdd2cbc3cc8cc1cdcf">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
