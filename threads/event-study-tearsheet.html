<!DOCTYPE html>
<html>
<head>
<link href='i1.wp.com' rel='dns-prefetch'>
<link href='i2.wp.com' rel='dns-prefetch'>
<link href='i3.wp.com' rel='dns-prefetch'>
<meta content='2HgX9mcLHaPOX6sfaaAkhWtblhEB9yUNw4l6l46e1k4' name='google-site-verification'>
<link rel="shortcut icon" type="image/x-icon" href="external/favicon-q-ac1a76f2c200e9026b5b1147519bb4fab6256910588b831e2411bc6c7c1218c3.png" />
<title>
Event Study Tearsheet
</title>
<meta content='Updated 6/16  - The Event Study notebook has been completely revamped with help from Luca one of our community members. It&#39;s also been modularized, documented, and cleaned so you can tweak it to your specifications.  To run it you call  run_event_study  with these parameters: def run_event_study(event_data, date_column=&#39;asof_date&#39;,                      start_date=&#39;2007-01-01&#39;, end_date=&#39;2014-01-01&#39;,                      benchmark_sid=&#39;SPY&#39;, days_before=10, days_after=10, top_liquid=500,      ...' name='description'>
<link rel="stylesheet" media="all" href="external/quanto-base-bundle-e8eb6050172aa0d24124d5c24bac90b2cccd88b5b9c7742026c0e9efab038c6e.css" />
<link rel="stylesheet" media="all" href="external/quanto-posts-bundle-aab01368d3f82d8dafc94ee9eabb82e77dc8c9fbbffa952fdcdc744dfa523cf3.css" />
<script src="external/quanto_global-057218867db29d5768131af5d6fb3476cef098e7d9e655108befb903c7ee985e.js"></script>
<script src="external/posts_bundle-3dfd82fa469c393d752e461d837aec9e4e364ae39f49198e34a6626f2180fdf7.js"></script>
<link href='external/logo-q-180x180-0f5a6a439c99203ed4aea6f656e7604c543d287be43d8b17c7591c1131f09a59.png' rel='apple-touch-icon'>
<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="rjqHRB7m3eP/6PlKJBWzchvHXX5ZF3RSRJsalWWrF4rSXPEJvBAPAEb1oHtr+hsGI0l+FyPbYUnGlMH/z+51MQ==" />
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<script>
//<![CDATA[
window.quanto_data={};quanto_data.bounce_back_params={"show_modal":null,"feedback_text":null};quanto_data.namespace="public";quanto_data.talib_info={"ADOSC":["Chaikin A/D Oscillator (Volume Indicators)",["fastperiod","3"],["slowperiod","10"]],"ADX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"ADXR":["Average Directional Movement Index Rating (Momentum Indicators)",["timeperiod","14"]],"APO":["Absolute Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"AROON":["Aroon (Momentum Indicators)",["timeperiod","14"]],"AROONOSC":["Aroon Oscillator (Momentum Indicators)",["timeperiod","14"]],"ATR":["Average True Range (Volatility Indicators)",["timeperiod","14"]],"BBANDS":["Bollinger Bands (Overlap Studies)",["timeperiod","5"],["nbdevup","2"],["nbdevdn","2"],["matype","0"]],"BETA":["Beta (Statistic Functions)",["timeperiod","5"]],"CCI":["Commodity Channel Index (Momentum Indicators)",["timeperiod","14"]],"CMO":["Chande Momentum Oscillator (Momentum Indicators)",["timeperiod","14"]],"CORREL":["Pearson's Correlation Coefficient (r) (Statistic Functions)",["timeperiod","30"]],"DEMA":["Double Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"DX":["Average Directional Movement Index (Momentum Indicators)",["timeperiod","14"]],"EMA":["Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"KAMA":["Kaufman Adaptive Moving Average (Overlap Studies)",["timeperiod","30"]],"LINEARREG":["Linear Regression (Statistic Functions)",["timeperiod","14"]],"LINEARREG_ANGLE":["Linear Regression Angle (Statistic Functions)",["timeperiod","14"]],"LINEARREG_INTERCEPT":["Linear Regression Intercept (Statistic Functions)",["timeperiod","14"]],"LINEARREG_SLOPE":["Linear Regression Slope (Statistic Functions)",["timeperiod","14"]],"MA":["Moving average (Overlap Studies)",["timeperiod","30"],["matype","0"]],"MACD":["Moving Average Convergence/Divergence (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["signalperiod","9"]],"MACDEXT":["MACD with controllable MA type (Momentum Indicators)",["fastperiod","12"],["fastmatype","0"],["slowperiod","26"],["slowmatype","0"],["signalperiod","9"],["signalmatype","0"]],"MACDFIX":["Moving Average Convergence/Divergence Fix 12/26 (Momentum Indicators)",["signalperiod","9"]],"MAX":["Highest values over a specified period (Math Operators)",["timeperiod","30"]],"MAXINDEX":["Index of highest value over a specified period (Math Operators)",["timeperiod","30"]],"MFI":["Money Flow Index (Momentum Indicators)",["timeperiod","14"]],"MIDPOINT":["Midpoint over period (Overlap Studies)",["timeperiod","14"]],"MIDPRICE":["Midpoint Price over period (Overlap Studies)",["timeperiod","14"]],"MIN":["Lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MININDEX":["Index of lowest value over a specified period (Math Operators)",["timeperiod","30"]],"MINMAX":["Lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINMAXINDEX":["Indexes of lowest and highest values over a specified period (Math Operators)",["timeperiod","30"]],"MINUS_DI":["Minus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"MINUS_DM":["Minus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"MOM":["Momentum (Momentum Indicators)",["timeperiod","10"]],"NATR":["Normalized Average True Range (Volatility Indicators)",["timeperiod","14"]],"PLUS_DI":["Plus Directional Indicator (Momentum Indicators)",["timeperiod","14"]],"PLUS_DM":["Plus Directional Movement (Momentum Indicators)",["timeperiod","14"]],"PPO":["Percentage Price Oscillator (Momentum Indicators)",["fastperiod","12"],["slowperiod","26"],["matype","0"]],"ROC":["Rate of change: ((price/prevPrice)-1)*100 (Momentum Indicators)",["timeperiod","10"]],"ROCP":["Rate of change Percentage: (price-prevPrice)/prevPrice (Momentum Indicators)",["timeperiod","10"]],"ROCR":["Rate of change ratio: (price/prevPrice) (Momentum Indicators)",["timeperiod","10"]],"ROCR100":["Rate of change ratio 100 scale: (price/prevPrice)*100 (Momentum Indicators)",["timeperiod","10"]],"RSI":["Relative Strength Index (Momentum Indicators)",["timeperiod","14"]],"SMA":["Simple Moving Average (Overlap Studies)",["timeperiod","30"]],"STDDEV":["Standard Deviation (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"STOCH":["Stochastic (Momentum Indicators)",["fastk_period","5"],["slowk_period","3"],["slowk_matype","0"],["slowd_period","3"],["slowd_matype","0"]],"STOCHF":["Stochastic Fast (Momentum Indicators)",["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"STOCHRSI":["Stochastic Relative Strength Index (Momentum Indicators)",["timeperiod","14"],["fastk_period","5"],["fastd_period","3"],["fastd_matype","0"]],"T3":["Triple Exponential Moving Average (T3) (Overlap Studies)",["timeperiod","5"],["vfactor","0.7"]],"TEMA":["Triple Exponential Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIMA":["Triangular Moving Average (Overlap Studies)",["timeperiod","30"]],"TRIX":["1-day Rate-Of-Change (ROC) of a Triple Smooth EMA (Momentum Indicators)",["timeperiod","30"]],"TSF":["Time Series Forecast (Statistic Functions)",["timeperiod","14"]],"ULTOSC":["Ultimate Oscillator (Momentum Indicators)",["timeperiod1","7"],["timeperiod2","14"],["timeperiod3","28"]],"VAR":["Variance (Statistic Functions)",["timeperiod","5"],["nbdev","1"]],"WILLR":["Williams' %R (Momentum Indicators)",["timeperiod","14"]],"WMA":["Weighted Moving Average (Overlap Studies)",["timeperiod","30"]]};quanto_data.nb_preview_url="https://notebooks-preview.prd.pub.quantopian.com";quanto_data.delay_nb_preview_load=true;
//]]>
</script>
<meta content='https://www.quantopian.com/posts/event-study-tearsheet' property='og:url'>
<meta content='Event Study Tearsheet' property='og:title'>

<input type="hidden" name="env" id="quanto-env" value="production" />
<meta content='550580758292093' property='fb:app_id'>
<meta content='https://www.quantopian.com/posts/event-study-tearsheet' property='og:url'>
<meta content='https://media.quantopian.com/public/og-image-default.png' property='og:image'>
<meta content='Event Study Tearsheet' property='og:title'>
<meta content='Updated 6/16  - The Event Study notebook has been completely revamped with help from Luca one of our community members. It&#39;s also been modularized, documented, and cleaned so you can tweak it to your specifications.  To run it you call  run_event_study  with these parameters: def run_event_study(event_data, date_column=&#39;asof_date&#39;,                      start_date=&#39;2007-01-01&#39;, end_date=&#39;2014-01-01&#39;,                      benchmark_sid=&#39;SPY&#39;, days_before=10, days_after=10, top_liquid=500,      ...' property='og:description'>
</head>
<script type='application/ld+json'>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.quantopian.com",
    "logo": "https://media.quantopian.com/logos/logo-q-press-red.png"
  }
</script>
<body class='' ontouchstart=''>
<div id='fb-root'></div>
<div class='wrapper'>
<div class='alert-v2 error'>
<div class='message'>
Quantopian's community platform is shutting down. Please read <a href="/posts/quantopians-community-services-are-closing">this post</a> for more information and <a href='/account#account'>download your code</a>.
</div>
</div>
<div class='navbar navbar-default navbar-static-top' id='app-navbar'>
<div class='container-fluid'>
<div class='navbar-header'>
<button class='navbar-toggle collapsed' data-target='#app-navbar-collapse' data-toggle='collapse'>
<span class='icon hamburger-menu'></span>
</button>
<a class='navbar-brand' href='/home'>
<img class='logo-image async-image' data-src='external/logo-q-white-b141ea6018546e5a4ecc3d10d8440ec076fc4385764e948b322828cc70950a76.svg'>
</a>
</div>
<div class='collapse navbar-collapse' id='app-navbar-collapse'>
<ul class='nav navbar-nav navbar-right'>
<li class='dropdown quanto-dropdown-new'>
<li>
<a class='header' href='/docs'>
Documentation
</a>
</li>
<li class='dropdown quanto-dropdown-new'>
<a class='header' data-toggle='dropdown' href='#'>
Learn
</a>
<ul class='dropdown-menu'>
<li>
<a class='mixpanel-button' data-event='main nav getting started clicked' href='/tutorials/getting-started'>Getting Started</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav tutorials clicked' href='/tutorials'>Tutorials</a>
</li>
<li>
<a class='mixpanel-button' data-event='main nav lectures clicked' href='/lectures'>Lectures</a>
</li>
</ul>
</li>
<li>
<a class='header' href='/posts' id='forum-link'>
Forum
</a>
</li>
<li>
<a class="header" href="/signin?return_to=/posts/event-study-tearsheet">Log In</a>
</li>
</li>

</ul>
</div>
</div>
</div>
<script>
  $(document).ready(function () {
    quanto.instances.fm = new quanto.FeedbackManager();
    quanto.instances.hm = new quanto.headerManager();
  })
</script>


<div class='content content-area new-style'>
<input type="hidden" name="page-id" id="page-id" value="postatomic" />
<script src="external/MathJax.js?config=TeX-AMS_HTML-full.js,Safe" async="async"></script>
<div class='container page-container post-atomic'>
<input id='parent-post-id-val' type='hidden' value='557e31adebf878b9df0001d0'>
<div class='post-container' data-post-id='557e31adebf878b9df0001d0' id='557e31adebf878b9df0001d0'>
<div class='back-button back-to-community'>Back to Community</div>
<div class='post-title'>Event Study Tearsheet</div>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<span class='posted-at'>edited </span>
<span UTCms='1467984103000' class='quanto-date posted-at'></span>
<div class='pull-right other-actions'>
<div class='dropup inline-block'>
<div class='dropdown share-control other-action-link'>
<div data-toggle='dropdown'>
<div class='share-image'></div>
Share
</div>
<ul class='dropdown-menu share-options-menu'>
<li>
<a class='share-row' href='https://twitter.com/intent/tweet?text=Event Study Tearsheet&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fevent-study-tearsheet%3Futm_source%3Dwebsite_share%26utm_campaign%3Dcloning-available-how-to-conduct-your-own-event-study-using-research%26utm_medium%3Dtwitter&amp;via=quantopian'>
<i class='icon icon-twitter'></i>
Share on Twitter
</a>
</li>
<li>
<div class='share-row facebook-button'>
<i class='icon icon-facebook'></i>
Share on Facebook
</div>
</li>
<li>
<div class='share-row linkedin-button' data-share-url='https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fwww.quantopian.com%2Fposts%2Fevent-study-tearsheet%3Futm_source%3Dwebsite_share%26utm_campaign%3Dcloning-available-how-to-conduct-your-own-event-study-using-research%26utm_medium%3Dlinkedin&amp;title=Event+Study+Tearsheet+%28Seong+Lee%29&amp;source=Quantopian'>
<i class='icon icon-linkedin'></i>
Share on LinkedIn
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
</div>

<input type="hidden" name="social_fb_post_link" id="social_fb_post_link" value="https://www.quantopian.com/posts/event-study-tearsheet?utm_source=website_share&amp;utm_campaign=cloning-available-how-to-conduct-your-own-event-study-using-research&amp;utm_medium=facebook" />
<input type="hidden" name="social_post_image" id="social_post_image" value="external/logo-q-red-outline.png" />
<input type="hidden" name="social_post_author" id="social_post_author" value="Seong Lee" />
<div class='body-text'>
<div class='body-text-container post-body'><p><strong>Updated 6/16</strong> - The Event Study notebook has been completely revamped with help from Luca one of our community members. It&#39;s also been modularized, documented, and cleaned so you can tweak it to your specifications. </p>

<p>To run it you call <code>run_event_study</code> with these parameters:</p>

<pre><code>def run_event_study(event_data, date_column=&#39;asof_date&#39;,  
                    start_date=&#39;2007-01-01&#39;, end_date=&#39;2014-01-01&#39;,  
                    benchmark_sid=&#39;SPY&#39;, days_before=10, days_after=10, top_liquid=500,  
                    use_liquid_stocks=True):  
    &quot;&quot;&quot;  
    Calculates simple &amp; cumulative returns for events and plots stock price movement  
    before and after the event date.  
    Parameters  
    ----------  
    event_data : pd.DataFrame  
        DataFrame that contains the events data with date and sid columns as  
        a minimum. See interactive tutorials on quantopian.com/data  
    date_column : String  
        String that labels the date column to be used for the event. e.g. `asof_date`  
    start_date, end_date : Datetime  
        Start and end date to be used for the cutoff for the evenet study  
    benchmark : string, int, zipline.assets._assets.Equity object  
        Security to be used as benchmark for returns calculations. See `get_returns`  
    days_before, days_after : int  
        Days before/after to be used to calculate returns for.  
    top_liquid : Int  
        If use_liquid_stocks is True, top_liquid determines the top X amount of stocks  
        to return ranked on liquidity  
    use_liquid_stocks : Boolean  
        If set to True, it will filter out any securities found in `event_data`  
        according to the filters found in `filter_universe`  
    &quot;&quot;&quot;  
</code></pre>

<p>This event study looks at buyback announcements.</p>
</div>
</div>
<div class='disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>

</div>

<div class='container page-container post-atomic'>
<div class='section-header reply-header'>
<div class='reply-title'>27 responses</div>
</div>
<div class='replies'>
<div class='post-container response-container' data-post-id='57595ba7a6694fb49600038e' id='57595ba7a6694fb49600038e'>
<a href='#57595ba7a6694fb49600038e'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1465473965000' class='quanto-date posted-at response-posted-at' href='#57595ba7a6694fb49600038e'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Seong,</p>

<p>Thank you for your NB, I used it in <a href="http://www.quantopian.com/posts/an-empirical-algorithmic-evaluation-of-technical-analysis">here</a> for evaluation of technical patterns. I cleaned and packed your code in a single function, so that it can be easily used elsewhere. Hopefully this might be useful to other people.</p>

<p>Also, I&#39;d like to share with you two shortcomings I found in the NB (that I fixed):</p>

<p>1 - The standard deviation bars should be calculated from the event date, not from the beginning of the cumulative return series. The standard deviation shouldn&#39;t be dependent on how far in the past we decide to plot the cumulative series. We are interested in what happens AFTER the event and so the event date should be the date when we start calculating of how far the prices deviate from each others.<br>
To fix that, I vertically shifted the cumulative plot so that it equals 0 at day 0 (I only modified get_returns function to achieve that). This has the side effect of making very easy the comparison between returns vs abnormal returns plots.</p>

<p>2 - I believe we should use open price instead of close price for the event study.  This is because a hypothetical  algorithm would place orders at market open (not after the market closes anyway). So it makes more sense to study the change of open prices.</p>

<p>Please let me know what you think.</p>

<p>Note: the NB begins with an explanation of the technical patterns we want to study. The event study is at the bottom of the NB and it is independent of the initial part of the NB so that it can be moved to other NBs.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57599b10a4580eb90000069f' id='57599b10a4580eb90000069f'>
<a href='#57599b10a4580eb90000069f'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/571d1bab2616ef09ce0002b6'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/a69e9457dd2832a76875bcae334d5baf?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/571d1bab2616ef09ce0002b6'>Dan Whitnable</a>
</div>
<a UTCms='1465490200000' class='quanto-date posted-at response-posted-at' href='#57599b10a4580eb90000069f'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Luca,</p>

<p>Thank you for &#39;bumping&#39; this post up into the recent category. Anyone and everyone interesting in technical trading should study this notebook and use it as a platform to test the efficacy of potential technical signal ideas. Also, very good catch about using opening prices. Small change/impact but it&#39;s all about the details. Also, I agree your std dev calculation calculation is more correct. The cleaned up code is excellent.</p>

<p>Seong, it&#39;s been awhile since you originally posted this. I was surprised there hadn&#39;t been any replies before now. This is a gem. You deserve more than kudos!</p>

<p>This post should be tagged &#39;interesting&#39;.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5759db90a4580eb9000009a4' id='5759db90a4580eb9000009a4'>
<a href='#5759db90a4580eb9000009a4'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1465506712000' class='quanto-date posted-at response-posted-at' href='#5759db90a4580eb9000009a4'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Seong, another point to add to the discussion, beta calculation. The calc_beta function  uses  numpy.polyfit to calculate Beta but I tried to swap that with scipy.stats.linregress (it is used in the new pipeline factor RollingLinearRegressionOfReturns to calculate Beta, so I assumed it was well tested).</p>

<p>The results are not as similar as I hoped. </p>

<p>I guess Q has a lot of experience in calculating Beta, could you suggest the best method to use?</p>

<pre><code>def calc_beta(...):  
    [...]  
    m, b = np.polyfit(bench_prices, stock_prices, 1)  
    return m  
</code></pre>

<p>vs </p>

<pre><code>def calc_beta(...):  
    [...]  
    regr_results = scipy.stats.linregress(y=stock_prices, x=bench_prices)  
    #alpha = regr_results[1]  
    beta = regr_results[0]  
    #r_value = regr_results[2]  
    #p_value = regr_results[3]  
    #stderr = regr_results[4]  
    return beta  
</code></pre>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5759df28c8d0b67d0f0004eb' id='5759df28c8d0b67d0f0004eb'>
<a href='#5759df28c8d0b67d0f0004eb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1465507630000' class='quanto-date posted-at response-posted-at' href='#5759df28c8d0b67d0f0004eb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Luca, </p>

<p>I&#39;m not too familiar in the distinctions between the two, but I would suggest using linregress as from my reading it provides a number of additional statistics and speed improvements over polyfit.</p>

<p>This work is awesome, by the way.</p>

<p>Seong  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='575a7226d0744abc95000a38' id='575a7226d0744abc95000a38'>
<a href='#575a7226d0744abc95000a38'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1465545263000' class='quanto-date posted-at response-posted-at' href='#575a7226d0744abc95000a38'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Ok then, here is a new version with the updated beta calculation  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='57632694b83b764418000453' id='57632694b83b764418000453'>
<a href='#57632694b83b764418000453'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1466115738000' class='quanto-date posted-at response-posted-at' href='#57632694b83b764418000453'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Updated with a much  more memory efficient version that will run across a longer timespan.</p>

<p>Luca,</p>

<p>I&#39;ve taken some of your changes along with the original framework and tried cleaning up the code quite a bit. I&#39;ve also included a new, more efficient way of calculating price returns by using a cumulative price change versus individual (x - y)/x calculations. </p>

<p>To run it you call <code>run_event_study</code> with these parameters:</p>

<pre><code>def run_event_study(event_data, date_column=&#39;asof_date&#39;,  
                    start_date=&#39;2007-01-01&#39;, end_date=&#39;2014-01-01&#39;,  
                    benchmark_sid=&#39;SPY&#39;, days_before=10, days_after=10, top_liquid=500,  
                    use_liquid_stocks=True):  
    &quot;&quot;&quot;  
    Calculates simple &amp; cumulative returns for events and plots stock price movement  
    before and after the event date.  
    Parameters  
    ----------  
    event_data : pd.DataFrame  
        DataFrame that contains the events data with date and sid columns as  
        a minimum. See interactive tutorials on quantopian.com/data  
    date_column : String  
        String that labels the date column to be used for the event. e.g. `asof_date`  
    start_date, end_date : Datetime  
        Start and end date to be used for the cutoff for the evenet study  
    benchmark : string, int, zipline.assets._assets.Equity object  
        Security to be used as benchmark for returns calculations. See `get_returns`  
    days_before, days_after : int  
        Days before/after to be used to calculate returns for.  
    top_liquid : Int  
        If use_liquid_stocks is True, top_liquid determines the top X amount of stocks  
        to return ranked on liquidity  
    use_liquid_stocks : Boolean  
        If set to True, it will filter out any securities found in `event_data`  
        according to the filters found in `filter_universe`  
    &quot;&quot;&quot;  
</code></pre>

<p>While I&#39;ll either be updating this thread or creating a new one to feature the notebook, here it is looking at Buyback Announcements.</p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='5764fce320f524c226000196' id='5764fce320f524c226000196'>
<a href='#5764fce320f524c226000196'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1466236137000' class='quanto-date posted-at response-posted-at' href='#5764fce320f524c226000196'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Beautiful, clean, modular code. I am impressed. I especially like the liquid  stock filtering, that is a very useful addition. </p>

<p>I found some serious bugs though (refactoring without unit testings is always a pain in the neck, I know).  If you upload the project on github I can submit my fixes there.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='576566db70e64ca8e0000467' id='576566db70e64ca8e0000467'>
<a href='#576566db70e64ca8e0000467'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1466263271000' class='quanto-date posted-at response-posted-at' href='#576566db70e64ca8e0000467'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Well, here is the new code anyway.  it is very likely I made some mistakes too so if someone feels like reviewing it, that would be nice. </p>

<p>List of changes:</p>

<p><strong>get_cum_returns:</strong></p>

<ul>
<li><p>days_before/days_after arguments should be considered trading days, not calendar days (but you might disagree on this) otherwise each event might get a cumulative return series of different length (depending on how many &quot;non trading&quot; days are included in days_before/days_after)</p></li>
<li><p>bug fix: when sid == benchmark the function breaks (and it also returns a DataFrame instead of a Series, breaking the caller code)</p></li>
<li><p>bug fix: abnormal returns were calculated subtracting the benchmark <strong>cumulative</strong> returns from sid <strong>cumulative</strong> returns but we should subtract the <strong>daily</strong> returns and build the cumulative returns after that</p></li>
<li><p>bug fix: cumulative return series calculation from price series is wrong:  </p></li>
</ul>

<pre><code>cum_returns = price.pct_change().cumsum().fillna(0)   # wrong  
cum_returns = (price.pct_change().fillna(0) + 1).cumprod() - 1 # correct  
</code></pre>

<p><strong>get_returns:</strong></p>

<ul>
<li><p>start_date/end_date (date range used to load the daily price) calculation is wrong and we end up having less days of data than required by get_cum_returns</p></li>
<li><p>valid_sids should be populated even when use_liquid_stocks is False, otherwise we&#39;ll discard all the events in run_event_study function</p></li>
<li><p>when calling get_price we have to avoid sid duplicates (e.g. when sid is benchmark) otherwise the returned dataframe will contain duplicated columns and that would break get_cum_returns</p></li>
<li><p>benchmark should be passed to get_cum_returns too</p></li>
</ul>

<p><strong>run_event_study:</strong></p>

<ul>
<li>benchmark must be a sid/Equity but not a string as it will be used to index the price DataFrame<br></li>
</ul>

<p><strong>filter_universe:</strong> </p>

<ul>
<li>added option to filter by price and volume too (this is something I needed fro my research but I think it&#39;s a common requirement too)<br></li>
</ul>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5768094cebc1b828c10000bc' id='5768094cebc1b828c10000bc'>
<a href='#5768094cebc1b828c10000bc'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1466435925000' class='quanto-date posted-at response-posted-at' href='#5768094cebc1b828c10000bc'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Luca. This is great. I&#39;ll update the main post with your changes after reviewing.</p>

<p>Do you mind summarizing a bit the differences between event study 1 and 2?  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='57680b0febc1b8ab2b0000c9' id='57680b0febc1b8ab2b0000c9'>
<a href='#57680b0febc1b8ab2b0000c9'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1466436377000' class='quanto-date posted-at response-posted-at' href='#57680b0febc1b8ab2b0000c9'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The event study 2 is what I was working on (<a href="http://www.quantopian.com/posts/an-empirical-algorithmic-evaluation-of-technical-analysis">event study applied technical pattern</a>). I replaced the old event study code with the one in your new NB and I noticed something was wrong so I fixed it. Finally I added event study 1 that is your original case study to make  the comparison easier</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5769850f95df22212a000bd7' id='5769850f95df22212a000bd7'>
<a href='#5769850f95df22212a000bd7'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1466533142000' class='quanto-date posted-at response-posted-at' href='#5769850f95df22212a000bd7'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Gotcha, thanks for providing that.</p>

<p>I&#39;ve been unsuccessful in trying to speed up the run-time when using the <code>use_liquid_stocks</code> flag. At the moment, we&#39;re running a pipeline output (filtered for security) per each event and in any given run (10,000 max events if using interactive), it takes 1+ hour to run. </p>

<p>Any thoughts on a better way to approach this?</p>

<p>Seong  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='576aa4899203e942450002cb' id='576aa4899203e942450002cb'>
<a href='#576aa4899203e942450002cb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1466606739000' class='quanto-date posted-at response-posted-at' href='#576aa4899203e942450002cb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Luca, </p>

<p>I&#39;ve tried making some speed improvements that allow you to use the <code>use_liquid_stocks</code> flag. Now, instead of running a pipeline output everyday, you only run it once over a 252 day time window.</p>

<p>This looks at negative earnings surprises over 2013 ~ 2014 with a surprise &lt; -50% (So really bad surprises) for the top 500 most liquid securities. The general observation is that the market seems to revert in the initial few days but am planning on running this over a longer time period to see how it&#39;ll hold up.  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='576ad13a614ed283970009fb' id='576ad13a614ed283970009fb'>
<a href='#576ad13a614ed283970009fb'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1466618178000' class='quanto-date posted-at response-posted-at' href='#576ad13a614ed283970009fb'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Running pipeline once per event study (in this case once per year) seems a reasonable workaround. I wonder if &quot;run_pipeline&quot; has some warming up delay as it happens when backtesting. That would explain the slowness. A possible solution would be to run pipeline for the whole event study date range and to save the resulting dataframe to perform daily top volume stocks filtering.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='59199ace35cb83000d3ce9c2' id='59199ace35cb83000d3ce9c2'>
<a href='#59199ace35cb83000d3ce9c2'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546cddf11784d3d4c6000436'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/eff513fd33ebe34d68f212ef2e2b2983?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546cddf11784d3d4c6000436'>Ph Quam</a>
</div>
<a UTCms='1494850254000' class='quanto-date posted-at response-posted-at' href='#59199ace35cb83000d3ce9c2'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi, I made the processing run about ten times faster (from 1000 seconds to 100 seconds for 2016) by grouping by date and calling get_price for all<br>
symbols on the date.<br>
Can we setup source control for this code? May be in alphalens or gist.github.com<br>
Can notebooks be diff-ed? If not it will be a .py file instead.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='591c64093dcc3619f843a7f3' id='591c64093dcc3619f843a7f3'>
<a href='#591c64093dcc3619f843a7f3'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/51cbb24ab03fe0bc5500000e'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/12b8399e99c8eab21b6bf2ac1d1da84a?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/51cbb24ab03fe0bc5500000e'>Seong Lee</a>
<img class='quantopian-badge async-image' data-src='https://qf.quantopian.com/assets/logos/staff-q-red-stroke-095008cf53acafb1da63369cad14e3083d49d13eea83f592dd3dd0d5f0474fcc.svg'>
</div>
<a UTCms='1495032841000' class='quanto-date posted-at response-posted-at' href='#591c64093dcc3619f843a7f3'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Ph Quam</p>

<p>Would you mind posting the notebook here? I&#39;m not aware of a code diff for ipython notebooks but can review and replace the main one in this thread with yours after some feedback</p>

<p>Seong  </p>
</div>
<div class='collapsed disclaimer-minimized-wrapper'>
<div class='title'>Disclaimer</div>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian. In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>
</div>
</div>

</div>
</div>

<div class='post-container response-container' data-post-id='591cb0ead79569000d71bf96' id='591cb0ead79569000d71bf96'>
<a href='#591cb0ead79569000d71bf96'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546cddf11784d3d4c6000436'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/eff513fd33ebe34d68f212ef2e2b2983?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546cddf11784d3d4c6000436'>Ph Quam</a>
</div>
<a UTCms='1495052522000' class='quanto-date posted-at response-posted-at' href='#591cb0ead79569000d71bf96'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Seong Lee<br>
I have also implemented grouping by several weeks. Now there are 3 different implementations of get_returns() under the same name.<br>
calc_beta is not used correctly - the same issue as std() above. Beta calculation should not include days_before.<br>
I even doubt if beta should be calculated per sid of for the whole factor returns. My reasoning is that we compare a tested strategy returns against the returns of Buy and Hold strategy on the benchmark instrument. The dates on which the factor generates buying signals are part of the tested factor and they should not affect the performance of the benchmark.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='591e0ac5de6d3b441989ef60' id='591e0ac5de6d3b441989ef60'>
<a href='#591e0ac5de6d3b441989ef60'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546cddf11784d3d4c6000436'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/eff513fd33ebe34d68f212ef2e2b2983?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546cddf11784d3d4c6000436'>Ph Quam</a>
</div>
<a UTCms='1495141061000' class='quanto-date posted-at response-posted-at' href='#591e0ac5de6d3b441989ef60'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>There was a minor bug in my code - global varible df was used instead of event_data parameter.<br>
I added the notebook in my alphalens fork <a href="https://github.com/volconst/alphalens/commits/master/alphalens/event_study_nb.py">https://github.com/volconst/alphalens/commits/master/alphalens/event_study_nb.py</a><br>
The fix is there and I will commit more changes.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5925afb15543b40010834672' id='5925afb15543b40010834672'>
<a href='#5925afb15543b40010834672'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546cddf11784d3d4c6000436'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/eff513fd33ebe34d68f212ef2e2b2983?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546cddf11784d3d4c6000436'>Ph Quam</a>
</div>
<a UTCms='1495642033000' class='quanto-date posted-at response-posted-at' href='#5925afb15543b40010834672'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This line in get_returns():<br>
        prices = prices.shift(-1)<br>
looked suspicious to me before and now I have a test that shows it is bad.<br>
I create a single event with 2 prices: 1 and 1.2 and expect to see relative change of 0.2 = (1.2-1)/1 at day 1. However this line leads to a change -0.16 in day 1. I am attaching the test based on the original notebook from this thread, but will post the fix based on the HEAD of my branch which contains all the performance optimizations I have added.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5925de410db212000d70f634' id='5925de410db212000d70f634'>
<a href='#5925de410db212000d70f634'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/546cddf11784d3d4c6000436'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/eff513fd33ebe34d68f212ef2e2b2983?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/546cddf11784d3d4c6000436'>Ph Quam</a>
</div>
<a UTCms='1495653953000' class='quanto-date posted-at response-posted-at' href='#5925de410db212000d70f634'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>This is without shifting <a href="https://github.com/volconst/alphalens/commit/1a7479d099887ecdf8bc9e357e22af0a1db26624">https://github.com/volconst/alphalens/commit/1a7479d099887ecdf8bc9e357e22af0a1db26624</a><br>
The good thing is that now there is more exploitable price movement at day 0, more in 2014 than 2013 - can this be due to data being recorded and<br>
delivered faster or more correctly?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a5ab8486344b5001ab5b270' id='5a5ab8486344b5001ab5b270'>
<a href='#5a5ab8486344b5001ab5b270'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/539fa9e62b7a914823000059'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0c24a0b73ae02be3f89eedb25ee71eaf?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/539fa9e62b7a914823000059'>Brett Elliot</a>
</div>
<a UTCms='1515894856000' class='quanto-date posted-at response-posted-at' href='#5a5ab8486344b5001ab5b270'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Seong (and Luca and Ph Quam,</p>

<p>Thanks for this! It&#39;s really great! I have two simple questions... </p>

<ol>
<li>Are days before and days after calendar days (including weekends, holidays, etc) or are they only days the markets are open?<br></li>
<li>Which is the best notebook to clone? There seem to be several referenced here, each having a different bug or fix (open vs closing price, global var vs local var). I&#39;m not sure if I should use the first or the last notebook.</li>
</ol>

<p>Thanks!  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a5b3a586344b5001ab5b7d5' id='5a5b3a586344b5001ab5b7d5'>
<a href='#5a5b3a586344b5001ab5b7d5'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1515928152000' class='quanto-date posted-at response-posted-at' href='#5a5b3a586344b5001ab5b7d5'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>@Brett</p>

<ol>
<li>Those are only days the markets are open. The code looks at the previous/next price information provided, not the previous/next calendar day.<br></li>
<li>I would go with Seong&#39;s version  as it was updated several times but you might like to check the changes introduced by Ph Quam to increase the speed.</li>
</ol>

<p>As a side note, when Alphalens is updated on Quantopian, we will be able to use the event study embedded in there. Have a look at the <a href="https://github.com/quantopian/alphalens/tree/master/alphalens/examples">example</a>.</p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a99ea72feac20658c7b5ed6' id='5a99ea72feac20658c7b5ed6'>
<a href='#5a99ea72feac20658c7b5ed6'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/539fa9e62b7a914823000059'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0c24a0b73ae02be3f89eedb25ee71eaf?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/539fa9e62b7a914823000059'>Brett Elliot</a>
</div>
<a UTCms='1520036466000' class='quanto-date posted-at response-posted-at' href='#5a99ea72feac20658c7b5ed6'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Hi Luca! </p>

<p>Why is it that all the graphs showing cumulative abnormal returns before and after are at zero on the event date? Is that because the graph is showing two CARs on one graph? The CAR for before the event and the CAR for after the event?</p>

<p>THanks  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a9a823fa2d5d3281ff455df' id='5a9a823fa2d5d3281ff455df'>
<a href='#5a9a823fa2d5d3281ff455df'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1520075327000' class='quanto-date posted-at response-posted-at' href='#5a9a823fa2d5d3281ff455df'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>The returns are 0 at event date because the plots consider the event date the reference and computes the previous and following returns relative to that date. In this way you can easily see the percentage gain/loss from the event date.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a9b616ce2e61c001bf03a80' id='5a9b616ce2e61c001bf03a80'>
<a href='#5a9b616ce2e61c001bf03a80'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/539fa9e62b7a914823000059'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0c24a0b73ae02be3f89eedb25ee71eaf?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/539fa9e62b7a914823000059'>Brett Elliot</a>
</div>
<a UTCms='1520132460000' class='quanto-date posted-at response-posted-at' href='#5a9b616ce2e61c001bf03a80'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Thanks Luca. That makes sense but I haven&#39;t seen any other event studies do that. I am not an event study expert though :)  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a9bbed1f3d9fa0012549a84' id='5a9bbed1f3d9fa0012549a84'>
<a href='#5a9bbed1f3d9fa0012549a84'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/54460194d718f327fd000380'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/e511e4eeb9334ef82f1caa7bd66c36dc?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/54460194d718f327fd000380'>Luca</a>
</div>
<a UTCms='1520156369000' class='quanto-date posted-at response-posted-at' href='#5a9bbed1f3d9fa0012549a84'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>Well, there might be other interesting ways of displaying that information. What would you have expected from that plot?  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5a9bed00f3d9fa0012549d6c' id='5a9bed00f3d9fa0012549d6c'>
<a href='#5a9bed00f3d9fa0012549d6c'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/539fa9e62b7a914823000059'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/0c24a0b73ae02be3f89eedb25ee71eaf?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/539fa9e62b7a914823000059'>Brett Elliot</a>
</div>
<a UTCms='1520168192000' class='quanto-date posted-at response-posted-at' href='#5a9bed00f3d9fa0012549d6c'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>I think this is probably the best way of viewing the data for the purpose of finding events that result in positive CAR. Like I said I&#39;m new to event studies and my initial investigation has lead me to more generic types of event studies. </p>

<p>As an example, <a href="https://www.eventstudytools.com/event-study-methodology">https://www.eventstudytools.com/event-study-methodology</a> </p>

<p>These tools show the CAR for the whole event window. </p>

<p>That said, the display in this notebook seems pretty good for purposes here.  </p>
</div>
</div>
</div>

<div class='post-container response-container' data-post-id='5abc00168a82505ad9dd4eec' id='5abc00168a82505ad9dd4eec'>
<a href='#5abc00168a82505ad9dd4eec'></a>
<div class='post-metadata'>
<div class='row'>
<div class='col-xs-14'>
<div class='inline-block'>
<div class='avatar-container'>
<a href='/users/55e602a002dd2432b00001d2'><img class='avatar async-image' data-src='https://secure.gravatar.com/avatar/706508819421d25d2dfb273421dc6887?d=https%3A%2F%2Fs3.amazonaws.com%2Fquantopian-website-assets%2Fdefault-avatar.png' height='30' width='30'></a>
</div>
<a class='author-name' href='/users/55e602a002dd2432b00001d2'>Burrito Dan</a>
</div>
<a UTCms='1522270230000' class='quanto-date posted-at response-posted-at' href='#5abc00168a82505ad9dd4eec'></a>
</div>
</div>
</div>

<div class='response-text'>
<div class='response-text-container post-body'><p>There&#39;s an event study built into <a href="https://github.com/quantopian/alphalens/blob/master/alphalens/tears.py">AlphaLens</a>. It might be helpful.</p>

<pre><code>
&quot;&quot;&quot;  
create_full_tear_sheet(factor_data, long_short=False, group_neutral=False, by_group=False)  
create_event_returns_tear_sheet(factor_data, prices, avgretplot=(3, 11),  
                                long_short=False, group_neutral=False, by_group=False)  
    factor_data : pd.DataFrame - MultiIndex  
        A MultiIndex DataFrame indexed by date (level 0) and asset (level 1),  
        containing the values for a single alpha factor, forward returns for  
        each period, the factor quantile/bin that factor value belongs to,  
        and (optionally) the group the asset belongs to.  
        - See full explanation in utils.get_clean_factor_and_forward_returns  
    long_short : bool  
        Should this computation happen on a long short portfolio? if so, then  
        mean quantile returns will be demeaned across the factor universe.  
        Additionally factor values will be demeaned across the factor universe  
        when factor weighting the portfolio for cumulative returns plots  
    group_neutral : bool  
        Should this computation happen on a group neutral portfolio? if so,  
        returns demeaning will occur on the group level.  
        Additionally each group will weight the same in cumulative returns  
        plots  
    by_group : bool  
        If True, display graphs separately for each group.  
&quot;&quot;&quot;
</code></pre>
</div>
</div>
</div>

</div>
<div class='sign-in-please'>
Please <a href='/signin?return_to=/posts/event-study-tearsheet'>sign in</a> or
<a href='/users/sign_up?redirect_to=/posts/event-study-tearsheet'>join Quantopian</a> to
post a reply.
</div>
</div>
<script>
  window.fbAsyncInit = function() {
    FB.init({
      appId: "550580758292093",
      status: false,
      cookie: true,
      xfbml: true
    });
  };
  
  (function(d, debug){
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {return;}
    js = d.createElement('script'); js.id = id; js.async = true;
    js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
    ref.parentNode.insertBefore(js, ref);
  }(document, /*debug*/ false));
  
  window.twttr = (function (d,s,id) {
    var t, js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return; js=d.createElement(s); js.id=id;
    js.src="//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs);
    return window.twttr || (t = { _e: [], ready: function(f){ t._e.push(f) } });
  }(document, "script", "twitter-wjs"));
</script>
<script>
  $(document).ready(function () {
    quanto.instances.pm = new quanto.PostManager(false)
  });
</script>

<div class='login-footer'>
<div class='container'>
<div class='login-footer-text'>
Become an expert in quant finance through Quantopian's hands-on education.
</div>
<div class='login-footer-button'>
<button class='btn btn-v2 stroke join-modal-link mixpanel-button' data-event='anon join footer click posts' data-mixpanel='click'>
Join Now
</button>
</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='error-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'>Error</span>
</div>
<div class='modal-body body-content'>
<p>Sorry, something went wrong.  Try again or contact us by <a class='feedback-link'>sending feedback</a>.</p>
</div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' href='#'>Close</button>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='confirmation-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<div class='pull-right'>
<button class='btn btn-v2 border' data-dismiss='modal'>Cancel</button>
<button class='btn btn-v2 blue action-button' data-dismiss='modal'></button>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='message-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title modal-title'></span>
</div>
<div class='modal-body body-content'></div>
<div class='modal-footer'>
<button class='btn btn-v2 blue action-button' data-dismiss='modal' id='message-modal-close'>Close</button>
</div>

</div>
</div>
</div>

<div class='always-bootstrap3-modals'>
<div class='fade modal quanto-modal-v2' id='join-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header visible-small'>
<span class='title'>
Join Quantopian.  It's Free!
</span>
<div class='modal-x-out visible-xs'></div>
</div>
<div class='modal-body'>
<div class='flex-wrap'>
<div class='join-left-pane hidden-small'>
<div class='margin_30l'>
<div class='join-hero-text'>
Join Quantopian.  It's Free!
</div>
<div class='join-benefits'>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image code'></div>
</div>
<div class='join-text'>
Use our research platform, backtester, and dozens of clean data sets.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image learn'></div>
</div>
<div class='join-text'>
Learn with our hands-on education and community forums.
</div>
</div>
<div class='join-benefit'>
<div class='join-image-container'>
<div class='join-image win'></div>
</div>
<div class='join-text'>
Enter to win cash prizes in our contest.
</div>
</div>
</div>
<div class='hidden saved-reminder'>
Don't worry, all your work is already saved.
</div>
</div>
</div>
<div class='join-right-pane'>
<div class='hidden-small'>
<div class='button-pane'>
<a class="button btn-v2 user-form-btn" href="/signin">Already a Quantopian member?</a>
</div>
</div>
<div class='visible-small'>
<div class='already-member'>
<a href='/signin'>Already a Quantopian member?</a>
</div>
</div>
<form class="quanto-form-v2" id="new-user-modal-form" action="/users" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><div class='error-message hidden'>
<div class='message'></div>
</div>
<div class='name-group'>
<div class='form-group inline-block'>
<label for="user_firstname">First Name</label>
<input class="form-control firstname" pattern=".*" required="required" autocomplete="off" autofocus="autofocus" type="text" name="user[firstname]" id="user_firstname" />
</div>
<div class='form-group inline-block'>
<label for="user_lastname">Last Name</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="text" name="user[lastname]" id="user_lastname" />
</div>
</div>
<div class='form-group'>
<label for="user_email">Email</label>
<input class="form-control" value="" pattern=".*" required="required" autocomplete="off" type="email" name="user[email]" id="user_email" />
</div>
<div class='form-group'>
<label for="user_password">Password</label>
<input autocomplete="off" class="form-control" pattern=".*" required="required" type="password" name="user[password]" id="user_password" />
</div>
<div class='checkbox eula'>
<input id='eula-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='eula-checkbox' id='checkbox-label'>I accept the <a href='/policies/terms' target='_blank'>Terms Of Use</a> and <a href='/policies/privacy' target='_blank'>Privacy Policy</a>.</label>
</div>
<div class='checkbox mailchimp-box'>
<input name="user[allow_marketing_emails]" type="hidden" value="0" /><input type="checkbox" value="1" name="user[allow_marketing_emails]" id="user_allow_marketing_emails" />
<div class='quanto-checkbox'></div>
<label for='user_allow_marketing_emails'>
Send me email updates with the latest news from the Quantopian community. We send these emails about once a month.
</label>
</div>
<div class='button-row'>
<button class='btn-v2 blue full' data-redirect-to='/tutorials/getting-started' id='sign-up-button' type='Submit'>Join Quantopian</button>
</div>
</form></div>
</div>
</div>

</div>
</div>
</div>

<div class='fade modal quanto-modal-v2' id='feedback-modal' role='dialog' tabindex='-1'>
<div class='modal-dialog' role='document'>
<div class='modal-content'>
<div class='modal-header'>
<span class='title'>Contact Support</span>
</div>
<div class='modal-body'>
<form class='anon-user controls quanto-form-v2' id='feedback-form'>
<div class='feedback-inputs'>
<div class='form-group'>
<input autofocus class='form-control' id='feedback-email-box' name='email' placeholder='Email Address' type='email'>
</div>
<div class='form-group'>
<input class='form-control' id='feedback-name-box' placeholder='Name' type='name'>
</div>
<div class='form-group'>
<textarea class='form-control' id='feedback-box' name='feedback' placeholder='What may we help you with?' rows='10'></textarea>
</div>
</div>
</form>
<form class='hidden quanto-form-v2 select-resource-area'>
<div class='select-step select-type-step'>
<div class='form-group'>
<select class='form-control select-resource-dropdown' title='Select the item you need help with'>
<option value='algorithm'>Algorithm</option>
<option value='backtest'>Backtest</option>
<option value='notebook'>Notebook</option>
</select>
</div>
</div>
<div class='select-step loading-area hidden'>
<div class='loading-text'>
Loading...
</div>
</div>
<div class='select-step empty-list-area hidden'>
<div class='back-button'>Go Back</div>
<div class='empty-text'>
No <span class='empty-list-resource-text'>algorithms</span> found
</div>
</div>
<div class='select-algo-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-algo-table select-item-table'>
<thead>
<tr>
<th>
Algorithm
<span class='sort-icon'></span>
</th>
<th>
Last Modified
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-backtest-area select-step hidden'>
<div class='back-button'>Go Back</div>
<table class='select-backtest-table select-item-table'>
<thead>
<tr>
<th>
Backtest
<span class='sort-icon'></span>
</th>
<th>
Started At
<span class='sort-icon'></span>
</th>
<th>
Overall Return
<span class='sort-icon'></span>
</th>
<th>
Status
<span class='sort-icon'></span>
</th>
</tr>
</thead>
</table>
</div>
<div class='select-notebook-area select-step hidden'>
<div class='back-button'>Go Back</div>
<div class='subtitle select-cell-step'>
Choose a cell to use as the preview for this notebook:
</div>
<div class='iframe-wrapper'>
<iframe class='notebook-list-iframe slow-fade' src=''></iframe>
</div>
<div class='progress-area slow-fade in'>
<div class='progress-container'>
<div class='progress-title'>
<div class='quanto-loader gray'></div>
</div>
</div>
</div>
<div class='maintenance-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, research is currently undergoing maintenance.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please check back shortly. If the maintenance period lasts longer than expected,
you can find updates on <a href='https://status.quantopian.com/'>status.quantopian.com</a>.
</div>
</div>

</div>
</div>
<div class='error-area'>
<div class='error-container'>
<div class='row'>
<div class='col-md-14 msg-title h1'>
Sorry, something went wrong on our end.
</div>
</div>
<div class='row'>
<div class='col-md-14 msg-subtitle'>
Please try again or contact <a class='open-feedback-link'>Quantopian support</a>.
</div>
</div>

</div>
</div>

</div>
<div class='selected-item-area select-step hidden'>
<div class='selected-item-group form-group'>
<div class='selected-item-control'>
<input class='disabled form-control selected-item-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change change-primary-item-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
<div class='selected-backtest-control'>
<input class='disabled form-control selected-backtest-box' type='text'>
<span class='secure-icon icon'></span>
<button class='btn change-backtest-button change-selection-button new-btn transparent' type='button'>
<span class='refresh-icon icon'></span>
</button>
</div>
</div>
<div class='checkbox-group form-group'>
<div class='checkbox give-permission'>
<input class='give-permission-checkbox' id='feedback-give-permission-checkbox' type='checkbox'>
<div class='quanto-checkbox'></div>
<label for='feedback-give-permission-checkbox'>
I permit Quantopian to view <span class='item-type-text'>this algorithm,
backtest or notebook and their imported datasets</span> for the purpose of providing support.
</label>
</div>
</div>
</div>
</form>

<div class='loading-step hidden'>
<div class='loading-text'>
Submitting your support ticket...
</div>
</div>
<div class='success-step invisible'>
<h2 class='title center'>
You've successfully submitted a support ticket.
</h2>
<p>
Our support team will be in touch soon.
</p>
<div class='confirmation-image'></div>
</div>
</div>
<div class='modal-footer'>
<button class='btn-v2 blue' id='send-feedback-button'>Send</button>
<div class='error-message hidden'>
Error submitting support request.
</div>
</div>

</div>
</div>
</div>

</div>
</div>
<div class='footer' id='quanto-footer-container'>
<div class='container'>
<div class='row header-row'>
<div class='col-sm-fourth span3'>
<img class='async-image logotype-image' data-src='https://qf.quantopian.com/assets/logos/logo-q-full-b23bda5ac757691b9259d396d0dfef91567165868b8c955a836649686e6d2248.svg'>
</div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'></div>
<div class='col-sm-fourth span3'>
<div class='feedback-email'>
Need help?
<a href="/cdn-cgi/l/email-protection#55333030313734363e152420343b213a253c343b7b363a38">Contact support.</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-sm-fourth span3'>
<div class='header'>Company</div>
<div class='footer-row'>
<a href='/about'>About</a>
</div>
<div class='footer-row'>
<a href='/academia'>Academia</a>
</div>
<div class='footer-row'>
<a href='/jobs'>Careers</a>
</div>
<div class='footer-row'>
<a href='/posts'>Community</a>
</div>
<div class='footer-row'>
<a href='/events'>Events</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Learn &amp; Support</div>
<div class='footer-row'>
<a href='/faq'>FAQ</a>
</div>
<div class='footer-row'>
<a href='/tutorials/getting-started'>Getting Started</a>
</div>
<div class='footer-row'>
<a href='/docs'>Documentation</a>
</div>
<div class='footer-row'>
<a href='/tutorials'>Tutorials</a>
</div>
<div class='footer-row'>
<a href='/lectures'>Lectures</a>
</div>
<div class='footer-row'>
<a href='/opensource'>Open Source</a>
</div>
<div class='footer-row'>
<a href='https://status.quantopian.com/'>Site Status</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Notices</div>
<div class='footer-row'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='footer-row'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
<div class='footer-row'>
<a href='/security'>Security</a>
</div>
<div class='footer-row'>
<a href='/policies/code-of-conduct'>Code of Conduct</a>
</div>
</div>
<div class='col-sm-fourth span3'>
<div class='header'>Follow Us</div>
<div class='footer-row'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='footer-row'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='footer-row'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='footer-row'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
</div>
</div>
<div class='row'>
<div class='col-xs-14 span12'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>
</div>
</div>
<div class='mobile-footer'>
<div class='mobile-nav-category main-links'>
<div class='mobile-nav-row-footer'>
<a href='/about'>About Quantopian</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/jobs'>Careers</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/posts'>Community</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/events'>Events</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/docs'>Documentation</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/academia'>Academia</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/lectures'>Lectures</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://status.quantopian.com/'>Status</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.facebook.com/quantopian'>Facebook</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.twitter.com/quantopian'>Twitter</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.linkedin.com/company/quantopian'>LinkedIn</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='https://www.youtube.com/channel/UC606MUq45P3zFLa4VGKbxsg'>YouTube</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/terms'>Terms of Use</a>
</div>
<div class='mobile-nav-row-footer'>
<a href='/policies/privacy'>Privacy Policy</a>
</div>
</div>
<div class='mobile-nav-category'>
<div class='disclaimer'>
<p>
The material on this website is provided for informational purposes only and does not constitute an offer to sell, a solicitation to buy, or a recommendation or endorsement for any security or strategy, nor does it constitute an offer to provide investment advisory services by Quantopian.
</p>
<p>
In addition, the material offers no opinion with respect to the suitability of any security or specific investment. No information contained herein should be regarded as a suggestion to engage in or refrain from any investment-related course of action as none of Quantopian nor any of its affiliates is undertaking to provide investment advice, act as an adviser to any plan or entity subject to the Employee Retirement Income Security Act of 1974, as amended, individual retirement account or individual retirement annuity, or give advice in a fiduciary capacity with respect to the materials presented herein.  If you are an individual retirement or other investor, contact your financial advisor or other fiduciary unrelated to Quantopian about whether any given investment idea, strategy, product or service described herein may be appropriate for your circumstances.  All investments involve risk, including loss of principal.  Quantopian makes no guarantees as to the accuracy or completeness of the views expressed in the website. The views are subject to change, and may have become unreliable for various reasons, including changes in market conditions or economic circumstances.
</p>

</div>
</div>
</div>

</div>
<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script></body>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', "UA-8519877-1", {
    cookieDomain: "quantopian.com"
  });
  ga('set', 'dimension1', 'session_5f9dc7425d387f00077e48e4');
  
  ga('send', 'pageview');
</script>

<input type="hidden" name="is_mac" id="is_mac" value="false" />
<input type="hidden" name="mp" id="mp" value="75873953cd404bcc1da88a55ff51e3b4" />
<script>
  (function(e,a){if(!a.__SV){var b=window;try{var c,l,i,j=b.location,g=j.hash;c=function(a,b){return(l=a.match(RegExp(b+"=([^&]*)")))?l[1]:null};g&&c(g,"state")&&(i=JSON.parse(decodeURIComponent(c(g,"state"))),"mpeditor"===i.action&&(b.sessionStorage.setItem("_mpcehash",g),history.replaceState(i.desiredHash||"",e.title,j.pathname+j.search)))}catch(m){}var k,h;window.mixpanel=a;a._i=[];a.init=function(b,c,f){function e(b,a){var c=a.split(".");2==c.length&&(b=b[c[0]],a=c[1]);b[a]=function(){b.push([a].concat(Array.prototype.slice.call(arguments,
  0)))}}var d=a;"undefined"!==typeof f?d=a[f]=[]:f="mixpanel";d.people=d.people||[];d.toString=function(b){var a="mixpanel";"mixpanel"!==f&&(a+="."+f);b||(a+=" (stub)");return a};d.people.toString=function(){return d.toString(1)+".people (stub)"};k="disable time_event track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user".split(" ");
  for(h=0;h<k.length;h++)e(d,k[h]);a._i.push([b,c,f])};a.__SV=1.2;b=e.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?MIXPANEL_CUSTOM_LIB_URL:"file:"===e.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";c=e.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}})(document,window.mixpanel||[]);
  mixpanel.init("75873953cd404bcc1da88a55ff51e3b4");
</script>
<script>
  mixpanel.track("view page", {"page": window.location.pathname});
</script>
</html>
